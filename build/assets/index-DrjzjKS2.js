function AS(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();function SS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Hm={exports:{}},Gc={},qm={exports:{}},Ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dv;function TS(){if(dv)return Ke;dv=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function x(W){return W===null||typeof W!="object"?null:(W=m&&W[m]||W["@@iterator"],typeof W=="function"?W:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,E={};function N(W,Z,ce){this.props=W,this.context=Z,this.refs=E,this.updater=ce||v}N.prototype.isReactComponent={},N.prototype.setState=function(W,Z){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,Z,"setState")},N.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function A(){}A.prototype=N.prototype;function T(W,Z,ce){this.props=W,this.context=Z,this.refs=E,this.updater=ce||v}var I=T.prototype=new A;I.constructor=T,w(I,N.prototype),I.isPureReactComponent=!0;var P=Array.isArray,U=Object.prototype.hasOwnProperty,O={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function C(W,Z,ce){var xe,je={},Re=null,fe=null;if(Z!=null)for(xe in Z.ref!==void 0&&(fe=Z.ref),Z.key!==void 0&&(Re=""+Z.key),Z)U.call(Z,xe)&&!R.hasOwnProperty(xe)&&(je[xe]=Z[xe]);var Ue=arguments.length-2;if(Ue===1)je.children=ce;else if(1<Ue){for(var Se=Array(Ue),We=0;We<Ue;We++)Se[We]=arguments[We+2];je.children=Se}if(W&&W.defaultProps)for(xe in Ue=W.defaultProps,Ue)je[xe]===void 0&&(je[xe]=Ue[xe]);return{$$typeof:n,type:W,key:Re,ref:fe,props:je,_owner:O.current}}function D(W,Z){return{$$typeof:n,type:W.type,key:Z,ref:W.ref,props:W.props,_owner:W._owner}}function B(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function V(W){var Z={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ce){return Z[ce]})}var $=/\/+/g;function L(W,Z){return typeof W=="object"&&W!==null&&W.key!=null?V(""+W.key):Z.toString(36)}function de(W,Z,ce,xe,je){var Re=typeof W;(Re==="undefined"||Re==="boolean")&&(W=null);var fe=!1;if(W===null)fe=!0;else switch(Re){case"string":case"number":fe=!0;break;case"object":switch(W.$$typeof){case n:case e:fe=!0}}if(fe)return fe=W,je=je(fe),W=xe===""?"."+L(fe,0):xe,P(je)?(ce="",W!=null&&(ce=W.replace($,"$&/")+"/"),de(je,Z,ce,"",function(We){return We})):je!=null&&(B(je)&&(je=D(je,ce+(!je.key||fe&&fe.key===je.key?"":(""+je.key).replace($,"$&/")+"/")+W)),Z.push(je)),1;if(fe=0,xe=xe===""?".":xe+":",P(W))for(var Ue=0;Ue<W.length;Ue++){Re=W[Ue];var Se=xe+L(Re,Ue);fe+=de(Re,Z,ce,Se,je)}else if(Se=x(W),typeof Se=="function")for(W=Se.call(W),Ue=0;!(Re=W.next()).done;)Re=Re.value,Se=xe+L(Re,Ue++),fe+=de(Re,Z,ce,Se,je);else if(Re==="object")throw Z=String(W),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.");return fe}function ye(W,Z,ce){if(W==null)return W;var xe=[],je=0;return de(W,xe,"","",function(Re){return Z.call(ce,Re,je++)}),xe}function ie(W){if(W._status===-1){var Z=W._result;Z=Z(),Z.then(function(ce){(W._status===0||W._status===-1)&&(W._status=1,W._result=ce)},function(ce){(W._status===0||W._status===-1)&&(W._status=2,W._result=ce)}),W._status===-1&&(W._status=0,W._result=Z)}if(W._status===1)return W._result.default;throw W._result}var oe={current:null},Y={transition:null},he={ReactCurrentDispatcher:oe,ReactCurrentBatchConfig:Y,ReactCurrentOwner:O};function le(){throw Error("act(...) is not supported in production builds of React.")}return Ke.Children={map:ye,forEach:function(W,Z,ce){ye(W,function(){Z.apply(this,arguments)},ce)},count:function(W){var Z=0;return ye(W,function(){Z++}),Z},toArray:function(W){return ye(W,function(Z){return Z})||[]},only:function(W){if(!B(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Ke.Component=N,Ke.Fragment=t,Ke.Profiler=r,Ke.PureComponent=T,Ke.StrictMode=s,Ke.Suspense=d,Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=he,Ke.act=le,Ke.cloneElement=function(W,Z,ce){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var xe=w({},W.props),je=W.key,Re=W.ref,fe=W._owner;if(Z!=null){if(Z.ref!==void 0&&(Re=Z.ref,fe=O.current),Z.key!==void 0&&(je=""+Z.key),W.type&&W.type.defaultProps)var Ue=W.type.defaultProps;for(Se in Z)U.call(Z,Se)&&!R.hasOwnProperty(Se)&&(xe[Se]=Z[Se]===void 0&&Ue!==void 0?Ue[Se]:Z[Se])}var Se=arguments.length-2;if(Se===1)xe.children=ce;else if(1<Se){Ue=Array(Se);for(var We=0;We<Se;We++)Ue[We]=arguments[We+2];xe.children=Ue}return{$$typeof:n,type:W.type,key:je,ref:Re,props:xe,_owner:fe}},Ke.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:i,_context:W},W.Consumer=W},Ke.createElement=C,Ke.createFactory=function(W){var Z=C.bind(null,W);return Z.type=W,Z},Ke.createRef=function(){return{current:null}},Ke.forwardRef=function(W){return{$$typeof:u,render:W}},Ke.isValidElement=B,Ke.lazy=function(W){return{$$typeof:p,_payload:{_status:-1,_result:W},_init:ie}},Ke.memo=function(W,Z){return{$$typeof:h,type:W,compare:Z===void 0?null:Z}},Ke.startTransition=function(W){var Z=Y.transition;Y.transition={};try{W()}finally{Y.transition=Z}},Ke.unstable_act=le,Ke.useCallback=function(W,Z){return oe.current.useCallback(W,Z)},Ke.useContext=function(W){return oe.current.useContext(W)},Ke.useDebugValue=function(){},Ke.useDeferredValue=function(W){return oe.current.useDeferredValue(W)},Ke.useEffect=function(W,Z){return oe.current.useEffect(W,Z)},Ke.useId=function(){return oe.current.useId()},Ke.useImperativeHandle=function(W,Z,ce){return oe.current.useImperativeHandle(W,Z,ce)},Ke.useInsertionEffect=function(W,Z){return oe.current.useInsertionEffect(W,Z)},Ke.useLayoutEffect=function(W,Z){return oe.current.useLayoutEffect(W,Z)},Ke.useMemo=function(W,Z){return oe.current.useMemo(W,Z)},Ke.useReducer=function(W,Z,ce){return oe.current.useReducer(W,Z,ce)},Ke.useRef=function(W){return oe.current.useRef(W)},Ke.useState=function(W){return oe.current.useState(W)},Ke.useSyncExternalStore=function(W,Z,ce){return oe.current.useSyncExternalStore(W,Z,ce)},Ke.useTransition=function(){return oe.current.useTransition()},Ke.version="18.3.1",Ke}var hv;function N0(){return hv||(hv=1,qm.exports=TS()),qm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fv;function CS(){if(fv)return Gc;fv=1;var n=N0(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(u,d,h){var p,m={},x=null,v=null;h!==void 0&&(x=""+h),d.key!==void 0&&(x=""+d.key),d.ref!==void 0&&(v=d.ref);for(p in d)s.call(d,p)&&!i.hasOwnProperty(p)&&(m[p]=d[p]);if(u&&u.defaultProps)for(p in d=u.defaultProps,d)m[p]===void 0&&(m[p]=d[p]);return{$$typeof:e,type:u,key:x,ref:v,props:m,_owner:r.current}}return Gc.Fragment=t,Gc.jsx=o,Gc.jsxs=o,Gc}var pv;function IS(){return pv||(pv=1,Hm.exports=CS()),Hm.exports}var l=IS(),kh={},Wm={exports:{}},Ws={},Gm={exports:{}},Km={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mv;function PS(){return mv||(mv=1,(function(n){function e(Y,he){var le=Y.length;Y.push(he);e:for(;0<le;){var W=le-1>>>1,Z=Y[W];if(0<r(Z,he))Y[W]=he,Y[le]=Z,le=W;else break e}}function t(Y){return Y.length===0?null:Y[0]}function s(Y){if(Y.length===0)return null;var he=Y[0],le=Y.pop();if(le!==he){Y[0]=le;e:for(var W=0,Z=Y.length,ce=Z>>>1;W<ce;){var xe=2*(W+1)-1,je=Y[xe],Re=xe+1,fe=Y[Re];if(0>r(je,le))Re<Z&&0>r(fe,je)?(Y[W]=fe,Y[Re]=le,W=Re):(Y[W]=je,Y[xe]=le,W=xe);else if(Re<Z&&0>r(fe,le))Y[W]=fe,Y[Re]=le,W=Re;else break e}}return he}function r(Y,he){var le=Y.sortIndex-he.sortIndex;return le!==0?le:Y.id-he.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,u=o.now();n.unstable_now=function(){return o.now()-u}}var d=[],h=[],p=1,m=null,x=3,v=!1,w=!1,E=!1,N=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(Y){for(var he=t(h);he!==null;){if(he.callback===null)s(h);else if(he.startTime<=Y)s(h),he.sortIndex=he.expirationTime,e(d,he);else break;he=t(h)}}function P(Y){if(E=!1,I(Y),!w)if(t(d)!==null)w=!0,ie(U);else{var he=t(h);he!==null&&oe(P,he.startTime-Y)}}function U(Y,he){w=!1,E&&(E=!1,A(C),C=-1),v=!0;var le=x;try{for(I(he),m=t(d);m!==null&&(!(m.expirationTime>he)||Y&&!V());){var W=m.callback;if(typeof W=="function"){m.callback=null,x=m.priorityLevel;var Z=W(m.expirationTime<=he);he=n.unstable_now(),typeof Z=="function"?m.callback=Z:m===t(d)&&s(d),I(he)}else s(d);m=t(d)}if(m!==null)var ce=!0;else{var xe=t(h);xe!==null&&oe(P,xe.startTime-he),ce=!1}return ce}finally{m=null,x=le,v=!1}}var O=!1,R=null,C=-1,D=5,B=-1;function V(){return!(n.unstable_now()-B<D)}function $(){if(R!==null){var Y=n.unstable_now();B=Y;var he=!0;try{he=R(!0,Y)}finally{he?L():(O=!1,R=null)}}else O=!1}var L;if(typeof T=="function")L=function(){T($)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ye=de.port2;de.port1.onmessage=$,L=function(){ye.postMessage(null)}}else L=function(){N($,0)};function ie(Y){R=Y,O||(O=!0,L())}function oe(Y,he){C=N(function(){Y(n.unstable_now())},he)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_continueExecution=function(){w||v||(w=!0,ie(U))},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(Y){switch(x){case 1:case 2:case 3:var he=3;break;default:he=x}var le=x;x=he;try{return Y()}finally{x=le}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Y,he){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var le=x;x=Y;try{return he()}finally{x=le}},n.unstable_scheduleCallback=function(Y,he,le){var W=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?W+le:W):le=W,Y){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=le+Z,Y={id:p++,callback:he,priorityLevel:Y,startTime:le,expirationTime:Z,sortIndex:-1},le>W?(Y.sortIndex=le,e(h,Y),t(d)===null&&Y===t(h)&&(E?(A(C),C=-1):E=!0,oe(P,le-W))):(Y.sortIndex=Z,e(d,Y),w||v||(w=!0,ie(U))),Y},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(Y){var he=x;return function(){var le=x;x=he;try{return Y.apply(this,arguments)}finally{x=le}}}})(Km)),Km}var gv;function jS(){return gv||(gv=1,Gm.exports=PS()),Gm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yv;function RS(){if(yv)return Ws;yv=1;var n=N0(),e=jS();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function i(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)s.add(c[a])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function x(a){return d.call(m,a)?!0:d.call(p,a)?!1:h.test(a)?m[a]=!0:(p[a]=!0,!1)}function v(a,c,f,y){if(f!==null&&f.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return y?!1:f!==null?!f.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function w(a,c,f,y){if(c===null||typeof c>"u"||v(a,c,f,y))return!0;if(y)return!1;if(f!==null)switch(f.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function E(a,c,f,y,b,_,j){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=y,this.attributeNamespace=b,this.mustUseProperty=f,this.propertyName=a,this.type=c,this.sanitizeURL=_,this.removeEmptyString=j}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){N[a]=new E(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];N[c]=new E(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){N[a]=new E(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){N[a]=new E(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){N[a]=new E(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){N[a]=new E(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){N[a]=new E(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){N[a]=new E(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){N[a]=new E(a,5,!1,a.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function T(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(A,T);N[c]=new E(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(A,T);N[c]=new E(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(A,T);N[c]=new E(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){N[a]=new E(a,1,!1,a.toLowerCase(),null,!1,!1)}),N.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){N[a]=new E(a,1,!1,a.toLowerCase(),null,!0,!0)});function I(a,c,f,y){var b=N.hasOwnProperty(c)?N[c]:null;(b!==null?b.type!==0:y||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(w(c,f,b,y)&&(f=null),y||b===null?x(c)&&(f===null?a.removeAttribute(c):a.setAttribute(c,""+f)):b.mustUseProperty?a[b.propertyName]=f===null?b.type===3?!1:"":f:(c=b.attributeName,y=b.attributeNamespace,f===null?a.removeAttribute(c):(b=b.type,f=b===3||b===4&&f===!0?"":""+f,y?a.setAttributeNS(y,c,f):a.setAttribute(c,f))))}var P=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,U=Symbol.for("react.element"),O=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),V=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),ye=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),oe=Symbol.for("react.offscreen"),Y=Symbol.iterator;function he(a){return a===null||typeof a!="object"?null:(a=Y&&a[Y]||a["@@iterator"],typeof a=="function"?a:null)}var le=Object.assign,W;function Z(a){if(W===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);W=c&&c[1]||""}return`
`+W+a}var ce=!1;function xe(a,c){if(!a||ce)return"";ce=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Q){var y=Q}Reflect.construct(a,[],c)}else{try{c.call()}catch(Q){y=Q}a.call(c.prototype)}else{try{throw Error()}catch(Q){y=Q}a()}}catch(Q){if(Q&&y&&typeof Q.stack=="string"){for(var b=Q.stack.split(`
`),_=y.stack.split(`
`),j=b.length-1,z=_.length-1;1<=j&&0<=z&&b[j]!==_[z];)z--;for(;1<=j&&0<=z;j--,z--)if(b[j]!==_[z]){if(j!==1||z!==1)do if(j--,z--,0>z||b[j]!==_[z]){var H=`
`+b[j].replace(" at new "," at ");return a.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",a.displayName)),H}while(1<=j&&0<=z);break}}}finally{ce=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?Z(a):""}function je(a){switch(a.tag){case 5:return Z(a.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return a=xe(a.type,!1),a;case 11:return a=xe(a.type.render,!1),a;case 1:return a=xe(a.type,!0),a;default:return""}}function Re(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case R:return"Fragment";case O:return"Portal";case D:return"Profiler";case C:return"StrictMode";case L:return"Suspense";case de:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case V:return(a.displayName||"Context")+".Consumer";case B:return(a._context.displayName||"Context")+".Provider";case $:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case ye:return c=a.displayName||null,c!==null?c:Re(a.type)||"Memo";case ie:c=a._payload,a=a._init;try{return Re(a(c))}catch{}}return null}function fe(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Re(c);case 8:return c===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ue(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Se(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function We(a){var c=Se(a)?"checked":"value",f=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),y=""+a[c];if(!a.hasOwnProperty(c)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var b=f.get,_=f.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return b.call(this)},set:function(j){y=""+j,_.call(this,j)}}),Object.defineProperty(a,c,{enumerable:f.enumerable}),{getValue:function(){return y},setValue:function(j){y=""+j},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function st(a){a._valueTracker||(a._valueTracker=We(a))}function Tt(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var f=c.getValue(),y="";return a&&(y=Se(a)?a.checked?"true":"false":a.value),a=y,a!==f?(c.setValue(a),!0):!1}function en(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function mi(a,c){var f=c.checked;return le({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??a._wrapperState.initialChecked})}function ld(a,c){var f=c.defaultValue==null?"":c.defaultValue,y=c.checked!=null?c.checked:c.defaultChecked;f=Ue(c.value!=null?c.value:f),a._wrapperState={initialChecked:y,initialValue:f,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function ko(a,c){c=c.checked,c!=null&&I(a,"checked",c,!1)}function Ea(a,c){ko(a,c);var f=Ue(c.value),y=c.type;if(f!=null)y==="number"?(f===0&&a.value===""||a.value!=f)&&(a.value=""+f):a.value!==""+f&&(a.value=""+f);else if(y==="submit"||y==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?Ht(a,c.type,f):c.hasOwnProperty("defaultValue")&&Ht(a,c.type,Ue(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function ec(a,c,f){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var y=c.type;if(!(y!=="submit"&&y!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,f||c===a.value||(a.value=c),a.defaultValue=c}f=a.name,f!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,f!==""&&(a.name=f)}function Ht(a,c,f){(c!=="number"||en(a.ownerDocument)!==a)&&(f==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+f&&(a.defaultValue=""+f))}var Mt=Array.isArray;function Dn(a,c,f,y){if(a=a.options,c){c={};for(var b=0;b<f.length;b++)c["$"+f[b]]=!0;for(f=0;f<a.length;f++)b=c.hasOwnProperty("$"+a[f].value),a[f].selected!==b&&(a[f].selected=b),b&&y&&(a[f].defaultSelected=!0)}else{for(f=""+Ue(f),c=null,b=0;b<a.length;b++){if(a[b].value===f){a[b].selected=!0,y&&(a[b].defaultSelected=!0);return}c!==null||a[b].disabled||(c=a[b])}c!==null&&(c.selected=!0)}}function tc(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return le({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function sc(a,c){var f=c.value;if(f==null){if(f=c.children,c=c.defaultValue,f!=null){if(c!=null)throw Error(t(92));if(Mt(f)){if(1<f.length)throw Error(t(93));f=f[0]}c=f}c==null&&(c=""),f=c}a._wrapperState={initialValue:Ue(f)}}function cd(a,c){var f=Ue(c.value),y=Ue(c.defaultValue);f!=null&&(f=""+f,f!==a.value&&(a.value=f),c.defaultValue==null&&a.defaultValue!==f&&(a.defaultValue=f)),y!=null&&(a.defaultValue=""+y)}function gi(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function nc(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Eo(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?nc(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var yi,ud=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,f,y,b){MSApp.execUnsafeLocalFunction(function(){return a(c,f,y,b)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(yi=yi||document.createElement("div"),yi.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=yi.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Na(a,c){if(c){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=c;return}}a.textContent=c}var xi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dd=["Webkit","ms","Moz","O"];Object.keys(xi).forEach(function(a){dd.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),xi[c]=xi[a]})});function bi(a,c,f){return c==null||typeof c=="boolean"||c===""?"":f||typeof c!="number"||c===0||xi.hasOwnProperty(a)&&xi[a]?(""+c).trim():c+"px"}function No(a,c){a=a.style;for(var f in c)if(c.hasOwnProperty(f)){var y=f.indexOf("--")===0,b=bi(f,c[f],y);f==="float"&&(f="cssFloat"),y?a.setProperty(f,b):a[f]=b}}var rc=le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mn(a,c){if(c){if(rc[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Ao(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vi=null;function So(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Pr=null,jr=null,Ct=null;function ic(a){if(a=jc(a)){if(typeof Pr!="function")throw Error(t(280));var c=a.stateNode;c&&(c=Fd(c),Pr(a.stateNode,a.type,c))}}function wi(a){jr?Ct?Ct.push(a):Ct=[a]:jr=a}function _i(){if(jr){var a=jr,c=Ct;if(Ct=jr=null,ic(a),c)for(a=0;a<c.length;a++)ic(c[a])}}function hd(a,c){return a(c)}function fd(){}var Jn=!1;function pd(a,c,f){if(Jn)return a(c,f);Jn=!0;try{return hd(a,c,f)}finally{Jn=!1,(jr!==null||Ct!==null)&&(fd(),_i())}}function Aa(a,c){var f=a.stateNode;if(f===null)return null;var y=Fd(f);if(y===null)return null;f=y[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break e;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(t(231,c,typeof f));return f}var ki=!1;if(u)try{var Ei={};Object.defineProperty(Ei,"passive",{get:function(){ki=!0}}),window.addEventListener("test",Ei,Ei),window.removeEventListener("test",Ei,Ei)}catch{ki=!1}function md(a,c,f,y,b,_,j,z,H){var Q=Array.prototype.slice.call(arguments,3);try{c.apply(f,Q)}catch(ne){this.onError(ne)}}var Rr=!1,Zn=null,To=!1,yn=null,gd={onError:function(a){Rr=!0,Zn=a}};function yd(a,c,f,y,b,_,j,z,H){Rr=!1,Zn=null,md.apply(gd,arguments)}function ac(a,c,f,y,b,_,j,z,H){if(yd.apply(this,arguments),Rr){if(Rr){var Q=Zn;Rr=!1,Zn=null}else throw Error(t(198));To||(To=!0,yn=Q)}}function Ln(a){var c=a,f=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(f=c.return),a=c.return;while(a)}return c.tag===3?f:null}function oc(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function xd(a){if(Ln(a)!==a)throw Error(t(188))}function bd(a){var c=a.alternate;if(!c){if(c=Ln(a),c===null)throw Error(t(188));return c!==a?null:a}for(var f=a,y=c;;){var b=f.return;if(b===null)break;var _=b.alternate;if(_===null){if(y=b.return,y!==null){f=y;continue}break}if(b.child===_.child){for(_=b.child;_;){if(_===f)return xd(b),a;if(_===y)return xd(b),c;_=_.sibling}throw Error(t(188))}if(f.return!==y.return)f=b,y=_;else{for(var j=!1,z=b.child;z;){if(z===f){j=!0,f=b,y=_;break}if(z===y){j=!0,y=b,f=_;break}z=z.sibling}if(!j){for(z=_.child;z;){if(z===f){j=!0,f=_,y=b;break}if(z===y){j=!0,y=_,f=b;break}z=z.sibling}if(!j)throw Error(t(189))}}if(f.alternate!==y)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?a:c}function vd(a){return a=bd(a),a!==null?Sa(a):null}function Sa(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=Sa(a);if(c!==null)return c;a=a.sibling}return null}var lc=e.unstable_scheduleCallback,Co=e.unstable_cancelCallback,Ta=e.unstable_shouldYield,Dr=e.unstable_requestPaint,gt=e.unstable_now,wp=e.unstable_getCurrentPriorityLevel,Io=e.unstable_ImmediatePriority,cc=e.unstable_UserBlockingPriority,Ca=e.unstable_NormalPriority,uc=e.unstable_LowPriority,Po=e.unstable_IdlePriority,Ia=null,tn=null;function wd(a){if(tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(Ia,a,void 0,(a.current.flags&128)===128)}catch{}}var sn=Math.clz32?Math.clz32:Pa,er=Math.log,xn=Math.LN2;function Pa(a){return a>>>=0,a===0?32:31-(er(a)/xn|0)|0}var tr=64,Ni=4194304;function it(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Mr(a,c){var f=a.pendingLanes;if(f===0)return 0;var y=0,b=a.suspendedLanes,_=a.pingedLanes,j=f&268435455;if(j!==0){var z=j&~b;z!==0?y=it(z):(_&=j,_!==0&&(y=it(_)))}else j=f&~b,j!==0?y=it(j):_!==0&&(y=it(_));if(y===0)return 0;if(c!==0&&c!==y&&(c&b)===0&&(b=y&-y,_=c&-c,b>=_||b===16&&(_&4194240)!==0))return c;if((y&4)!==0&&(y|=f&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=y;0<c;)f=31-sn(c),b=1<<f,y|=a[f],c&=~b;return y}function ja(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ra(a,c){for(var f=a.suspendedLanes,y=a.pingedLanes,b=a.expirationTimes,_=a.pendingLanes;0<_;){var j=31-sn(_),z=1<<j,H=b[j];H===-1?((z&f)===0||(z&y)!==0)&&(b[j]=ja(z,c)):H<=c&&(a.expiredLanes|=z),_&=~z}}function dc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function hc(){var a=tr;return tr<<=1,(tr&4194240)===0&&(tr=64),a}function fc(a){for(var c=[],f=0;31>f;f++)c.push(a);return c}function Da(a,c,f){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-sn(c),a[c]=f}function _p(a,c){var f=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var y=a.eventTimes;for(a=a.expirationTimes;0<f;){var b=31-sn(f),_=1<<b;c[b]=0,y[b]=-1,a[b]=-1,f&=~_}}function pc(a,c){var f=a.entangledLanes|=c;for(a=a.entanglements;f;){var y=31-sn(f),b=1<<y;b&c|a[y]&c&&(a[y]|=c),f&=~b}}var Je=0;function sr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var mc,jo,gc,yc,xc,nr=!1,Ro=[],rr=null,ir=null,cs=null,Ma=new Map,Lr=new Map,nn=[],_d="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ai(a,c){switch(a){case"focusin":case"focusout":rr=null;break;case"dragenter":case"dragleave":ir=null;break;case"mouseover":case"mouseout":cs=null;break;case"pointerover":case"pointerout":Ma.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lr.delete(c.pointerId)}}function On(a,c,f,y,b,_){return a===null||a.nativeEvent!==_?(a={blockedOn:c,domEventName:f,eventSystemFlags:y,nativeEvent:_,targetContainers:[b]},c!==null&&(c=jc(c),c!==null&&jo(c)),a):(a.eventSystemFlags|=y,c=a.targetContainers,b!==null&&c.indexOf(b)===-1&&c.push(b),a)}function kd(a,c,f,y,b){switch(c){case"focusin":return rr=On(rr,a,c,f,y,b),!0;case"dragenter":return ir=On(ir,a,c,f,y,b),!0;case"mouseover":return cs=On(cs,a,c,f,y,b),!0;case"pointerover":var _=b.pointerId;return Ma.set(_,On(Ma.get(_)||null,a,c,f,y,b)),!0;case"gotpointercapture":return _=b.pointerId,Lr.set(_,On(Lr.get(_)||null,a,c,f,y,b)),!0}return!1}function Do(a){var c=Va(a.target);if(c!==null){var f=Ln(c);if(f!==null){if(c=f.tag,c===13){if(c=oc(f),c!==null){a.blockedOn=c,xc(a.priority,function(){gc(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function dt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var f=Mo(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(f===null){f=a.nativeEvent;var y=new f.constructor(f.type,f);vi=y,f.target.dispatchEvent(y),vi=null}else return c=jc(f),c!==null&&jo(c),a.blockedOn=f,!1;c.shift()}return!0}function Ed(a,c,f){dt(a)&&f.delete(c)}function kp(){nr=!1,rr!==null&&dt(rr)&&(rr=null),ir!==null&&dt(ir)&&(ir=null),cs!==null&&dt(cs)&&(cs=null),Ma.forEach(Ed),Lr.forEach(Ed)}function Si(a,c){a.blockedOn===c&&(a.blockedOn=null,nr||(nr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,kp)))}function Ti(a){function c(b){return Si(b,a)}if(0<Ro.length){Si(Ro[0],a);for(var f=1;f<Ro.length;f++){var y=Ro[f];y.blockedOn===a&&(y.blockedOn=null)}}for(rr!==null&&Si(rr,a),ir!==null&&Si(ir,a),cs!==null&&Si(cs,a),Ma.forEach(c),Lr.forEach(c),f=0;f<nn.length;f++)y=nn[f],y.blockedOn===a&&(y.blockedOn=null);for(;0<nn.length&&(f=nn[0],f.blockedOn===null);)Do(f),f.blockedOn===null&&nn.shift()}var Or=P.ReactCurrentBatchConfig,Fr=!0;function ar(a,c,f,y){var b=Je,_=Or.transition;Or.transition=null;try{Je=1,bc(a,c,f,y)}finally{Je=b,Or.transition=_}}function Nd(a,c,f,y){var b=Je,_=Or.transition;Or.transition=null;try{Je=4,bc(a,c,f,y)}finally{Je=b,Or.transition=_}}function bc(a,c,f,y){if(Fr){var b=Mo(a,c,f,y);if(b===null)Dp(a,c,y,or,f),Ai(a,y);else if(kd(b,a,c,f,y))y.stopPropagation();else if(Ai(a,y),c&4&&-1<_d.indexOf(a)){for(;b!==null;){var _=jc(b);if(_!==null&&mc(_),_=Mo(a,c,f,y),_===null&&Dp(a,c,y,or,f),_===b)break;b=_}b!==null&&y.stopPropagation()}else Dp(a,c,y,null,f)}}var or=null;function Mo(a,c,f,y){if(or=null,a=So(y),a=Va(a),a!==null)if(c=Ln(a),c===null)a=null;else if(f=c.tag,f===13){if(a=oc(c),a!==null)return a;a=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return or=a,null}function Lo(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wp()){case Io:return 1;case cc:return 4;case Ca:case uc:return 16;case Po:return 536870912;default:return 16}default:return 16}}var rn=null,Oo=null,Vr=null;function Ad(){if(Vr)return Vr;var a,c=Oo,f=c.length,y,b="value"in rn?rn.value:rn.textContent,_=b.length;for(a=0;a<f&&c[a]===b[a];a++);var j=f-a;for(y=1;y<=j&&c[f-y]===b[_-y];y++);return Vr=b.slice(a,1<y?1-y:void 0)}function La(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function lr(){return!0}function vc(){return!1}function ws(a){function c(f,y,b,_,j){this._reactName=f,this._targetInst=b,this.type=y,this.nativeEvent=_,this.target=j,this.currentTarget=null;for(var z in a)a.hasOwnProperty(z)&&(f=a[z],this[z]=f?f(_):_[z]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?lr:vc,this.isPropagationStopped=vc,this}return le(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=lr)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=lr)},persist:function(){},isPersistent:lr}),c}var cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oa=ws(cr),Ci=le({},cr,{view:0,detail:0}),Fo=ws(Ci),Vo,Uo,an,Fa=le({},Ci,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Be,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==an&&(an&&a.type==="mousemove"?(Vo=a.screenX-an.screenX,Uo=a.screenY-an.screenY):Uo=Vo=0,an=a),Vo)},movementY:function(a){return"movementY"in a?a.movementY:Uo}}),wc=ws(Fa),Sd=le({},Fa,{dataTransfer:0}),Td=ws(Sd),Bo=le({},Ci,{relatedTarget:0}),us=ws(Bo),Cd=le({},cr,{animationName:0,elapsedTime:0,pseudoElement:0}),Id=ws(Cd),Ii=le({},cr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=ws(Ii),k=le({},cr,{data:0}),S=ws(k),M={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},K={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},J={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ue(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=J[a])?!!c[a]:!1}function Be(){return ue}var Lt=le({},Ci,{key:function(a){if(a.key){var c=M[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=La(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?K[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Be,charCode:function(a){return a.type==="keypress"?La(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?La(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ct=ws(Lt),qt=le({},Fa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),on=ws(qt),Ur=le({},Ci,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Be}),ur=ws(Ur),dr=le({},cr,{propertyName:0,elapsedTime:0,pseudoElement:0}),zo=ws(dr),_c=le({},Fa,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),vA=ws(_c),wA=[9,13,27,32],Ep=u&&"CompositionEvent"in window,kc=null;u&&"documentMode"in document&&(kc=document.documentMode);var _A=u&&"TextEvent"in window&&!kc,nx=u&&(!Ep||kc&&8<kc&&11>=kc),rx=" ",ix=!1;function ax(a,c){switch(a){case"keyup":return wA.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ox(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var $o=!1;function kA(a,c){switch(a){case"compositionend":return ox(c);case"keypress":return c.which!==32?null:(ix=!0,rx);case"textInput":return a=c.data,a===rx&&ix?null:a;default:return null}}function EA(a,c){if($o)return a==="compositionend"||!Ep&&ax(a,c)?(a=Ad(),Vr=Oo=rn=null,$o=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return nx&&c.locale!=="ko"?null:c.data;default:return null}}var NA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lx(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!NA[a.type]:c==="textarea"}function cx(a,c,f,y){wi(y),c=Md(c,"onChange"),0<c.length&&(f=new Oa("onChange","change",null,f,y),a.push({event:f,listeners:c}))}var Ec=null,Nc=null;function AA(a){Sx(a,0)}function Pd(a){var c=Ko(a);if(Tt(c))return a}function SA(a,c){if(a==="change")return c}var ux=!1;if(u){var Np;if(u){var Ap="oninput"in document;if(!Ap){var dx=document.createElement("div");dx.setAttribute("oninput","return;"),Ap=typeof dx.oninput=="function"}Np=Ap}else Np=!1;ux=Np&&(!document.documentMode||9<document.documentMode)}function hx(){Ec&&(Ec.detachEvent("onpropertychange",fx),Nc=Ec=null)}function fx(a){if(a.propertyName==="value"&&Pd(Nc)){var c=[];cx(c,Nc,a,So(a)),pd(AA,c)}}function TA(a,c,f){a==="focusin"?(hx(),Ec=c,Nc=f,Ec.attachEvent("onpropertychange",fx)):a==="focusout"&&hx()}function CA(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Pd(Nc)}function IA(a,c){if(a==="click")return Pd(c)}function PA(a,c){if(a==="input"||a==="change")return Pd(c)}function jA(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var Fn=typeof Object.is=="function"?Object.is:jA;function Ac(a,c){if(Fn(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var f=Object.keys(a),y=Object.keys(c);if(f.length!==y.length)return!1;for(y=0;y<f.length;y++){var b=f[y];if(!d.call(c,b)||!Fn(a[b],c[b]))return!1}return!0}function px(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function mx(a,c){var f=px(a);a=0;for(var y;f;){if(f.nodeType===3){if(y=a+f.textContent.length,a<=c&&y>=c)return{node:f,offset:c-a};a=y}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=px(f)}}function gx(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?gx(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function yx(){for(var a=window,c=en();c instanceof a.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)a=c.contentWindow;else break;c=en(a.document)}return c}function Sp(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function RA(a){var c=yx(),f=a.focusedElem,y=a.selectionRange;if(c!==f&&f&&f.ownerDocument&&gx(f.ownerDocument.documentElement,f)){if(y!==null&&Sp(f)){if(c=y.start,a=y.end,a===void 0&&(a=c),"selectionStart"in f)f.selectionStart=c,f.selectionEnd=Math.min(a,f.value.length);else if(a=(c=f.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var b=f.textContent.length,_=Math.min(y.start,b);y=y.end===void 0?_:Math.min(y.end,b),!a.extend&&_>y&&(b=y,y=_,_=b),b=mx(f,_);var j=mx(f,y);b&&j&&(a.rangeCount!==1||a.anchorNode!==b.node||a.anchorOffset!==b.offset||a.focusNode!==j.node||a.focusOffset!==j.offset)&&(c=c.createRange(),c.setStart(b.node,b.offset),a.removeAllRanges(),_>y?(a.addRange(c),a.extend(j.node,j.offset)):(c.setEnd(j.node,j.offset),a.addRange(c)))}}for(c=[],a=f;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<c.length;f++)a=c[f],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var DA=u&&"documentMode"in document&&11>=document.documentMode,Ho=null,Tp=null,Sc=null,Cp=!1;function xx(a,c,f){var y=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Cp||Ho==null||Ho!==en(y)||(y=Ho,"selectionStart"in y&&Sp(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Sc&&Ac(Sc,y)||(Sc=y,y=Md(Tp,"onSelect"),0<y.length&&(c=new Oa("onSelect","select",null,c,f),a.push({event:c,listeners:y}),c.target=Ho)))}function jd(a,c){var f={};return f[a.toLowerCase()]=c.toLowerCase(),f["Webkit"+a]="webkit"+c,f["Moz"+a]="moz"+c,f}var qo={animationend:jd("Animation","AnimationEnd"),animationiteration:jd("Animation","AnimationIteration"),animationstart:jd("Animation","AnimationStart"),transitionend:jd("Transition","TransitionEnd")},Ip={},bx={};u&&(bx=document.createElement("div").style,"AnimationEvent"in window||(delete qo.animationend.animation,delete qo.animationiteration.animation,delete qo.animationstart.animation),"TransitionEvent"in window||delete qo.transitionend.transition);function Rd(a){if(Ip[a])return Ip[a];if(!qo[a])return a;var c=qo[a],f;for(f in c)if(c.hasOwnProperty(f)&&f in bx)return Ip[a]=c[f];return a}var vx=Rd("animationend"),wx=Rd("animationiteration"),_x=Rd("animationstart"),kx=Rd("transitionend"),Ex=new Map,Nx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(a,c){Ex.set(a,c),i(c,[a])}for(var Pp=0;Pp<Nx.length;Pp++){var jp=Nx[Pp],MA=jp.toLowerCase(),LA=jp[0].toUpperCase()+jp.slice(1);Pi(MA,"on"+LA)}Pi(vx,"onAnimationEnd"),Pi(wx,"onAnimationIteration"),Pi(_x,"onAnimationStart"),Pi("dblclick","onDoubleClick"),Pi("focusin","onFocus"),Pi("focusout","onBlur"),Pi(kx,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tc));function Ax(a,c,f){var y=a.type||"unknown-event";a.currentTarget=f,ac(y,c,void 0,a),a.currentTarget=null}function Sx(a,c){c=(c&4)!==0;for(var f=0;f<a.length;f++){var y=a[f],b=y.event;y=y.listeners;e:{var _=void 0;if(c)for(var j=y.length-1;0<=j;j--){var z=y[j],H=z.instance,Q=z.currentTarget;if(z=z.listener,H!==_&&b.isPropagationStopped())break e;Ax(b,z,Q),_=H}else for(j=0;j<y.length;j++){if(z=y[j],H=z.instance,Q=z.currentTarget,z=z.listener,H!==_&&b.isPropagationStopped())break e;Ax(b,z,Q),_=H}}}if(To)throw a=yn,To=!1,yn=null,a}function yt(a,c){var f=c[Up];f===void 0&&(f=c[Up]=new Set);var y=a+"__bubble";f.has(y)||(Tx(c,a,2,!1),f.add(y))}function Rp(a,c,f){var y=0;c&&(y|=4),Tx(f,a,y,c)}var Dd="_reactListening"+Math.random().toString(36).slice(2);function Cc(a){if(!a[Dd]){a[Dd]=!0,s.forEach(function(f){f!=="selectionchange"&&(OA.has(f)||Rp(f,!1,a),Rp(f,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Dd]||(c[Dd]=!0,Rp("selectionchange",!1,c))}}function Tx(a,c,f,y){switch(Lo(c)){case 1:var b=ar;break;case 4:b=Nd;break;default:b=bc}f=b.bind(null,c,f,a),b=void 0,!ki||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(b=!0),y?b!==void 0?a.addEventListener(c,f,{capture:!0,passive:b}):a.addEventListener(c,f,!0):b!==void 0?a.addEventListener(c,f,{passive:b}):a.addEventListener(c,f,!1)}function Dp(a,c,f,y,b){var _=y;if((c&1)===0&&(c&2)===0&&y!==null)e:for(;;){if(y===null)return;var j=y.tag;if(j===3||j===4){var z=y.stateNode.containerInfo;if(z===b||z.nodeType===8&&z.parentNode===b)break;if(j===4)for(j=y.return;j!==null;){var H=j.tag;if((H===3||H===4)&&(H=j.stateNode.containerInfo,H===b||H.nodeType===8&&H.parentNode===b))return;j=j.return}for(;z!==null;){if(j=Va(z),j===null)return;if(H=j.tag,H===5||H===6){y=_=j;continue e}z=z.parentNode}}y=y.return}pd(function(){var Q=_,ne=So(f),re=[];e:{var se=Ex.get(a);if(se!==void 0){var me=Oa,_e=a;switch(a){case"keypress":if(La(f)===0)break e;case"keydown":case"keyup":me=ct;break;case"focusin":_e="focus",me=us;break;case"focusout":_e="blur",me=us;break;case"beforeblur":case"afterblur":me=us;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=wc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=Td;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=ur;break;case vx:case wx:case _x:me=Id;break;case kx:me=zo;break;case"scroll":me=Fo;break;case"wheel":me=vA;break;case"copy":case"cut":case"paste":me=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=on}var Ne=(c&4)!==0,Ot=!Ne&&a==="scroll",G=Ne?se!==null?se+"Capture":null:se;Ne=[];for(var q=Q,X;q!==null;){X=q;var ae=X.stateNode;if(X.tag===5&&ae!==null&&(X=ae,G!==null&&(ae=Aa(q,G),ae!=null&&Ne.push(Ic(q,ae,X)))),Ot)break;q=q.return}0<Ne.length&&(se=new me(se,_e,null,f,ne),re.push({event:se,listeners:Ne}))}}if((c&7)===0){e:{if(se=a==="mouseover"||a==="pointerover",me=a==="mouseout"||a==="pointerout",se&&f!==vi&&(_e=f.relatedTarget||f.fromElement)&&(Va(_e)||_e[Br]))break e;if((me||se)&&(se=ne.window===ne?ne:(se=ne.ownerDocument)?se.defaultView||se.parentWindow:window,me?(_e=f.relatedTarget||f.toElement,me=Q,_e=_e?Va(_e):null,_e!==null&&(Ot=Ln(_e),_e!==Ot||_e.tag!==5&&_e.tag!==6)&&(_e=null)):(me=null,_e=Q),me!==_e)){if(Ne=wc,ae="onMouseLeave",G="onMouseEnter",q="mouse",(a==="pointerout"||a==="pointerover")&&(Ne=on,ae="onPointerLeave",G="onPointerEnter",q="pointer"),Ot=me==null?se:Ko(me),X=_e==null?se:Ko(_e),se=new Ne(ae,q+"leave",me,f,ne),se.target=Ot,se.relatedTarget=X,ae=null,Va(ne)===Q&&(Ne=new Ne(G,q+"enter",_e,f,ne),Ne.target=X,Ne.relatedTarget=Ot,ae=Ne),Ot=ae,me&&_e)t:{for(Ne=me,G=_e,q=0,X=Ne;X;X=Wo(X))q++;for(X=0,ae=G;ae;ae=Wo(ae))X++;for(;0<q-X;)Ne=Wo(Ne),q--;for(;0<X-q;)G=Wo(G),X--;for(;q--;){if(Ne===G||G!==null&&Ne===G.alternate)break t;Ne=Wo(Ne),G=Wo(G)}Ne=null}else Ne=null;me!==null&&Cx(re,se,me,Ne,!1),_e!==null&&Ot!==null&&Cx(re,Ot,_e,Ne,!0)}}e:{if(se=Q?Ko(Q):window,me=se.nodeName&&se.nodeName.toLowerCase(),me==="select"||me==="input"&&se.type==="file")var Ae=SA;else if(lx(se))if(ux)Ae=PA;else{Ae=CA;var De=TA}else(me=se.nodeName)&&me.toLowerCase()==="input"&&(se.type==="checkbox"||se.type==="radio")&&(Ae=IA);if(Ae&&(Ae=Ae(a,Q))){cx(re,Ae,f,ne);break e}De&&De(a,se,Q),a==="focusout"&&(De=se._wrapperState)&&De.controlled&&se.type==="number"&&Ht(se,"number",se.value)}switch(De=Q?Ko(Q):window,a){case"focusin":(lx(De)||De.contentEditable==="true")&&(Ho=De,Tp=Q,Sc=null);break;case"focusout":Sc=Tp=Ho=null;break;case"mousedown":Cp=!0;break;case"contextmenu":case"mouseup":case"dragend":Cp=!1,xx(re,f,ne);break;case"selectionchange":if(DA)break;case"keydown":case"keyup":xx(re,f,ne)}var Me;if(Ep)e:{switch(a){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else $o?ax(a,f)&&(Fe="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(Fe="onCompositionStart");Fe&&(nx&&f.locale!=="ko"&&($o||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&$o&&(Me=Ad()):(rn=ne,Oo="value"in rn?rn.value:rn.textContent,$o=!0)),De=Md(Q,Fe),0<De.length&&(Fe=new S(Fe,a,null,f,ne),re.push({event:Fe,listeners:De}),Me?Fe.data=Me:(Me=ox(f),Me!==null&&(Fe.data=Me)))),(Me=_A?kA(a,f):EA(a,f))&&(Q=Md(Q,"onBeforeInput"),0<Q.length&&(ne=new S("onBeforeInput","beforeinput",null,f,ne),re.push({event:ne,listeners:Q}),ne.data=Me))}Sx(re,c)})}function Ic(a,c,f){return{instance:a,listener:c,currentTarget:f}}function Md(a,c){for(var f=c+"Capture",y=[];a!==null;){var b=a,_=b.stateNode;b.tag===5&&_!==null&&(b=_,_=Aa(a,f),_!=null&&y.unshift(Ic(a,_,b)),_=Aa(a,c),_!=null&&y.push(Ic(a,_,b))),a=a.return}return y}function Wo(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Cx(a,c,f,y,b){for(var _=c._reactName,j=[];f!==null&&f!==y;){var z=f,H=z.alternate,Q=z.stateNode;if(H!==null&&H===y)break;z.tag===5&&Q!==null&&(z=Q,b?(H=Aa(f,_),H!=null&&j.unshift(Ic(f,H,z))):b||(H=Aa(f,_),H!=null&&j.push(Ic(f,H,z)))),f=f.return}j.length!==0&&a.push({event:c,listeners:j})}var FA=/\r\n?/g,VA=/\u0000|\uFFFD/g;function Ix(a){return(typeof a=="string"?a:""+a).replace(FA,`
`).replace(VA,"")}function Ld(a,c,f){if(c=Ix(c),Ix(a)!==c&&f)throw Error(t(425))}function Od(){}var Mp=null,Lp=null;function Op(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Fp=typeof setTimeout=="function"?setTimeout:void 0,UA=typeof clearTimeout=="function"?clearTimeout:void 0,Px=typeof Promise=="function"?Promise:void 0,BA=typeof queueMicrotask=="function"?queueMicrotask:typeof Px<"u"?function(a){return Px.resolve(null).then(a).catch(zA)}:Fp;function zA(a){setTimeout(function(){throw a})}function Vp(a,c){var f=c,y=0;do{var b=f.nextSibling;if(a.removeChild(f),b&&b.nodeType===8)if(f=b.data,f==="/$"){if(y===0){a.removeChild(b),Ti(c);return}y--}else f!=="$"&&f!=="$?"&&f!=="$!"||y++;f=b}while(f);Ti(c)}function ji(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function jx(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"){if(c===0)return a;c--}else f==="/$"&&c++}a=a.previousSibling}return null}var Go=Math.random().toString(36).slice(2),hr="__reactFiber$"+Go,Pc="__reactProps$"+Go,Br="__reactContainer$"+Go,Up="__reactEvents$"+Go,$A="__reactListeners$"+Go,HA="__reactHandles$"+Go;function Va(a){var c=a[hr];if(c)return c;for(var f=a.parentNode;f;){if(c=f[Br]||f[hr]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(a=jx(a);a!==null;){if(f=a[hr])return f;a=jx(a)}return c}a=f,f=a.parentNode}return null}function jc(a){return a=a[hr]||a[Br],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Ko(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Fd(a){return a[Pc]||null}var Bp=[],Yo=-1;function Ri(a){return{current:a}}function xt(a){0>Yo||(a.current=Bp[Yo],Bp[Yo]=null,Yo--)}function pt(a,c){Yo++,Bp[Yo]=a.current,a.current=c}var Di={},_s=Ri(Di),Bs=Ri(!1),Ua=Di;function Xo(a,c){var f=a.type.contextTypes;if(!f)return Di;var y=a.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var b={},_;for(_ in f)b[_]=c[_];return y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=b),b}function zs(a){return a=a.childContextTypes,a!=null}function Vd(){xt(Bs),xt(_s)}function Rx(a,c,f){if(_s.current!==Di)throw Error(t(168));pt(_s,c),pt(Bs,f)}function Dx(a,c,f){var y=a.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return f;y=y.getChildContext();for(var b in y)if(!(b in c))throw Error(t(108,fe(a)||"Unknown",b));return le({},f,y)}function Ud(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Di,Ua=_s.current,pt(_s,a),pt(Bs,Bs.current),!0}function Mx(a,c,f){var y=a.stateNode;if(!y)throw Error(t(169));f?(a=Dx(a,c,Ua),y.__reactInternalMemoizedMergedChildContext=a,xt(Bs),xt(_s),pt(_s,a)):xt(Bs),pt(Bs,f)}var zr=null,Bd=!1,zp=!1;function Lx(a){zr===null?zr=[a]:zr.push(a)}function qA(a){Bd=!0,Lx(a)}function Mi(){if(!zp&&zr!==null){zp=!0;var a=0,c=Je;try{var f=zr;for(Je=1;a<f.length;a++){var y=f[a];do y=y(!0);while(y!==null)}zr=null,Bd=!1}catch(b){throw zr!==null&&(zr=zr.slice(a+1)),lc(Io,Mi),b}finally{Je=c,zp=!1}}return null}var Qo=[],Jo=0,zd=null,$d=0,bn=[],vn=0,Ba=null,$r=1,Hr="";function za(a,c){Qo[Jo++]=$d,Qo[Jo++]=zd,zd=a,$d=c}function Ox(a,c,f){bn[vn++]=$r,bn[vn++]=Hr,bn[vn++]=Ba,Ba=a;var y=$r;a=Hr;var b=32-sn(y)-1;y&=~(1<<b),f+=1;var _=32-sn(c)+b;if(30<_){var j=b-b%5;_=(y&(1<<j)-1).toString(32),y>>=j,b-=j,$r=1<<32-sn(c)+b|f<<b|y,Hr=_+a}else $r=1<<_|f<<b|y,Hr=a}function $p(a){a.return!==null&&(za(a,1),Ox(a,1,0))}function Hp(a){for(;a===zd;)zd=Qo[--Jo],Qo[Jo]=null,$d=Qo[--Jo],Qo[Jo]=null;for(;a===Ba;)Ba=bn[--vn],bn[vn]=null,Hr=bn[--vn],bn[vn]=null,$r=bn[--vn],bn[vn]=null}var ln=null,cn=null,vt=!1,Vn=null;function Fx(a,c){var f=En(5,null,null,0);f.elementType="DELETED",f.stateNode=c,f.return=a,c=a.deletions,c===null?(a.deletions=[f],a.flags|=16):c.push(f)}function Vx(a,c){switch(a.tag){case 5:var f=a.type;return c=c.nodeType!==1||f.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,ln=a,cn=ji(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,ln=a,cn=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(f=Ba!==null?{id:$r,overflow:Hr}:null,a.memoizedState={dehydrated:c,treeContext:f,retryLane:1073741824},f=En(18,null,null,0),f.stateNode=c,f.return=a,a.child=f,ln=a,cn=null,!0):!1;default:return!1}}function qp(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Wp(a){if(vt){var c=cn;if(c){var f=c;if(!Vx(a,c)){if(qp(a))throw Error(t(418));c=ji(f.nextSibling);var y=ln;c&&Vx(a,c)?Fx(y,f):(a.flags=a.flags&-4097|2,vt=!1,ln=a)}}else{if(qp(a))throw Error(t(418));a.flags=a.flags&-4097|2,vt=!1,ln=a}}}function Ux(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;ln=a}function Hd(a){if(a!==ln)return!1;if(!vt)return Ux(a),vt=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Op(a.type,a.memoizedProps)),c&&(c=cn)){if(qp(a))throw Bx(),Error(t(418));for(;c;)Fx(a,c),c=ji(c.nextSibling)}if(Ux(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="/$"){if(c===0){cn=ji(a.nextSibling);break e}c--}else f!=="$"&&f!=="$!"&&f!=="$?"||c++}a=a.nextSibling}cn=null}}else cn=ln?ji(a.stateNode.nextSibling):null;return!0}function Bx(){for(var a=cn;a;)a=ji(a.nextSibling)}function Zo(){cn=ln=null,vt=!1}function Gp(a){Vn===null?Vn=[a]:Vn.push(a)}var WA=P.ReactCurrentBatchConfig;function Rc(a,c,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var y=f.stateNode}if(!y)throw Error(t(147,a));var b=y,_=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===_?c.ref:(c=function(j){var z=b.refs;j===null?delete z[_]:z[_]=j},c._stringRef=_,c)}if(typeof a!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,a))}return a}function qd(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function zx(a){var c=a._init;return c(a._payload)}function $x(a){function c(G,q){if(a){var X=G.deletions;X===null?(G.deletions=[q],G.flags|=16):X.push(q)}}function f(G,q){if(!a)return null;for(;q!==null;)c(G,q),q=q.sibling;return null}function y(G,q){for(G=new Map;q!==null;)q.key!==null?G.set(q.key,q):G.set(q.index,q),q=q.sibling;return G}function b(G,q){return G=$i(G,q),G.index=0,G.sibling=null,G}function _(G,q,X){return G.index=X,a?(X=G.alternate,X!==null?(X=X.index,X<q?(G.flags|=2,q):X):(G.flags|=2,q)):(G.flags|=1048576,q)}function j(G){return a&&G.alternate===null&&(G.flags|=2),G}function z(G,q,X,ae){return q===null||q.tag!==6?(q=Fm(X,G.mode,ae),q.return=G,q):(q=b(q,X),q.return=G,q)}function H(G,q,X,ae){var Ae=X.type;return Ae===R?ne(G,q,X.props.children,ae,X.key):q!==null&&(q.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===ie&&zx(Ae)===q.type)?(ae=b(q,X.props),ae.ref=Rc(G,q,X),ae.return=G,ae):(ae=mh(X.type,X.key,X.props,null,G.mode,ae),ae.ref=Rc(G,q,X),ae.return=G,ae)}function Q(G,q,X,ae){return q===null||q.tag!==4||q.stateNode.containerInfo!==X.containerInfo||q.stateNode.implementation!==X.implementation?(q=Vm(X,G.mode,ae),q.return=G,q):(q=b(q,X.children||[]),q.return=G,q)}function ne(G,q,X,ae,Ae){return q===null||q.tag!==7?(q=Xa(X,G.mode,ae,Ae),q.return=G,q):(q=b(q,X),q.return=G,q)}function re(G,q,X){if(typeof q=="string"&&q!==""||typeof q=="number")return q=Fm(""+q,G.mode,X),q.return=G,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case U:return X=mh(q.type,q.key,q.props,null,G.mode,X),X.ref=Rc(G,null,q),X.return=G,X;case O:return q=Vm(q,G.mode,X),q.return=G,q;case ie:var ae=q._init;return re(G,ae(q._payload),X)}if(Mt(q)||he(q))return q=Xa(q,G.mode,X,null),q.return=G,q;qd(G,q)}return null}function se(G,q,X,ae){var Ae=q!==null?q.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return Ae!==null?null:z(G,q,""+X,ae);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case U:return X.key===Ae?H(G,q,X,ae):null;case O:return X.key===Ae?Q(G,q,X,ae):null;case ie:return Ae=X._init,se(G,q,Ae(X._payload),ae)}if(Mt(X)||he(X))return Ae!==null?null:ne(G,q,X,ae,null);qd(G,X)}return null}function me(G,q,X,ae,Ae){if(typeof ae=="string"&&ae!==""||typeof ae=="number")return G=G.get(X)||null,z(q,G,""+ae,Ae);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case U:return G=G.get(ae.key===null?X:ae.key)||null,H(q,G,ae,Ae);case O:return G=G.get(ae.key===null?X:ae.key)||null,Q(q,G,ae,Ae);case ie:var De=ae._init;return me(G,q,X,De(ae._payload),Ae)}if(Mt(ae)||he(ae))return G=G.get(X)||null,ne(q,G,ae,Ae,null);qd(q,ae)}return null}function _e(G,q,X,ae){for(var Ae=null,De=null,Me=q,Fe=q=0,is=null;Me!==null&&Fe<X.length;Fe++){Me.index>Fe?(is=Me,Me=null):is=Me.sibling;var rt=se(G,Me,X[Fe],ae);if(rt===null){Me===null&&(Me=is);break}a&&Me&&rt.alternate===null&&c(G,Me),q=_(rt,q,Fe),De===null?Ae=rt:De.sibling=rt,De=rt,Me=is}if(Fe===X.length)return f(G,Me),vt&&za(G,Fe),Ae;if(Me===null){for(;Fe<X.length;Fe++)Me=re(G,X[Fe],ae),Me!==null&&(q=_(Me,q,Fe),De===null?Ae=Me:De.sibling=Me,De=Me);return vt&&za(G,Fe),Ae}for(Me=y(G,Me);Fe<X.length;Fe++)is=me(Me,G,Fe,X[Fe],ae),is!==null&&(a&&is.alternate!==null&&Me.delete(is.key===null?Fe:is.key),q=_(is,q,Fe),De===null?Ae=is:De.sibling=is,De=is);return a&&Me.forEach(function(Hi){return c(G,Hi)}),vt&&za(G,Fe),Ae}function Ne(G,q,X,ae){var Ae=he(X);if(typeof Ae!="function")throw Error(t(150));if(X=Ae.call(X),X==null)throw Error(t(151));for(var De=Ae=null,Me=q,Fe=q=0,is=null,rt=X.next();Me!==null&&!rt.done;Fe++,rt=X.next()){Me.index>Fe?(is=Me,Me=null):is=Me.sibling;var Hi=se(G,Me,rt.value,ae);if(Hi===null){Me===null&&(Me=is);break}a&&Me&&Hi.alternate===null&&c(G,Me),q=_(Hi,q,Fe),De===null?Ae=Hi:De.sibling=Hi,De=Hi,Me=is}if(rt.done)return f(G,Me),vt&&za(G,Fe),Ae;if(Me===null){for(;!rt.done;Fe++,rt=X.next())rt=re(G,rt.value,ae),rt!==null&&(q=_(rt,q,Fe),De===null?Ae=rt:De.sibling=rt,De=rt);return vt&&za(G,Fe),Ae}for(Me=y(G,Me);!rt.done;Fe++,rt=X.next())rt=me(Me,G,Fe,rt.value,ae),rt!==null&&(a&&rt.alternate!==null&&Me.delete(rt.key===null?Fe:rt.key),q=_(rt,q,Fe),De===null?Ae=rt:De.sibling=rt,De=rt);return a&&Me.forEach(function(NS){return c(G,NS)}),vt&&za(G,Fe),Ae}function Ot(G,q,X,ae){if(typeof X=="object"&&X!==null&&X.type===R&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case U:e:{for(var Ae=X.key,De=q;De!==null;){if(De.key===Ae){if(Ae=X.type,Ae===R){if(De.tag===7){f(G,De.sibling),q=b(De,X.props.children),q.return=G,G=q;break e}}else if(De.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===ie&&zx(Ae)===De.type){f(G,De.sibling),q=b(De,X.props),q.ref=Rc(G,De,X),q.return=G,G=q;break e}f(G,De);break}else c(G,De);De=De.sibling}X.type===R?(q=Xa(X.props.children,G.mode,ae,X.key),q.return=G,G=q):(ae=mh(X.type,X.key,X.props,null,G.mode,ae),ae.ref=Rc(G,q,X),ae.return=G,G=ae)}return j(G);case O:e:{for(De=X.key;q!==null;){if(q.key===De)if(q.tag===4&&q.stateNode.containerInfo===X.containerInfo&&q.stateNode.implementation===X.implementation){f(G,q.sibling),q=b(q,X.children||[]),q.return=G,G=q;break e}else{f(G,q);break}else c(G,q);q=q.sibling}q=Vm(X,G.mode,ae),q.return=G,G=q}return j(G);case ie:return De=X._init,Ot(G,q,De(X._payload),ae)}if(Mt(X))return _e(G,q,X,ae);if(he(X))return Ne(G,q,X,ae);qd(G,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,q!==null&&q.tag===6?(f(G,q.sibling),q=b(q,X),q.return=G,G=q):(f(G,q),q=Fm(X,G.mode,ae),q.return=G,G=q),j(G)):f(G,q)}return Ot}var el=$x(!0),Hx=$x(!1),Wd=Ri(null),Gd=null,tl=null,Kp=null;function Yp(){Kp=tl=Gd=null}function Xp(a){var c=Wd.current;xt(Wd),a._currentValue=c}function Qp(a,c,f){for(;a!==null;){var y=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),a===f)break;a=a.return}}function sl(a,c){Gd=a,Kp=tl=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&($s=!0),a.firstContext=null)}function wn(a){var c=a._currentValue;if(Kp!==a)if(a={context:a,memoizedValue:c,next:null},tl===null){if(Gd===null)throw Error(t(308));tl=a,Gd.dependencies={lanes:0,firstContext:a}}else tl=tl.next=a;return c}var $a=null;function Jp(a){$a===null?$a=[a]:$a.push(a)}function qx(a,c,f,y){var b=c.interleaved;return b===null?(f.next=f,Jp(c)):(f.next=b.next,b.next=f),c.interleaved=f,qr(a,y)}function qr(a,c){a.lanes|=c;var f=a.alternate;for(f!==null&&(f.lanes|=c),f=a,a=a.return;a!==null;)a.childLanes|=c,f=a.alternate,f!==null&&(f.childLanes|=c),f=a,a=a.return;return f.tag===3?f.stateNode:null}var Li=!1;function Zp(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wx(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Wr(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function Oi(a,c,f){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,(nt&2)!==0){var b=y.pending;return b===null?c.next=c:(c.next=b.next,b.next=c),y.pending=c,qr(a,f)}return b=y.interleaved,b===null?(c.next=c,Jp(y)):(c.next=b.next,b.next=c),y.interleaved=c,qr(a,f)}function Kd(a,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194240)!==0)){var y=c.lanes;y&=a.pendingLanes,f|=y,c.lanes=f,pc(a,f)}}function Gx(a,c){var f=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,f===y)){var b=null,_=null;if(f=f.firstBaseUpdate,f!==null){do{var j={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};_===null?b=_=j:_=_.next=j,f=f.next}while(f!==null);_===null?b=_=c:_=_.next=c}else b=_=c;f={baseState:y.baseState,firstBaseUpdate:b,lastBaseUpdate:_,shared:y.shared,effects:y.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=c:a.next=c,f.lastBaseUpdate=c}function Yd(a,c,f,y){var b=a.updateQueue;Li=!1;var _=b.firstBaseUpdate,j=b.lastBaseUpdate,z=b.shared.pending;if(z!==null){b.shared.pending=null;var H=z,Q=H.next;H.next=null,j===null?_=Q:j.next=Q,j=H;var ne=a.alternate;ne!==null&&(ne=ne.updateQueue,z=ne.lastBaseUpdate,z!==j&&(z===null?ne.firstBaseUpdate=Q:z.next=Q,ne.lastBaseUpdate=H))}if(_!==null){var re=b.baseState;j=0,ne=Q=H=null,z=_;do{var se=z.lane,me=z.eventTime;if((y&se)===se){ne!==null&&(ne=ne.next={eventTime:me,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var _e=a,Ne=z;switch(se=c,me=f,Ne.tag){case 1:if(_e=Ne.payload,typeof _e=="function"){re=_e.call(me,re,se);break e}re=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=Ne.payload,se=typeof _e=="function"?_e.call(me,re,se):_e,se==null)break e;re=le({},re,se);break e;case 2:Li=!0}}z.callback!==null&&z.lane!==0&&(a.flags|=64,se=b.effects,se===null?b.effects=[z]:se.push(z))}else me={eventTime:me,lane:se,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ne===null?(Q=ne=me,H=re):ne=ne.next=me,j|=se;if(z=z.next,z===null){if(z=b.shared.pending,z===null)break;se=z,z=se.next,se.next=null,b.lastBaseUpdate=se,b.shared.pending=null}}while(!0);if(ne===null&&(H=re),b.baseState=H,b.firstBaseUpdate=Q,b.lastBaseUpdate=ne,c=b.shared.interleaved,c!==null){b=c;do j|=b.lane,b=b.next;while(b!==c)}else _===null&&(b.shared.lanes=0);Wa|=j,a.lanes=j,a.memoizedState=re}}function Kx(a,c,f){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var y=a[c],b=y.callback;if(b!==null){if(y.callback=null,y=f,typeof b!="function")throw Error(t(191,b));b.call(y)}}}var Dc={},fr=Ri(Dc),Mc=Ri(Dc),Lc=Ri(Dc);function Ha(a){if(a===Dc)throw Error(t(174));return a}function em(a,c){switch(pt(Lc,c),pt(Mc,a),pt(fr,Dc),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Eo(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=Eo(c,a)}xt(fr),pt(fr,c)}function nl(){xt(fr),xt(Mc),xt(Lc)}function Yx(a){Ha(Lc.current);var c=Ha(fr.current),f=Eo(c,a.type);c!==f&&(pt(Mc,a),pt(fr,f))}function tm(a){Mc.current===a&&(xt(fr),xt(Mc))}var wt=Ri(0);function Xd(a){for(var c=a;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var sm=[];function nm(){for(var a=0;a<sm.length;a++)sm[a]._workInProgressVersionPrimary=null;sm.length=0}var Qd=P.ReactCurrentDispatcher,rm=P.ReactCurrentBatchConfig,qa=0,_t=null,Zt=null,ns=null,Jd=!1,Oc=!1,Fc=0,GA=0;function ks(){throw Error(t(321))}function im(a,c){if(c===null)return!1;for(var f=0;f<c.length&&f<a.length;f++)if(!Fn(a[f],c[f]))return!1;return!0}function am(a,c,f,y,b,_){if(qa=_,_t=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Qd.current=a===null||a.memoizedState===null?QA:JA,a=f(y,b),Oc){_=0;do{if(Oc=!1,Fc=0,25<=_)throw Error(t(301));_+=1,ns=Zt=null,c.updateQueue=null,Qd.current=ZA,a=f(y,b)}while(Oc)}if(Qd.current=th,c=Zt!==null&&Zt.next!==null,qa=0,ns=Zt=_t=null,Jd=!1,c)throw Error(t(300));return a}function om(){var a=Fc!==0;return Fc=0,a}function pr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ns===null?_t.memoizedState=ns=a:ns=ns.next=a,ns}function _n(){if(Zt===null){var a=_t.alternate;a=a!==null?a.memoizedState:null}else a=Zt.next;var c=ns===null?_t.memoizedState:ns.next;if(c!==null)ns=c,Zt=a;else{if(a===null)throw Error(t(310));Zt=a,a={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},ns===null?_t.memoizedState=ns=a:ns=ns.next=a}return ns}function Vc(a,c){return typeof c=="function"?c(a):c}function lm(a){var c=_n(),f=c.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=a;var y=Zt,b=y.baseQueue,_=f.pending;if(_!==null){if(b!==null){var j=b.next;b.next=_.next,_.next=j}y.baseQueue=b=_,f.pending=null}if(b!==null){_=b.next,y=y.baseState;var z=j=null,H=null,Q=_;do{var ne=Q.lane;if((qa&ne)===ne)H!==null&&(H=H.next={lane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),y=Q.hasEagerState?Q.eagerState:a(y,Q.action);else{var re={lane:ne,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null};H===null?(z=H=re,j=y):H=H.next=re,_t.lanes|=ne,Wa|=ne}Q=Q.next}while(Q!==null&&Q!==_);H===null?j=y:H.next=z,Fn(y,c.memoizedState)||($s=!0),c.memoizedState=y,c.baseState=j,c.baseQueue=H,f.lastRenderedState=y}if(a=f.interleaved,a!==null){b=a;do _=b.lane,_t.lanes|=_,Wa|=_,b=b.next;while(b!==a)}else b===null&&(f.lanes=0);return[c.memoizedState,f.dispatch]}function cm(a){var c=_n(),f=c.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=a;var y=f.dispatch,b=f.pending,_=c.memoizedState;if(b!==null){f.pending=null;var j=b=b.next;do _=a(_,j.action),j=j.next;while(j!==b);Fn(_,c.memoizedState)||($s=!0),c.memoizedState=_,c.baseQueue===null&&(c.baseState=_),f.lastRenderedState=_}return[_,y]}function Xx(){}function Qx(a,c){var f=_t,y=_n(),b=c(),_=!Fn(y.memoizedState,b);if(_&&(y.memoizedState=b,$s=!0),y=y.queue,um(eb.bind(null,f,y,a),[a]),y.getSnapshot!==c||_||ns!==null&&ns.memoizedState.tag&1){if(f.flags|=2048,Uc(9,Zx.bind(null,f,y,b,c),void 0,null),rs===null)throw Error(t(349));(qa&30)!==0||Jx(f,c,b)}return b}function Jx(a,c,f){a.flags|=16384,a={getSnapshot:c,value:f},c=_t.updateQueue,c===null?(c={lastEffect:null,stores:null},_t.updateQueue=c,c.stores=[a]):(f=c.stores,f===null?c.stores=[a]:f.push(a))}function Zx(a,c,f,y){c.value=f,c.getSnapshot=y,tb(c)&&sb(a)}function eb(a,c,f){return f(function(){tb(c)&&sb(a)})}function tb(a){var c=a.getSnapshot;a=a.value;try{var f=c();return!Fn(a,f)}catch{return!0}}function sb(a){var c=qr(a,1);c!==null&&$n(c,a,1,-1)}function nb(a){var c=pr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vc,lastRenderedState:a},c.queue=a,a=a.dispatch=XA.bind(null,_t,a),[c.memoizedState,a]}function Uc(a,c,f,y){return a={tag:a,create:c,destroy:f,deps:y,next:null},c=_t.updateQueue,c===null?(c={lastEffect:null,stores:null},_t.updateQueue=c,c.lastEffect=a.next=a):(f=c.lastEffect,f===null?c.lastEffect=a.next=a:(y=f.next,f.next=a,a.next=y,c.lastEffect=a)),a}function rb(){return _n().memoizedState}function Zd(a,c,f,y){var b=pr();_t.flags|=a,b.memoizedState=Uc(1|c,f,void 0,y===void 0?null:y)}function eh(a,c,f,y){var b=_n();y=y===void 0?null:y;var _=void 0;if(Zt!==null){var j=Zt.memoizedState;if(_=j.destroy,y!==null&&im(y,j.deps)){b.memoizedState=Uc(c,f,_,y);return}}_t.flags|=a,b.memoizedState=Uc(1|c,f,_,y)}function ib(a,c){return Zd(8390656,8,a,c)}function um(a,c){return eh(2048,8,a,c)}function ab(a,c){return eh(4,2,a,c)}function ob(a,c){return eh(4,4,a,c)}function lb(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function cb(a,c,f){return f=f!=null?f.concat([a]):null,eh(4,4,lb.bind(null,c,a),f)}function dm(){}function ub(a,c){var f=_n();c=c===void 0?null:c;var y=f.memoizedState;return y!==null&&c!==null&&im(c,y[1])?y[0]:(f.memoizedState=[a,c],a)}function db(a,c){var f=_n();c=c===void 0?null:c;var y=f.memoizedState;return y!==null&&c!==null&&im(c,y[1])?y[0]:(a=a(),f.memoizedState=[a,c],a)}function hb(a,c,f){return(qa&21)===0?(a.baseState&&(a.baseState=!1,$s=!0),a.memoizedState=f):(Fn(f,c)||(f=hc(),_t.lanes|=f,Wa|=f,a.baseState=!0),c)}function KA(a,c){var f=Je;Je=f!==0&&4>f?f:4,a(!0);var y=rm.transition;rm.transition={};try{a(!1),c()}finally{Je=f,rm.transition=y}}function fb(){return _n().memoizedState}function YA(a,c,f){var y=Bi(a);if(f={lane:y,action:f,hasEagerState:!1,eagerState:null,next:null},pb(a))mb(c,f);else if(f=qx(a,c,f,y),f!==null){var b=Rs();$n(f,a,y,b),gb(f,c,y)}}function XA(a,c,f){var y=Bi(a),b={lane:y,action:f,hasEagerState:!1,eagerState:null,next:null};if(pb(a))mb(c,b);else{var _=a.alternate;if(a.lanes===0&&(_===null||_.lanes===0)&&(_=c.lastRenderedReducer,_!==null))try{var j=c.lastRenderedState,z=_(j,f);if(b.hasEagerState=!0,b.eagerState=z,Fn(z,j)){var H=c.interleaved;H===null?(b.next=b,Jp(c)):(b.next=H.next,H.next=b),c.interleaved=b;return}}catch{}finally{}f=qx(a,c,b,y),f!==null&&(b=Rs(),$n(f,a,y,b),gb(f,c,y))}}function pb(a){var c=a.alternate;return a===_t||c!==null&&c===_t}function mb(a,c){Oc=Jd=!0;var f=a.pending;f===null?c.next=c:(c.next=f.next,f.next=c),a.pending=c}function gb(a,c,f){if((f&4194240)!==0){var y=c.lanes;y&=a.pendingLanes,f|=y,c.lanes=f,pc(a,f)}}var th={readContext:wn,useCallback:ks,useContext:ks,useEffect:ks,useImperativeHandle:ks,useInsertionEffect:ks,useLayoutEffect:ks,useMemo:ks,useReducer:ks,useRef:ks,useState:ks,useDebugValue:ks,useDeferredValue:ks,useTransition:ks,useMutableSource:ks,useSyncExternalStore:ks,useId:ks,unstable_isNewReconciler:!1},QA={readContext:wn,useCallback:function(a,c){return pr().memoizedState=[a,c===void 0?null:c],a},useContext:wn,useEffect:ib,useImperativeHandle:function(a,c,f){return f=f!=null?f.concat([a]):null,Zd(4194308,4,lb.bind(null,c,a),f)},useLayoutEffect:function(a,c){return Zd(4194308,4,a,c)},useInsertionEffect:function(a,c){return Zd(4,2,a,c)},useMemo:function(a,c){var f=pr();return c=c===void 0?null:c,a=a(),f.memoizedState=[a,c],a},useReducer:function(a,c,f){var y=pr();return c=f!==void 0?f(c):c,y.memoizedState=y.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},y.queue=a,a=a.dispatch=YA.bind(null,_t,a),[y.memoizedState,a]},useRef:function(a){var c=pr();return a={current:a},c.memoizedState=a},useState:nb,useDebugValue:dm,useDeferredValue:function(a){return pr().memoizedState=a},useTransition:function(){var a=nb(!1),c=a[0];return a=KA.bind(null,a[1]),pr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,f){var y=_t,b=pr();if(vt){if(f===void 0)throw Error(t(407));f=f()}else{if(f=c(),rs===null)throw Error(t(349));(qa&30)!==0||Jx(y,c,f)}b.memoizedState=f;var _={value:f,getSnapshot:c};return b.queue=_,ib(eb.bind(null,y,_,a),[a]),y.flags|=2048,Uc(9,Zx.bind(null,y,_,f,c),void 0,null),f},useId:function(){var a=pr(),c=rs.identifierPrefix;if(vt){var f=Hr,y=$r;f=(y&~(1<<32-sn(y)-1)).toString(32)+f,c=":"+c+"R"+f,f=Fc++,0<f&&(c+="H"+f.toString(32)),c+=":"}else f=GA++,c=":"+c+"r"+f.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},JA={readContext:wn,useCallback:ub,useContext:wn,useEffect:um,useImperativeHandle:cb,useInsertionEffect:ab,useLayoutEffect:ob,useMemo:db,useReducer:lm,useRef:rb,useState:function(){return lm(Vc)},useDebugValue:dm,useDeferredValue:function(a){var c=_n();return hb(c,Zt.memoizedState,a)},useTransition:function(){var a=lm(Vc)[0],c=_n().memoizedState;return[a,c]},useMutableSource:Xx,useSyncExternalStore:Qx,useId:fb,unstable_isNewReconciler:!1},ZA={readContext:wn,useCallback:ub,useContext:wn,useEffect:um,useImperativeHandle:cb,useInsertionEffect:ab,useLayoutEffect:ob,useMemo:db,useReducer:cm,useRef:rb,useState:function(){return cm(Vc)},useDebugValue:dm,useDeferredValue:function(a){var c=_n();return Zt===null?c.memoizedState=a:hb(c,Zt.memoizedState,a)},useTransition:function(){var a=cm(Vc)[0],c=_n().memoizedState;return[a,c]},useMutableSource:Xx,useSyncExternalStore:Qx,useId:fb,unstable_isNewReconciler:!1};function Un(a,c){if(a&&a.defaultProps){c=le({},c),a=a.defaultProps;for(var f in a)c[f]===void 0&&(c[f]=a[f]);return c}return c}function hm(a,c,f,y){c=a.memoizedState,f=f(y,c),f=f==null?c:le({},c,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var sh={isMounted:function(a){return(a=a._reactInternals)?Ln(a)===a:!1},enqueueSetState:function(a,c,f){a=a._reactInternals;var y=Rs(),b=Bi(a),_=Wr(y,b);_.payload=c,f!=null&&(_.callback=f),c=Oi(a,_,b),c!==null&&($n(c,a,b,y),Kd(c,a,b))},enqueueReplaceState:function(a,c,f){a=a._reactInternals;var y=Rs(),b=Bi(a),_=Wr(y,b);_.tag=1,_.payload=c,f!=null&&(_.callback=f),c=Oi(a,_,b),c!==null&&($n(c,a,b,y),Kd(c,a,b))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var f=Rs(),y=Bi(a),b=Wr(f,y);b.tag=2,c!=null&&(b.callback=c),c=Oi(a,b,y),c!==null&&($n(c,a,y,f),Kd(c,a,y))}};function yb(a,c,f,y,b,_,j){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,_,j):c.prototype&&c.prototype.isPureReactComponent?!Ac(f,y)||!Ac(b,_):!0}function xb(a,c,f){var y=!1,b=Di,_=c.contextType;return typeof _=="object"&&_!==null?_=wn(_):(b=zs(c)?Ua:_s.current,y=c.contextTypes,_=(y=y!=null)?Xo(a,b):Di),c=new c(f,_),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=sh,a.stateNode=c,c._reactInternals=a,y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=_),c}function bb(a,c,f,y){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,y),c.state!==a&&sh.enqueueReplaceState(c,c.state,null)}function fm(a,c,f,y){var b=a.stateNode;b.props=f,b.state=a.memoizedState,b.refs={},Zp(a);var _=c.contextType;typeof _=="object"&&_!==null?b.context=wn(_):(_=zs(c)?Ua:_s.current,b.context=Xo(a,_)),b.state=a.memoizedState,_=c.getDerivedStateFromProps,typeof _=="function"&&(hm(a,c,_,f),b.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(c=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),c!==b.state&&sh.enqueueReplaceState(b,b.state,null),Yd(a,f,b,y),b.state=a.memoizedState),typeof b.componentDidMount=="function"&&(a.flags|=4194308)}function rl(a,c){try{var f="",y=c;do f+=je(y),y=y.return;while(y);var b=f}catch(_){b=`
Error generating stack: `+_.message+`
`+_.stack}return{value:a,source:c,stack:b,digest:null}}function pm(a,c,f){return{value:a,source:null,stack:f??null,digest:c??null}}function mm(a,c){try{console.error(c.value)}catch(f){setTimeout(function(){throw f})}}var eS=typeof WeakMap=="function"?WeakMap:Map;function vb(a,c,f){f=Wr(-1,f),f.tag=3,f.payload={element:null};var y=c.value;return f.callback=function(){ch||(ch=!0,Im=y),mm(a,c)},f}function wb(a,c,f){f=Wr(-1,f),f.tag=3;var y=a.type.getDerivedStateFromError;if(typeof y=="function"){var b=c.value;f.payload=function(){return y(b)},f.callback=function(){mm(a,c)}}var _=a.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(f.callback=function(){mm(a,c),typeof y!="function"&&(Vi===null?Vi=new Set([this]):Vi.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})}),f}function _b(a,c,f){var y=a.pingCache;if(y===null){y=a.pingCache=new eS;var b=new Set;y.set(c,b)}else b=y.get(c),b===void 0&&(b=new Set,y.set(c,b));b.has(f)||(b.add(f),a=pS.bind(null,a,c,f),c.then(a,a))}function kb(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function Eb(a,c,f,y,b){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(c=Wr(-1,1),c.tag=2,Oi(f,c,1))),f.lanes|=1),a):(a.flags|=65536,a.lanes=b,a)}var tS=P.ReactCurrentOwner,$s=!1;function js(a,c,f,y){c.child=a===null?Hx(c,null,f,y):el(c,a.child,f,y)}function Nb(a,c,f,y,b){f=f.render;var _=c.ref;return sl(c,b),y=am(a,c,f,y,_,b),f=om(),a!==null&&!$s?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~b,Gr(a,c,b)):(vt&&f&&$p(c),c.flags|=1,js(a,c,y,b),c.child)}function Ab(a,c,f,y,b){if(a===null){var _=f.type;return typeof _=="function"&&!Om(_)&&_.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(c.tag=15,c.type=_,Sb(a,c,_,y,b)):(a=mh(f.type,null,y,c,c.mode,b),a.ref=c.ref,a.return=c,c.child=a)}if(_=a.child,(a.lanes&b)===0){var j=_.memoizedProps;if(f=f.compare,f=f!==null?f:Ac,f(j,y)&&a.ref===c.ref)return Gr(a,c,b)}return c.flags|=1,a=$i(_,y),a.ref=c.ref,a.return=c,c.child=a}function Sb(a,c,f,y,b){if(a!==null){var _=a.memoizedProps;if(Ac(_,y)&&a.ref===c.ref)if($s=!1,c.pendingProps=y=_,(a.lanes&b)!==0)(a.flags&131072)!==0&&($s=!0);else return c.lanes=a.lanes,Gr(a,c,b)}return gm(a,c,f,y,b)}function Tb(a,c,f){var y=c.pendingProps,b=y.children,_=a!==null?a.memoizedState:null;if(y.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(al,un),un|=f;else{if((f&1073741824)===0)return a=_!==null?_.baseLanes|f:f,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,pt(al,un),un|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=_!==null?_.baseLanes:f,pt(al,un),un|=y}else _!==null?(y=_.baseLanes|f,c.memoizedState=null):y=f,pt(al,un),un|=y;return js(a,c,b,f),c.child}function Cb(a,c){var f=c.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(c.flags|=512,c.flags|=2097152)}function gm(a,c,f,y,b){var _=zs(f)?Ua:_s.current;return _=Xo(c,_),sl(c,b),f=am(a,c,f,y,_,b),y=om(),a!==null&&!$s?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~b,Gr(a,c,b)):(vt&&y&&$p(c),c.flags|=1,js(a,c,f,b),c.child)}function Ib(a,c,f,y,b){if(zs(f)){var _=!0;Ud(c)}else _=!1;if(sl(c,b),c.stateNode===null)rh(a,c),xb(c,f,y),fm(c,f,y,b),y=!0;else if(a===null){var j=c.stateNode,z=c.memoizedProps;j.props=z;var H=j.context,Q=f.contextType;typeof Q=="object"&&Q!==null?Q=wn(Q):(Q=zs(f)?Ua:_s.current,Q=Xo(c,Q));var ne=f.getDerivedStateFromProps,re=typeof ne=="function"||typeof j.getSnapshotBeforeUpdate=="function";re||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(z!==y||H!==Q)&&bb(c,j,y,Q),Li=!1;var se=c.memoizedState;j.state=se,Yd(c,y,j,b),H=c.memoizedState,z!==y||se!==H||Bs.current||Li?(typeof ne=="function"&&(hm(c,f,ne,y),H=c.memoizedState),(z=Li||yb(c,f,z,y,se,H,Q))?(re||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(c.flags|=4194308)):(typeof j.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=H),j.props=y,j.state=H,j.context=Q,y=z):(typeof j.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{j=c.stateNode,Wx(a,c),z=c.memoizedProps,Q=c.type===c.elementType?z:Un(c.type,z),j.props=Q,re=c.pendingProps,se=j.context,H=f.contextType,typeof H=="object"&&H!==null?H=wn(H):(H=zs(f)?Ua:_s.current,H=Xo(c,H));var me=f.getDerivedStateFromProps;(ne=typeof me=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(z!==re||se!==H)&&bb(c,j,y,H),Li=!1,se=c.memoizedState,j.state=se,Yd(c,y,j,b);var _e=c.memoizedState;z!==re||se!==_e||Bs.current||Li?(typeof me=="function"&&(hm(c,f,me,y),_e=c.memoizedState),(Q=Li||yb(c,f,Q,y,se,_e,H)||!1)?(ne||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(y,_e,H),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(y,_e,H)),typeof j.componentDidUpdate=="function"&&(c.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof j.componentDidUpdate!="function"||z===a.memoizedProps&&se===a.memoizedState||(c.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&se===a.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=_e),j.props=y,j.state=_e,j.context=H,y=Q):(typeof j.componentDidUpdate!="function"||z===a.memoizedProps&&se===a.memoizedState||(c.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&se===a.memoizedState||(c.flags|=1024),y=!1)}return ym(a,c,f,y,_,b)}function ym(a,c,f,y,b,_){Cb(a,c);var j=(c.flags&128)!==0;if(!y&&!j)return b&&Mx(c,f,!1),Gr(a,c,_);y=c.stateNode,tS.current=c;var z=j&&typeof f.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,a!==null&&j?(c.child=el(c,a.child,null,_),c.child=el(c,null,z,_)):js(a,c,z,_),c.memoizedState=y.state,b&&Mx(c,f,!0),c.child}function Pb(a){var c=a.stateNode;c.pendingContext?Rx(a,c.pendingContext,c.pendingContext!==c.context):c.context&&Rx(a,c.context,!1),em(a,c.containerInfo)}function jb(a,c,f,y,b){return Zo(),Gp(b),c.flags|=256,js(a,c,f,y),c.child}var xm={dehydrated:null,treeContext:null,retryLane:0};function bm(a){return{baseLanes:a,cachePool:null,transitions:null}}function Rb(a,c,f){var y=c.pendingProps,b=wt.current,_=!1,j=(c.flags&128)!==0,z;if((z=j)||(z=a!==null&&a.memoizedState===null?!1:(b&2)!==0),z?(_=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(b|=1),pt(wt,b&1),a===null)return Wp(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(j=y.children,a=y.fallback,_?(y=c.mode,_=c.child,j={mode:"hidden",children:j},(y&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=j):_=gh(j,y,0,null),a=Xa(a,y,f,null),_.return=c,a.return=c,_.sibling=a,c.child=_,c.child.memoizedState=bm(f),c.memoizedState=xm,a):vm(c,j));if(b=a.memoizedState,b!==null&&(z=b.dehydrated,z!==null))return sS(a,c,j,y,z,b,f);if(_){_=y.fallback,j=c.mode,b=a.child,z=b.sibling;var H={mode:"hidden",children:y.children};return(j&1)===0&&c.child!==b?(y=c.child,y.childLanes=0,y.pendingProps=H,c.deletions=null):(y=$i(b,H),y.subtreeFlags=b.subtreeFlags&14680064),z!==null?_=$i(z,_):(_=Xa(_,j,f,null),_.flags|=2),_.return=c,y.return=c,y.sibling=_,c.child=y,y=_,_=c.child,j=a.child.memoizedState,j=j===null?bm(f):{baseLanes:j.baseLanes|f,cachePool:null,transitions:j.transitions},_.memoizedState=j,_.childLanes=a.childLanes&~f,c.memoizedState=xm,y}return _=a.child,a=_.sibling,y=$i(_,{mode:"visible",children:y.children}),(c.mode&1)===0&&(y.lanes=f),y.return=c,y.sibling=null,a!==null&&(f=c.deletions,f===null?(c.deletions=[a],c.flags|=16):f.push(a)),c.child=y,c.memoizedState=null,y}function vm(a,c){return c=gh({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function nh(a,c,f,y){return y!==null&&Gp(y),el(c,a.child,null,f),a=vm(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function sS(a,c,f,y,b,_,j){if(f)return c.flags&256?(c.flags&=-257,y=pm(Error(t(422))),nh(a,c,j,y)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(_=y.fallback,b=c.mode,y=gh({mode:"visible",children:y.children},b,0,null),_=Xa(_,b,j,null),_.flags|=2,y.return=c,_.return=c,y.sibling=_,c.child=y,(c.mode&1)!==0&&el(c,a.child,null,j),c.child.memoizedState=bm(j),c.memoizedState=xm,_);if((c.mode&1)===0)return nh(a,c,j,null);if(b.data==="$!"){if(y=b.nextSibling&&b.nextSibling.dataset,y)var z=y.dgst;return y=z,_=Error(t(419)),y=pm(_,y,void 0),nh(a,c,j,y)}if(z=(j&a.childLanes)!==0,$s||z){if(y=rs,y!==null){switch(j&-j){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=(b&(y.suspendedLanes|j))!==0?0:b,b!==0&&b!==_.retryLane&&(_.retryLane=b,qr(a,b),$n(y,a,b,-1))}return Lm(),y=pm(Error(t(421))),nh(a,c,j,y)}return b.data==="$?"?(c.flags|=128,c.child=a.child,c=mS.bind(null,a),b._reactRetry=c,null):(a=_.treeContext,cn=ji(b.nextSibling),ln=c,vt=!0,Vn=null,a!==null&&(bn[vn++]=$r,bn[vn++]=Hr,bn[vn++]=Ba,$r=a.id,Hr=a.overflow,Ba=c),c=vm(c,y.children),c.flags|=4096,c)}function Db(a,c,f){a.lanes|=c;var y=a.alternate;y!==null&&(y.lanes|=c),Qp(a.return,c,f)}function wm(a,c,f,y,b){var _=a.memoizedState;_===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:f,tailMode:b}:(_.isBackwards=c,_.rendering=null,_.renderingStartTime=0,_.last=y,_.tail=f,_.tailMode=b)}function Mb(a,c,f){var y=c.pendingProps,b=y.revealOrder,_=y.tail;if(js(a,c,y.children,f),y=wt.current,(y&2)!==0)y=y&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Db(a,f,c);else if(a.tag===19)Db(a,f,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}y&=1}if(pt(wt,y),(c.mode&1)===0)c.memoizedState=null;else switch(b){case"forwards":for(f=c.child,b=null;f!==null;)a=f.alternate,a!==null&&Xd(a)===null&&(b=f),f=f.sibling;f=b,f===null?(b=c.child,c.child=null):(b=f.sibling,f.sibling=null),wm(c,!1,b,f,_);break;case"backwards":for(f=null,b=c.child,c.child=null;b!==null;){if(a=b.alternate,a!==null&&Xd(a)===null){c.child=b;break}a=b.sibling,b.sibling=f,f=b,b=a}wm(c,!0,f,null,_);break;case"together":wm(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function rh(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function Gr(a,c,f){if(a!==null&&(c.dependencies=a.dependencies),Wa|=c.lanes,(f&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,f=$i(a,a.pendingProps),c.child=f,f.return=c;a.sibling!==null;)a=a.sibling,f=f.sibling=$i(a,a.pendingProps),f.return=c;f.sibling=null}return c.child}function nS(a,c,f){switch(c.tag){case 3:Pb(c),Zo();break;case 5:Yx(c);break;case 1:zs(c.type)&&Ud(c);break;case 4:em(c,c.stateNode.containerInfo);break;case 10:var y=c.type._context,b=c.memoizedProps.value;pt(Wd,y._currentValue),y._currentValue=b;break;case 13:if(y=c.memoizedState,y!==null)return y.dehydrated!==null?(pt(wt,wt.current&1),c.flags|=128,null):(f&c.child.childLanes)!==0?Rb(a,c,f):(pt(wt,wt.current&1),a=Gr(a,c,f),a!==null?a.sibling:null);pt(wt,wt.current&1);break;case 19:if(y=(f&c.childLanes)!==0,(a.flags&128)!==0){if(y)return Mb(a,c,f);c.flags|=128}if(b=c.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),pt(wt,wt.current),y)break;return null;case 22:case 23:return c.lanes=0,Tb(a,c,f)}return Gr(a,c,f)}var Lb,_m,Ob,Fb;Lb=function(a,c){for(var f=c.child;f!==null;){if(f.tag===5||f.tag===6)a.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},_m=function(){},Ob=function(a,c,f,y){var b=a.memoizedProps;if(b!==y){a=c.stateNode,Ha(fr.current);var _=null;switch(f){case"input":b=mi(a,b),y=mi(a,y),_=[];break;case"select":b=le({},b,{value:void 0}),y=le({},y,{value:void 0}),_=[];break;case"textarea":b=tc(a,b),y=tc(a,y),_=[];break;default:typeof b.onClick!="function"&&typeof y.onClick=="function"&&(a.onclick=Od)}Mn(f,y);var j;f=null;for(Q in b)if(!y.hasOwnProperty(Q)&&b.hasOwnProperty(Q)&&b[Q]!=null)if(Q==="style"){var z=b[Q];for(j in z)z.hasOwnProperty(j)&&(f||(f={}),f[j]="")}else Q!=="dangerouslySetInnerHTML"&&Q!=="children"&&Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(r.hasOwnProperty(Q)?_||(_=[]):(_=_||[]).push(Q,null));for(Q in y){var H=y[Q];if(z=b?.[Q],y.hasOwnProperty(Q)&&H!==z&&(H!=null||z!=null))if(Q==="style")if(z){for(j in z)!z.hasOwnProperty(j)||H&&H.hasOwnProperty(j)||(f||(f={}),f[j]="");for(j in H)H.hasOwnProperty(j)&&z[j]!==H[j]&&(f||(f={}),f[j]=H[j])}else f||(_||(_=[]),_.push(Q,f)),f=H;else Q==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,z=z?z.__html:void 0,H!=null&&z!==H&&(_=_||[]).push(Q,H)):Q==="children"?typeof H!="string"&&typeof H!="number"||(_=_||[]).push(Q,""+H):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&(r.hasOwnProperty(Q)?(H!=null&&Q==="onScroll"&&yt("scroll",a),_||z===H||(_=[])):(_=_||[]).push(Q,H))}f&&(_=_||[]).push("style",f);var Q=_;(c.updateQueue=Q)&&(c.flags|=4)}},Fb=function(a,c,f,y){f!==y&&(c.flags|=4)};function Bc(a,c){if(!vt)switch(a.tailMode){case"hidden":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var y=null;f!==null;)f.alternate!==null&&(y=f),f=f.sibling;y===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function Es(a){var c=a.alternate!==null&&a.alternate.child===a.child,f=0,y=0;if(c)for(var b=a.child;b!==null;)f|=b.lanes|b.childLanes,y|=b.subtreeFlags&14680064,y|=b.flags&14680064,b.return=a,b=b.sibling;else for(b=a.child;b!==null;)f|=b.lanes|b.childLanes,y|=b.subtreeFlags,y|=b.flags,b.return=a,b=b.sibling;return a.subtreeFlags|=y,a.childLanes=f,c}function rS(a,c,f){var y=c.pendingProps;switch(Hp(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Es(c),null;case 1:return zs(c.type)&&Vd(),Es(c),null;case 3:return y=c.stateNode,nl(),xt(Bs),xt(_s),nm(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(a===null||a.child===null)&&(Hd(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Vn!==null&&(Rm(Vn),Vn=null))),_m(a,c),Es(c),null;case 5:tm(c);var b=Ha(Lc.current);if(f=c.type,a!==null&&c.stateNode!=null)Ob(a,c,f,y,b),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(t(166));return Es(c),null}if(a=Ha(fr.current),Hd(c)){y=c.stateNode,f=c.type;var _=c.memoizedProps;switch(y[hr]=c,y[Pc]=_,a=(c.mode&1)!==0,f){case"dialog":yt("cancel",y),yt("close",y);break;case"iframe":case"object":case"embed":yt("load",y);break;case"video":case"audio":for(b=0;b<Tc.length;b++)yt(Tc[b],y);break;case"source":yt("error",y);break;case"img":case"image":case"link":yt("error",y),yt("load",y);break;case"details":yt("toggle",y);break;case"input":ld(y,_),yt("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!_.multiple},yt("invalid",y);break;case"textarea":sc(y,_),yt("invalid",y)}Mn(f,_),b=null;for(var j in _)if(_.hasOwnProperty(j)){var z=_[j];j==="children"?typeof z=="string"?y.textContent!==z&&(_.suppressHydrationWarning!==!0&&Ld(y.textContent,z,a),b=["children",z]):typeof z=="number"&&y.textContent!==""+z&&(_.suppressHydrationWarning!==!0&&Ld(y.textContent,z,a),b=["children",""+z]):r.hasOwnProperty(j)&&z!=null&&j==="onScroll"&&yt("scroll",y)}switch(f){case"input":st(y),ec(y,_,!0);break;case"textarea":st(y),gi(y);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(y.onclick=Od)}y=b,c.updateQueue=y,y!==null&&(c.flags|=4)}else{j=b.nodeType===9?b:b.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=nc(f)),a==="http://www.w3.org/1999/xhtml"?f==="script"?(a=j.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof y.is=="string"?a=j.createElement(f,{is:y.is}):(a=j.createElement(f),f==="select"&&(j=a,y.multiple?j.multiple=!0:y.size&&(j.size=y.size))):a=j.createElementNS(a,f),a[hr]=c,a[Pc]=y,Lb(a,c,!1,!1),c.stateNode=a;e:{switch(j=Ao(f,y),f){case"dialog":yt("cancel",a),yt("close",a),b=y;break;case"iframe":case"object":case"embed":yt("load",a),b=y;break;case"video":case"audio":for(b=0;b<Tc.length;b++)yt(Tc[b],a);b=y;break;case"source":yt("error",a),b=y;break;case"img":case"image":case"link":yt("error",a),yt("load",a),b=y;break;case"details":yt("toggle",a),b=y;break;case"input":ld(a,y),b=mi(a,y),yt("invalid",a);break;case"option":b=y;break;case"select":a._wrapperState={wasMultiple:!!y.multiple},b=le({},y,{value:void 0}),yt("invalid",a);break;case"textarea":sc(a,y),b=tc(a,y),yt("invalid",a);break;default:b=y}Mn(f,b),z=b;for(_ in z)if(z.hasOwnProperty(_)){var H=z[_];_==="style"?No(a,H):_==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,H!=null&&ud(a,H)):_==="children"?typeof H=="string"?(f!=="textarea"||H!=="")&&Na(a,H):typeof H=="number"&&Na(a,""+H):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(r.hasOwnProperty(_)?H!=null&&_==="onScroll"&&yt("scroll",a):H!=null&&I(a,_,H,j))}switch(f){case"input":st(a),ec(a,y,!1);break;case"textarea":st(a),gi(a);break;case"option":y.value!=null&&a.setAttribute("value",""+Ue(y.value));break;case"select":a.multiple=!!y.multiple,_=y.value,_!=null?Dn(a,!!y.multiple,_,!1):y.defaultValue!=null&&Dn(a,!!y.multiple,y.defaultValue,!0);break;default:typeof b.onClick=="function"&&(a.onclick=Od)}switch(f){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Es(c),null;case 6:if(a&&c.stateNode!=null)Fb(a,c,a.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(t(166));if(f=Ha(Lc.current),Ha(fr.current),Hd(c)){if(y=c.stateNode,f=c.memoizedProps,y[hr]=c,(_=y.nodeValue!==f)&&(a=ln,a!==null))switch(a.tag){case 3:Ld(y.nodeValue,f,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Ld(y.nodeValue,f,(a.mode&1)!==0)}_&&(c.flags|=4)}else y=(f.nodeType===9?f:f.ownerDocument).createTextNode(y),y[hr]=c,c.stateNode=y}return Es(c),null;case 13:if(xt(wt),y=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(vt&&cn!==null&&(c.mode&1)!==0&&(c.flags&128)===0)Bx(),Zo(),c.flags|=98560,_=!1;else if(_=Hd(c),y!==null&&y.dehydrated!==null){if(a===null){if(!_)throw Error(t(318));if(_=c.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[hr]=c}else Zo(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Es(c),_=!1}else Vn!==null&&(Rm(Vn),Vn=null),_=!0;if(!_)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=f,c):(y=y!==null,y!==(a!==null&&a.memoizedState!==null)&&y&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(wt.current&1)!==0?es===0&&(es=3):Lm())),c.updateQueue!==null&&(c.flags|=4),Es(c),null);case 4:return nl(),_m(a,c),a===null&&Cc(c.stateNode.containerInfo),Es(c),null;case 10:return Xp(c.type._context),Es(c),null;case 17:return zs(c.type)&&Vd(),Es(c),null;case 19:if(xt(wt),_=c.memoizedState,_===null)return Es(c),null;if(y=(c.flags&128)!==0,j=_.rendering,j===null)if(y)Bc(_,!1);else{if(es!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(j=Xd(a),j!==null){for(c.flags|=128,Bc(_,!1),y=j.updateQueue,y!==null&&(c.updateQueue=y,c.flags|=4),c.subtreeFlags=0,y=f,f=c.child;f!==null;)_=f,a=y,_.flags&=14680066,j=_.alternate,j===null?(_.childLanes=0,_.lanes=a,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=j.childLanes,_.lanes=j.lanes,_.child=j.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=j.memoizedProps,_.memoizedState=j.memoizedState,_.updateQueue=j.updateQueue,_.type=j.type,a=j.dependencies,_.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),f=f.sibling;return pt(wt,wt.current&1|2),c.child}a=a.sibling}_.tail!==null&&gt()>ol&&(c.flags|=128,y=!0,Bc(_,!1),c.lanes=4194304)}else{if(!y)if(a=Xd(j),a!==null){if(c.flags|=128,y=!0,f=a.updateQueue,f!==null&&(c.updateQueue=f,c.flags|=4),Bc(_,!0),_.tail===null&&_.tailMode==="hidden"&&!j.alternate&&!vt)return Es(c),null}else 2*gt()-_.renderingStartTime>ol&&f!==1073741824&&(c.flags|=128,y=!0,Bc(_,!1),c.lanes=4194304);_.isBackwards?(j.sibling=c.child,c.child=j):(f=_.last,f!==null?f.sibling=j:c.child=j,_.last=j)}return _.tail!==null?(c=_.tail,_.rendering=c,_.tail=c.sibling,_.renderingStartTime=gt(),c.sibling=null,f=wt.current,pt(wt,y?f&1|2:f&1),c):(Es(c),null);case 22:case 23:return Mm(),y=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==y&&(c.flags|=8192),y&&(c.mode&1)!==0?(un&1073741824)!==0&&(Es(c),c.subtreeFlags&6&&(c.flags|=8192)):Es(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function iS(a,c){switch(Hp(c),c.tag){case 1:return zs(c.type)&&Vd(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return nl(),xt(Bs),xt(_s),nm(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return tm(c),null;case 13:if(xt(wt),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));Zo()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return xt(wt),null;case 4:return nl(),null;case 10:return Xp(c.type._context),null;case 22:case 23:return Mm(),null;case 24:return null;default:return null}}var ih=!1,Ns=!1,aS=typeof WeakSet=="function"?WeakSet:Set,be=null;function il(a,c){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(y){It(a,c,y)}else f.current=null}function km(a,c,f){try{f()}catch(y){It(a,c,y)}}var Vb=!1;function oS(a,c){if(Mp=Fr,a=yx(),Sp(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else e:{f=(f=a.ownerDocument)&&f.defaultView||window;var y=f.getSelection&&f.getSelection();if(y&&y.rangeCount!==0){f=y.anchorNode;var b=y.anchorOffset,_=y.focusNode;y=y.focusOffset;try{f.nodeType,_.nodeType}catch{f=null;break e}var j=0,z=-1,H=-1,Q=0,ne=0,re=a,se=null;t:for(;;){for(var me;re!==f||b!==0&&re.nodeType!==3||(z=j+b),re!==_||y!==0&&re.nodeType!==3||(H=j+y),re.nodeType===3&&(j+=re.nodeValue.length),(me=re.firstChild)!==null;)se=re,re=me;for(;;){if(re===a)break t;if(se===f&&++Q===b&&(z=j),se===_&&++ne===y&&(H=j),(me=re.nextSibling)!==null)break;re=se,se=re.parentNode}re=me}f=z===-1||H===-1?null:{start:z,end:H}}else f=null}f=f||{start:0,end:0}}else f=null;for(Lp={focusedElem:a,selectionRange:f},Fr=!1,be=c;be!==null;)if(c=be,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,be=a;else for(;be!==null;){c=be;try{var _e=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(_e!==null){var Ne=_e.memoizedProps,Ot=_e.memoizedState,G=c.stateNode,q=G.getSnapshotBeforeUpdate(c.elementType===c.type?Ne:Un(c.type,Ne),Ot);G.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var X=c.stateNode.containerInfo;X.nodeType===1?X.textContent="":X.nodeType===9&&X.documentElement&&X.removeChild(X.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ae){It(c,c.return,ae)}if(a=c.sibling,a!==null){a.return=c.return,be=a;break}be=c.return}return _e=Vb,Vb=!1,_e}function zc(a,c,f){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var b=y=y.next;do{if((b.tag&a)===a){var _=b.destroy;b.destroy=void 0,_!==void 0&&km(c,f,_)}b=b.next}while(b!==y)}}function ah(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var f=c=c.next;do{if((f.tag&a)===a){var y=f.create;f.destroy=y()}f=f.next}while(f!==c)}}function Em(a){var c=a.ref;if(c!==null){var f=a.stateNode;switch(a.tag){case 5:a=f;break;default:a=f}typeof c=="function"?c(a):c.current=a}}function Ub(a){var c=a.alternate;c!==null&&(a.alternate=null,Ub(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[hr],delete c[Pc],delete c[Up],delete c[$A],delete c[HA])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Bb(a){return a.tag===5||a.tag===3||a.tag===4}function zb(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Bb(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Nm(a,c,f){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?f.nodeType===8?f.parentNode.insertBefore(a,c):f.insertBefore(a,c):(f.nodeType===8?(c=f.parentNode,c.insertBefore(a,f)):(c=f,c.appendChild(a)),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=Od));else if(y!==4&&(a=a.child,a!==null))for(Nm(a,c,f),a=a.sibling;a!==null;)Nm(a,c,f),a=a.sibling}function Am(a,c,f){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?f.insertBefore(a,c):f.appendChild(a);else if(y!==4&&(a=a.child,a!==null))for(Am(a,c,f),a=a.sibling;a!==null;)Am(a,c,f),a=a.sibling}var ds=null,Bn=!1;function Fi(a,c,f){for(f=f.child;f!==null;)$b(a,c,f),f=f.sibling}function $b(a,c,f){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(Ia,f)}catch{}switch(f.tag){case 5:Ns||il(f,c);case 6:var y=ds,b=Bn;ds=null,Fi(a,c,f),ds=y,Bn=b,ds!==null&&(Bn?(a=ds,f=f.stateNode,a.nodeType===8?a.parentNode.removeChild(f):a.removeChild(f)):ds.removeChild(f.stateNode));break;case 18:ds!==null&&(Bn?(a=ds,f=f.stateNode,a.nodeType===8?Vp(a.parentNode,f):a.nodeType===1&&Vp(a,f),Ti(a)):Vp(ds,f.stateNode));break;case 4:y=ds,b=Bn,ds=f.stateNode.containerInfo,Bn=!0,Fi(a,c,f),ds=y,Bn=b;break;case 0:case 11:case 14:case 15:if(!Ns&&(y=f.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){b=y=y.next;do{var _=b,j=_.destroy;_=_.tag,j!==void 0&&((_&2)!==0||(_&4)!==0)&&km(f,c,j),b=b.next}while(b!==y)}Fi(a,c,f);break;case 1:if(!Ns&&(il(f,c),y=f.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=f.memoizedProps,y.state=f.memoizedState,y.componentWillUnmount()}catch(z){It(f,c,z)}Fi(a,c,f);break;case 21:Fi(a,c,f);break;case 22:f.mode&1?(Ns=(y=Ns)||f.memoizedState!==null,Fi(a,c,f),Ns=y):Fi(a,c,f);break;default:Fi(a,c,f)}}function Hb(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new aS),c.forEach(function(y){var b=gS.bind(null,a,y);f.has(y)||(f.add(y),y.then(b,b))})}}function zn(a,c){var f=c.deletions;if(f!==null)for(var y=0;y<f.length;y++){var b=f[y];try{var _=a,j=c,z=j;e:for(;z!==null;){switch(z.tag){case 5:ds=z.stateNode,Bn=!1;break e;case 3:ds=z.stateNode.containerInfo,Bn=!0;break e;case 4:ds=z.stateNode.containerInfo,Bn=!0;break e}z=z.return}if(ds===null)throw Error(t(160));$b(_,j,b),ds=null,Bn=!1;var H=b.alternate;H!==null&&(H.return=null),b.return=null}catch(Q){It(b,c,Q)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)qb(c,a),c=c.sibling}function qb(a,c){var f=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(zn(c,a),mr(a),y&4){try{zc(3,a,a.return),ah(3,a)}catch(Ne){It(a,a.return,Ne)}try{zc(5,a,a.return)}catch(Ne){It(a,a.return,Ne)}}break;case 1:zn(c,a),mr(a),y&512&&f!==null&&il(f,f.return);break;case 5:if(zn(c,a),mr(a),y&512&&f!==null&&il(f,f.return),a.flags&32){var b=a.stateNode;try{Na(b,"")}catch(Ne){It(a,a.return,Ne)}}if(y&4&&(b=a.stateNode,b!=null)){var _=a.memoizedProps,j=f!==null?f.memoizedProps:_,z=a.type,H=a.updateQueue;if(a.updateQueue=null,H!==null)try{z==="input"&&_.type==="radio"&&_.name!=null&&ko(b,_),Ao(z,j);var Q=Ao(z,_);for(j=0;j<H.length;j+=2){var ne=H[j],re=H[j+1];ne==="style"?No(b,re):ne==="dangerouslySetInnerHTML"?ud(b,re):ne==="children"?Na(b,re):I(b,ne,re,Q)}switch(z){case"input":Ea(b,_);break;case"textarea":cd(b,_);break;case"select":var se=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!_.multiple;var me=_.value;me!=null?Dn(b,!!_.multiple,me,!1):se!==!!_.multiple&&(_.defaultValue!=null?Dn(b,!!_.multiple,_.defaultValue,!0):Dn(b,!!_.multiple,_.multiple?[]:"",!1))}b[Pc]=_}catch(Ne){It(a,a.return,Ne)}}break;case 6:if(zn(c,a),mr(a),y&4){if(a.stateNode===null)throw Error(t(162));b=a.stateNode,_=a.memoizedProps;try{b.nodeValue=_}catch(Ne){It(a,a.return,Ne)}}break;case 3:if(zn(c,a),mr(a),y&4&&f!==null&&f.memoizedState.isDehydrated)try{Ti(c.containerInfo)}catch(Ne){It(a,a.return,Ne)}break;case 4:zn(c,a),mr(a);break;case 13:zn(c,a),mr(a),b=a.child,b.flags&8192&&(_=b.memoizedState!==null,b.stateNode.isHidden=_,!_||b.alternate!==null&&b.alternate.memoizedState!==null||(Cm=gt())),y&4&&Hb(a);break;case 22:if(ne=f!==null&&f.memoizedState!==null,a.mode&1?(Ns=(Q=Ns)||ne,zn(c,a),Ns=Q):zn(c,a),mr(a),y&8192){if(Q=a.memoizedState!==null,(a.stateNode.isHidden=Q)&&!ne&&(a.mode&1)!==0)for(be=a,ne=a.child;ne!==null;){for(re=be=ne;be!==null;){switch(se=be,me=se.child,se.tag){case 0:case 11:case 14:case 15:zc(4,se,se.return);break;case 1:il(se,se.return);var _e=se.stateNode;if(typeof _e.componentWillUnmount=="function"){y=se,f=se.return;try{c=y,_e.props=c.memoizedProps,_e.state=c.memoizedState,_e.componentWillUnmount()}catch(Ne){It(y,f,Ne)}}break;case 5:il(se,se.return);break;case 22:if(se.memoizedState!==null){Kb(re);continue}}me!==null?(me.return=se,be=me):Kb(re)}ne=ne.sibling}e:for(ne=null,re=a;;){if(re.tag===5){if(ne===null){ne=re;try{b=re.stateNode,Q?(_=b.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(z=re.stateNode,H=re.memoizedProps.style,j=H!=null&&H.hasOwnProperty("display")?H.display:null,z.style.display=bi("display",j))}catch(Ne){It(a,a.return,Ne)}}}else if(re.tag===6){if(ne===null)try{re.stateNode.nodeValue=Q?"":re.memoizedProps}catch(Ne){It(a,a.return,Ne)}}else if((re.tag!==22&&re.tag!==23||re.memoizedState===null||re===a)&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===a)break e;for(;re.sibling===null;){if(re.return===null||re.return===a)break e;ne===re&&(ne=null),re=re.return}ne===re&&(ne=null),re.sibling.return=re.return,re=re.sibling}}break;case 19:zn(c,a),mr(a),y&4&&Hb(a);break;case 21:break;default:zn(c,a),mr(a)}}function mr(a){var c=a.flags;if(c&2){try{e:{for(var f=a.return;f!==null;){if(Bb(f)){var y=f;break e}f=f.return}throw Error(t(160))}switch(y.tag){case 5:var b=y.stateNode;y.flags&32&&(Na(b,""),y.flags&=-33);var _=zb(a);Am(a,_,b);break;case 3:case 4:var j=y.stateNode.containerInfo,z=zb(a);Nm(a,z,j);break;default:throw Error(t(161))}}catch(H){It(a,a.return,H)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function lS(a,c,f){be=a,Wb(a)}function Wb(a,c,f){for(var y=(a.mode&1)!==0;be!==null;){var b=be,_=b.child;if(b.tag===22&&y){var j=b.memoizedState!==null||ih;if(!j){var z=b.alternate,H=z!==null&&z.memoizedState!==null||Ns;z=ih;var Q=Ns;if(ih=j,(Ns=H)&&!Q)for(be=b;be!==null;)j=be,H=j.child,j.tag===22&&j.memoizedState!==null?Yb(b):H!==null?(H.return=j,be=H):Yb(b);for(;_!==null;)be=_,Wb(_),_=_.sibling;be=b,ih=z,Ns=Q}Gb(a)}else(b.subtreeFlags&8772)!==0&&_!==null?(_.return=b,be=_):Gb(a)}}function Gb(a){for(;be!==null;){var c=be;if((c.flags&8772)!==0){var f=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Ns||ah(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!Ns)if(f===null)y.componentDidMount();else{var b=c.elementType===c.type?f.memoizedProps:Un(c.type,f.memoizedProps);y.componentDidUpdate(b,f.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var _=c.updateQueue;_!==null&&Kx(c,_,y);break;case 3:var j=c.updateQueue;if(j!==null){if(f=null,c.child!==null)switch(c.child.tag){case 5:f=c.child.stateNode;break;case 1:f=c.child.stateNode}Kx(c,j,f)}break;case 5:var z=c.stateNode;if(f===null&&c.flags&4){f=z;var H=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":H.autoFocus&&f.focus();break;case"img":H.src&&(f.src=H.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Q=c.alternate;if(Q!==null){var ne=Q.memoizedState;if(ne!==null){var re=ne.dehydrated;re!==null&&Ti(re)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ns||c.flags&512&&Em(c)}catch(se){It(c,c.return,se)}}if(c===a){be=null;break}if(f=c.sibling,f!==null){f.return=c.return,be=f;break}be=c.return}}function Kb(a){for(;be!==null;){var c=be;if(c===a){be=null;break}var f=c.sibling;if(f!==null){f.return=c.return,be=f;break}be=c.return}}function Yb(a){for(;be!==null;){var c=be;try{switch(c.tag){case 0:case 11:case 15:var f=c.return;try{ah(4,c)}catch(H){It(c,f,H)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var b=c.return;try{y.componentDidMount()}catch(H){It(c,b,H)}}var _=c.return;try{Em(c)}catch(H){It(c,_,H)}break;case 5:var j=c.return;try{Em(c)}catch(H){It(c,j,H)}}}catch(H){It(c,c.return,H)}if(c===a){be=null;break}var z=c.sibling;if(z!==null){z.return=c.return,be=z;break}be=c.return}}var cS=Math.ceil,oh=P.ReactCurrentDispatcher,Sm=P.ReactCurrentOwner,kn=P.ReactCurrentBatchConfig,nt=0,rs=null,Wt=null,hs=0,un=0,al=Ri(0),es=0,$c=null,Wa=0,lh=0,Tm=0,Hc=null,Hs=null,Cm=0,ol=1/0,Kr=null,ch=!1,Im=null,Vi=null,uh=!1,Ui=null,dh=0,qc=0,Pm=null,hh=-1,fh=0;function Rs(){return(nt&6)!==0?gt():hh!==-1?hh:hh=gt()}function Bi(a){return(a.mode&1)===0?1:(nt&2)!==0&&hs!==0?hs&-hs:WA.transition!==null?(fh===0&&(fh=hc()),fh):(a=Je,a!==0||(a=window.event,a=a===void 0?16:Lo(a.type)),a)}function $n(a,c,f,y){if(50<qc)throw qc=0,Pm=null,Error(t(185));Da(a,f,y),((nt&2)===0||a!==rs)&&(a===rs&&((nt&2)===0&&(lh|=f),es===4&&zi(a,hs)),qs(a,y),f===1&&nt===0&&(c.mode&1)===0&&(ol=gt()+500,Bd&&Mi()))}function qs(a,c){var f=a.callbackNode;Ra(a,c);var y=Mr(a,a===rs?hs:0);if(y===0)f!==null&&Co(f),a.callbackNode=null,a.callbackPriority=0;else if(c=y&-y,a.callbackPriority!==c){if(f!=null&&Co(f),c===1)a.tag===0?qA(Qb.bind(null,a)):Lx(Qb.bind(null,a)),BA(function(){(nt&6)===0&&Mi()}),f=null;else{switch(sr(y)){case 1:f=Io;break;case 4:f=cc;break;case 16:f=Ca;break;case 536870912:f=Po;break;default:f=Ca}f=iv(f,Xb.bind(null,a))}a.callbackPriority=c,a.callbackNode=f}}function Xb(a,c){if(hh=-1,fh=0,(nt&6)!==0)throw Error(t(327));var f=a.callbackNode;if(ll()&&a.callbackNode!==f)return null;var y=Mr(a,a===rs?hs:0);if(y===0)return null;if((y&30)!==0||(y&a.expiredLanes)!==0||c)c=ph(a,y);else{c=y;var b=nt;nt|=2;var _=Zb();(rs!==a||hs!==c)&&(Kr=null,ol=gt()+500,Ka(a,c));do try{hS();break}catch(z){Jb(a,z)}while(!0);Yp(),oh.current=_,nt=b,Wt!==null?c=0:(rs=null,hs=0,c=es)}if(c!==0){if(c===2&&(b=dc(a),b!==0&&(y=b,c=jm(a,b))),c===1)throw f=$c,Ka(a,0),zi(a,y),qs(a,gt()),f;if(c===6)zi(a,y);else{if(b=a.current.alternate,(y&30)===0&&!uS(b)&&(c=ph(a,y),c===2&&(_=dc(a),_!==0&&(y=_,c=jm(a,_))),c===1))throw f=$c,Ka(a,0),zi(a,y),qs(a,gt()),f;switch(a.finishedWork=b,a.finishedLanes=y,c){case 0:case 1:throw Error(t(345));case 2:Ya(a,Hs,Kr);break;case 3:if(zi(a,y),(y&130023424)===y&&(c=Cm+500-gt(),10<c)){if(Mr(a,0)!==0)break;if(b=a.suspendedLanes,(b&y)!==y){Rs(),a.pingedLanes|=a.suspendedLanes&b;break}a.timeoutHandle=Fp(Ya.bind(null,a,Hs,Kr),c);break}Ya(a,Hs,Kr);break;case 4:if(zi(a,y),(y&4194240)===y)break;for(c=a.eventTimes,b=-1;0<y;){var j=31-sn(y);_=1<<j,j=c[j],j>b&&(b=j),y&=~_}if(y=b,y=gt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*cS(y/1960))-y,10<y){a.timeoutHandle=Fp(Ya.bind(null,a,Hs,Kr),y);break}Ya(a,Hs,Kr);break;case 5:Ya(a,Hs,Kr);break;default:throw Error(t(329))}}}return qs(a,gt()),a.callbackNode===f?Xb.bind(null,a):null}function jm(a,c){var f=Hc;return a.current.memoizedState.isDehydrated&&(Ka(a,c).flags|=256),a=ph(a,c),a!==2&&(c=Hs,Hs=f,c!==null&&Rm(c)),a}function Rm(a){Hs===null?Hs=a:Hs.push.apply(Hs,a)}function uS(a){for(var c=a;;){if(c.flags&16384){var f=c.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var y=0;y<f.length;y++){var b=f[y],_=b.getSnapshot;b=b.value;try{if(!Fn(_(),b))return!1}catch{return!1}}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function zi(a,c){for(c&=~Tm,c&=~lh,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var f=31-sn(c),y=1<<f;a[f]=-1,c&=~y}}function Qb(a){if((nt&6)!==0)throw Error(t(327));ll();var c=Mr(a,0);if((c&1)===0)return qs(a,gt()),null;var f=ph(a,c);if(a.tag!==0&&f===2){var y=dc(a);y!==0&&(c=y,f=jm(a,y))}if(f===1)throw f=$c,Ka(a,0),zi(a,c),qs(a,gt()),f;if(f===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Ya(a,Hs,Kr),qs(a,gt()),null}function Dm(a,c){var f=nt;nt|=1;try{return a(c)}finally{nt=f,nt===0&&(ol=gt()+500,Bd&&Mi())}}function Ga(a){Ui!==null&&Ui.tag===0&&(nt&6)===0&&ll();var c=nt;nt|=1;var f=kn.transition,y=Je;try{if(kn.transition=null,Je=1,a)return a()}finally{Je=y,kn.transition=f,nt=c,(nt&6)===0&&Mi()}}function Mm(){un=al.current,xt(al)}function Ka(a,c){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==-1&&(a.timeoutHandle=-1,UA(f)),Wt!==null)for(f=Wt.return;f!==null;){var y=f;switch(Hp(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Vd();break;case 3:nl(),xt(Bs),xt(_s),nm();break;case 5:tm(y);break;case 4:nl();break;case 13:xt(wt);break;case 19:xt(wt);break;case 10:Xp(y.type._context);break;case 22:case 23:Mm()}f=f.return}if(rs=a,Wt=a=$i(a.current,null),hs=un=c,es=0,$c=null,Tm=lh=Wa=0,Hs=Hc=null,$a!==null){for(c=0;c<$a.length;c++)if(f=$a[c],y=f.interleaved,y!==null){f.interleaved=null;var b=y.next,_=f.pending;if(_!==null){var j=_.next;_.next=b,y.next=j}f.pending=y}$a=null}return a}function Jb(a,c){do{var f=Wt;try{if(Yp(),Qd.current=th,Jd){for(var y=_t.memoizedState;y!==null;){var b=y.queue;b!==null&&(b.pending=null),y=y.next}Jd=!1}if(qa=0,ns=Zt=_t=null,Oc=!1,Fc=0,Sm.current=null,f===null||f.return===null){es=1,$c=c,Wt=null;break}e:{var _=a,j=f.return,z=f,H=c;if(c=hs,z.flags|=32768,H!==null&&typeof H=="object"&&typeof H.then=="function"){var Q=H,ne=z,re=ne.tag;if((ne.mode&1)===0&&(re===0||re===11||re===15)){var se=ne.alternate;se?(ne.updateQueue=se.updateQueue,ne.memoizedState=se.memoizedState,ne.lanes=se.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var me=kb(j);if(me!==null){me.flags&=-257,Eb(me,j,z,_,c),me.mode&1&&_b(_,Q,c),c=me,H=Q;var _e=c.updateQueue;if(_e===null){var Ne=new Set;Ne.add(H),c.updateQueue=Ne}else _e.add(H);break e}else{if((c&1)===0){_b(_,Q,c),Lm();break e}H=Error(t(426))}}else if(vt&&z.mode&1){var Ot=kb(j);if(Ot!==null){(Ot.flags&65536)===0&&(Ot.flags|=256),Eb(Ot,j,z,_,c),Gp(rl(H,z));break e}}_=H=rl(H,z),es!==4&&(es=2),Hc===null?Hc=[_]:Hc.push(_),_=j;do{switch(_.tag){case 3:_.flags|=65536,c&=-c,_.lanes|=c;var G=vb(_,H,c);Gx(_,G);break e;case 1:z=H;var q=_.type,X=_.stateNode;if((_.flags&128)===0&&(typeof q.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(Vi===null||!Vi.has(X)))){_.flags|=65536,c&=-c,_.lanes|=c;var ae=wb(_,z,c);Gx(_,ae);break e}}_=_.return}while(_!==null)}tv(f)}catch(Ae){c=Ae,Wt===f&&f!==null&&(Wt=f=f.return);continue}break}while(!0)}function Zb(){var a=oh.current;return oh.current=th,a===null?th:a}function Lm(){(es===0||es===3||es===2)&&(es=4),rs===null||(Wa&268435455)===0&&(lh&268435455)===0||zi(rs,hs)}function ph(a,c){var f=nt;nt|=2;var y=Zb();(rs!==a||hs!==c)&&(Kr=null,Ka(a,c));do try{dS();break}catch(b){Jb(a,b)}while(!0);if(Yp(),nt=f,oh.current=y,Wt!==null)throw Error(t(261));return rs=null,hs=0,es}function dS(){for(;Wt!==null;)ev(Wt)}function hS(){for(;Wt!==null&&!Ta();)ev(Wt)}function ev(a){var c=rv(a.alternate,a,un);a.memoizedProps=a.pendingProps,c===null?tv(a):Wt=c,Sm.current=null}function tv(a){var c=a;do{var f=c.alternate;if(a=c.return,(c.flags&32768)===0){if(f=rS(f,c,un),f!==null){Wt=f;return}}else{if(f=iS(f,c),f!==null){f.flags&=32767,Wt=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{es=6,Wt=null;return}}if(c=c.sibling,c!==null){Wt=c;return}Wt=c=a}while(c!==null);es===0&&(es=5)}function Ya(a,c,f){var y=Je,b=kn.transition;try{kn.transition=null,Je=1,fS(a,c,f,y)}finally{kn.transition=b,Je=y}return null}function fS(a,c,f,y){do ll();while(Ui!==null);if((nt&6)!==0)throw Error(t(327));f=a.finishedWork;var b=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var _=f.lanes|f.childLanes;if(_p(a,_),a===rs&&(Wt=rs=null,hs=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||uh||(uh=!0,iv(Ca,function(){return ll(),null})),_=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||_){_=kn.transition,kn.transition=null;var j=Je;Je=1;var z=nt;nt|=4,Sm.current=null,oS(a,f),qb(f,a),RA(Lp),Fr=!!Mp,Lp=Mp=null,a.current=f,lS(f),Dr(),nt=z,Je=j,kn.transition=_}else a.current=f;if(uh&&(uh=!1,Ui=a,dh=b),_=a.pendingLanes,_===0&&(Vi=null),wd(f.stateNode),qs(a,gt()),c!==null)for(y=a.onRecoverableError,f=0;f<c.length;f++)b=c[f],y(b.value,{componentStack:b.stack,digest:b.digest});if(ch)throw ch=!1,a=Im,Im=null,a;return(dh&1)!==0&&a.tag!==0&&ll(),_=a.pendingLanes,(_&1)!==0?a===Pm?qc++:(qc=0,Pm=a):qc=0,Mi(),null}function ll(){if(Ui!==null){var a=sr(dh),c=kn.transition,f=Je;try{if(kn.transition=null,Je=16>a?16:a,Ui===null)var y=!1;else{if(a=Ui,Ui=null,dh=0,(nt&6)!==0)throw Error(t(331));var b=nt;for(nt|=4,be=a.current;be!==null;){var _=be,j=_.child;if((be.flags&16)!==0){var z=_.deletions;if(z!==null){for(var H=0;H<z.length;H++){var Q=z[H];for(be=Q;be!==null;){var ne=be;switch(ne.tag){case 0:case 11:case 15:zc(8,ne,_)}var re=ne.child;if(re!==null)re.return=ne,be=re;else for(;be!==null;){ne=be;var se=ne.sibling,me=ne.return;if(Ub(ne),ne===Q){be=null;break}if(se!==null){se.return=me,be=se;break}be=me}}}var _e=_.alternate;if(_e!==null){var Ne=_e.child;if(Ne!==null){_e.child=null;do{var Ot=Ne.sibling;Ne.sibling=null,Ne=Ot}while(Ne!==null)}}be=_}}if((_.subtreeFlags&2064)!==0&&j!==null)j.return=_,be=j;else e:for(;be!==null;){if(_=be,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:zc(9,_,_.return)}var G=_.sibling;if(G!==null){G.return=_.return,be=G;break e}be=_.return}}var q=a.current;for(be=q;be!==null;){j=be;var X=j.child;if((j.subtreeFlags&2064)!==0&&X!==null)X.return=j,be=X;else e:for(j=q;be!==null;){if(z=be,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:ah(9,z)}}catch(Ae){It(z,z.return,Ae)}if(z===j){be=null;break e}var ae=z.sibling;if(ae!==null){ae.return=z.return,be=ae;break e}be=z.return}}if(nt=b,Mi(),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(Ia,a)}catch{}y=!0}return y}finally{Je=f,kn.transition=c}}return!1}function sv(a,c,f){c=rl(f,c),c=vb(a,c,1),a=Oi(a,c,1),c=Rs(),a!==null&&(Da(a,1,c),qs(a,c))}function It(a,c,f){if(a.tag===3)sv(a,a,f);else for(;c!==null;){if(c.tag===3){sv(c,a,f);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Vi===null||!Vi.has(y))){a=rl(f,a),a=wb(c,a,1),c=Oi(c,a,1),a=Rs(),c!==null&&(Da(c,1,a),qs(c,a));break}}c=c.return}}function pS(a,c,f){var y=a.pingCache;y!==null&&y.delete(c),c=Rs(),a.pingedLanes|=a.suspendedLanes&f,rs===a&&(hs&f)===f&&(es===4||es===3&&(hs&130023424)===hs&&500>gt()-Cm?Ka(a,0):Tm|=f),qs(a,c)}function nv(a,c){c===0&&((a.mode&1)===0?c=1:(c=Ni,Ni<<=1,(Ni&130023424)===0&&(Ni=4194304)));var f=Rs();a=qr(a,c),a!==null&&(Da(a,c,f),qs(a,f))}function mS(a){var c=a.memoizedState,f=0;c!==null&&(f=c.retryLane),nv(a,f)}function gS(a,c){var f=0;switch(a.tag){case 13:var y=a.stateNode,b=a.memoizedState;b!==null&&(f=b.retryLane);break;case 19:y=a.stateNode;break;default:throw Error(t(314))}y!==null&&y.delete(c),nv(a,f)}var rv;rv=function(a,c,f){if(a!==null)if(a.memoizedProps!==c.pendingProps||Bs.current)$s=!0;else{if((a.lanes&f)===0&&(c.flags&128)===0)return $s=!1,nS(a,c,f);$s=(a.flags&131072)!==0}else $s=!1,vt&&(c.flags&1048576)!==0&&Ox(c,$d,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;rh(a,c),a=c.pendingProps;var b=Xo(c,_s.current);sl(c,f),b=am(null,c,y,a,b,f);var _=om();return c.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,zs(y)?(_=!0,Ud(c)):_=!1,c.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,Zp(c),b.updater=sh,c.stateNode=b,b._reactInternals=c,fm(c,y,a,f),c=ym(null,c,y,!0,_,f)):(c.tag=0,vt&&_&&$p(c),js(null,c,b,f),c=c.child),c;case 16:y=c.elementType;e:{switch(rh(a,c),a=c.pendingProps,b=y._init,y=b(y._payload),c.type=y,b=c.tag=xS(y),a=Un(y,a),b){case 0:c=gm(null,c,y,a,f);break e;case 1:c=Ib(null,c,y,a,f);break e;case 11:c=Nb(null,c,y,a,f);break e;case 14:c=Ab(null,c,y,Un(y.type,a),f);break e}throw Error(t(306,y,""))}return c;case 0:return y=c.type,b=c.pendingProps,b=c.elementType===y?b:Un(y,b),gm(a,c,y,b,f);case 1:return y=c.type,b=c.pendingProps,b=c.elementType===y?b:Un(y,b),Ib(a,c,y,b,f);case 3:e:{if(Pb(c),a===null)throw Error(t(387));y=c.pendingProps,_=c.memoizedState,b=_.element,Wx(a,c),Yd(c,y,null,f);var j=c.memoizedState;if(y=j.element,_.isDehydrated)if(_={element:y,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},c.updateQueue.baseState=_,c.memoizedState=_,c.flags&256){b=rl(Error(t(423)),c),c=jb(a,c,y,f,b);break e}else if(y!==b){b=rl(Error(t(424)),c),c=jb(a,c,y,f,b);break e}else for(cn=ji(c.stateNode.containerInfo.firstChild),ln=c,vt=!0,Vn=null,f=Hx(c,null,y,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Zo(),y===b){c=Gr(a,c,f);break e}js(a,c,y,f)}c=c.child}return c;case 5:return Yx(c),a===null&&Wp(c),y=c.type,b=c.pendingProps,_=a!==null?a.memoizedProps:null,j=b.children,Op(y,b)?j=null:_!==null&&Op(y,_)&&(c.flags|=32),Cb(a,c),js(a,c,j,f),c.child;case 6:return a===null&&Wp(c),null;case 13:return Rb(a,c,f);case 4:return em(c,c.stateNode.containerInfo),y=c.pendingProps,a===null?c.child=el(c,null,y,f):js(a,c,y,f),c.child;case 11:return y=c.type,b=c.pendingProps,b=c.elementType===y?b:Un(y,b),Nb(a,c,y,b,f);case 7:return js(a,c,c.pendingProps,f),c.child;case 8:return js(a,c,c.pendingProps.children,f),c.child;case 12:return js(a,c,c.pendingProps.children,f),c.child;case 10:e:{if(y=c.type._context,b=c.pendingProps,_=c.memoizedProps,j=b.value,pt(Wd,y._currentValue),y._currentValue=j,_!==null)if(Fn(_.value,j)){if(_.children===b.children&&!Bs.current){c=Gr(a,c,f);break e}}else for(_=c.child,_!==null&&(_.return=c);_!==null;){var z=_.dependencies;if(z!==null){j=_.child;for(var H=z.firstContext;H!==null;){if(H.context===y){if(_.tag===1){H=Wr(-1,f&-f),H.tag=2;var Q=_.updateQueue;if(Q!==null){Q=Q.shared;var ne=Q.pending;ne===null?H.next=H:(H.next=ne.next,ne.next=H),Q.pending=H}}_.lanes|=f,H=_.alternate,H!==null&&(H.lanes|=f),Qp(_.return,f,c),z.lanes|=f;break}H=H.next}}else if(_.tag===10)j=_.type===c.type?null:_.child;else if(_.tag===18){if(j=_.return,j===null)throw Error(t(341));j.lanes|=f,z=j.alternate,z!==null&&(z.lanes|=f),Qp(j,f,c),j=_.sibling}else j=_.child;if(j!==null)j.return=_;else for(j=_;j!==null;){if(j===c){j=null;break}if(_=j.sibling,_!==null){_.return=j.return,j=_;break}j=j.return}_=j}js(a,c,b.children,f),c=c.child}return c;case 9:return b=c.type,y=c.pendingProps.children,sl(c,f),b=wn(b),y=y(b),c.flags|=1,js(a,c,y,f),c.child;case 14:return y=c.type,b=Un(y,c.pendingProps),b=Un(y.type,b),Ab(a,c,y,b,f);case 15:return Sb(a,c,c.type,c.pendingProps,f);case 17:return y=c.type,b=c.pendingProps,b=c.elementType===y?b:Un(y,b),rh(a,c),c.tag=1,zs(y)?(a=!0,Ud(c)):a=!1,sl(c,f),xb(c,y,b),fm(c,y,b,f),ym(null,c,y,!0,a,f);case 19:return Mb(a,c,f);case 22:return Tb(a,c,f)}throw Error(t(156,c.tag))};function iv(a,c){return lc(a,c)}function yS(a,c,f,y){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function En(a,c,f,y){return new yS(a,c,f,y)}function Om(a){return a=a.prototype,!(!a||!a.isReactComponent)}function xS(a){if(typeof a=="function")return Om(a)?1:0;if(a!=null){if(a=a.$$typeof,a===$)return 11;if(a===ye)return 14}return 2}function $i(a,c){var f=a.alternate;return f===null?(f=En(a.tag,c,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=c,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,c=a.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function mh(a,c,f,y,b,_){var j=2;if(y=a,typeof a=="function")Om(a)&&(j=1);else if(typeof a=="string")j=5;else e:switch(a){case R:return Xa(f.children,b,_,c);case C:j=8,b|=8;break;case D:return a=En(12,f,c,b|2),a.elementType=D,a.lanes=_,a;case L:return a=En(13,f,c,b),a.elementType=L,a.lanes=_,a;case de:return a=En(19,f,c,b),a.elementType=de,a.lanes=_,a;case oe:return gh(f,b,_,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case B:j=10;break e;case V:j=9;break e;case $:j=11;break e;case ye:j=14;break e;case ie:j=16,y=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=En(j,f,c,b),c.elementType=a,c.type=y,c.lanes=_,c}function Xa(a,c,f,y){return a=En(7,a,y,c),a.lanes=f,a}function gh(a,c,f,y){return a=En(22,a,y,c),a.elementType=oe,a.lanes=f,a.stateNode={isHidden:!1},a}function Fm(a,c,f){return a=En(6,a,null,c),a.lanes=f,a}function Vm(a,c,f){return c=En(4,a.children!==null?a.children:[],a.key,c),c.lanes=f,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function bS(a,c,f,y,b){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fc(0),this.expirationTimes=fc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fc(0),this.identifierPrefix=y,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function Um(a,c,f,y,b,_,j,z,H){return a=new bS(a,c,f,z,H),c===1?(c=1,_===!0&&(c|=8)):c=0,_=En(3,null,null,c),a.current=_,_.stateNode=a,_.memoizedState={element:y,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zp(_),a}function vS(a,c,f){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:O,key:y==null?null:""+y,children:a,containerInfo:c,implementation:f}}function av(a){if(!a)return Di;a=a._reactInternals;e:{if(Ln(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(zs(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var f=a.type;if(zs(f))return Dx(a,f,c)}return c}function ov(a,c,f,y,b,_,j,z,H){return a=Um(f,y,!0,a,b,_,j,z,H),a.context=av(null),f=a.current,y=Rs(),b=Bi(f),_=Wr(y,b),_.callback=c??null,Oi(f,_,b),a.current.lanes=b,Da(a,b,y),qs(a,y),a}function yh(a,c,f,y){var b=c.current,_=Rs(),j=Bi(b);return f=av(f),c.context===null?c.context=f:c.pendingContext=f,c=Wr(_,j),c.payload={element:a},y=y===void 0?null:y,y!==null&&(c.callback=y),a=Oi(b,c,j),a!==null&&($n(a,b,j,_),Kd(a,b,j)),j}function xh(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function lv(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<c?f:c}}function Bm(a,c){lv(a,c),(a=a.alternate)&&lv(a,c)}function wS(){return null}var cv=typeof reportError=="function"?reportError:function(a){console.error(a)};function zm(a){this._internalRoot=a}bh.prototype.render=zm.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));yh(a,c,null,null)},bh.prototype.unmount=zm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;Ga(function(){yh(null,a,null,null)}),c[Br]=null}};function bh(a){this._internalRoot=a}bh.prototype.unstable_scheduleHydration=function(a){if(a){var c=yc();a={blockedOn:null,target:a,priority:c};for(var f=0;f<nn.length&&c!==0&&c<nn[f].priority;f++);nn.splice(f,0,a),f===0&&Do(a)}};function $m(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function vh(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function uv(){}function _S(a,c,f,y,b){if(b){if(typeof y=="function"){var _=y;y=function(){var Q=xh(j);_.call(Q)}}var j=ov(c,y,a,0,null,!1,!1,"",uv);return a._reactRootContainer=j,a[Br]=j.current,Cc(a.nodeType===8?a.parentNode:a),Ga(),j}for(;b=a.lastChild;)a.removeChild(b);if(typeof y=="function"){var z=y;y=function(){var Q=xh(H);z.call(Q)}}var H=Um(a,0,!1,null,null,!1,!1,"",uv);return a._reactRootContainer=H,a[Br]=H.current,Cc(a.nodeType===8?a.parentNode:a),Ga(function(){yh(c,H,f,y)}),H}function wh(a,c,f,y,b){var _=f._reactRootContainer;if(_){var j=_;if(typeof b=="function"){var z=b;b=function(){var H=xh(j);z.call(H)}}yh(c,j,a,b)}else j=_S(f,c,a,b,y);return xh(j)}mc=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var f=it(c.pendingLanes);f!==0&&(pc(c,f|1),qs(c,gt()),(nt&6)===0&&(ol=gt()+500,Mi()))}break;case 13:Ga(function(){var y=qr(a,1);if(y!==null){var b=Rs();$n(y,a,1,b)}}),Bm(a,1)}},jo=function(a){if(a.tag===13){var c=qr(a,134217728);if(c!==null){var f=Rs();$n(c,a,134217728,f)}Bm(a,134217728)}},gc=function(a){if(a.tag===13){var c=Bi(a),f=qr(a,c);if(f!==null){var y=Rs();$n(f,a,c,y)}Bm(a,c)}},yc=function(){return Je},xc=function(a,c){var f=Je;try{return Je=a,c()}finally{Je=f}},Pr=function(a,c,f){switch(c){case"input":if(Ea(a,f),c=f.name,f.type==="radio"&&c!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<f.length;c++){var y=f[c];if(y!==a&&y.form===a.form){var b=Fd(y);if(!b)throw Error(t(90));Tt(y),Ea(y,b)}}}break;case"textarea":cd(a,f);break;case"select":c=f.value,c!=null&&Dn(a,!!f.multiple,c,!1)}},hd=Dm,fd=Ga;var kS={usingClientEntryPoint:!1,Events:[jc,Ko,Fd,wi,_i,Dm]},Wc={findFiberByHostInstance:Va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ES={bundleType:Wc.bundleType,version:Wc.version,rendererPackageName:Wc.rendererPackageName,rendererConfig:Wc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=vd(a),a===null?null:a.stateNode},findFiberByHostInstance:Wc.findFiberByHostInstance||wS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_h.isDisabled&&_h.supportsFiber)try{Ia=_h.inject(ES),tn=_h}catch{}}return Ws.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kS,Ws.createPortal=function(a,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$m(c))throw Error(t(200));return vS(a,c,null,f)},Ws.createRoot=function(a,c){if(!$m(a))throw Error(t(299));var f=!1,y="",b=cv;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(b=c.onRecoverableError)),c=Um(a,1,!1,null,null,f,!1,y,b),a[Br]=c.current,Cc(a.nodeType===8?a.parentNode:a),new zm(c)},Ws.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=vd(c),a=a===null?null:a.stateNode,a},Ws.flushSync=function(a){return Ga(a)},Ws.hydrate=function(a,c,f){if(!vh(c))throw Error(t(200));return wh(null,a,c,!0,f)},Ws.hydrateRoot=function(a,c,f){if(!$m(a))throw Error(t(405));var y=f!=null&&f.hydratedSources||null,b=!1,_="",j=cv;if(f!=null&&(f.unstable_strictMode===!0&&(b=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onRecoverableError!==void 0&&(j=f.onRecoverableError)),c=ov(c,null,a,1,f??null,b,!1,_,j),a[Br]=c.current,Cc(a),y)for(a=0;a<y.length;a++)f=y[a],b=f._getVersion,b=b(f._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[f,b]:c.mutableSourceEagerHydrationData.push(f,b);return new bh(c)},Ws.render=function(a,c,f){if(!vh(c))throw Error(t(200));return wh(null,a,c,!1,f)},Ws.unmountComponentAtNode=function(a){if(!vh(a))throw Error(t(40));return a._reactRootContainer?(Ga(function(){wh(null,null,a,!1,function(){a._reactRootContainer=null,a[Br]=null})}),!0):!1},Ws.unstable_batchedUpdates=Dm,Ws.unstable_renderSubtreeIntoContainer=function(a,c,f,y){if(!vh(f))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return wh(a,c,f,!1,y)},Ws.version="18.3.1-next-f1338f8080-20240426",Ws}var xv;function DS(){if(xv)return Wm.exports;xv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Wm.exports=RS(),Wm.exports}var bv;function MS(){if(bv)return kh;bv=1;var n=DS();return kh.createRoot=n.createRoot,kh.hydrateRoot=n.hydrateRoot,kh}var LS=MS(),F=N0();const OS=SS(F),FS=AS({__proto__:null,default:OS},[F]);/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var vv="popstate";function VS(n={}){function e(s,r){let{pathname:i,search:o,hash:u}=s.location;return Ng("",{pathname:i,search:o,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(s,r){return typeof r=="string"?r:xu(r)}return BS(e,t,null,n)}function Et(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Gn(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function US(){return Math.random().toString(36).substring(2,10)}function wv(n,e){return{usr:n.state,key:n.key,idx:e}}function Ng(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?$l(e):e,state:t,key:e&&e.key||s||US()}}function xu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function $l(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function BS(n,e,t,s={}){let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,u="POP",d=null,h=p();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function p(){return(o.state||{idx:null}).idx}function m(){u="POP";let N=p(),A=N==null?null:N-h;h=N,d&&d({action:u,location:E.location,delta:A})}function x(N,A){u="PUSH";let T=Ng(E.location,N,A);h=p()+1;let I=wv(T,h),P=E.createHref(T);try{o.pushState(I,"",P)}catch(U){if(U instanceof DOMException&&U.name==="DataCloneError")throw U;r.location.assign(P)}i&&d&&d({action:u,location:E.location,delta:1})}function v(N,A){u="REPLACE";let T=Ng(E.location,N,A);h=p();let I=wv(T,h),P=E.createHref(T);o.replaceState(I,"",P),i&&d&&d({action:u,location:E.location,delta:0})}function w(N){return zS(N)}let E={get action(){return u},get location(){return n(r,o)},listen(N){if(d)throw new Error("A history only accepts one active listener");return r.addEventListener(vv,m),d=N,()=>{r.removeEventListener(vv,m),d=null}},createHref(N){return e(r,N)},createURL:w,encodeLocation(N){let A=w(N);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:x,replace:v,go(N){return o.go(N)}};return E}function zS(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Et(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:xu(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function Y_(n,e,t="/"){return $S(n,e,t,!1)}function $S(n,e,t,s){let r=typeof e=="string"?$l(e):e,i=ni(r.pathname||"/",t);if(i==null)return null;let o=X_(n);HS(o);let u=null;for(let d=0;u==null&&d<o.length;++d){let h=tT(i);u=ZS(o[d],h,s)}return u}function X_(n,e=[],t=[],s="",r=!1){let i=(o,u,d=r,h)=>{let p={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(s)&&d)return;Et(p.relativePath.startsWith(s),`Absolute route path "${p.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(s.length)}let m=ei([s,p.relativePath]),x=t.concat(p);o.children&&o.children.length>0&&(Et(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),X_(o.children,e,x,m,d)),!(o.path==null&&!o.index)&&e.push({path:m,score:QS(m,o.index),routesMeta:x})};return n.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))i(o,u);else for(let d of Q_(o.path))i(o,u,!0,d)}),e}function Q_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,r=t.endsWith("?"),i=t.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=Q_(s.join("/")),u=[];return u.push(...o.map(d=>d===""?i:[i,d].join("/"))),r&&u.push(...o),u.map(d=>n.startsWith("/")&&d===""?"/":d)}function HS(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:JS(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var qS=/^:[\w-]+$/,WS=3,GS=2,KS=1,YS=10,XS=-2,_v=n=>n==="*";function QS(n,e){let t=n.split("/"),s=t.length;return t.some(_v)&&(s+=XS),e&&(s+=GS),t.filter(r=>!_v(r)).reduce((r,i)=>r+(qS.test(i)?WS:i===""?KS:YS),s)}function JS(n,e){return n.length===e.length&&n.slice(0,-1).every((s,r)=>s===e[r])?n[n.length-1]-e[e.length-1]:0}function ZS(n,e,t=!1){let{routesMeta:s}=n,r={},i="/",o=[];for(let u=0;u<s.length;++u){let d=s[u],h=u===s.length-1,p=i==="/"?e:e.slice(i.length)||"/",m=af({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},p),x=d.route;if(!m&&h&&t&&!s[s.length-1].route.index&&(m=af({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},p)),!m)return null;Object.assign(r,m.params),o.push({params:r,pathname:ei([i,m.pathname]),pathnameBase:iT(ei([i,m.pathnameBase])),route:x}),m.pathnameBase!=="/"&&(i=ei([i,m.pathnameBase]))}return o}function af(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=eT(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:s.reduce((h,{paramName:p,isOptional:m},x)=>{if(p==="*"){let w=u[x]||"";o=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const v=u[x];return m&&!v?h[p]=void 0:h[p]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:i,pathnameBase:o,pattern:n}}function eT(n,e=!1,t=!0){Gn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,d)=>(s.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function tT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gn(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ni(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}var J_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sT=n=>J_.test(n);function nT(n,e="/"){let{pathname:t,search:s="",hash:r=""}=typeof n=="string"?$l(n):n,i;if(t)if(sT(t))i=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Gn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?i=kv(t.substring(1),"/"):i=kv(t,e)}else i=e;return{pathname:i,search:aT(s),hash:oT(r)}}function kv(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function Ym(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Z_(n){let e=rT(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function ek(n,e,t,s=!1){let r;typeof n=="string"?r=$l(n):(r={...n},Et(!r.pathname||!r.pathname.includes("?"),Ym("?","pathname","search",r)),Et(!r.pathname||!r.pathname.includes("#"),Ym("#","pathname","hash",r)),Et(!r.search||!r.search.includes("#"),Ym("#","search","hash",r)));let i=n===""||r.pathname==="",o=i?"/":r.pathname,u;if(o==null)u=t;else{let m=e.length-1;if(!s&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),m-=1;r.pathname=x.join("/")}u=m>=0?e[m]:"/"}let d=nT(r,u),h=o&&o!=="/"&&o.endsWith("/"),p=(i||o===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(h||p)&&(d.pathname+="/"),d}var ei=n=>n.join("/").replace(/\/\/+/g,"/"),iT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),aT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,oT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,lT=class{constructor(n,e,t,s=!1){this.status=n,this.statusText=e||"",this.internal=s,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function cT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function uT(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var tk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function sk(n,e){let t=n;if(typeof t!="string"||!J_.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let s=t,r=!1;if(tk)try{let i=new URL(window.location.href),o=t.startsWith("//")?new URL(i.protocol+t):new URL(t),u=ni(o.pathname,e);o.origin===i.origin&&u!=null?t=u+o.search+o.hash:r=!0}catch{Gn(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:r,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var nk=["POST","PUT","PATCH","DELETE"];new Set(nk);var dT=["GET",...nk];new Set(dT);var Hl=F.createContext(null);Hl.displayName="DataRouter";var Mf=F.createContext(null);Mf.displayName="DataRouterState";var hT=F.createContext(!1),rk=F.createContext({isTransitioning:!1});rk.displayName="ViewTransition";var fT=F.createContext(new Map);fT.displayName="Fetchers";var pT=F.createContext(null);pT.displayName="Await";var jn=F.createContext(null);jn.displayName="Navigation";var Lu=F.createContext(null);Lu.displayName="Location";var hi=F.createContext({outlet:null,matches:[],isDataRoute:!1});hi.displayName="Route";var A0=F.createContext(null);A0.displayName="RouteError";var ik="REACT_ROUTER_ERROR",mT="REDIRECT",gT="ROUTE_ERROR_RESPONSE";function yT(n){if(n.startsWith(`${ik}:${mT}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function xT(n){if(n.startsWith(`${ik}:${gT}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new lT(e.status,e.statusText,e.data)}catch{}}function bT(n,{relative:e}={}){Et(Ou(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=F.useContext(jn),{hash:r,pathname:i,search:o}=Fu(n,{relative:e}),u=i;return t!=="/"&&(u=i==="/"?t:ei([t,i])),s.createHref({pathname:u,search:o,hash:r})}function Ou(){return F.useContext(Lu)!=null}function po(){return Et(Ou(),"useLocation() may be used only in the context of a <Router> component."),F.useContext(Lu).location}var ak="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ok(n){F.useContext(jn).static||F.useLayoutEffect(n)}function ql(){let{isDataRoute:n}=F.useContext(hi);return n?jT():vT()}function vT(){Et(Ou(),"useNavigate() may be used only in the context of a <Router> component.");let n=F.useContext(Hl),{basename:e,navigator:t}=F.useContext(jn),{matches:s}=F.useContext(hi),{pathname:r}=po(),i=JSON.stringify(Z_(s)),o=F.useRef(!1);return ok(()=>{o.current=!0}),F.useCallback((d,h={})=>{if(Gn(o.current,ak),!o.current)return;if(typeof d=="number"){t.go(d);return}let p=ek(d,JSON.parse(i),r,h.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:ei([e,p.pathname])),(h.replace?t.replace:t.push)(p,h.state,h)},[e,t,i,r,n])}F.createContext(null);function Fu(n,{relative:e}={}){let{matches:t}=F.useContext(hi),{pathname:s}=po(),r=JSON.stringify(Z_(t));return F.useMemo(()=>ek(n,JSON.parse(r),s,e==="path"),[n,r,s,e])}function wT(n,e){return lk(n,e)}function lk(n,e,t,s,r){Et(Ou(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=F.useContext(jn),{matches:o}=F.useContext(hi),u=o[o.length-1],d=u?u.params:{},h=u?u.pathname:"/",p=u?u.pathnameBase:"/",m=u&&u.route;{let T=m&&m.path||"";uk(h,!m||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let x=po(),v;if(e){let T=typeof e=="string"?$l(e):e;Et(p==="/"||T.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${T.pathname}" was given in the \`location\` prop.`),v=T}else v=x;let w=v.pathname||"/",E=w;if(p!=="/"){let T=p.replace(/^\//,"").split("/");E="/"+w.replace(/^\//,"").split("/").slice(T.length).join("/")}let N=Y_(n,{pathname:E});Gn(m||N!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Gn(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=AT(N&&N.map(T=>Object.assign({},T,{params:Object.assign({},d,T.params),pathname:ei([p,i.encodeLocation?i.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?p:ei([p,i.encodeLocation?i.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),o,t,s,r);return e&&A?F.createElement(Lu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},A):A}function _T(){let n=PT(),e=cT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},i={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=F.createElement(F.Fragment,null,F.createElement("p",null," Hey developer "),F.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",F.createElement("code",{style:i},"ErrorBoundary")," or"," ",F.createElement("code",{style:i},"errorElement")," prop on your route.")),F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},e),t?F.createElement("pre",{style:r},t):null,o)}var kT=F.createElement(_T,null),ck=class extends F.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=xT(n.digest);t&&(n=t)}let e=n!==void 0?F.createElement(hi.Provider,{value:this.props.routeContext},F.createElement(A0.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?F.createElement(ET,{error:n},e):e}};ck.contextType=hT;var Xm=new WeakMap;function ET({children:n,error:e}){let{basename:t}=F.useContext(jn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=yT(e.digest);if(s){let r=Xm.get(e);if(r)throw r;let i=sk(s.location,t);if(tk&&!Xm.get(e))if(i.isExternal||s.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:s.replace}));throw Xm.set(e,o),o}return F.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return n}function NT({routeContext:n,match:e,children:t}){let s=F.useContext(Hl);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),F.createElement(hi.Provider,{value:n},t)}function AT(n,e=[],t=null,s=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,o=t?.errors;if(o!=null){let p=i.findIndex(m=>m.route.id&&o?.[m.route.id]!==void 0);Et(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,p+1))}let u=!1,d=-1;if(t)for(let p=0;p<i.length;p++){let m=i[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=p),m.route.id){let{loaderData:x,errors:v}=t,w=m.route.loader&&!x.hasOwnProperty(m.route.id)&&(!v||v[m.route.id]===void 0);if(m.route.lazy||w){u=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}let h=t&&s?(p,m)=>{s(p,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:uT(t.matches),errorInfo:m})}:void 0;return i.reduceRight((p,m,x)=>{let v,w=!1,E=null,N=null;t&&(v=o&&m.route.id?o[m.route.id]:void 0,E=m.route.errorElement||kT,u&&(d<0&&x===0?(uk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,N=null):d===x&&(w=!0,N=m.route.hydrateFallbackElement||null)));let A=e.concat(i.slice(0,x+1)),T=()=>{let I;return v?I=E:w?I=N:m.route.Component?I=F.createElement(m.route.Component,null):m.route.element?I=m.route.element:I=p,F.createElement(NT,{match:m,routeContext:{outlet:p,matches:A,isDataRoute:t!=null},children:I})};return t&&(m.route.ErrorBoundary||m.route.errorElement||x===0)?F.createElement(ck,{location:t.location,revalidation:t.revalidation,component:E,error:v,children:T(),routeContext:{outlet:null,matches:A,isDataRoute:!0},onError:h}):T()},null)}function S0(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ST(n){let e=F.useContext(Hl);return Et(e,S0(n)),e}function TT(n){let e=F.useContext(Mf);return Et(e,S0(n)),e}function CT(n){let e=F.useContext(hi);return Et(e,S0(n)),e}function T0(n){let e=CT(n),t=e.matches[e.matches.length-1];return Et(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function IT(){return T0("useRouteId")}function PT(){let n=F.useContext(A0),e=TT("useRouteError"),t=T0("useRouteError");return n!==void 0?n:e.errors?.[t]}function jT(){let{router:n}=ST("useNavigate"),e=T0("useNavigate"),t=F.useRef(!1);return ok(()=>{t.current=!0}),F.useCallback(async(r,i={})=>{Gn(t.current,ak),t.current&&(typeof r=="number"?await n.navigate(r):await n.navigate(r,{fromRouteId:e,...i}))},[n,e])}var Ev={};function uk(n,e,t){!e&&!Ev[n]&&(Ev[n]=!0,Gn(!1,t))}F.memo(RT);function RT({routes:n,future:e,state:t,onError:s}){return lk(n,void 0,t,s,e)}function Ja(n){Et(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function DT({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:r,static:i=!1,unstable_useTransitions:o}){Et(!Ou(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=n.replace(/^\/*/,"/"),d=F.useMemo(()=>({basename:u,navigator:r,static:i,unstable_useTransitions:o,future:{}}),[u,r,i,o]);typeof t=="string"&&(t=$l(t));let{pathname:h="/",search:p="",hash:m="",state:x=null,key:v="default"}=t,w=F.useMemo(()=>{let E=ni(h,u);return E==null?null:{location:{pathname:E,search:p,hash:m,state:x,key:v},navigationType:s}},[u,h,p,m,x,v,s]);return Gn(w!=null,`<Router basename="${u}"> is not able to match the URL "${h}${p}${m}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:F.createElement(jn.Provider,{value:d},F.createElement(Lu.Provider,{children:e,value:w}))}function MT({children:n,location:e}){return wT(Ag(n),e)}function Ag(n,e=[]){let t=[];return F.Children.forEach(n,(s,r)=>{if(!F.isValidElement(s))return;let i=[...e,r];if(s.type===F.Fragment){t.push.apply(t,Ag(s.props.children,i));return}Et(s.type===Ja,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Et(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Ag(s.props.children,i)),t.push(o)}),t}var Wh="get",Gh="application/x-www-form-urlencoded";function Lf(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function LT(n){return Lf(n)&&n.tagName.toLowerCase()==="button"}function OT(n){return Lf(n)&&n.tagName.toLowerCase()==="form"}function FT(n){return Lf(n)&&n.tagName.toLowerCase()==="input"}function VT(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function UT(n,e){return n.button===0&&(!e||e==="_self")&&!VT(n)}var Eh=null;function BT(){if(Eh===null)try{new FormData(document.createElement("form"),0),Eh=!1}catch{Eh=!0}return Eh}var zT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Qm(n){return n!=null&&!zT.has(n)?(Gn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Gh}"`),null):n}function $T(n,e){let t,s,r,i,o;if(OT(n)){let u=n.getAttribute("action");s=u?ni(u,e):null,t=n.getAttribute("method")||Wh,r=Qm(n.getAttribute("enctype"))||Gh,i=new FormData(n)}else if(LT(n)||FT(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=n.getAttribute("formaction")||u.getAttribute("action");if(s=d?ni(d,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||Wh,r=Qm(n.getAttribute("formenctype"))||Qm(u.getAttribute("enctype"))||Gh,i=new FormData(u,n),!BT()){let{name:h,type:p,value:m}=n;if(p==="image"){let x=h?`${h}.`:"";i.append(`${x}x`,"0"),i.append(`${x}y`,"0")}else h&&i.append(h,m)}}else{if(Lf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Wh,s=null,r=Gh,o=n}return i&&r==="text/plain"&&(o=i,i=void 0),{action:s,method:t.toLowerCase(),encType:r,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function C0(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function HT(n,e,t){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return s.pathname==="/"?s.pathname=`_root.${t}`:e&&ni(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function qT(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function WT(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function GT(n,e,t){let s=await Promise.all(n.map(async r=>{let i=e.routes[r.route.id];if(i){let o=await qT(i,t);return o.links?o.links():[]}return[]}));return QT(s.flat(1).filter(WT).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function Nv(n,e,t,s,r,i){let o=(d,h)=>t[h]?d.route.id!==t[h].route.id:!0,u=(d,h)=>t[h].pathname!==d.pathname||t[h].route.path?.endsWith("*")&&t[h].params["*"]!==d.params["*"];return i==="assets"?e.filter((d,h)=>o(d,h)||u(d,h)):i==="data"?e.filter((d,h)=>{let p=s.routes[d.route.id];if(!p||!p.hasLoader)return!1;if(o(d,h)||u(d,h))return!0;if(d.route.shouldRevalidate){let m=d.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function KT(n,e,{includeHydrateFallback:t}={}){return YT(n.map(s=>{let r=e.routes[s.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function YT(n){return[...new Set(n)]}function XT(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function QT(n,e){let t=new Set;return new Set(e),n.reduce((s,r)=>{let i=JSON.stringify(XT(r));return t.has(i)||(t.add(i),s.push({key:i,link:r})),s},[])}function dk(){let n=F.useContext(Hl);return C0(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function JT(){let n=F.useContext(Mf);return C0(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var I0=F.createContext(void 0);I0.displayName="FrameworkContext";function hk(){let n=F.useContext(I0);return C0(n,"You must render this element inside a <HydratedRouter> element"),n}function ZT(n,e){let t=F.useContext(I0),[s,r]=F.useState(!1),[i,o]=F.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:h,onMouseLeave:p,onTouchStart:m}=e,x=F.useRef(null);F.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let E=A=>{A.forEach(T=>{o(T.isIntersecting)})},N=new IntersectionObserver(E,{threshold:.5});return x.current&&N.observe(x.current),()=>{N.disconnect()}}},[n]),F.useEffect(()=>{if(s){let E=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(E)}}},[s]);let v=()=>{r(!0)},w=()=>{r(!1),o(!1)};return t?n!=="intent"?[i,x,{}]:[i,x,{onFocus:Kc(u,v),onBlur:Kc(d,w),onMouseEnter:Kc(h,v),onMouseLeave:Kc(p,w),onTouchStart:Kc(m,v)}]:[!1,x,{}]}function Kc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function eC({page:n,...e}){let{router:t}=dk(),s=F.useMemo(()=>Y_(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?F.createElement(sC,{page:n,matches:s,...e}):null}function tC(n){let{manifest:e,routeModules:t}=hk(),[s,r]=F.useState([]);return F.useEffect(()=>{let i=!1;return GT(n,e,t).then(o=>{i||r(o)}),()=>{i=!0}},[n,e,t]),s}function sC({page:n,matches:e,...t}){let s=po(),{manifest:r,routeModules:i}=hk(),{basename:o}=dk(),{loaderData:u,matches:d}=JT(),h=F.useMemo(()=>Nv(n,e,d,r,s,"data"),[n,e,d,r,s]),p=F.useMemo(()=>Nv(n,e,d,r,s,"assets"),[n,e,d,r,s]),m=F.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let w=new Set,E=!1;if(e.forEach(A=>{let T=r.routes[A.route.id];!T||!T.hasLoader||(!h.some(I=>I.route.id===A.route.id)&&A.route.id in u&&i[A.route.id]?.shouldRevalidate||T.hasClientLoader?E=!0:w.add(A.route.id))}),w.size===0)return[];let N=HT(n,o,"data");return E&&w.size>0&&N.searchParams.set("_routes",e.filter(A=>w.has(A.route.id)).map(A=>A.route.id).join(",")),[N.pathname+N.search]},[o,u,s,r,h,e,n,i]),x=F.useMemo(()=>KT(p,r),[p,r]),v=tC(p);return F.createElement(F.Fragment,null,m.map(w=>F.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),x.map(w=>F.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),v.map(({key:w,link:E})=>F.createElement("link",{key:w,nonce:t.nonce,...E})))}function nC(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var rC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{rC&&(window.__reactRouterVersion="7.11.0")}catch{}function iC({basename:n,children:e,unstable_useTransitions:t,window:s}){let r=F.useRef();r.current==null&&(r.current=VS({window:s,v5Compat:!0}));let i=r.current,[o,u]=F.useState({action:i.action,location:i.location}),d=F.useCallback(h=>{t===!1?u(h):F.startTransition(()=>u(h))},[t]);return F.useLayoutEffect(()=>i.listen(d),[i,d]),F.createElement(DT,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:t})}var fk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Cs=F.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:r,reloadDocument:i,replace:o,state:u,target:d,to:h,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:x,...v},w){let{basename:E,unstable_useTransitions:N}=F.useContext(jn),A=typeof h=="string"&&fk.test(h),T=sk(h,E);h=T.to;let I=bT(h,{relative:r}),[P,U,O]=ZT(s,v),R=cC(h,{replace:o,state:u,target:d,preventScrollReset:p,relative:r,viewTransition:m,unstable_defaultShouldRevalidate:x,unstable_useTransitions:N});function C(B){e&&e(B),B.defaultPrevented||R(B)}let D=F.createElement("a",{...v,...O,href:T.absoluteURL||I,onClick:T.isExternal||i?e:C,ref:nC(w,U),target:d,"data-discover":!A&&t==="render"?"true":void 0});return P&&!A?F.createElement(F.Fragment,null,D,F.createElement(eC,{page:I})):D});Cs.displayName="Link";var aC=F.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:r=!1,style:i,to:o,viewTransition:u,children:d,...h},p){let m=Fu(o,{relative:h.relative}),x=po(),v=F.useContext(Mf),{navigator:w,basename:E}=F.useContext(jn),N=v!=null&&pC(m)&&u===!0,A=w.encodeLocation?w.encodeLocation(m).pathname:m.pathname,T=x.pathname,I=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(T=T.toLowerCase(),I=I?I.toLowerCase():null,A=A.toLowerCase()),I&&E&&(I=ni(I,E)||I);const P=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let U=T===A||!r&&T.startsWith(A)&&T.charAt(P)==="/",O=I!=null&&(I===A||!r&&I.startsWith(A)&&I.charAt(A.length)==="/"),R={isActive:U,isPending:O,isTransitioning:N},C=U?e:void 0,D;typeof s=="function"?D=s(R):D=[s,U?"active":null,O?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let B=typeof i=="function"?i(R):i;return F.createElement(Cs,{...h,"aria-current":C,className:D,ref:p,style:B,to:o,viewTransition:u},typeof d=="function"?d(R):d)});aC.displayName="NavLink";var oC=F.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:r,state:i,method:o=Wh,action:u,onSubmit:d,relative:h,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:x,...v},w)=>{let{unstable_useTransitions:E}=F.useContext(jn),N=hC(),A=fC(u,{relative:h}),T=o.toLowerCase()==="get"?"get":"post",I=typeof u=="string"&&fk.test(u),P=U=>{if(d&&d(U),U.defaultPrevented)return;U.preventDefault();let O=U.nativeEvent.submitter,R=O?.getAttribute("formmethod")||o,C=()=>N(O||U.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:r,state:i,relative:h,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:x});E&&t!==!1?F.startTransition(()=>C()):C()};return F.createElement("form",{ref:w,method:T,action:A,onSubmit:s?d:P,...v,"data-discover":!I&&n==="render"?"true":void 0})});oC.displayName="Form";function lC(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pk(n){let e=F.useContext(Hl);return Et(e,lC(n)),e}function cC(n,{target:e,replace:t,state:s,preventScrollReset:r,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let h=ql(),p=po(),m=Fu(n,{relative:i});return F.useCallback(x=>{if(UT(x,e)){x.preventDefault();let v=t!==void 0?t:xu(p)===xu(m),w=()=>h(n,{replace:v,state:s,preventScrollReset:r,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:u});d?F.startTransition(()=>w()):w()}},[p,h,m,t,s,e,n,r,i,o,u,d])}var uC=0,dC=()=>`__${String(++uC)}__`;function hC(){let{router:n}=pk("useSubmit"),{basename:e}=F.useContext(jn),t=IT(),s=n.fetch,r=n.navigate;return F.useCallback(async(i,o={})=>{let{action:u,method:d,encType:h,formData:p,body:m}=$T(i,e);if(o.navigate===!1){let x=o.fetcherKey||dC();await s(x,t,o.action||u,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:p,body:m,formMethod:o.method||d,formEncType:o.encType||h,flushSync:o.flushSync})}else await r(o.action||u,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:p,body:m,formMethod:o.method||d,formEncType:o.encType||h,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[s,r,e,t])}function fC(n,{relative:e}={}){let{basename:t}=F.useContext(jn),s=F.useContext(hi);Et(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),i={...Fu(n||".",{relative:e})},o=po();if(n==null){i.search=o.search;let u=new URLSearchParams(i.search),d=u.getAll("index");if(d.some(p=>p==="")){u.delete("index"),d.filter(m=>m).forEach(m=>u.append("index",m));let p=u.toString();i.search=p?`?${p}`:""}}return(!n||n===".")&&r.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:ei([t,i.pathname])),xu(i)}function pC(n,{relative:e}={}){let t=F.useContext(rk);Et(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=pk("useViewTransitionState"),r=Fu(n,{relative:e});if(!t.isTransitioning)return!1;let i=ni(t.currentLocation.pathname,s)||t.currentLocation.pathname,o=ni(t.nextLocation.pathname,s)||t.nextLocation.pathname;return af(r.pathname,o)!=null||af(r.pathname,i)!=null}const mk=F.createContext(void 0);function mC({children:n}){const[e,t]=F.useState(()=>{const r=localStorage.getItem("theme");return r==="dark"||r===null});F.useEffect(()=>{e?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")},[e]);const s=()=>{t(!e)};return l.jsx(mk.Provider,{value:{isDark:e,toggleTheme:s},children:l.jsx("div",{className:e?"dark":"",children:n})})}function Vu(){const n=F.useContext(mk);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n}const gC=()=>{};var Av={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},yC=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],o=n[t++],u=n[t++],d=((r&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536;e[s++]=String.fromCharCode(55296+(d>>10)),e[s++]=String.fromCharCode(56320+(d&1023))}else{const i=n[t++],o=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},yk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],o=r+1<n.length,u=o?n[r+1]:0,d=r+2<n.length,h=d?n[r+2]:0,p=i>>2,m=(i&3)<<4|u>>4;let x=(u&15)<<2|h>>6,v=h&63;d||(v=64,o||(x=64)),s.push(t[p],t[m],t[x],t[v])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(gk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],u=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const m=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||u==null||h==null||m==null)throw new xC;const x=i<<2|u>>4;if(s.push(x),h!==64){const v=u<<4&240|h>>2;if(s.push(v),m!==64){const w=h<<6&192|m;s.push(w)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class xC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bC=function(n){const e=gk(n);return yk.encodeByteArray(e,!0)},of=function(n){return bC(n).replace(/\./g,"")},xk=function(n){try{return yk.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC=()=>vC().__FIREBASE_DEFAULTS__,_C=()=>{if(typeof process>"u"||typeof Av>"u")return;const n=Av.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},kC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&xk(n[1]);return e&&JSON.parse(e)},Of=()=>{try{return gC()||wC()||_C()||kC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bk=n=>Of()?.emulatorHosts?.[n],P0=n=>{const e=bk(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},vk=()=>Of()?.config,wk=n=>Of()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ff(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[of(JSON.stringify(t)),of(JSON.stringify(o)),""].join(".")}const uu={};function NC(){const n={prod:[],emulator:[]};for(const e of Object.keys(uu))uu[e]?n.emulator.push(e):n.prod.push(e);return n}function AC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Sv=!1;function Vf(n,e){if(typeof window>"u"||typeof document>"u"||!Ir(window.location.host)||uu[n]===e||uu[n]||Sv)return;uu[n]=e;function t(x){return`__firebase__banner__${x}`}const s="__firebase__banner",i=NC().prod.length>0;function o(){const x=document.getElementById(s);x&&x.remove()}function u(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function d(x,v){x.setAttribute("width","24"),x.setAttribute("id",v),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function h(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Sv=!0,o()},x}function p(x,v){x.setAttribute("id",v),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function m(){const x=AC(s),v=t("text"),w=document.getElementById(v)||document.createElement("span"),E=t("learnmore"),N=document.getElementById(E)||document.createElement("a"),A=t("preprendIcon"),T=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const I=x.element;u(I),p(N,E);const P=h();d(T,A),I.append(T,w,N,P),document.body.appendChild(I)}i?(w.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function SC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ps())}function TC(){const n=Of()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function CC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IC(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function PC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jC(){const n=Ps();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function RC(){return!TC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function DC(){try{return typeof indexedDB=="object"}catch{return!1}}function MC(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC="FirebaseError";class Qn extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=LC,Object.setPrototypeOf(this,Qn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Uu.prototype.create)}}class Uu{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?OC(i,s):"Error",u=`${this.serviceName}: ${o} (${r}).`;return new Qn(r,u,s)}}function OC(n,e){return n.replace(FC,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const FC=/\{\$([^}]+)}/g;function VC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function io(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],o=e[r];if(Tv(i)&&Tv(o)){if(!io(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function Tv(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bu(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function su(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function nu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function UC(n,e){const t=new BC(n,e);return t.subscribe.bind(t)}class BC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let r;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");zC(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:s},r.next===void 0&&(r.next=Jm),r.error===void 0&&(r.error=Jm),r.complete===void 0&&(r.complete=Jm);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zC(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Jm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(n){return n&&n._delegate?n._delegate:n}class ri{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new EC;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qC(e))try{this.getOrInitializeService({instanceIdentifier:Za})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Za){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Za){return this.instances.has(e)}getOptions(e=Za){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);s===u&&o.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:HC(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Za){return this.component?this.component.multipleInstances?e:Za:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HC(n){return n===Za?void 0:n}function qC(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new $C(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ye||(Ye={}));const GC={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},KC=Ye.INFO,YC={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},XC=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=YC[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class j0{constructor(e){this.name=e,this._logLevel=KC,this._logHandler=XC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const QC=(n,e)=>e.some(t=>n instanceof t);let Cv,Iv;function JC(){return Cv||(Cv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZC(){return Iv||(Iv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kk=new WeakMap,Sg=new WeakMap,Ek=new WeakMap,Zm=new WeakMap,R0=new WeakMap;function e2(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(ta(n.result)),r()},o=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&kk.set(t,n)}).catch(()=>{}),R0.set(e,n),e}function t2(n){if(Sg.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Sg.set(n,e)}let Tg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Sg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ek.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ta(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function s2(n){Tg=n(Tg)}function n2(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(eg(this),e,...t);return Ek.set(s,e.sort?e.sort():[e]),ta(s)}:ZC().includes(n)?function(...e){return n.apply(eg(this),e),ta(kk.get(this))}:function(...e){return ta(n.apply(eg(this),e))}}function r2(n){return typeof n=="function"?n2(n):(n instanceof IDBTransaction&&t2(n),QC(n,JC())?new Proxy(n,Tg):n)}function ta(n){if(n instanceof IDBRequest)return e2(n);if(Zm.has(n))return Zm.get(n);const e=r2(n);return e!==n&&(Zm.set(n,e),R0.set(e,n)),e}const eg=n=>R0.get(n);function i2(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(n,e),u=ta(o);return s&&o.addEventListener("upgradeneeded",d=>{s(ta(o.result),d.oldVersion,d.newVersion,ta(o.transaction),d)}),t&&o.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),u.then(d=>{i&&d.addEventListener("close",()=>i()),r&&d.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),u}const a2=["get","getKey","getAll","getAllKeys","count"],o2=["put","add","delete","clear"],tg=new Map;function Pv(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(tg.get(e))return tg.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=o2.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||a2.includes(t)))return;const i=async function(o,...u){const d=this.transaction(o,r?"readwrite":"readonly");let h=d.store;return s&&(h=h.index(u.shift())),(await Promise.all([h[t](...u),r&&d.done]))[0]};return tg.set(e,i),i}s2(n=>({...n,get:(e,t,s)=>Pv(e,t)||n.get(e,t,s),has:(e,t)=>!!Pv(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(c2(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function c2(n){return n.getComponent()?.type==="VERSION"}const Cg="@firebase/app",jv="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii=new j0("@firebase/app"),u2="@firebase/app-compat",d2="@firebase/analytics-compat",h2="@firebase/analytics",f2="@firebase/app-check-compat",p2="@firebase/app-check",m2="@firebase/auth",g2="@firebase/auth-compat",y2="@firebase/database",x2="@firebase/data-connect",b2="@firebase/database-compat",v2="@firebase/functions",w2="@firebase/functions-compat",_2="@firebase/installations",k2="@firebase/installations-compat",E2="@firebase/messaging",N2="@firebase/messaging-compat",A2="@firebase/performance",S2="@firebase/performance-compat",T2="@firebase/remote-config",C2="@firebase/remote-config-compat",I2="@firebase/storage",P2="@firebase/storage-compat",j2="@firebase/firestore",R2="@firebase/ai",D2="@firebase/firestore-compat",M2="firebase",L2="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig="[DEFAULT]",O2={[Cg]:"fire-core",[u2]:"fire-core-compat",[h2]:"fire-analytics",[d2]:"fire-analytics-compat",[p2]:"fire-app-check",[f2]:"fire-app-check-compat",[m2]:"fire-auth",[g2]:"fire-auth-compat",[y2]:"fire-rtdb",[x2]:"fire-data-connect",[b2]:"fire-rtdb-compat",[v2]:"fire-fn",[w2]:"fire-fn-compat",[_2]:"fire-iid",[k2]:"fire-iid-compat",[E2]:"fire-fcm",[N2]:"fire-fcm-compat",[A2]:"fire-perf",[S2]:"fire-perf-compat",[T2]:"fire-rc",[C2]:"fire-rc-compat",[I2]:"fire-gcs",[P2]:"fire-gcs-compat",[j2]:"fire-fst",[D2]:"fire-fst-compat",[R2]:"fire-vertex","fire-js":"fire-js",[M2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf=new Map,F2=new Map,Pg=new Map;function Rv(n,e){try{n.container.addComponent(e)}catch(t){ii.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function aa(n){const e=n.name;if(Pg.has(e))return ii.debug(`There were multiple attempts to register component ${e}.`),!1;Pg.set(e,n);for(const t of lf.values())Rv(t,n);for(const t of F2.values())Rv(t,n);return!0}function zu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Xs(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},sa=new Uu("app","Firebase",V2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ri("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo=L2;function Nk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Ig,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw sa.create("bad-app-name",{appName:String(r)});if(t||(t=vk()),!t)throw sa.create("no-options");const i=lf.get(r);if(i){if(io(t,i.options)&&io(s,i.config))return i;throw sa.create("duplicate-app",{appName:r})}const o=new WC(r);for(const d of Pg.values())o.addComponent(d);const u=new U2(t,s,o);return lf.set(r,u),u}function Uf(n=Ig){const e=lf.get(n);if(!e&&n===Ig&&vk())return Nk();if(!e)throw sa.create("no-app",{appName:n});return e}function Cn(n,e,t){let s=O2[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ii.warn(o.join(" "));return}aa(new ri(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2="firebase-heartbeat-database",z2=1,bu="firebase-heartbeat-store";let sg=null;function Ak(){return sg||(sg=i2(B2,z2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(bu)}catch(t){console.warn(t)}}}}).catch(n=>{throw sa.create("idb-open",{originalErrorMessage:n.message})})),sg}async function $2(n){try{const t=(await Ak()).transaction(bu),s=await t.objectStore(bu).get(Sk(n));return await t.done,s}catch(e){if(e instanceof Qn)ii.warn(e.message);else{const t=sa.create("idb-get",{originalErrorMessage:e?.message});ii.warn(t.message)}}}async function Dv(n,e){try{const s=(await Ak()).transaction(bu,"readwrite");await s.objectStore(bu).put(e,Sk(n)),await s.done}catch(t){if(t instanceof Qn)ii.warn(t.message);else{const s=sa.create("idb-set",{originalErrorMessage:t?.message});ii.warn(s.message)}}}function Sk(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H2=1024,q2=30;class W2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new K2(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Mv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>q2){const r=Y2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ii.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Mv(),{heartbeatsToSend:t,unsentEntries:s}=G2(this._heartbeatsCache.heartbeats),r=of(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return ii.warn(e),""}}}function Mv(){return new Date().toISOString().substring(0,10)}function G2(n,e=H2){const t=[];let s=n.slice();for(const r of n){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Lv(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Lv(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class K2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return DC()?MC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await $2(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Dv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Dv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Lv(n){return of(JSON.stringify({version:2,heartbeats:n})).length}function Y2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X2(n){aa(new ri("platform-logger",e=>new l2(e),"PRIVATE")),aa(new ri("heartbeat",e=>new W2(e),"PRIVATE")),Cn(Cg,jv,n),Cn(Cg,jv,"esm2020"),Cn("fire-js","")}X2("");function Tk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Q2=Tk,Ck=new Uu("auth","Firebase",Tk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf=new j0("@firebase/auth");function J2(n,...e){cf.logLevel<=Ye.WARN&&cf.warn(`Auth (${mo}): ${n}`,...e)}function Kh(n,...e){cf.logLevel<=Ye.ERROR&&cf.error(`Auth (${mo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(n,...e){throw D0(n,...e)}function _r(n,...e){return D0(n,...e)}function Ik(n,e,t){const s={...Q2(),[e]:t};return new Uu("auth","Firebase",s).create(e,{appName:n.name})}function ti(n){return Ik(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function D0(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return Ck.create(n,...e)}function Le(n,e,...t){if(!n)throw D0(e,...t)}function Jr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Kh(e),new Error(e)}function ai(n,e){n||Jr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jg(){return typeof self<"u"&&self.location?.href||""}function Z2(){return Ov()==="http:"||Ov()==="https:"}function Ov(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Z2()||IC()||"connection"in navigator)?navigator.onLine:!0}function tI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,t){this.shortDelay=e,this.longDelay=t,ai(t>e,"Short delay should be less than long delay!"),this.isMobile=SC()||PC()}get(){return eI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0(n,e){ai(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Jr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Jr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Jr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rI=new $u(3e4,6e4);function ba(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function va(n,e,t,s,r={}){return jk(n,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const u=Bu({key:n.config.apiKey,...o}).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:d,...i};return CC()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Ir(n.emulatorConfig.host)&&(h.credentials="include"),Pk.fetch()(await Rk(n,n.config.apiHost,t,u),h)})}async function jk(n,e,t){n._canInitEmulator=!1;const s={...sI,...e};try{const r=new aI(n),i=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Nh(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const u=i.ok?o.errorMessage:o.error.message,[d,h]=u.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nh(n,"credential-already-in-use",o);if(d==="EMAIL_EXISTS")throw Nh(n,"email-already-in-use",o);if(d==="USER_DISABLED")throw Nh(n,"user-disabled",o);const p=s[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Ik(n,p,h);Kn(n,p)}}catch(r){if(r instanceof Qn)throw r;Kn(n,"network-request-failed",{message:String(r)})}}async function Hu(n,e,t,s,r={}){const i=await va(n,e,t,s,r);return"mfaPendingCredential"in i&&Kn(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Rk(n,e,t,s){const r=`${e}${t}?${s}`,i=n,o=i.config.emulator?M0(n.config,r):`${n.config.apiScheme}://${r}`;return nI.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function iI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class aI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(_r(this.auth,"network-request-failed")),rI.get())})}}function Nh(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const r=_r(n,e,s);return r.customData._tokenResponse=t,r}function Fv(n){return n!==void 0&&n.enterprise!==void 0}class oI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return iI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function lI(n,e){return va(n,"GET","/v2/recaptchaConfig",ba(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cI(n,e){return va(n,"POST","/v1/accounts:delete",e)}async function uf(n,e){return va(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uI(n,e=!1){const t=bt(n),s=await t.getIdToken(e),r=L0(s);Le(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i?.sign_in_provider;return{claims:r,token:s,authTime:du(ng(r.auth_time)),issuedAtTime:du(ng(r.iat)),expirationTime:du(ng(r.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function ng(n){return Number(n)*1e3}function L0(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Kh("JWT malformed, contained fewer than 3 sections"),null;try{const r=xk(t);return r?JSON.parse(r):(Kh("Failed to decode base64 JWT payload"),null)}catch(r){return Kh("Caught error parsing JWT payload as JSON",r?.toString()),null}}function Vv(n){const e=L0(n);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vu(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Qn&&dI(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function dI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=du(this.lastLoginAt),this.creationTime=du(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function df(n){const e=n.auth,t=await n.getIdToken(),s=await vu(n,uf(e,{idToken:t}));Le(s?.users.length,e,"internal-error");const r=s.users[0];n._notifyReloadListener(r);const i=r.providerUserInfo?.length?Dk(r.providerUserInfo):[],o=pI(n.providerData,i),u=n.isAnonymous,d=!(n.email&&r.passwordHash)&&!o?.length,h=u?d:!1,p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Rg(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,p)}async function fI(n){const e=bt(n);await df(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function pI(n,e){return[...n.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function Dk(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mI(n,e){const t=await jk(n,{},async()=>{const s=Bu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=n.config,o=await Rk(n,r,"/v1/token",`key=${i}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:u,body:s};return n.emulatorConfig&&Ir(n.emulatorConfig.host)&&(d.credentials="include"),Pk.fetch()(o,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function gI(n,e){return va(n,"POST","/v2/accounts:revokeToken",ba(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Vv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Le(e.length!==0,"internal-error");const t=Vv(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:r,expiresIn:i}=await mI(e,t);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:r,expirationTime:i}=t,o=new kl;return s&&(Le(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(Le(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(Le(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new kl,this.toJSON())}_performRefresh(){return Jr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(n,e){Le(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Hn{constructor({uid:e,auth:t,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new hI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Rg(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await vu(this,this.stsTokenManager.getToken(this.auth,e));return Le(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return uI(this,e)}reload(){return fI(this)}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Hn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await df(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xs(this.auth.app))return Promise.reject(ti(this.auth));const e=await this.getIdToken();return await vu(this,cI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,r=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,u=t.tenantId??void 0,d=t._redirectEventId??void 0,h=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:m,emailVerified:x,isAnonymous:v,providerData:w,stsTokenManager:E}=t;Le(m&&E,e,"internal-error");const N=kl.fromJSON(this.name,E);Le(typeof m=="string",e,"internal-error"),qi(s,e.name),qi(r,e.name),Le(typeof x=="boolean",e,"internal-error"),Le(typeof v=="boolean",e,"internal-error"),qi(i,e.name),qi(o,e.name),qi(u,e.name),qi(d,e.name),qi(h,e.name),qi(p,e.name);const A=new Hn({uid:m,auth:e,email:r,emailVerified:x,displayName:s,isAnonymous:v,photoURL:o,phoneNumber:i,tenantId:u,stsTokenManager:N,createdAt:h,lastLoginAt:p});return w&&Array.isArray(w)&&(A.providerData=w.map(T=>({...T}))),d&&(A._redirectEventId=d),A}static async _fromIdTokenResponse(e,t,s=!1){const r=new kl;r.updateFromServerResponse(t);const i=new Hn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await df(i),i}static async _fromGetAccountInfoResponse(e,t,s){const r=t.users[0];Le(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?Dk(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!i?.length,u=new kl;u.updateFromIdToken(s);const d=new Hn({uid:r.localId,auth:e,stsTokenManager:u,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Rg(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!i?.length};return Object.assign(d,h),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv=new Map;function Zr(n){ai(n instanceof Function,"Expected a class definition");let e=Uv.get(n);return e?(ai(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Uv.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Mk.type="NONE";const Bv=Mk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(n,e,t){return`firebase:${n}:${e}:${t}`}class El{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=Yh(this.userKey,r.apiKey,i),this.fullPersistenceKey=Yh("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await uf(this.auth,{idToken:e}).catch(()=>{});return t?Hn._fromGetAccountInfoResponse(this.auth,t,e):null}return Hn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new El(Zr(Bv),e,s);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=r[0]||Zr(Bv);const o=Yh(s,e.config.apiKey,e.name);let u=null;for(const h of t)try{const p=await h._get(o);if(p){let m;if(typeof p=="string"){const x=await uf(e,{idToken:p}).catch(()=>{});if(!x)break;m=await Hn._fromGetAccountInfoResponse(e,x,p)}else m=Hn._fromJSON(e,p);h!==i&&(u=m),i=h;break}}catch{}const d=r.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!d.length?new El(i,e,s):(i=d[0],u&&await i._set(o,u.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new El(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zv(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Vk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Lk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Bk(e))return"Blackberry";if(zk(e))return"Webos";if(Ok(e))return"Safari";if((e.includes("chrome/")||Fk(e))&&!e.includes("edge/"))return"Chrome";if(Uk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function Lk(n=Ps()){return/firefox\//i.test(n)}function Ok(n=Ps()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Fk(n=Ps()){return/crios\//i.test(n)}function Vk(n=Ps()){return/iemobile/i.test(n)}function Uk(n=Ps()){return/android/i.test(n)}function Bk(n=Ps()){return/blackberry/i.test(n)}function zk(n=Ps()){return/webos/i.test(n)}function O0(n=Ps()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function yI(n=Ps()){return O0(n)&&!!window.navigator?.standalone}function xI(){return jC()&&document.documentMode===10}function $k(n=Ps()){return O0(n)||Uk(n)||zk(n)||Bk(n)||/windows phone/i.test(n)||Vk(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hk(n,e=[]){let t;switch(n){case"Browser":t=zv(Ps());break;case"Worker":t=`${zv(Ps())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${mo}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=i=>new Promise((o,u)=>{try{const d=e(i);o(d)}catch(d){u(d)}});s.onAbort=t,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vI(n,e={}){return va(n,"GET","/v2/passwordPolicy",ba(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI=6;class _I{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??wI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e,t,s,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $v(this),this.idTokenSubscription=new $v(this),this.beforeStateQueue=new bI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ck,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await El.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await uf(this,{idToken:e}),s=await Hn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Xs(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=s?._redirectEventId,u=await this.tryRedirectSignIn(e);(!i||i===o)&&u?.user&&(s=u.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await df(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=tI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xs(this.app))return Promise.reject(ti(this));const t=e?bt(e):null;return t&&Le(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xs(this.app)?Promise.reject(ti(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xs(this.app)?Promise.reject(ti(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Zr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vI(this),t=new _I(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Uu("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await gI(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Zr(e)||this._popupRedirectResolver;Le(t,this,"argument-error"),this.redirectPersistenceManager=await El.create(this,[Zr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,r){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(u,this,"internal-error"),u.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,s,r);return()=>{o=!0,d()}}else{const d=e.addObserver(t);return()=>{o=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Hk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Xs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&J2(`Error while retrieving App Check token: ${e.error}`),e?.token}}function go(n){return bt(n)}class $v{constructor(e){this.auth=e,this.observer=null,this.addObserver=UC(t=>this.observer=t)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EI(n){Bf=n}function qk(n){return Bf.loadJS(n)}function NI(){return Bf.recaptchaEnterpriseScript}function AI(){return Bf.gapiScript}function SI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class TI{constructor(){this.enterprise=new CI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class CI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const II="recaptcha-enterprise",Wk="NO_RECAPTCHA";class PI{constructor(e){this.type=II,this.auth=go(e)}async verify(e="verify",t=!1){async function s(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,u)=>{lI(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const h=new oI(d);return i.tenantId==null?i._agentRecaptchaConfig=h:i._tenantRecaptchaConfigs[i.tenantId]=h,o(h.siteKey)}}).catch(d=>{u(d)})})}function r(i,o,u){const d=window.grecaptcha;Fv(d)?d.enterprise.ready(()=>{d.enterprise.execute(i,{action:e}).then(h=>{o(h)}).catch(()=>{o(Wk)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new TI().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{s(this.auth).then(u=>{if(!t&&Fv(window.grecaptcha))r(u,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let d=NI();d.length!==0&&(d+=u),qk(d).then(()=>{r(u,i,o)}).catch(h=>{o(h)})}}).catch(u=>{o(u)})})}}async function Hv(n,e,t,s=!1,r=!1){const i=new PI(n);let o;if(r)o=Wk;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const d=u.phoneEnrollmentInfo.phoneNumber,h=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const d=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return s?Object.assign(u,{captchaResp:o}):Object.assign(u,{captchaResponse:o}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function Dg(n,e,t,s,r){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Hv(n,e,t,t==="getOobCode");return s(n,i)}else return s(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Hv(n,e,t,t==="getOobCode");return s(n,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jI(n,e){const t=zu(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),i=t.getOptions();if(io(i,e??{}))return r;Kn(r,"already-initialized")}return t.initialize({options:e})}function RI(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(Zr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function DI(n,e,t){const s=go(n);Le(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=Gk(e),{host:o,port:u}=MI(e),d=u===null?"":`:${u}`,h={url:`${i}//${o}${d}/`},p=Object.freeze({host:o,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){Le(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Le(io(h,s.config.emulator)&&io(p,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=h,s.emulatorConfig=p,s.settings.appVerificationDisabledForTesting=!0,Ir(o)?(Ff(`${i}//${o}${d}`),Vf("Auth",!0)):LI()}function Gk(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function MI(n){const e=Gk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:qv(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:qv(o)}}}function qv(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function LI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Jr("not implemented")}_getIdTokenResponse(e){return Jr("not implemented")}_linkToIdToken(e,t){return Jr("not implemented")}_getReauthenticationResolver(e){return Jr("not implemented")}}async function OI(n,e){return va(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FI(n,e){return Hu(n,"POST","/v1/accounts:signInWithPassword",ba(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VI(n,e){return Hu(n,"POST","/v1/accounts:signInWithEmailLink",ba(n,e))}async function UI(n,e){return Hu(n,"POST","/v1/accounts:signInWithEmailLink",ba(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends F0{constructor(e,t,s,r=null){super("password",s),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new wu(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new wu(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dg(e,t,"signInWithPassword",FI);case"emailLink":return VI(e,{email:this._email,oobCode:this._password});default:Kn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dg(e,s,"signUpPassword",OI);case"emailLink":return UI(e,{idToken:t,email:this._email,oobCode:this._password});default:Kn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nl(n,e){return Hu(n,"POST","/v1/accounts:signInWithIdp",ba(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI="http://localhost";class ao extends F0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ao(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Kn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...i}=t;if(!s||!r)return null;const o=new ao(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Nl(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Nl(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Nl(e,t)}buildRequest(){const e={requestUri:BI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Bu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $I(n){const e=su(nu(n)).link,t=e?su(nu(e)).deep_link_id:null,s=su(nu(n)).deep_link_id;return(s?su(nu(s)).link:null)||s||t||e||n}class V0{constructor(e){const t=su(nu(e)),s=t.apiKey??null,r=t.oobCode??null,i=zI(t.mode??null);Le(s&&r&&i,"argument-error"),this.apiKey=s,this.operation=i,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=$I(e);try{return new V0(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(){this.providerId=Wl.PROVIDER_ID}static credential(e,t){return wu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=V0.parseLink(t);return Le(s,"argument-error"),wu._fromEmailAndCode(e,s.code,s.tenantId)}}Wl.PROVIDER_ID="password";Wl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Wl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu extends Kk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends qu{constructor(){super("facebook.com")}static credential(e){return ao._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gi.credential(e.oauthAccessToken)}catch{return null}}}Gi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki extends qu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ao._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Ki.credential(t,s)}catch{return null}}}Ki.GOOGLE_SIGN_IN_METHOD="google.com";Ki.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends qu{constructor(){super("github.com")}static credential(e){return ao._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yi.credential(e.oauthAccessToken)}catch{return null}}}Yi.GITHUB_SIGN_IN_METHOD="github.com";Yi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends qu{constructor(){super("twitter.com")}static credential(e,t){return ao._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Xi.credential(t,s)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HI(n,e){return Hu(n,"POST","/v1/accounts:signUp",ba(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,r=!1){const i=await Hn._fromIdTokenResponse(e,s,r),o=Wv(s);return new oo({user:i,providerId:o,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const r=Wv(s);return new oo({user:e,providerId:r,_tokenResponse:s,operationType:t})}}function Wv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf extends Qn{constructor(e,t,s,r){super(t.code,t.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,hf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,r){return new hf(e,t,s,r)}}function Yk(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?hf._fromErrorAndOperation(n,i,e,s):i})}async function qI(n,e,t=!1){const s=await vu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return oo._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WI(n,e,t=!1){const{auth:s}=n;if(Xs(s.app))return Promise.reject(ti(s));const r="reauthenticate";try{const i=await vu(n,Yk(s,r,e,n),t);Le(i.idToken,s,"internal-error");const o=L0(i.idToken);Le(o,s,"internal-error");const{sub:u}=o;return Le(n.uid===u,s,"user-mismatch"),oo._forOperation(n,r,i)}catch(i){throw i?.code==="auth/user-not-found"&&Kn(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xk(n,e,t=!1){if(Xs(n.app))return Promise.reject(ti(n));const s="signIn",r=await Yk(n,s,e),i=await oo._fromIdTokenResponse(n,s,r);return t||await n._updateCurrentUser(i.user),i}async function GI(n,e){return Xk(go(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qk(n){const e=go(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function KI(n,e,t){if(Xs(n.app))return Promise.reject(ti(n));const s=go(n),o=await Dg(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",HI).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&Qk(n),d}),u=await oo._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(u.user),u}function YI(n,e,t){return Xs(n.app)?Promise.reject(ti(n)):GI(bt(n),Wl.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&Qk(n),s})}function XI(n,e,t,s){return bt(n).onIdTokenChanged(e,t,s)}function QI(n,e,t){return bt(n).beforeAuthStateChanged(e,t)}function JI(n,e,t,s){return bt(n).onAuthStateChanged(e,t,s)}function ZI(n){return bt(n).signOut()}const ff="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ff,"1"),this.storage.removeItem(ff),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP=1e3,tP=10;class Zk extends Jk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$k(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),r=this.localCache[t];s!==r&&e(t,r,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,u,d)=>{this.notifyListeners(o,d)});return}const s=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!t&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);xI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,tP):r()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},eP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Zk.type="LOCAL";const sP=Zk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1 extends Jk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}e1.type="SESSION";const t1=e1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const s=new zf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const u=Array.from(o).map(async h=>h(t.origin,i)),d=await nP(u);t.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}zf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((u,d)=>{const h=U0("",20);r.port1.start();const p=setTimeout(()=>{d(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(m){const x=m;if(x.data.eventId===h)switch(x.data.status){case"ack":clearTimeout(p),i=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),u(x.data.response);break;default:clearTimeout(p),clearTimeout(i),d(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(){return window}function iP(n){kr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s1(){return typeof kr().WorkerGlobalScope<"u"&&typeof kr().importScripts=="function"}async function aP(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function oP(){return navigator?.serviceWorker?.controller||null}function lP(){return s1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n1="firebaseLocalStorageDb",cP=1,pf="firebaseLocalStorage",r1="fbase_key";class Wu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $f(n,e){return n.transaction([pf],e?"readwrite":"readonly").objectStore(pf)}function uP(){const n=indexedDB.deleteDatabase(n1);return new Wu(n).toPromise()}function Mg(){const n=indexedDB.open(n1,cP);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(pf,{keyPath:r1})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(pf)?e(s):(s.close(),await uP(),e(await Mg()))})})}async function Gv(n,e,t){const s=$f(n,!0).put({[r1]:e,value:t});return new Wu(s).toPromise()}async function dP(n,e){const t=$f(n,!1).get(e),s=await new Wu(t).toPromise();return s===void 0?null:s.value}function Kv(n,e){const t=$f(n,!0).delete(e);return new Wu(t).toPromise()}const hP=800,fP=3;class i1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>fP)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return s1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=zf._getInstance(lP()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await aP(),!this.activeServiceWorker)return;this.sender=new rP(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||oP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mg();return await Gv(e,ff,"1"),await Kv(e,ff),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Gv(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>dP(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Kv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=$f(r,!1).getAll();return new Wu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),hP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}i1.type="LOCAL";const pP=i1;new $u(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mP(n,e){return e?Zr(e):(Le(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0 extends F0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Nl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Nl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Nl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function gP(n){return Xk(n.auth,new B0(n),n.bypassAuthState)}function yP(n){const{auth:e,user:t}=n;return Le(t,e,"internal-error"),WI(t,new B0(n),n.bypassAuthState)}async function xP(n){const{auth:e,user:t}=n;return Le(t,e,"internal-error"),qI(t,new B0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(e,t,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:r,tenantId:i,error:o,type:u}=e;if(o){this.reject(o);return}const d={auth:this.auth,requestUri:t,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(d))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return gP;case"linkViaPopup":case"linkViaRedirect":return xP;case"reauthViaPopup":case"reauthViaRedirect":return yP;default:Kn(this.auth,"internal-error")}}resolve(e){ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bP=new $u(2e3,1e4);class xl extends a1{constructor(e,t,s,r,i){super(e,t,r,i),this.provider=s,this.authWindow=null,this.pollId=null,xl.currentPopupAction&&xl.currentPopupAction.cancel(),xl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Le(e,this.auth,"internal-error"),e}async onExecution(){ai(this.filter.length===1,"Popup operations only handle one event");const e=U0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_r(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(_r(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_r(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,bP.get())};e()}}xl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vP="pendingRedirect",Xh=new Map;class wP extends a1{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Xh.get(this.auth._key());if(!e){try{const s=await _P(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Xh.set(this.auth._key(),e)}return this.bypassAuthState||Xh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _P(n,e){const t=NP(e),s=EP(n);if(!await s._isAvailable())return!1;const r=await s._get(t)==="true";return await s._remove(t),r}function kP(n,e){Xh.set(n._key(),e)}function EP(n){return Zr(n._redirectPersistence)}function NP(n){return Yh(vP,n.config.apiKey,n.name)}async function AP(n,e,t=!1){if(Xs(n.app))return Promise.reject(ti(n));const s=go(n),r=mP(s,e),o=await new wP(s,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SP=600*1e3;class TP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!CP(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!o1(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(_r(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=SP&&this.cachedEventUids.clear(),this.cachedEventUids.has(Yv(e))}saveEventToCache(e){this.cachedEventUids.add(Yv(e)),this.lastProcessedEventTime=Date.now()}}function Yv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function o1({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function CP(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return o1(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IP(n,e={}){return va(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,jP=/^https?/;async function RP(n){if(n.config.emulator)return;const{authorizedDomains:e}=await IP(n);for(const t of e)try{if(DP(t))return}catch{}Kn(n,"unauthorized-domain")}function DP(n){const e=jg(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===s}if(!jP.test(t))return!1;if(PP.test(n))return s===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=new $u(3e4,6e4);function Xv(){const n=kr().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function LP(n){return new Promise((e,t)=>{function s(){Xv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Xv(),t(_r(n,"network-request-failed"))},timeout:MP.get()})}if(kr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(kr().gapi?.load)s();else{const r=SI("iframefcb");return kr()[r]=()=>{gapi.load?s():t(_r(n,"network-request-failed"))},qk(`${AI()}?onload=${r}`).catch(i=>t(i))}}).catch(e=>{throw Qh=null,e})}let Qh=null;function OP(n){return Qh=Qh||LP(n),Qh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP=new $u(5e3,15e3),VP="__/auth/iframe",UP="emulator/auth/iframe",BP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $P(n){const e=n.config;Le(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?M0(e,UP):`https://${n.config.authDomain}/${VP}`,s={apiKey:e.apiKey,appName:n.name,v:mo},r=zP.get(n.config.apiHost);r&&(s.eid=r);const i=n._getFrameworks();return i.length&&(s.fw=i.join(",")),`${t}?${Bu(s).slice(1)}`}async function HP(n){const e=await OP(n),t=kr().gapi;return Le(t,n,"internal-error"),e.open({where:document.body,url:$P(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:BP,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=_r(n,"network-request-failed"),u=kr().setTimeout(()=>{i(o)},FP.get());function d(){kr().clearTimeout(u),r(s)}s.ping(d).then(d,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},WP=500,GP=600,KP="_blank",YP="http://localhost";class Qv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function XP(n,e,t,s=WP,r=GP){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let u="";const d={...qP,width:s.toString(),height:r.toString(),top:i,left:o},h=Ps().toLowerCase();t&&(u=Fk(h)?KP:t),Lk(h)&&(e=e||YP,d.scrollbars="yes");const p=Object.entries(d).reduce((x,[v,w])=>`${x}${v}=${w},`,"");if(yI(h)&&u!=="_self")return QP(e||"",u),new Qv(null);const m=window.open(e||"",u,p);Le(m,n,"popup-blocked");try{m.focus()}catch{}return new Qv(m)}function QP(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP="__/auth/handler",ZP="emulator/auth/handler",ej=encodeURIComponent("fac");async function Jv(n,e,t,s,r,i){Le(n.config.authDomain,n,"auth-domain-config-required"),Le(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:mo,eventId:r};if(e instanceof Kk){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",VC(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))o[p]=m}if(e instanceof qu){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(o.scopes=p.join(","))}n.tenantId&&(o.tid=n.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const d=await n._getAppCheckToken(),h=d?`#${ej}=${encodeURIComponent(d)}`:"";return`${tj(n)}?${Bu(u).slice(1)}${h}`}function tj({config:n}){return n.emulator?M0(n,ZP):`https://${n.authDomain}/${JP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rg="webStorageSupport";class sj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=t1,this._completeRedirectFn=AP,this._overrideRedirectResult=kP}async _openPopup(e,t,s,r){ai(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Jv(e,t,s,jg(),r);return XP(e,i,U0())}async _openRedirect(e,t,s,r){await this._originValidation(e);const i=await Jv(e,t,s,jg(),r);return iP(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:i}=this.eventManagers[t];return r?Promise.resolve(r):(ai(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await HP(e),s=new TP(e);return t.register("authEvent",r=>(Le(r?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(rg,{type:rg},r=>{const i=r?.[0]?.[rg];i!==void 0&&t(!!i),Kn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=RP(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return $k()||Ok()||O0()}}const nj=sj;var Zv="@firebase/auth",ew="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ij(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aj(n){aa(new ri("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=s.options;Le(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const d={apiKey:o,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hk(n)},h=new kI(s,r,i,d);return RI(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),aa(new ri("auth-internal",e=>{const t=go(e.getProvider("auth").getImmediate());return(s=>new rj(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Cn(Zv,ew,ij(n)),Cn(Zv,ew,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oj=300,lj=wk("authIdTokenMaxAge")||oj;let tw=null;const cj=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>lj)return;const r=t?.token;tw!==r&&(tw=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function uj(n=Uf()){const e=zu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=jI(n,{popupRedirectResolver:nj,persistence:[pP,sP,t1]}),s=wk("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=cj(i.toString());QI(t,o,()=>o(t.currentUser)),XI(t,u=>o(u))}}const r=bk("auth");return r&&DI(t,`http://${r}`),t}function dj(){return document.getElementsByTagName("head")?.[0]??document}EI({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=r=>{const i=_r("internal-error");i.customData=r,t(i)},s.type="text/javascript",s.charset="UTF-8",dj().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aj("Browser");var hj="firebase",fj="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cn(hj,fj,"app");var sw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var na,l1;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,C){function D(){}D.prototype=C.prototype,R.F=C.prototype,R.prototype=new D,R.prototype.constructor=R,R.D=function(B,V,$){for(var L=Array(arguments.length-2),de=2;de<arguments.length;de++)L[de-2]=arguments[de];return C.prototype[V].apply(B,L)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(R,C,D){D||(D=0);const B=Array(16);if(typeof C=="string")for(var V=0;V<16;++V)B[V]=C.charCodeAt(D++)|C.charCodeAt(D++)<<8|C.charCodeAt(D++)<<16|C.charCodeAt(D++)<<24;else for(V=0;V<16;++V)B[V]=C[D++]|C[D++]<<8|C[D++]<<16|C[D++]<<24;C=R.g[0],D=R.g[1],V=R.g[2];let $=R.g[3],L;L=C+($^D&(V^$))+B[0]+3614090360&4294967295,C=D+(L<<7&4294967295|L>>>25),L=$+(V^C&(D^V))+B[1]+3905402710&4294967295,$=C+(L<<12&4294967295|L>>>20),L=V+(D^$&(C^D))+B[2]+606105819&4294967295,V=$+(L<<17&4294967295|L>>>15),L=D+(C^V&($^C))+B[3]+3250441966&4294967295,D=V+(L<<22&4294967295|L>>>10),L=C+($^D&(V^$))+B[4]+4118548399&4294967295,C=D+(L<<7&4294967295|L>>>25),L=$+(V^C&(D^V))+B[5]+1200080426&4294967295,$=C+(L<<12&4294967295|L>>>20),L=V+(D^$&(C^D))+B[6]+2821735955&4294967295,V=$+(L<<17&4294967295|L>>>15),L=D+(C^V&($^C))+B[7]+4249261313&4294967295,D=V+(L<<22&4294967295|L>>>10),L=C+($^D&(V^$))+B[8]+1770035416&4294967295,C=D+(L<<7&4294967295|L>>>25),L=$+(V^C&(D^V))+B[9]+2336552879&4294967295,$=C+(L<<12&4294967295|L>>>20),L=V+(D^$&(C^D))+B[10]+4294925233&4294967295,V=$+(L<<17&4294967295|L>>>15),L=D+(C^V&($^C))+B[11]+2304563134&4294967295,D=V+(L<<22&4294967295|L>>>10),L=C+($^D&(V^$))+B[12]+1804603682&4294967295,C=D+(L<<7&4294967295|L>>>25),L=$+(V^C&(D^V))+B[13]+4254626195&4294967295,$=C+(L<<12&4294967295|L>>>20),L=V+(D^$&(C^D))+B[14]+2792965006&4294967295,V=$+(L<<17&4294967295|L>>>15),L=D+(C^V&($^C))+B[15]+1236535329&4294967295,D=V+(L<<22&4294967295|L>>>10),L=C+(V^$&(D^V))+B[1]+4129170786&4294967295,C=D+(L<<5&4294967295|L>>>27),L=$+(D^V&(C^D))+B[6]+3225465664&4294967295,$=C+(L<<9&4294967295|L>>>23),L=V+(C^D&($^C))+B[11]+643717713&4294967295,V=$+(L<<14&4294967295|L>>>18),L=D+($^C&(V^$))+B[0]+3921069994&4294967295,D=V+(L<<20&4294967295|L>>>12),L=C+(V^$&(D^V))+B[5]+3593408605&4294967295,C=D+(L<<5&4294967295|L>>>27),L=$+(D^V&(C^D))+B[10]+38016083&4294967295,$=C+(L<<9&4294967295|L>>>23),L=V+(C^D&($^C))+B[15]+3634488961&4294967295,V=$+(L<<14&4294967295|L>>>18),L=D+($^C&(V^$))+B[4]+3889429448&4294967295,D=V+(L<<20&4294967295|L>>>12),L=C+(V^$&(D^V))+B[9]+568446438&4294967295,C=D+(L<<5&4294967295|L>>>27),L=$+(D^V&(C^D))+B[14]+3275163606&4294967295,$=C+(L<<9&4294967295|L>>>23),L=V+(C^D&($^C))+B[3]+4107603335&4294967295,V=$+(L<<14&4294967295|L>>>18),L=D+($^C&(V^$))+B[8]+1163531501&4294967295,D=V+(L<<20&4294967295|L>>>12),L=C+(V^$&(D^V))+B[13]+2850285829&4294967295,C=D+(L<<5&4294967295|L>>>27),L=$+(D^V&(C^D))+B[2]+4243563512&4294967295,$=C+(L<<9&4294967295|L>>>23),L=V+(C^D&($^C))+B[7]+1735328473&4294967295,V=$+(L<<14&4294967295|L>>>18),L=D+($^C&(V^$))+B[12]+2368359562&4294967295,D=V+(L<<20&4294967295|L>>>12),L=C+(D^V^$)+B[5]+4294588738&4294967295,C=D+(L<<4&4294967295|L>>>28),L=$+(C^D^V)+B[8]+2272392833&4294967295,$=C+(L<<11&4294967295|L>>>21),L=V+($^C^D)+B[11]+1839030562&4294967295,V=$+(L<<16&4294967295|L>>>16),L=D+(V^$^C)+B[14]+4259657740&4294967295,D=V+(L<<23&4294967295|L>>>9),L=C+(D^V^$)+B[1]+2763975236&4294967295,C=D+(L<<4&4294967295|L>>>28),L=$+(C^D^V)+B[4]+1272893353&4294967295,$=C+(L<<11&4294967295|L>>>21),L=V+($^C^D)+B[7]+4139469664&4294967295,V=$+(L<<16&4294967295|L>>>16),L=D+(V^$^C)+B[10]+3200236656&4294967295,D=V+(L<<23&4294967295|L>>>9),L=C+(D^V^$)+B[13]+681279174&4294967295,C=D+(L<<4&4294967295|L>>>28),L=$+(C^D^V)+B[0]+3936430074&4294967295,$=C+(L<<11&4294967295|L>>>21),L=V+($^C^D)+B[3]+3572445317&4294967295,V=$+(L<<16&4294967295|L>>>16),L=D+(V^$^C)+B[6]+76029189&4294967295,D=V+(L<<23&4294967295|L>>>9),L=C+(D^V^$)+B[9]+3654602809&4294967295,C=D+(L<<4&4294967295|L>>>28),L=$+(C^D^V)+B[12]+3873151461&4294967295,$=C+(L<<11&4294967295|L>>>21),L=V+($^C^D)+B[15]+530742520&4294967295,V=$+(L<<16&4294967295|L>>>16),L=D+(V^$^C)+B[2]+3299628645&4294967295,D=V+(L<<23&4294967295|L>>>9),L=C+(V^(D|~$))+B[0]+4096336452&4294967295,C=D+(L<<6&4294967295|L>>>26),L=$+(D^(C|~V))+B[7]+1126891415&4294967295,$=C+(L<<10&4294967295|L>>>22),L=V+(C^($|~D))+B[14]+2878612391&4294967295,V=$+(L<<15&4294967295|L>>>17),L=D+($^(V|~C))+B[5]+4237533241&4294967295,D=V+(L<<21&4294967295|L>>>11),L=C+(V^(D|~$))+B[12]+1700485571&4294967295,C=D+(L<<6&4294967295|L>>>26),L=$+(D^(C|~V))+B[3]+2399980690&4294967295,$=C+(L<<10&4294967295|L>>>22),L=V+(C^($|~D))+B[10]+4293915773&4294967295,V=$+(L<<15&4294967295|L>>>17),L=D+($^(V|~C))+B[1]+2240044497&4294967295,D=V+(L<<21&4294967295|L>>>11),L=C+(V^(D|~$))+B[8]+1873313359&4294967295,C=D+(L<<6&4294967295|L>>>26),L=$+(D^(C|~V))+B[15]+4264355552&4294967295,$=C+(L<<10&4294967295|L>>>22),L=V+(C^($|~D))+B[6]+2734768916&4294967295,V=$+(L<<15&4294967295|L>>>17),L=D+($^(V|~C))+B[13]+1309151649&4294967295,D=V+(L<<21&4294967295|L>>>11),L=C+(V^(D|~$))+B[4]+4149444226&4294967295,C=D+(L<<6&4294967295|L>>>26),L=$+(D^(C|~V))+B[11]+3174756917&4294967295,$=C+(L<<10&4294967295|L>>>22),L=V+(C^($|~D))+B[2]+718787259&4294967295,V=$+(L<<15&4294967295|L>>>17),L=D+($^(V|~C))+B[9]+3951481745&4294967295,R.g[0]=R.g[0]+C&4294967295,R.g[1]=R.g[1]+(V+(L<<21&4294967295|L>>>11))&4294967295,R.g[2]=R.g[2]+V&4294967295,R.g[3]=R.g[3]+$&4294967295}s.prototype.v=function(R,C){C===void 0&&(C=R.length);const D=C-this.blockSize,B=this.C;let V=this.h,$=0;for(;$<C;){if(V==0)for(;$<=D;)r(this,R,$),$+=this.blockSize;if(typeof R=="string"){for(;$<C;)if(B[V++]=R.charCodeAt($++),V==this.blockSize){r(this,B),V=0;break}}else for(;$<C;)if(B[V++]=R[$++],V==this.blockSize){r(this,B),V=0;break}}this.h=V,this.o+=C},s.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var C=1;C<R.length-8;++C)R[C]=0;C=this.o*8;for(var D=R.length-8;D<R.length;++D)R[D]=C&255,C/=256;for(this.v(R),R=Array(16),C=0,D=0;D<4;++D)for(let B=0;B<32;B+=8)R[C++]=this.g[D]>>>B&255;return R};function i(R,C){var D=u;return Object.prototype.hasOwnProperty.call(D,R)?D[R]:D[R]=C(R)}function o(R,C){this.h=C;const D=[];let B=!0;for(let V=R.length-1;V>=0;V--){const $=R[V]|0;B&&$==C||(D[V]=$,B=!1)}this.g=D}var u={};function d(R){return-128<=R&&R<128?i(R,function(C){return new o([C|0],C<0?-1:0)}):new o([R|0],R<0?-1:0)}function h(R){if(isNaN(R)||!isFinite(R))return m;if(R<0)return N(h(-R));const C=[];let D=1;for(let B=0;R>=D;B++)C[B]=R/D|0,D*=4294967296;return new o(C,0)}function p(R,C){if(R.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(R.charAt(0)=="-")return N(p(R.substring(1),C));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=h(Math.pow(C,8));let B=m;for(let $=0;$<R.length;$+=8){var V=Math.min(8,R.length-$);const L=parseInt(R.substring($,$+V),C);V<8?(V=h(Math.pow(C,V)),B=B.j(V).add(h(L))):(B=B.j(D),B=B.add(h(L)))}return B}var m=d(0),x=d(1),v=d(16777216);n=o.prototype,n.m=function(){if(E(this))return-N(this).m();let R=0,C=1;for(let D=0;D<this.g.length;D++){const B=this.i(D);R+=(B>=0?B:4294967296+B)*C,C*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(w(this))return"0";if(E(this))return"-"+N(this).toString(R);const C=h(Math.pow(R,6));var D=this;let B="";for(;;){const V=P(D,C).g;D=A(D,V.j(C));let $=((D.g.length>0?D.g[0]:D.h)>>>0).toString(R);if(D=V,w(D))return $+B;for(;$.length<6;)$="0"+$;B=$+B}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function w(R){if(R.h!=0)return!1;for(let C=0;C<R.g.length;C++)if(R.g[C]!=0)return!1;return!0}function E(R){return R.h==-1}n.l=function(R){return R=A(this,R),E(R)?-1:w(R)?0:1};function N(R){const C=R.g.length,D=[];for(let B=0;B<C;B++)D[B]=~R.g[B];return new o(D,~R.h).add(x)}n.abs=function(){return E(this)?N(this):this},n.add=function(R){const C=Math.max(this.g.length,R.g.length),D=[];let B=0;for(let V=0;V<=C;V++){let $=B+(this.i(V)&65535)+(R.i(V)&65535),L=($>>>16)+(this.i(V)>>>16)+(R.i(V)>>>16);B=L>>>16,$&=65535,L&=65535,D[V]=L<<16|$}return new o(D,D[D.length-1]&-2147483648?-1:0)};function A(R,C){return R.add(N(C))}n.j=function(R){if(w(this)||w(R))return m;if(E(this))return E(R)?N(this).j(N(R)):N(N(this).j(R));if(E(R))return N(this.j(N(R)));if(this.l(v)<0&&R.l(v)<0)return h(this.m()*R.m());const C=this.g.length+R.g.length,D=[];for(var B=0;B<2*C;B++)D[B]=0;for(B=0;B<this.g.length;B++)for(let V=0;V<R.g.length;V++){const $=this.i(B)>>>16,L=this.i(B)&65535,de=R.i(V)>>>16,ye=R.i(V)&65535;D[2*B+2*V]+=L*ye,T(D,2*B+2*V),D[2*B+2*V+1]+=$*ye,T(D,2*B+2*V+1),D[2*B+2*V+1]+=L*de,T(D,2*B+2*V+1),D[2*B+2*V+2]+=$*de,T(D,2*B+2*V+2)}for(R=0;R<C;R++)D[R]=D[2*R+1]<<16|D[2*R];for(R=C;R<2*C;R++)D[R]=0;return new o(D,0)};function T(R,C){for(;(R[C]&65535)!=R[C];)R[C+1]+=R[C]>>>16,R[C]&=65535,C++}function I(R,C){this.g=R,this.h=C}function P(R,C){if(w(C))throw Error("division by zero");if(w(R))return new I(m,m);if(E(R))return C=P(N(R),C),new I(N(C.g),N(C.h));if(E(C))return C=P(R,N(C)),new I(N(C.g),C.h);if(R.g.length>30){if(E(R)||E(C))throw Error("slowDivide_ only works with positive integers.");for(var D=x,B=C;B.l(R)<=0;)D=U(D),B=U(B);var V=O(D,1),$=O(B,1);for(B=O(B,2),D=O(D,2);!w(B);){var L=$.add(B);L.l(R)<=0&&(V=V.add(D),$=L),B=O(B,1),D=O(D,1)}return C=A(R,V.j(C)),new I(V,C)}for(V=m;R.l(C)>=0;){for(D=Math.max(1,Math.floor(R.m()/C.m())),B=Math.ceil(Math.log(D)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),$=h(D),L=$.j(C);E(L)||L.l(R)>0;)D-=B,$=h(D),L=$.j(C);w($)&&($=x),V=V.add($),R=A(R,L)}return new I(V,R)}n.B=function(R){return P(this,R).h},n.and=function(R){const C=Math.max(this.g.length,R.g.length),D=[];for(let B=0;B<C;B++)D[B]=this.i(B)&R.i(B);return new o(D,this.h&R.h)},n.or=function(R){const C=Math.max(this.g.length,R.g.length),D=[];for(let B=0;B<C;B++)D[B]=this.i(B)|R.i(B);return new o(D,this.h|R.h)},n.xor=function(R){const C=Math.max(this.g.length,R.g.length),D=[];for(let B=0;B<C;B++)D[B]=this.i(B)^R.i(B);return new o(D,this.h^R.h)};function U(R){const C=R.g.length+1,D=[];for(let B=0;B<C;B++)D[B]=R.i(B)<<1|R.i(B-1)>>>31;return new o(D,R.h)}function O(R,C){const D=C>>5;C%=32;const B=R.g.length-D,V=[];for(let $=0;$<B;$++)V[$]=C>0?R.i($+D)>>>C|R.i($+D+1)<<32-C:R.i($+D);return new o(V,R.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,l1=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=p,na=o}).apply(typeof sw<"u"?sw:typeof self<"u"?self:typeof window<"u"?window:{});var Ah=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var c1,ru,u1,Jh,Lg,d1,h1,f1;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ah=="object"&&Ah];for(var k=0;k<g.length;++k){var S=g[k];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var s=t(this);function r(g,k){if(k)e:{var S=s;g=g.split(".");for(var M=0;M<g.length-1;M++){var K=g[M];if(!(K in S))break e;S=S[K]}g=g[g.length-1],M=S[g],k=k(M),k!=M&&k!=null&&e(S,g,{configurable:!0,writable:!0,value:k})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(k){var S=[],M;for(M in k)Object.prototype.hasOwnProperty.call(k,M)&&S.push([M,k[M]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function u(g){var k=typeof g;return k=="object"&&g!=null||k=="function"}function d(g,k,S){return g.call.apply(g.bind,arguments)}function h(g,k,S){return h=d,h.apply(null,arguments)}function p(g,k){var S=Array.prototype.slice.call(arguments,1);return function(){var M=S.slice();return M.push.apply(M,arguments),g.apply(this,M)}}function m(g,k){function S(){}S.prototype=k.prototype,g.Z=k.prototype,g.prototype=new S,g.prototype.constructor=g,g.Ob=function(M,K,J){for(var ue=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)ue[Be-2]=arguments[Be];return k.prototype[K].apply(M,ue)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function v(g){const k=g.length;if(k>0){const S=Array(k);for(let M=0;M<k;M++)S[M]=g[M];return S}return[]}function w(g,k){for(let M=1;M<arguments.length;M++){const K=arguments[M];var S=typeof K;if(S=S!="object"?S:K?Array.isArray(K)?"array":S:"null",S=="array"||S=="object"&&typeof K.length=="number"){S=g.length||0;const J=K.length||0;g.length=S+J;for(let ue=0;ue<J;ue++)g[S+ue]=K[ue]}else g.push(K)}}class E{constructor(k,S){this.i=k,this.j=S,this.h=0,this.g=null}get(){let k;return this.h>0?(this.h--,k=this.g,this.g=k.next,k.next=null):k=this.i(),k}}function N(g){o.setTimeout(()=>{throw g},0)}function A(){var g=R;let k=null;return g.g&&(k=g.g,g.g=g.g.next,g.g||(g.h=null),k.next=null),k}class T{constructor(){this.h=this.g=null}add(k,S){const M=I.get();M.set(k,S),this.h?this.h.next=M:this.g=M,this.h=M}}var I=new E(()=>new P,g=>g.reset());class P{constructor(){this.next=this.g=this.h=null}set(k,S){this.h=k,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let U,O=!1,R=new T,C=()=>{const g=Promise.resolve(void 0);U=()=>{g.then(D)}};function D(){for(var g;g=A();){try{g.h.call(g.g)}catch(S){N(S)}var k=I;k.j(g),k.h<100&&(k.h++,g.next=k.g,k.g=g)}O=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(g,k){this.type=g,this.g=this.target=k,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var $=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,k=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const S=()=>{};o.addEventListener("test",S,k),o.removeEventListener("test",S,k)}catch{}return g})();function L(g){return/^[\s\xa0]*$/.test(g)}function de(g,k){V.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,k)}m(de,V),de.prototype.init=function(g,k){const S=this.type=g.type,M=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=k,k=g.relatedTarget,k||(S=="mouseover"?k=g.fromElement:S=="mouseout"&&(k=g.toElement)),this.relatedTarget=k,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var ye="closure_listenable_"+(Math.random()*1e6|0),ie=0;function oe(g,k,S,M,K){this.listener=g,this.proxy=null,this.src=k,this.type=S,this.capture=!!M,this.ha=K,this.key=++ie,this.da=this.fa=!1}function Y(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function he(g,k,S){for(const M in g)k.call(S,g[M],M,g)}function le(g,k){for(const S in g)k.call(void 0,g[S],S,g)}function W(g){const k={};for(const S in g)k[S]=g[S];return k}const Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ce(g,k){let S,M;for(let K=1;K<arguments.length;K++){M=arguments[K];for(S in M)g[S]=M[S];for(let J=0;J<Z.length;J++)S=Z[J],Object.prototype.hasOwnProperty.call(M,S)&&(g[S]=M[S])}}function xe(g){this.src=g,this.g={},this.h=0}xe.prototype.add=function(g,k,S,M,K){const J=g.toString();g=this.g[J],g||(g=this.g[J]=[],this.h++);const ue=Re(g,k,M,K);return ue>-1?(k=g[ue],S||(k.fa=!1)):(k=new oe(k,this.src,J,!!M,K),k.fa=S,g.push(k)),k};function je(g,k){const S=k.type;if(S in g.g){var M=g.g[S],K=Array.prototype.indexOf.call(M,k,void 0),J;(J=K>=0)&&Array.prototype.splice.call(M,K,1),J&&(Y(k),g.g[S].length==0&&(delete g.g[S],g.h--))}}function Re(g,k,S,M){for(let K=0;K<g.length;++K){const J=g[K];if(!J.da&&J.listener==k&&J.capture==!!S&&J.ha==M)return K}return-1}var fe="closure_lm_"+(Math.random()*1e6|0),Ue={};function Se(g,k,S,M,K){if(Array.isArray(k)){for(let J=0;J<k.length;J++)Se(g,k[J],S,M,K);return null}return S=ec(S),g&&g[ye]?g.J(k,S,u(M)?!!M.capture:!1,K):We(g,k,S,!1,M,K)}function We(g,k,S,M,K,J){if(!k)throw Error("Invalid event type");const ue=u(K)?!!K.capture:!!K;let Be=ko(g);if(Be||(g[fe]=Be=new xe(g)),S=Be.add(k,S,M,ue,J),S.proxy)return S;if(M=st(),S.proxy=M,M.src=g,M.listener=S,g.addEventListener)$||(K=ue),K===void 0&&(K=!1),g.addEventListener(k.toString(),M,K);else if(g.attachEvent)g.attachEvent(mi(k.toString()),M);else if(g.addListener&&g.removeListener)g.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return S}function st(){function g(S){return k.call(g.src,g.listener,S)}const k=ld;return g}function Tt(g,k,S,M,K){if(Array.isArray(k))for(var J=0;J<k.length;J++)Tt(g,k[J],S,M,K);else M=u(M)?!!M.capture:!!M,S=ec(S),g&&g[ye]?(g=g.i,J=String(k).toString(),J in g.g&&(k=g.g[J],S=Re(k,S,M,K),S>-1&&(Y(k[S]),Array.prototype.splice.call(k,S,1),k.length==0&&(delete g.g[J],g.h--)))):g&&(g=ko(g))&&(k=g.g[k.toString()],g=-1,k&&(g=Re(k,S,M,K)),(S=g>-1?k[g]:null)&&en(S))}function en(g){if(typeof g!="number"&&g&&!g.da){var k=g.src;if(k&&k[ye])je(k.i,g);else{var S=g.type,M=g.proxy;k.removeEventListener?k.removeEventListener(S,M,g.capture):k.detachEvent?k.detachEvent(mi(S),M):k.addListener&&k.removeListener&&k.removeListener(M),(S=ko(k))?(je(S,g),S.h==0&&(S.src=null,k[fe]=null)):Y(g)}}}function mi(g){return g in Ue?Ue[g]:Ue[g]="on"+g}function ld(g,k){if(g.da)g=!0;else{k=new de(k,this);const S=g.listener,M=g.ha||g.src;g.fa&&en(g),g=S.call(M,k)}return g}function ko(g){return g=g[fe],g instanceof xe?g:null}var Ea="__closure_events_fn_"+(Math.random()*1e9>>>0);function ec(g){return typeof g=="function"?g:(g[Ea]||(g[Ea]=function(k){return g.handleEvent(k)}),g[Ea])}function Ht(){B.call(this),this.i=new xe(this),this.M=this,this.G=null}m(Ht,B),Ht.prototype[ye]=!0,Ht.prototype.removeEventListener=function(g,k,S,M){Tt(this,g,k,S,M)};function Mt(g,k){var S,M=g.G;if(M)for(S=[];M;M=M.G)S.push(M);if(g=g.M,M=k.type||k,typeof k=="string")k=new V(k,g);else if(k instanceof V)k.target=k.target||g;else{var K=k;k=new V(M,g),ce(k,K)}K=!0;let J,ue;if(S)for(ue=S.length-1;ue>=0;ue--)J=k.g=S[ue],K=Dn(J,M,!0,k)&&K;if(J=k.g=g,K=Dn(J,M,!0,k)&&K,K=Dn(J,M,!1,k)&&K,S)for(ue=0;ue<S.length;ue++)J=k.g=S[ue],K=Dn(J,M,!1,k)&&K}Ht.prototype.N=function(){if(Ht.Z.N.call(this),this.i){var g=this.i;for(const k in g.g){const S=g.g[k];for(let M=0;M<S.length;M++)Y(S[M]);delete g.g[k],g.h--}}this.G=null},Ht.prototype.J=function(g,k,S,M){return this.i.add(String(g),k,!1,S,M)},Ht.prototype.K=function(g,k,S,M){return this.i.add(String(g),k,!0,S,M)};function Dn(g,k,S,M){if(k=g.i.g[String(k)],!k)return!0;k=k.concat();let K=!0;for(let J=0;J<k.length;++J){const ue=k[J];if(ue&&!ue.da&&ue.capture==S){const Be=ue.listener,Lt=ue.ha||ue.src;ue.fa&&je(g.i,ue),K=Be.call(Lt,M)!==!1&&K}}return K&&!M.defaultPrevented}function tc(g,k){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(k)>2147483647?-1:o.setTimeout(g,k||0)}function sc(g){g.g=tc(()=>{g.g=null,g.i&&(g.i=!1,sc(g))},g.l);const k=g.h;g.h=null,g.m.apply(null,k)}class cd extends B{constructor(k,S){super(),this.m=k,this.l=S,this.h=null,this.i=!1,this.g=null}j(k){this.h=arguments,this.g?this.i=!0:sc(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function gi(g){B.call(this),this.h=g,this.g={}}m(gi,B);var nc=[];function Eo(g){he(g.g,function(k,S){this.g.hasOwnProperty(S)&&en(k)},g),g.g={}}gi.prototype.N=function(){gi.Z.N.call(this),Eo(this)},gi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yi=o.JSON.stringify,ud=o.JSON.parse,Na=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function xi(){}function dd(){}var bi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function No(){V.call(this,"d")}m(No,V);function rc(){V.call(this,"c")}m(rc,V);var Mn={},Ao=null;function vi(){return Ao=Ao||new Ht}Mn.Ia="serverreachability";function So(g){V.call(this,Mn.Ia,g)}m(So,V);function Pr(g){const k=vi();Mt(k,new So(k))}Mn.STAT_EVENT="statevent";function jr(g,k){V.call(this,Mn.STAT_EVENT,g),this.stat=k}m(jr,V);function Ct(g){const k=vi();Mt(k,new jr(k,g))}Mn.Ja="timingevent";function ic(g,k){V.call(this,Mn.Ja,g),this.size=k}m(ic,V);function wi(g,k){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},k)}function _i(){this.g=!0}_i.prototype.ua=function(){this.g=!1};function hd(g,k,S,M,K,J){g.info(function(){if(g.g)if(J){var ue="",Be=J.split("&");for(let ct=0;ct<Be.length;ct++){var Lt=Be[ct].split("=");if(Lt.length>1){const qt=Lt[0];Lt=Lt[1];const on=qt.split("_");ue=on.length>=2&&on[1]=="type"?ue+(qt+"="+Lt+"&"):ue+(qt+"=redacted&")}}}else ue=null;else ue=J;return"XMLHTTP REQ ("+M+") [attempt "+K+"]: "+k+`
`+S+`
`+ue})}function fd(g,k,S,M,K,J,ue){g.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+K+"]: "+k+`
`+S+`
`+J+" "+ue})}function Jn(g,k,S,M){g.info(function(){return"XMLHTTP TEXT ("+k+"): "+Aa(g,S)+(M?" "+M:"")})}function pd(g,k){g.info(function(){return"TIMEOUT: "+k})}_i.prototype.info=function(){};function Aa(g,k){if(!g.g)return k;if(!k)return null;try{const J=JSON.parse(k);if(J){for(g=0;g<J.length;g++)if(Array.isArray(J[g])){var S=J[g];if(!(S.length<2)){var M=S[1];if(Array.isArray(M)&&!(M.length<1)){var K=M[0];if(K!="noop"&&K!="stop"&&K!="close")for(let ue=1;ue<M.length;ue++)M[ue]=""}}}}return yi(J)}catch{return k}}var ki={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ei={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},md;function Rr(){}m(Rr,xi),Rr.prototype.g=function(){return new XMLHttpRequest},md=new Rr;function Zn(g){return encodeURIComponent(String(g))}function To(g){var k=1;g=g.split(":");const S=[];for(;k>0&&g.length;)S.push(g.shift()),k--;return g.length&&S.push(g.join(":")),S}function yn(g,k,S,M){this.j=g,this.i=k,this.l=S,this.S=M||1,this.V=new gi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gd}function gd(){this.i=null,this.g="",this.h=!1}var yd={},ac={};function Ln(g,k,S){g.M=1,g.A=Mr(xn(k)),g.u=S,g.R=!0,oc(g,null)}function oc(g,k){g.F=Date.now(),Sa(g),g.B=xn(g.A);var S=g.B,M=g.S;Array.isArray(M)||(M=[String(M)]),yc(S.i,"t",M),g.C=0,S=g.j.L,g.h=new gd,g.g=Sd(g.j,S?k:null,!g.u),g.P>0&&(g.O=new cd(h(g.Y,g,g.g),g.P)),k=g.V,S=g.g,M=g.ba;var K="readystatechange";Array.isArray(K)||(K&&(nc[0]=K.toString()),K=nc);for(let J=0;J<K.length;J++){const ue=Se(S,K[J],M||k.handleEvent,!1,k.h||k);if(!ue)break;k.g[ue.key]=ue}k=g.J?W(g.J):{},g.u?(g.v||(g.v="POST"),k["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,k)):(g.v="GET",g.g.ea(g.B,g.v,null,k)),Pr(),hd(g.i,g.v,g.B,g.l,g.S,g.u)}yn.prototype.ba=function(g){g=g.target;const k=this.O;k&&ar(g)==3?k.j():this.Y(g)},yn.prototype.Y=function(g){try{if(g==this.g)e:{const Be=ar(this.g),Lt=this.g.ya(),ct=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||Nd(this.g)))){this.K||Be!=4||Lt==7||(Lt==8||ct<=0?Pr(3):Pr(2)),Co(this);var k=this.g.ca();this.X=k;var S=xd(this);if(this.o=k==200,fd(this.i,this.v,this.B,this.l,this.S,Be,k),this.o){if(this.U&&!this.L){t:{if(this.g){var M,K=this.g;if((M=K.g?K.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(M)){var J=M;break t}}J=null}if(g=J)Jn(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,gt(this,g);else{this.o=!1,this.m=3,Ct(12),Dr(this),Ta(this);break e}}if(this.R){g=!0;let qt;for(;!this.K&&this.C<S.length;)if(qt=vd(this,S),qt==ac){Be==4&&(this.m=4,Ct(14),g=!1),Jn(this.i,this.l,null,"[Incomplete Response]");break}else if(qt==yd){this.m=4,Ct(15),Jn(this.i,this.l,S,"[Invalid Chunk]"),g=!1;break}else Jn(this.i,this.l,qt,null),gt(this,qt);if(bd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||S.length!=0||this.h.h||(this.m=1,Ct(16),g=!1),this.o=this.o&&g,!g)Jn(this.i,this.l,S,"[Invalid Chunked Response]"),Dr(this),Ta(this);else if(S.length>0&&!this.W){this.W=!0;var ue=this.j;ue.g==this&&ue.aa&&!ue.P&&(ue.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),Oa(ue),ue.P=!0,Ct(11))}}else Jn(this.i,this.l,S,null),gt(this,S);Be==4&&Dr(this),this.o&&!this.K&&(Be==4?Vo(this.j,this):(this.o=!1,Sa(this)))}else bc(this.g),k==400&&S.indexOf("Unknown SID")>0?(this.m=3,Ct(12)):(this.m=0,Ct(13)),Dr(this),Ta(this)}}}catch{}finally{}};function xd(g){if(!bd(g))return g.g.la();const k=Nd(g.g);if(k==="")return"";let S="";const M=k.length,K=ar(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return Dr(g),Ta(g),"";g.h.i=new o.TextDecoder}for(let J=0;J<M;J++)g.h.h=!0,S+=g.h.i.decode(k[J],{stream:!(K&&J==M-1)});return k.length=0,g.h.g+=S,g.C=0,g.h.g}function bd(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function vd(g,k){var S=g.C,M=k.indexOf(`
`,S);return M==-1?ac:(S=Number(k.substring(S,M)),isNaN(S)?yd:(M+=1,M+S>k.length?ac:(k=k.slice(M,M+S),g.C=M+S,k)))}yn.prototype.cancel=function(){this.K=!0,Dr(this)};function Sa(g){g.T=Date.now()+g.H,lc(g,g.H)}function lc(g,k){if(g.D!=null)throw Error("WatchDog timer not null");g.D=wi(h(g.aa,g),k)}function Co(g){g.D&&(o.clearTimeout(g.D),g.D=null)}yn.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(pd(this.i,this.B),this.M!=2&&(Pr(),Ct(17)),Dr(this),this.m=2,Ta(this)):lc(this,this.T-g)};function Ta(g){g.j.I==0||g.K||Vo(g.j,g)}function Dr(g){Co(g);var k=g.O;k&&typeof k.dispose=="function"&&k.dispose(),g.O=null,Eo(g.V),g.g&&(k=g.g,g.g=null,k.abort(),k.dispose())}function gt(g,k){try{var S=g.j;if(S.I!=0&&(S.g==g||uc(S.h,g))){if(!g.L&&uc(S.h,g)&&S.I==3){try{var M=S.Ba.g.parse(k)}catch{M=null}if(Array.isArray(M)&&M.length==3){var K=M;if(K[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<g.F)Fo(S),rn(S);else break e;cr(S),Ct(18)}}else S.xa=K[1],0<S.xa-S.K&&K[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=wi(h(S.Va,S),6e3));Ca(S.h)<=1&&S.ta&&(S.ta=void 0)}else an(S,11)}else if((g.L||S.g==g)&&Fo(S),!L(k))for(K=S.Ba.g.parse(k),k=0;k<K.length;k++){let ct=K[k];const qt=ct[0];if(!(qt<=S.K))if(S.K=qt,ct=ct[1],S.I==2)if(ct[0]=="c"){S.M=ct[1],S.ba=ct[2];const on=ct[3];on!=null&&(S.ka=on,S.j.info("VER="+S.ka));const Ur=ct[4];Ur!=null&&(S.za=Ur,S.j.info("SVER="+S.za));const ur=ct[5];ur!=null&&typeof ur=="number"&&ur>0&&(M=1.5*ur,S.O=M,S.j.info("backChannelRequestTimeoutMs_="+M)),M=S;const dr=g.g;if(dr){const zo=dr.g?dr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zo){var J=M.h;J.g||zo.indexOf("spdy")==-1&&zo.indexOf("quic")==-1&&zo.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Po(J,J.h),J.h=null))}if(M.G){const _c=dr.g?dr.g.getResponseHeader("X-HTTP-Session-Id"):null;_c&&(M.wa=_c,it(M.J,M.G,_c))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-g.F,S.j.info("Handshake RTT: "+S.T+"ms")),M=S;var ue=g;if(M.na=wc(M,M.L?M.ba:null,M.W),ue.L){Ia(M.h,ue);var Be=ue,Lt=M.O;Lt&&(Be.H=Lt),Be.D&&(Co(Be),Sa(Be)),M.g=ue}else ws(M);S.i.length>0&&Vr(S)}else ct[0]!="stop"&&ct[0]!="close"||an(S,7);else S.I==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?an(S,7):Lo(S):ct[0]!="noop"&&S.l&&S.l.qa(ct),S.A=0)}}Pr(4)}catch{}}var wp=class{constructor(g,k){this.g=g,this.map=k}};function Io(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function cc(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Ca(g){return g.h?1:g.g?g.g.size:0}function uc(g,k){return g.h?g.h==k:g.g?g.g.has(k):!1}function Po(g,k){g.g?g.g.add(k):g.h=k}function Ia(g,k){g.h&&g.h==k?g.h=null:g.g&&g.g.has(k)&&g.g.delete(k)}Io.prototype.cancel=function(){if(this.i=tn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function tn(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let k=g.i;for(const S of g.g.values())k=k.concat(S.G);return k}return v(g.i)}var wd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sn(g,k){if(g){g=g.split("&");for(let S=0;S<g.length;S++){const M=g[S].indexOf("=");let K,J=null;M>=0?(K=g[S].substring(0,M),J=g[S].substring(M+1)):K=g[S],k(K,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function er(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let k;g instanceof er?(this.l=g.l,Pa(this,g.j),this.o=g.o,this.g=g.g,tr(this,g.u),this.h=g.h,Ni(this,xc(g.i)),this.m=g.m):g&&(k=String(g).match(wd))?(this.l=!1,Pa(this,k[1]||"",!0),this.o=ja(k[2]||""),this.g=ja(k[3]||"",!0),tr(this,k[4]),this.h=ja(k[5]||"",!0),Ni(this,k[6]||"",!0),this.m=ja(k[7]||"")):(this.l=!1,this.i=new Je(null,this.l))}er.prototype.toString=function(){const g=[];var k=this.j;k&&g.push(Ra(k,hc,!0),":");var S=this.g;return(S||k=="file")&&(g.push("//"),(k=this.o)&&g.push(Ra(k,hc,!0),"@"),g.push(Zn(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&g.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&g.push("/"),g.push(Ra(S,S.charAt(0)=="/"?Da:fc,!0))),(S=this.i.toString())&&g.push("?",S),(S=this.m)&&g.push("#",Ra(S,pc)),g.join("")},er.prototype.resolve=function(g){const k=xn(this);let S=!!g.j;S?Pa(k,g.j):S=!!g.o,S?k.o=g.o:S=!!g.g,S?k.g=g.g:S=g.u!=null;var M=g.h;if(S)tr(k,g.u);else if(S=!!g.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var K=k.h.lastIndexOf("/");K!=-1&&(M=k.h.slice(0,K+1)+M)}if(K=M,K==".."||K==".")M="";else if(K.indexOf("./")!=-1||K.indexOf("/.")!=-1){M=K.lastIndexOf("/",0)==0,K=K.split("/");const J=[];for(let ue=0;ue<K.length;){const Be=K[ue++];Be=="."?M&&ue==K.length&&J.push(""):Be==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),M&&ue==K.length&&J.push("")):(J.push(Be),M=!0)}M=J.join("/")}else M=K}return S?k.h=M:S=g.i.toString()!=="",S?Ni(k,xc(g.i)):S=!!g.m,S&&(k.m=g.m),k};function xn(g){return new er(g)}function Pa(g,k,S){g.j=S?ja(k,!0):k,g.j&&(g.j=g.j.replace(/:$/,""))}function tr(g,k){if(k){if(k=Number(k),isNaN(k)||k<0)throw Error("Bad port number "+k);g.u=k}else g.u=null}function Ni(g,k,S){k instanceof Je?(g.i=k,Ro(g.i,g.l)):(S||(k=Ra(k,_p)),g.i=new Je(k,g.l))}function it(g,k,S){g.i.set(k,S)}function Mr(g){return it(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function ja(g,k){return g?k?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Ra(g,k,S){return typeof g=="string"?(g=encodeURI(g).replace(k,dc),S&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function dc(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var hc=/[#\/\?@]/g,fc=/[#\?:]/g,Da=/[#\?]/g,_p=/[#\?@]/g,pc=/#/g;function Je(g,k){this.h=this.g=null,this.i=g||null,this.j=!!k}function sr(g){g.g||(g.g=new Map,g.h=0,g.i&&sn(g.i,function(k,S){g.add(decodeURIComponent(k.replace(/\+/g," ")),S)}))}n=Je.prototype,n.add=function(g,k){sr(this),this.i=null,g=nr(this,g);let S=this.g.get(g);return S||this.g.set(g,S=[]),S.push(k),this.h+=1,this};function mc(g,k){sr(g),k=nr(g,k),g.g.has(k)&&(g.i=null,g.h-=g.g.get(k).length,g.g.delete(k))}function jo(g,k){return sr(g),k=nr(g,k),g.g.has(k)}n.forEach=function(g,k){sr(this),this.g.forEach(function(S,M){S.forEach(function(K){g.call(k,K,M,this)},this)},this)};function gc(g,k){sr(g);let S=[];if(typeof k=="string")jo(g,k)&&(S=S.concat(g.g.get(nr(g,k))));else for(g=Array.from(g.g.values()),k=0;k<g.length;k++)S=S.concat(g[k]);return S}n.set=function(g,k){return sr(this),this.i=null,g=nr(this,g),jo(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[k]),this.h+=1,this},n.get=function(g,k){return g?(g=gc(this,g),g.length>0?String(g[0]):k):k};function yc(g,k,S){mc(g,k),S.length>0&&(g.i=null,g.g.set(nr(g,k),v(S)),g.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],k=Array.from(this.g.keys());for(let M=0;M<k.length;M++){var S=k[M];const K=Zn(S);S=gc(this,S);for(let J=0;J<S.length;J++){let ue=K;S[J]!==""&&(ue+="="+Zn(S[J])),g.push(ue)}}return this.i=g.join("&")};function xc(g){const k=new Je;return k.i=g.i,g.g&&(k.g=new Map(g.g),k.h=g.h),k}function nr(g,k){return k=String(k),g.j&&(k=k.toLowerCase()),k}function Ro(g,k){k&&!g.j&&(sr(g),g.i=null,g.g.forEach(function(S,M){const K=M.toLowerCase();M!=K&&(mc(this,M),yc(this,K,S))},g)),g.j=k}function rr(g,k){const S=new _i;if(o.Image){const M=new Image;M.onload=p(cs,S,"TestLoadImage: loaded",!0,k,M),M.onerror=p(cs,S,"TestLoadImage: error",!1,k,M),M.onabort=p(cs,S,"TestLoadImage: abort",!1,k,M),M.ontimeout=p(cs,S,"TestLoadImage: timeout",!1,k,M),o.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=g}else k(!1)}function ir(g,k){const S=new _i,M=new AbortController,K=setTimeout(()=>{M.abort(),cs(S,"TestPingServer: timeout",!1,k)},1e4);fetch(g,{signal:M.signal}).then(J=>{clearTimeout(K),J.ok?cs(S,"TestPingServer: ok",!0,k):cs(S,"TestPingServer: server error",!1,k)}).catch(()=>{clearTimeout(K),cs(S,"TestPingServer: error",!1,k)})}function cs(g,k,S,M,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),M(S)}catch{}}function Ma(){this.g=new Na}function Lr(g){this.i=g.Sb||null,this.h=g.ab||!1}m(Lr,xi),Lr.prototype.g=function(){return new nn(this.i,this.h)};function nn(g,k){Ht.call(this),this.H=g,this.o=k,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(nn,Ht),n=nn.prototype,n.open=function(g,k){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=k,this.readyState=1,On(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const k={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(k.body=g),(this.H||o).fetch(new Request(this.D,k)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ai(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,On(this)),this.g&&(this.readyState=3,On(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;_d(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function _d(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var k=g.value?g.value:new Uint8Array(0);(k=this.B.decode(k,{stream:!g.done}))&&(this.response=this.responseText+=k)}g.done?Ai(this):On(this),this.readyState==3&&_d(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,Ai(this))},n.Na=function(g){this.g&&(this.response=g,Ai(this))},n.ga=function(){this.g&&Ai(this)};function Ai(g){g.readyState=4,g.l=null,g.j=null,g.B=null,On(g)}n.setRequestHeader=function(g,k){this.A.append(g,k)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],k=this.h.entries();for(var S=k.next();!S.done;)S=S.value,g.push(S[0]+": "+S[1]),S=k.next();return g.join(`\r
`)};function On(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(nn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function kd(g){let k="";return he(g,function(S,M){k+=M,k+=":",k+=S,k+=`\r
`}),k}function Do(g,k,S){e:{for(M in S){var M=!1;break e}M=!0}M||(S=kd(S),typeof g=="string"?S!=null&&Zn(S):it(g,k,S))}function dt(g){Ht.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(dt,Ht);var Ed=/^https?$/i,kp=["POST","PUT"];n=dt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,k,S,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);k=k?k.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():md.g(),this.g.onreadystatechange=x(h(this.Ca,this));try{this.B=!0,this.g.open(k,String(g),!0),this.B=!1}catch(J){Si(this,J);return}if(g=S||"",S=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var K in M)S.set(K,M[K]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const J of M.keys())S.set(J,M.get(J));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(S.keys()).find(J=>J.toLowerCase()=="content-type"),K=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(kp,k,void 0)>=0)||M||K||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,ue]of S)this.g.setRequestHeader(J,ue);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(J){Si(this,J)}};function Si(g,k){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=k,g.o=5,Ti(g),Fr(g)}function Ti(g){g.A||(g.A=!0,Mt(g,"complete"),Mt(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Mt(this,"complete"),Mt(this,"abort"),Fr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Fr(this,!0)),dt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Or(this):this.Xa())},n.Xa=function(){Or(this)};function Or(g){if(g.h&&typeof i<"u"){if(g.v&&ar(g)==4)setTimeout(g.Ca.bind(g),0);else if(Mt(g,"readystatechange"),ar(g)==4){g.h=!1;try{const J=g.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var k=!0;break e;default:k=!1}var S;if(!(S=k)){var M;if(M=J===0){let ue=String(g.D).match(wd)[1]||null;!ue&&o.self&&o.self.location&&(ue=o.self.location.protocol.slice(0,-1)),M=!Ed.test(ue?ue.toLowerCase():"")}S=M}if(S)Mt(g,"complete"),Mt(g,"success");else{g.o=6;try{var K=ar(g)>2?g.g.statusText:""}catch{K=""}g.l=K+" ["+g.ca()+"]",Ti(g)}}finally{Fr(g)}}}}function Fr(g,k){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const S=g.g;g.g=null,k||Mt(g,"ready");try{S.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ar(g){return g.g?g.g.readyState:0}n.ca=function(){try{return ar(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var k=this.g.responseText;return g&&k.indexOf(g)==0&&(k=k.substring(g.length)),ud(k)}};function Nd(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function bc(g){const k={};g=(g.g&&ar(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<g.length;M++){if(L(g[M]))continue;var S=To(g[M]);const K=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const J=k[K]||[];k[K]=J,J.push(S)}le(k,function(M){return M.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function or(g,k,S){return S&&S.internalChannelParams&&S.internalChannelParams[g]||k}function Mo(g){this.za=0,this.i=[],this.j=new _i,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=or("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=or("baseRetryDelayMs",5e3,g),this.Za=or("retryDelaySeedMs",1e4,g),this.Ta=or("forwardChannelMaxRetries",2,g),this.va=or("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Io(g&&g.concurrentRequestLimit),this.Ba=new Ma,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Mo.prototype,n.ka=8,n.I=1,n.connect=function(g,k,S,M){Ct(0),this.W=g,this.H=k||{},S&&M!==void 0&&(this.H.OSID=S,this.H.OAID=M),this.F=this.X,this.J=wc(this,null,this.W),Vr(this)};function Lo(g){if(Oo(g),g.I==3){var k=g.V++,S=xn(g.J);if(it(S,"SID",g.M),it(S,"RID",k),it(S,"TYPE","terminate"),lr(g,S),k=new yn(g,g.j,k),k.M=2,k.A=Mr(xn(S)),S=!1,o.navigator&&o.navigator.sendBeacon)try{S=o.navigator.sendBeacon(k.A.toString(),"")}catch{}!S&&o.Image&&(new Image().src=k.A,S=!0),S||(k.g=Sd(k.j,null),k.g.ea(k.A)),k.F=Date.now(),Sa(k)}Fa(g)}function rn(g){g.g&&(Oa(g),g.g.cancel(),g.g=null)}function Oo(g){rn(g),g.v&&(o.clearTimeout(g.v),g.v=null),Fo(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Vr(g){if(!cc(g.h)&&!g.m){g.m=!0;var k=g.Ea;U||C(),O||(U(),O=!0),R.add(k,g),g.D=0}}function Ad(g,k){return Ca(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=k.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=wi(h(g.Ea,g,k),Uo(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const K=new yn(this,this.j,g);let J=this.o;if(this.U&&(J?(J=W(J),ce(J,this.U)):J=this.U),this.u!==null||this.R||(K.J=J,J=null),this.S)e:{for(var k=0,S=0;S<this.i.length;S++){t:{var M=this.i[S];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(k+=M,k>4096){k=S;break e}if(k===4096||S===this.i.length-1){k=S+1;break e}}k=1e3}else k=1e3;k=vc(this,K,k),S=xn(this.J),it(S,"RID",g),it(S,"CVER",22),this.G&&it(S,"X-HTTP-Session-Id",this.G),lr(this,S),J&&(this.R?k="headers="+Zn(kd(J))+"&"+k:this.u&&Do(S,this.u,J)),Po(this.h,K),this.Ra&&it(S,"TYPE","init"),this.S?(it(S,"$req",k),it(S,"SID","null"),K.U=!0,Ln(K,S,null)):Ln(K,S,k),this.I=2}}else this.I==3&&(g?La(this,g):this.i.length==0||cc(this.h)||La(this))};function La(g,k){var S;k?S=k.l:S=g.V++;const M=xn(g.J);it(M,"SID",g.M),it(M,"RID",S),it(M,"AID",g.K),lr(g,M),g.u&&g.o&&Do(M,g.u,g.o),S=new yn(g,g.j,S,g.D+1),g.u===null&&(S.J=g.o),k&&(g.i=k.G.concat(g.i)),k=vc(g,S,1e3),S.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Po(g.h,S),Ln(S,M,k)}function lr(g,k){g.H&&he(g.H,function(S,M){it(k,M,S)}),g.l&&he({},function(S,M){it(k,M,S)})}function vc(g,k,S){S=Math.min(g.i.length,S);const M=g.l?h(g.l.Ka,g.l,g):null;e:{var K=g.i;let Be=-1;for(;;){const Lt=["count="+S];Be==-1?S>0?(Be=K[0].g,Lt.push("ofs="+Be)):Be=0:Lt.push("ofs="+Be);let ct=!0;for(let qt=0;qt<S;qt++){var J=K[qt].g;const on=K[qt].map;if(J-=Be,J<0)Be=Math.max(0,K[qt].g-100),ct=!1;else try{J="req"+J+"_"||"";try{var ue=on instanceof Map?on:Object.entries(on);for(const[Ur,ur]of ue){let dr=ur;u(ur)&&(dr=yi(ur)),Lt.push(J+Ur+"="+encodeURIComponent(dr))}}catch(Ur){throw Lt.push(J+"type="+encodeURIComponent("_badmap")),Ur}}catch{M&&M(on)}}if(ct){ue=Lt.join("&");break e}}ue=void 0}return g=g.i.splice(0,S),k.G=g,ue}function ws(g){if(!g.g&&!g.v){g.Y=1;var k=g.Da;U||C(),O||(U(),O=!0),R.add(k,g),g.A=0}}function cr(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=wi(h(g.Da,g),Uo(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,Ci(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=wi(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ct(10),rn(this),Ci(this))};function Oa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function Ci(g){g.g=new yn(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var k=xn(g.na);it(k,"RID","rpc"),it(k,"SID",g.M),it(k,"AID",g.K),it(k,"CI",g.F?"0":"1"),!g.F&&g.ia&&it(k,"TO",g.ia),it(k,"TYPE","xmlhttp"),lr(g,k),g.u&&g.o&&Do(k,g.u,g.o),g.O&&(g.g.H=g.O);var S=g.g;g=g.ba,S.M=1,S.A=Mr(xn(k)),S.u=null,S.R=!0,oc(S,g)}n.Va=function(){this.C!=null&&(this.C=null,rn(this),cr(this),Ct(19))};function Fo(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function Vo(g,k){var S=null;if(g.g==k){Fo(g),Oa(g),g.g=null;var M=2}else if(uc(g.h,k))S=k.G,Ia(g.h,k),M=1;else return;if(g.I!=0){if(k.o)if(M==1){S=k.u?k.u.length:0,k=Date.now()-k.F;var K=g.D;M=vi(),Mt(M,new ic(M,S)),Vr(g)}else ws(g);else if(K=k.m,K==3||K==0&&k.X>0||!(M==1&&Ad(g,k)||M==2&&cr(g)))switch(S&&S.length>0&&(k=g.h,k.i=k.i.concat(S)),K){case 1:an(g,5);break;case 4:an(g,10);break;case 3:an(g,6);break;default:an(g,2)}}}function Uo(g,k){let S=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(S*=2),S*k}function an(g,k){if(g.j.info("Error code "+k),k==2){var S=h(g.bb,g),M=g.Ua;const K=!M;M=new er(M||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Pa(M,"https"),Mr(M),K?rr(M.toString(),S):ir(M.toString(),S)}else Ct(2);g.I=0,g.l&&g.l.pa(k),Fa(g),Oo(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Ct(2)):(this.j.info("Failed to ping google.com"),Ct(1))};function Fa(g){if(g.I=0,g.ja=[],g.l){const k=tn(g.h);(k.length!=0||g.i.length!=0)&&(w(g.ja,k),w(g.ja,g.i),g.h.i.length=0,v(g.i),g.i.length=0),g.l.oa()}}function wc(g,k,S){var M=S instanceof er?xn(S):new er(S);if(M.g!="")k&&(M.g=k+"."+M.g),tr(M,M.u);else{var K=o.location;M=K.protocol,k=k?k+"."+K.hostname:K.hostname,K=+K.port;const J=new er(null);M&&Pa(J,M),k&&(J.g=k),K&&tr(J,K),S&&(J.h=S),M=J}return S=g.G,k=g.wa,S&&k&&it(M,S,k),it(M,"VER",g.ka),lr(g,M),M}function Sd(g,k,S){if(k&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return k=g.Aa&&!g.ma?new dt(new Lr({ab:S})):new dt(g.ma),k.Fa(g.L),k}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Td(){}n=Td.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Bo(){}Bo.prototype.g=function(g,k){return new us(g,k)};function us(g,k){Ht.call(this),this.g=new Mo(k),this.l=g,this.h=k&&k.messageUrlParams||null,g=k&&k.messageHeaders||null,k&&k.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=k&&k.initMessageHeaders||null,k&&k.messageContentType&&(g?g["X-WebChannel-Content-Type"]=k.messageContentType:g={"X-WebChannel-Content-Type":k.messageContentType}),k&&k.sa&&(g?g["X-WebChannel-Client-Profile"]=k.sa:g={"X-WebChannel-Client-Profile":k.sa}),this.g.U=g,(g=k&&k.Qb)&&!L(g)&&(this.g.u=g),this.A=k&&k.supportsCrossDomainXhr||!1,this.v=k&&k.sendRawJson||!1,(k=k&&k.httpSessionIdParam)&&!L(k)&&(this.g.G=k,g=this.h,g!==null&&k in g&&(g=this.h,k in g&&delete g[k])),this.j=new Ii(this)}m(us,Ht),us.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},us.prototype.close=function(){Lo(this.g)},us.prototype.o=function(g){var k=this.g;if(typeof g=="string"){var S={};S.__data__=g,g=S}else this.v&&(S={},S.__data__=yi(g),g=S);k.i.push(new wp(k.Ya++,g)),k.I==3&&Vr(k)},us.prototype.N=function(){this.g.l=null,delete this.j,Lo(this.g),delete this.g,us.Z.N.call(this)};function Cd(g){No.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var k=g.__sm__;if(k){e:{for(const S in k){g=S;break e}g=void 0}(this.i=g)&&(g=this.i,k=k!==null&&g in k?k[g]:void 0),this.data=k}else this.data=g}m(Cd,No);function Id(){rc.call(this),this.status=1}m(Id,rc);function Ii(g){this.g=g}m(Ii,Td),Ii.prototype.ra=function(){Mt(this.g,"a")},Ii.prototype.qa=function(g){Mt(this.g,new Cd(g))},Ii.prototype.pa=function(g){Mt(this.g,new Id)},Ii.prototype.oa=function(){Mt(this.g,"b")},Bo.prototype.createWebChannel=Bo.prototype.g,us.prototype.send=us.prototype.o,us.prototype.open=us.prototype.m,us.prototype.close=us.prototype.close,f1=function(){return new Bo},h1=function(){return vi()},d1=Mn,Lg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ki.NO_ERROR=0,ki.TIMEOUT=8,ki.HTTP_ERROR=6,Jh=ki,Ei.COMPLETE="complete",u1=Ei,dd.EventType=bi,bi.OPEN="a",bi.CLOSE="b",bi.ERROR="c",bi.MESSAGE="d",Ht.prototype.listen=Ht.prototype.J,ru=dd,dt.prototype.listenOnce=dt.prototype.K,dt.prototype.getLastError=dt.prototype.Ha,dt.prototype.getLastErrorCode=dt.prototype.ya,dt.prototype.getStatus=dt.prototype.ca,dt.prototype.getResponseJson=dt.prototype.La,dt.prototype.getResponseText=dt.prototype.la,dt.prototype.send=dt.prototype.ea,dt.prototype.setWithCredentials=dt.prototype.Fa,c1=dt}).apply(typeof Ah<"u"?Ah:typeof self<"u"?self:typeof window<"u"?window:{});const nw="@firebase/firestore",rw="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ss=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ss.UNAUTHENTICATED=new Ss(null),Ss.GOOGLE_CREDENTIALS=new Ss("google-credentials-uid"),Ss.FIRST_PARTY=new Ss("first-party-uid"),Ss.MOCK_USER=new Ss("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gl="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo=new j0("@firebase/firestore");function dl(){return lo.logLevel}function ge(n,...e){if(lo.logLevel<=Ye.DEBUG){const t=e.map(z0);lo.debug(`Firestore (${Gl}): ${n}`,...t)}}function oi(n,...e){if(lo.logLevel<=Ye.ERROR){const t=e.map(z0);lo.error(`Firestore (${Gl}): ${n}`,...t)}}function jl(n,...e){if(lo.logLevel<=Ye.WARN){const t=e.map(z0);lo.warn(`Firestore (${Gl}): ${n}`,...t)}}function z0(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,p1(n,s,t)}function p1(n,e,t){let s=`FIRESTORE (${Gl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw oi(s),new Error(s)}function lt(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||p1(e,r,s)}function He(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pe extends Qn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class pj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ss.UNAUTHENTICATED)))}shutdown(){}}class mj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class gj{constructor(e){this.t=e,this.currentUser=Ss.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){lt(this.o===void 0,42304);let s=this.i;const r=d=>this.i!==s?(s=this.i,t(d)):Promise.resolve();let i=new si;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new si,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const d=i;e.enqueueRetryable((async()=>{await d.promise,await r(this.currentUser)}))},u=d=>{ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((d=>u(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new si)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(lt(typeof s.accessToken=="string",31837,{l:s}),new m1(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lt(e===null||typeof e=="string",2055,{h:e}),new Ss(e)}}class yj{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=Ss.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class xj{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new yj(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ss.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class iw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bj{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Xs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){lt(this.o===void 0,3512);const s=i=>{i.error!=null&&ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ge("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>s(i)))};const r=i=>{ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>r(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new iw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(lt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new iw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vj(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=vj(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%62))}return s}}function Xe(n,e){return n<e?-1:n>e?1:0}function Og(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),i=e.charAt(s);if(r!==i)return ig(r)===ig(i)?Xe(r,i):ig(r)?1:-1}return Xe(n.length,e.length)}const wj=55296,_j=57343;function ig(n){const e=n.charCodeAt(0);return e>=wj&&e<=_j}function Rl(n,e,t){return n.length===e.length&&n.every(((s,r)=>t(s,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aw="__name__";class br{constructor(e,t,s){t===void 0?t=0:t>e.length&&Oe(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Oe(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return br.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof br?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=br.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return Xe(e.length,t.length)}static compareSegments(e,t){const s=br.isNumericId(e),r=br.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?br.extractNumericId(e).compare(br.extractNumericId(t)):Og(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return na.fromString(e.substring(4,e.length-2))}}class mt extends br{construct(e,t,s){return new mt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new pe(ee.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((r=>r.length>0)))}return new mt(t)}static emptyPath(){return new mt([])}}const kj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xs extends br{construct(e,t,s){return new xs(e,t,s)}static isValidIdentifier(e){return kj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===aw}static keyField(){return new xs([aw])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new pe(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const u=e[r];if(u==="\\"){if(r+1===e.length)throw new pe(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[r+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new pe(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=d,r+=2}else u==="`"?(o=!o,r++):u!=="."||o?(s+=u,r++):(i(),r++)}if(i(),o)throw new pe(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xs(t)}static emptyPath(){return new xs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.path=e}static fromPath(e){return new Pe(mt.fromString(e))}static fromName(e){return new Pe(mt.fromString(e).popFirst(5))}static empty(){return new Pe(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pe(new mt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g1(n,e,t){if(!t)throw new pe(ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Ej(n,e,t,s){if(e===!0&&s===!0)throw new pe(ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ow(n){if(!Pe.isDocumentKey(n))throw new pe(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function lw(n){if(Pe.isDocumentKey(n))throw new pe(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function y1(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Hf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Oe(12329,{type:typeof n})}function Yn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new pe(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Hf(n);throw new pe(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Gu(n,e){if(!y1(n))throw new pe(ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const o=n[s];if(r&&typeof o!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${s}' field to equal '${i.value}'`;break}}if(t)throw new pe(ee.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw=-62135596800,uw=1e6;class Ce{static now(){return Ce.fromMillis(Date.now())}static fromDate(e){return Ce.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*uw);return new Ce(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new pe(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new pe(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<cw)throw new pe(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pe(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/uw}_compareTo(e){return this.seconds===e.seconds?Xe(this.nanoseconds,e.nanoseconds):Xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ce._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Gu(e,Ce._jsonSchema))return new Ce(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-cw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ce._jsonSchemaVersion="firestore/timestamp/1.0",Ce._jsonSchema={type:Qt("string",Ce._jsonSchemaVersion),seconds:Qt("number"),nanoseconds:Qt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new Ce(0,0))}static max(){return new Ve(new Ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _u=-1;function Nj(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=Ve.fromTimestamp(s===1e9?new Ce(t+1,0):new Ce(t,s));return new oa(r,Pe.empty(),e)}function Aj(n){return new oa(n.readTime,n.key,_u)}class oa{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new oa(Ve.min(),Pe.empty(),_u)}static max(){return new oa(Ve.max(),Pe.empty(),_u)}}function Sj(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Pe.comparator(n.documentKey,e.documentKey),t!==0?t:Xe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Cj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kl(n){if(n.code!==ee.FAILED_PRECONDITION||n.message!==Tj)throw n;ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Oe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new te(((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof te?t:te.resolve(t)}catch(t){return te.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):te.reject(t)}static resolve(e){return new te(((t,s)=>{t(e)}))}static reject(e){return new te(((t,s)=>{s(e)}))}static waitFor(e){return new te(((t,s)=>{let r=0,i=0,o=!1;e.forEach((u=>{++r,u.next((()=>{++i,o&&i===r&&t()}),(d=>s(d)))})),o=!0,i===r&&t()}))}static or(e){let t=te.resolve(!1);for(const s of e)t=t.next((r=>r?te.resolve(r):s()));return t}static forEach(e,t){const s=[];return e.forEach(((r,i)=>{s.push(t.call(this,r,i))})),this.waitFor(s)}static mapArray(e,t){return new te(((s,r)=>{const i=e.length,o=new Array(i);let u=0;for(let d=0;d<i;d++){const h=d;t(e[h]).next((p=>{o[h]=p,++u,u===i&&s(o)}),(p=>r(p)))}}))}static doWhile(e,t){return new te(((s,r)=>{const i=()=>{e()===!0?t().next((()=>{i()}),r):s()};i()}))}}function Ij(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Yl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0=-1;function Wf(n){return n==null}function mf(n){return n===0&&1/n==-1/0}function Pj(n){return typeof n=="number"&&Number.isInteger(n)&&!mf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1="";function jj(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=dw(e)),e=Rj(n.get(t),e);return dw(e)}function Rj(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="";break;case x1:t+="";break;default:t+=i}}return t}function dw(n){return n+x1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function b1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,t){this.comparator=e,this.root=t||gs.EMPTY}insert(e,t){return new St(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,gs.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sh(this.root,e,this.comparator,!0)}}class Sh{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gs{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??gs.RED,this.left=r??gs.EMPTY,this.right=i??gs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new gs(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return gs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return gs.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Oe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Oe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Oe(27949);return e+(this.isRed()?0:1)}}gs.EMPTY=null,gs.RED=!0,gs.BLACK=!1;gs.EMPTY=new class{constructor(){this.size=0}get key(){throw Oe(57766)}get value(){throw Oe(16141)}get color(){throw Oe(16727)}get left(){throw Oe(29726)}get right(){throw Oe(36894)}copy(e,t,s,r,i){return this}insert(e,t,s){return new gs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fw(this.data.getIterator())}getIteratorFrom(e){return new fw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof ss)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ss(this.comparator);return t.data=e,t}}class fw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(xs.comparator)}static empty(){return new fn([])}unionWith(e){let t=new ss(xs.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new fn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Rl(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new v1("Invalid base64 string: "+i):i}})(e);return new vs(t)}static fromUint8Array(e){const t=(function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i})(e);return new vs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vs.EMPTY_BYTE_STRING=new vs("");const Dj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function la(n){if(lt(!!n,39018),typeof n=="string"){let e=0;const t=Dj.exec(n);if(lt(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ca(n){return typeof n=="string"?vs.fromBase64String(n):vs.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1="server_timestamp",_1="__type__",k1="__previous_value__",E1="__local_write_time__";function q0(n){return(n?.mapValue?.fields||{})[_1]?.stringValue===w1}function Gf(n){const e=n.mapValue.fields[k1];return q0(e)?Gf(e):e}function ku(n){const e=la(n.mapValue.fields[E1].timestampValue);return new Ce(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(e,t,s,r,i,o,u,d,h,p){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=h,this.isUsingEmulator=p}}const gf="(default)";class Eu{constructor(e,t){this.projectId=e,this.database=t||gf}static empty(){return new Eu("","")}get isDefaultDatabase(){return this.database===gf}isEqual(e){return e instanceof Eu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N1="__type__",Lj="__max__",Th={mapValue:{}},A1="__vector__",yf="value";function ua(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?q0(n)?4:Fj(n)?9007199254740991:Oj(n)?10:11:Oe(28295,{value:n})}function Tr(n,e){if(n===e)return!0;const t=ua(n);if(t!==ua(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ku(n).isEqual(ku(e));case 3:return(function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=la(r.timestampValue),u=la(i.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,i){return ca(r.bytesValue).isEqual(ca(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,i){return Vt(r.geoPointValue.latitude)===Vt(i.geoPointValue.latitude)&&Vt(r.geoPointValue.longitude)===Vt(i.geoPointValue.longitude)})(n,e);case 2:return(function(r,i){if("integerValue"in r&&"integerValue"in i)return Vt(r.integerValue)===Vt(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=Vt(r.doubleValue),u=Vt(i.doubleValue);return o===u?mf(o)===mf(u):isNaN(o)&&isNaN(u)}return!1})(n,e);case 9:return Rl(n.arrayValue.values||[],e.arrayValue.values||[],Tr);case 10:case 11:return(function(r,i){const o=r.mapValue.fields||{},u=i.mapValue.fields||{};if(hw(o)!==hw(u))return!1;for(const d in o)if(o.hasOwnProperty(d)&&(u[d]===void 0||!Tr(o[d],u[d])))return!1;return!0})(n,e);default:return Oe(52216,{left:n})}}function Nu(n,e){return(n.values||[]).find((t=>Tr(t,e)))!==void 0}function Dl(n,e){if(n===e)return 0;const t=ua(n),s=ua(e);if(t!==s)return Xe(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Xe(n.booleanValue,e.booleanValue);case 2:return(function(i,o){const u=Vt(i.integerValue||i.doubleValue),d=Vt(o.integerValue||o.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1})(n,e);case 3:return pw(n.timestampValue,e.timestampValue);case 4:return pw(ku(n),ku(e));case 5:return Og(n.stringValue,e.stringValue);case 6:return(function(i,o){const u=ca(i),d=ca(o);return u.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(i,o){const u=i.split("/"),d=o.split("/");for(let h=0;h<u.length&&h<d.length;h++){const p=Xe(u[h],d[h]);if(p!==0)return p}return Xe(u.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,o){const u=Xe(Vt(i.latitude),Vt(o.latitude));return u!==0?u:Xe(Vt(i.longitude),Vt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return mw(n.arrayValue,e.arrayValue);case 10:return(function(i,o){const u=i.fields||{},d=o.fields||{},h=u[yf]?.arrayValue,p=d[yf]?.arrayValue,m=Xe(h?.values?.length||0,p?.values?.length||0);return m!==0?m:mw(h,p)})(n.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Th.mapValue&&o===Th.mapValue)return 0;if(i===Th.mapValue)return 1;if(o===Th.mapValue)return-1;const u=i.fields||{},d=Object.keys(u),h=o.fields||{},p=Object.keys(h);d.sort(),p.sort();for(let m=0;m<d.length&&m<p.length;++m){const x=Og(d[m],p[m]);if(x!==0)return x;const v=Dl(u[d[m]],h[p[m]]);if(v!==0)return v}return Xe(d.length,p.length)})(n.mapValue,e.mapValue);default:throw Oe(23264,{he:t})}}function pw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Xe(n,e);const t=la(n),s=la(e),r=Xe(t.seconds,s.seconds);return r!==0?r:Xe(t.nanos,s.nanos)}function mw(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=Dl(t[r],s[r]);if(i)return i}return Xe(t.length,s.length)}function Ml(n){return Fg(n)}function Fg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=la(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ca(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=Fg(i);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${Fg(t.fields[o])}`;return r+"}"})(n.mapValue):Oe(61005,{value:n})}function Zh(n){switch(ua(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Gf(n);return e?16+Zh(e):16;case 5:return 2*n.stringValue.length;case 6:return ca(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((r,i)=>r+Zh(i)),0)})(n.arrayValue);case 10:case 11:return(function(s){let r=0;return wa(s.fields,((i,o)=>{r+=i.length+Zh(o)})),r})(n.mapValue);default:throw Oe(13486,{value:n})}}function gw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Vg(n){return!!n&&"integerValue"in n}function W0(n){return!!n&&"arrayValue"in n}function yw(n){return!!n&&"nullValue"in n}function xw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ef(n){return!!n&&"mapValue"in n}function Oj(n){return(n?.mapValue?.fields||{})[N1]?.stringValue===A1}function hu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return wa(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=hu(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hu(n.arrayValue.values[t]);return e}return{...n}}function Fj(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Lj}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e){this.value=e}static empty(){return new Qs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!ef(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hu(t)}setAll(e){let t=xs.emptyPath(),s={},r=[];e.forEach(((o,u)=>{if(!t.isImmediateParentOf(u)){const d=this.getFieldsMap(t);this.applyChanges(d,s,r),s={},r=[],t=u.popLast()}o?s[u.lastSegment()]=hu(o):r.push(u.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());ef(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];ef(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){wa(t,((r,i)=>e[r]=i));for(const r of s)delete e[r]}clone(){return new Qs(hu(this.value))}}function S1(n){const e=[];return wa(n.fields,((t,s)=>{const r=new xs([t]);if(ef(s)){const i=S1(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)})),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,t,s,r,i,o,u){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=u}static newInvalidDocument(e){return new Ts(e,0,Ve.min(),Ve.min(),Ve.min(),Qs.empty(),0)}static newFoundDocument(e,t,s,r){return new Ts(e,1,t,Ve.min(),s,r,0)}static newNoDocument(e,t){return new Ts(e,2,t,Ve.min(),Ve.min(),Qs.empty(),0)}static newUnknownDocument(e,t){return new Ts(e,3,t,Ve.min(),Ve.min(),Qs.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ts&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ts(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e,t){this.position=e,this.inclusive=t}}function bw(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(i.field.isKeyField()?s=Pe.comparator(Pe.fromName(o.referenceValue),t.key):s=Dl(o,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function vw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Tr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,t="asc"){this.field=e,this.dir=t}}function Vj(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{}class Xt extends T1{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new Bj(e,t,s):t==="array-contains"?new Hj(e,s):t==="in"?new qj(e,s):t==="not-in"?new Wj(e,s):t==="array-contains-any"?new Gj(e,s):new Xt(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new zj(e,s):new $j(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Dl(t,this.value)):t!==null&&ua(this.value)===ua(t)&&this.matchesComparison(Dl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Oe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Xn extends T1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Xn(e,t)}matches(e){return C1(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function C1(n){return n.op==="and"}function I1(n){return Uj(n)&&C1(n)}function Uj(n){for(const e of n.filters)if(e instanceof Xn)return!1;return!0}function Ug(n){if(n instanceof Xt)return n.field.canonicalString()+n.op.toString()+Ml(n.value);if(I1(n))return n.filters.map((e=>Ug(e))).join(",");{const e=n.filters.map((t=>Ug(t))).join(",");return`${n.op}(${e})`}}function P1(n,e){return n instanceof Xt?(function(s,r){return r instanceof Xt&&s.op===r.op&&s.field.isEqual(r.field)&&Tr(s.value,r.value)})(n,e):n instanceof Xn?(function(s,r){return r instanceof Xn&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce(((i,o,u)=>i&&P1(o,r.filters[u])),!0):!1})(n,e):void Oe(19439)}function j1(n){return n instanceof Xt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ml(t.value)}`})(n):n instanceof Xn?(function(t){return t.op.toString()+" {"+t.getFilters().map(j1).join(" ,")+"}"})(n):"Filter"}class Bj extends Xt{constructor(e,t,s){super(e,t,s),this.key=Pe.fromName(s.referenceValue)}matches(e){const t=Pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class zj extends Xt{constructor(e,t){super(e,"in",t),this.keys=R1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class $j extends Xt{constructor(e,t){super(e,"not-in",t),this.keys=R1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function R1(n,e){return(e.arrayValue?.values||[]).map((t=>Pe.fromName(t.referenceValue)))}class Hj extends Xt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return W0(t)&&Nu(t.arrayValue,this.value)}}class qj extends Xt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Nu(this.value.arrayValue,t)}}class Wj extends Xt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Nu(this.value.arrayValue,t)}}class Gj extends Xt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!W0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Nu(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{constructor(e,t=null,s=[],r=[],i=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=u,this.Te=null}}function ww(n,e=null,t=[],s=[],r=null,i=null,o=null){return new Kj(n,e,t,s,r,i,o)}function G0(n){const e=He(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Ug(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(i){return i.field.canonicalString()+i.dir})(s))).join(","),Wf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Ml(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Ml(s))).join(",")),e.Te=t}return e.Te}function K0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Vj(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!P1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!vw(n.startAt,e.startAt)&&vw(n.endAt,e.endAt)}function Bg(n){return Pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,t=null,s=[],r=[],i=null,o="F",u=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Yj(n,e,t,s,r,i,o,u){return new Xl(n,e,t,s,r,i,o,u)}function Y0(n){return new Xl(n)}function _w(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function D1(n){return n.collectionGroup!==null}function fu(n){const e=He(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new ss(xs.comparator);return o.filters.forEach((d=>{d.getFlattenedFilters().forEach((h=>{h.isInequality()&&(u=u.add(h.field))}))})),u})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Au(i,s))})),t.has(xs.keyField().canonicalString())||e.Ie.push(new Au(xs.keyField(),s))}return e.Ie}function Er(n){const e=He(n);return e.Ee||(e.Ee=Xj(e,fu(n))),e.Ee}function Xj(n,e){if(n.limitType==="F")return ww(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const i=r.dir==="desc"?"asc":"desc";return new Au(r.field,i)}));const t=n.endAt?new xf(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new xf(n.startAt.position,n.startAt.inclusive):null;return ww(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function zg(n,e){const t=n.filters.concat([e]);return new Xl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function $g(n,e,t){return new Xl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Kf(n,e){return K0(Er(n),Er(e))&&n.limitType===e.limitType}function M1(n){return`${G0(Er(n))}|lt:${n.limitType}`}function hl(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((r=>j1(r))).join(", ")}]`),Wf(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((r=>Ml(r))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((r=>Ml(r))).join(",")),`Target(${s})`})(Er(n))}; limitType=${n.limitType})`}function Yf(n,e){return e.isFoundDocument()&&(function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):Pe.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)})(n,e)&&(function(s,r){for(const i of fu(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0})(n,e)&&(function(s,r){return!(s.startAt&&!(function(o,u,d){const h=bw(o,u,d);return o.inclusive?h<=0:h<0})(s.startAt,fu(s),r)||s.endAt&&!(function(o,u,d){const h=bw(o,u,d);return o.inclusive?h>=0:h>0})(s.endAt,fu(s),r))})(n,e)}function Qj(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function L1(n){return(e,t)=>{let s=!1;for(const r of fu(n)){const i=Jj(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function Jj(n,e,t){const s=n.field.isKeyField()?Pe.comparator(e.key,t.key):(function(i,o,u){const d=o.data.field(i),h=u.data.field(i);return d!==null&&h!==null?Dl(d,h):Oe(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Oe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){wa(this.inner,((t,s)=>{for(const[r,i]of s)e(r,i)}))}isEmpty(){return b1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zj=new St(Pe.comparator);function li(){return Zj}const O1=new St(Pe.comparator);function iu(...n){let e=O1;for(const t of n)e=e.insert(t.key,t);return e}function F1(n){let e=O1;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function eo(){return pu()}function V1(){return pu()}function pu(){return new yo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const eR=new St(Pe.comparator),tR=new ss(Pe.comparator);function Qe(...n){let e=tR;for(const t of n)e=e.add(t);return e}const sR=new ss(Xe);function nR(){return sR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mf(e)?"-0":e}}function U1(n){return{integerValue:""+n}}function rR(n,e){return Pj(e)?U1(e):X0(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(){this._=void 0}}function iR(n,e,t){return n instanceof bf?(function(r,i){const o={fields:{[_1]:{stringValue:w1},[E1]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&q0(i)&&(i=Gf(i)),i&&(o.fields[k1]=i),{mapValue:o}})(t,e):n instanceof Su?z1(n,e):n instanceof Tu?$1(n,e):(function(r,i){const o=B1(r,i),u=kw(o)+kw(r.Ae);return Vg(o)&&Vg(r.Ae)?U1(u):X0(r.serializer,u)})(n,e)}function aR(n,e,t){return n instanceof Su?z1(n,e):n instanceof Tu?$1(n,e):t}function B1(n,e){return n instanceof vf?(function(s){return Vg(s)||(function(i){return!!i&&"doubleValue"in i})(s)})(e)?e:{integerValue:0}:null}class bf extends Xf{}class Su extends Xf{constructor(e){super(),this.elements=e}}function z1(n,e){const t=H1(e);for(const s of n.elements)t.some((r=>Tr(r,s)))||t.push(s);return{arrayValue:{values:t}}}class Tu extends Xf{constructor(e){super(),this.elements=e}}function $1(n,e){let t=H1(e);for(const s of n.elements)t=t.filter((r=>!Tr(r,s)));return{arrayValue:{values:t}}}class vf extends Xf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kw(n){return Vt(n.integerValue||n.doubleValue)}function H1(n){return W0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function oR(n,e){return n.field.isEqual(e.field)&&(function(s,r){return s instanceof Su&&r instanceof Su||s instanceof Tu&&r instanceof Tu?Rl(s.elements,r.elements,Tr):s instanceof vf&&r instanceof vf?Tr(s.Ae,r.Ae):s instanceof bf&&r instanceof bf})(n.transform,e.transform)}class lR{constructor(e,t){this.version=e,this.transformResults=t}}class In{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new In}static exists(e){return new In(void 0,e)}static updateTime(e){return new In(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function tf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Qf{}function q1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Q0(n.key,In.none()):new Ku(n.key,n.data,In.none());{const t=n.data,s=Qs.empty();let r=new ss(xs.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new _a(n.key,s,new fn(r.toArray()),In.none())}}function cR(n,e,t){n instanceof Ku?(function(r,i,o){const u=r.value.clone(),d=Nw(r.fieldTransforms,i,o.transformResults);u.setAll(d),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):n instanceof _a?(function(r,i,o){if(!tf(r.precondition,i))return void i.convertToUnknownDocument(o.version);const u=Nw(r.fieldTransforms,i,o.transformResults),d=i.data;d.setAll(W1(r)),d.setAll(u),i.convertToFoundDocument(o.version,d).setHasCommittedMutations()})(n,e,t):(function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function mu(n,e,t,s){return n instanceof Ku?(function(i,o,u,d){if(!tf(i.precondition,o))return u;const h=i.value.clone(),p=Aw(i.fieldTransforms,d,o);return h.setAll(p),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,s):n instanceof _a?(function(i,o,u,d){if(!tf(i.precondition,o))return u;const h=Aw(i.fieldTransforms,d,o),p=o.data;return p.setAll(W1(i)),p.setAll(h),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),u===null?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((m=>m.field)))})(n,e,t,s):(function(i,o,u){return tf(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u})(n,e,t)}function uR(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=B1(s.transform,r||null);i!=null&&(t===null&&(t=Qs.empty()),t.set(s.field,i))}return t||null}function Ew(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&Rl(s,r,((i,o)=>oR(i,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ku extends Qf{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class _a extends Qf{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function W1(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function Nw(n,e,t){const s=new Map;lt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,u=e.data.field(i.field);s.set(i.field,aR(o,u,t[r]))}return s}function Aw(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,iR(i,o,e))}return s}class Q0 extends Qf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dR extends Qf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&cR(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=mu(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=mu(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=V1();return this.mutations.forEach((r=>{const i=e.get(r.key),o=i.overlayedDocument;let u=this.applyToLocalView(o,i.mutatedFields);u=t.has(r.key)?null:u;const d=q1(o,u);d!==null&&s.set(r.key,d),o.isValidDocument()||o.convertToNoDocument(Ve.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Qe())}isEqual(e){return this.batchId===e.batchId&&Rl(this.mutations,e.mutations,((t,s)=>Ew(t,s)))&&Rl(this.baseMutations,e.baseMutations,((t,s)=>Ew(t,s)))}}class J0{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){lt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=(function(){return eR})();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new J0(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yt,tt;function mR(n){switch(n){case ee.OK:return Oe(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return Oe(15467,{code:n})}}function G1(n){if(n===void 0)return oi("GRPC error has no .code"),ee.UNKNOWN;switch(n){case Yt.OK:return ee.OK;case Yt.CANCELLED:return ee.CANCELLED;case Yt.UNKNOWN:return ee.UNKNOWN;case Yt.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case Yt.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case Yt.INTERNAL:return ee.INTERNAL;case Yt.UNAVAILABLE:return ee.UNAVAILABLE;case Yt.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case Yt.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case Yt.NOT_FOUND:return ee.NOT_FOUND;case Yt.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case Yt.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case Yt.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case Yt.ABORTED:return ee.ABORTED;case Yt.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case Yt.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case Yt.DATA_LOSS:return ee.DATA_LOSS;default:return Oe(39323,{code:n})}}(tt=Yt||(Yt={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR=new na([4294967295,4294967295],0);function Sw(n){const e=gR().encode(n),t=new l1;return t.update(e),new Uint8Array(t.digest())}function Tw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new na([t,s],0),new na([r,i],0)]}class Z0{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new au(`Invalid padding: ${t}`);if(s<0)throw new au(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new au(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new au(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=na.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply(na.fromNumber(s)));return r.compare(yR)===1&&(r=new na([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Sw(e),[s,r]=Tw(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Z0(i,r,t);return s.forEach((u=>o.insert(u))),o}insert(e){if(this.ge===0)return;const t=Sw(e),[s,r]=Tw(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class au extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,Yu.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Jf(Ve.min(),r,new St(Xe),li(),Qe())}}class Yu{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Yu(s,t,Qe(),Qe(),Qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class K1{constructor(e,t){this.targetId=e,this.Ce=t}}class Y1{constructor(e,t,s=vs.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class Cw{constructor(){this.ve=0,this.Fe=Iw(),this.Me=vs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Qe(),t=Qe(),s=Qe();return this.Fe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:Oe(38017,{changeType:i})}})),new Yu(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=Iw()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class xR{constructor(e){this.Ge=e,this.ze=new Map,this.je=li(),this.Je=Ch(),this.He=Ch(),this.Ye=new St(Xe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Oe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(Bg(i))if(s===0){const o=new Pe(i.path);this.et(t,o,Ts.newNoDocument(o,Ve.min()))}else lt(s===1,20013,{expectedCount:s});else{const o=this._t(t);if(o!==s){const u=this.ut(e),d=u?this.ct(u,e,o):1;if(d!==0){this.it(t);const h=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let o,u;try{o=ca(s).toUint8Array()}catch(d){if(d instanceof v1)return jl("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new Z0(o,r,i)}catch(d){return jl(d instanceof au?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.ge===0?null:u}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach((i=>{const o=this.Ge.ht(),u=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(u)||(this.et(t,i,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((i,o)=>{const u=this.ot(o);if(u){if(i.current&&Bg(u.target)){const d=new Pe(u.target.path);this.It(d).has(o)||this.Et(o,d)||this.et(o,d,Ts.newNoDocument(d,e))}i.Be&&(t.set(o,i.ke()),i.qe())}}));let s=Qe();this.He.forEach(((i,o)=>{let u=!0;o.forEachWhile((d=>{const h=this.ot(d);return!h||h.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(s=s.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const r=new Jf(e,t,this.Ye,this.je,s);return this.je=li(),this.Je=Ch(),this.He=Ch(),this.Ye=new St(Xe),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Cw,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ss(Xe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ss(Xe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ge("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Cw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ch(){return new St(Pe.comparator)}function Iw(){return new St(Pe.comparator)}const bR={asc:"ASCENDING",desc:"DESCENDING"},vR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wR={and:"AND",or:"OR"};class _R{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Hg(n,e){return n.useProto3Json||Wf(e)?e:{value:e}}function wf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function X1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function kR(n,e){return wf(n,e.toTimestamp())}function Nr(n){return lt(!!n,49232),Ve.fromTimestamp((function(t){const s=la(t);return new Ce(s.seconds,s.nanos)})(n))}function ey(n,e){return qg(n,e).canonicalString()}function qg(n,e){const t=(function(r){return new mt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Q1(n){const e=mt.fromString(n);return lt(sE(e),10190,{key:e.toString()}),e}function Wg(n,e){return ey(n.databaseId,e.path)}function ag(n,e){const t=Q1(e);if(t.get(1)!==n.databaseId.projectId)throw new pe(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new pe(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Pe(Z1(t))}function J1(n,e){return ey(n.databaseId,e)}function ER(n){const e=Q1(n);return e.length===4?mt.emptyPath():Z1(e)}function Gg(n){return new mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Z1(n){return lt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Pw(n,e,t){return{name:Wg(n,e),fields:t.value.mapValue.fields}}function NR(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Oe(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=(function(h,p){return h.useProto3Json?(lt(p===void 0||typeof p=="string",58123),vs.fromBase64String(p||"")):(lt(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),vs.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&(function(h){const p=h.code===void 0?ee.UNKNOWN:G1(h.code);return new pe(p,h.message||"")})(o);t=new Y1(s,r,i,u||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=ag(n,s.document.name),i=Nr(s.document.updateTime),o=s.document.createTime?Nr(s.document.createTime):Ve.min(),u=new Qs({mapValue:{fields:s.document.fields}}),d=Ts.newFoundDocument(r,i,o,u),h=s.targetIds||[],p=s.removedTargetIds||[];t=new sf(h,p,d.key,d)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=ag(n,s.document),i=s.readTime?Nr(s.readTime):Ve.min(),o=Ts.newNoDocument(r,i),u=s.removedTargetIds||[];t=new sf([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=ag(n,s.document),i=s.removedTargetIds||[];t=new sf([],i,r,null)}else{if(!("filter"in e))return Oe(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new pR(r,i),u=s.targetId;t=new K1(u,o)}}return t}function AR(n,e){let t;if(e instanceof Ku)t={update:Pw(n,e.key,e.value)};else if(e instanceof Q0)t={delete:Wg(n,e.key)};else if(e instanceof _a)t={update:Pw(n,e.key,e.data),updateMask:MR(e.fieldMask)};else{if(!(e instanceof dR))return Oe(16599,{Vt:e.type});t={verify:Wg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(i,o){const u=o.transform;if(u instanceof bf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Su)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Tu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof vf)return{fieldPath:o.field.canonicalString(),increment:u.Ae};throw Oe(20930,{transform:o.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(r,i){return i.updateTime!==void 0?{updateTime:kR(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Oe(27497)})(n,e.precondition)),t}function SR(n,e){return n&&n.length>0?(lt(e!==void 0,14353),n.map((t=>(function(r,i){let o=r.updateTime?Nr(r.updateTime):Nr(i);return o.isEqual(Ve.min())&&(o=Nr(i)),new lR(o,r.transformResults||[])})(t,e)))):[]}function TR(n,e){return{documents:[J1(n,e.path)]}}function CR(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=J1(n,r);const i=(function(h){if(h.length!==0)return tE(Xn.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const o=(function(h){if(h.length!==0)return h.map((p=>(function(x){return{field:fl(x.field),direction:jR(x.dir)}})(p)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const u=Hg(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function IR(n){let e=ER(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){lt(s===1,65062);const p=t.from[0];p.allDescendants?r=p.collectionId:e=e.child(p.collectionId)}let i=[];t.where&&(i=(function(m){const x=eE(m);return x instanceof Xn&&I1(x)?x.getFilters():[x]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map((x=>(function(w){return new Au(pl(w.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(x)))})(t.orderBy));let u=null;t.limit&&(u=(function(m){let x;return x=typeof m=="object"?m.value:m,Wf(x)?null:x})(t.limit));let d=null;t.startAt&&(d=(function(m){const x=!!m.before,v=m.values||[];return new xf(v,x)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const x=!m.before,v=m.values||[];return new xf(v,x)})(t.endAt)),Yj(e,r,o,i,u,"F",d,h)}function PR(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Oe(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function eE(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=pl(t.unaryFilter.field);return Xt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=pl(t.unaryFilter.field);return Xt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=pl(t.unaryFilter.field);return Xt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=pl(t.unaryFilter.field);return Xt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Oe(61313);default:return Oe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Xt.create(pl(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Oe(58110);default:return Oe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Xn.create(t.compositeFilter.filters.map((s=>eE(s))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Oe(1026)}})(t.compositeFilter.op))})(n):Oe(30097,{filter:n})}function jR(n){return bR[n]}function RR(n){return vR[n]}function DR(n){return wR[n]}function fl(n){return{fieldPath:n.canonicalString()}}function pl(n){return xs.fromServerFormat(n.fieldPath)}function tE(n){return n instanceof Xt?(function(t){if(t.op==="=="){if(xw(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NAN"}};if(yw(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(xw(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NOT_NAN"}};if(yw(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fl(t.field),op:RR(t.op),value:t.value}}})(n):n instanceof Xn?(function(t){const s=t.getFilters().map((r=>tE(r)));return s.length===1?s[0]:{compositeFilter:{op:DR(t.op),filters:s}}})(n):Oe(54877,{filter:n})}function MR(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function sE(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,t,s,r,i=Ve.min(),o=Ve.min(),u=vs.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e){this.yt=e}}function OR(n){const e=IR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?$g(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(){this.Cn=new VR}addToCollectionParentIndex(e,t){return this.Cn.add(t),te.resolve()}getCollectionParents(e,t){return te.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return te.resolve()}deleteFieldIndex(e,t){return te.resolve()}deleteAllFieldIndexes(e){return te.resolve()}createTargetIndexes(e,t){return te.resolve()}getDocumentsMatchingTarget(e,t){return te.resolve(null)}getIndexType(e,t){return te.resolve(0)}getFieldIndexes(e,t){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,t){return te.resolve(oa.min())}getMinOffsetFromCollectionGroup(e,t){return te.resolve(oa.min())}updateCollectionGroup(e,t,s){return te.resolve()}updateIndexEntries(e,t){return te.resolve()}}class VR{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new ss(mt.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new ss(mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},nE=41943040;class Ys{static withCacheSize(e){return new Ys(e,Ys.DEFAULT_COLLECTION_PERCENTILE,Ys.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ys.DEFAULT_COLLECTION_PERCENTILE=10,Ys.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ys.DEFAULT=new Ys(nE,Ys.DEFAULT_COLLECTION_PERCENTILE,Ys.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ys.DISABLED=new Ys(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ll(0)}static cr(){return new Ll(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="LruGarbageCollector",UR=1048576;function Dw([n,e],[t,s]){const r=Xe(n,t);return r===0?Xe(e,s):r}class BR{constructor(e){this.Ir=e,this.buffer=new ss(Dw),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Dw(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class zR{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ge(Rw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Yl(t)?ge(Rw,"Ignoring IndexedDB error during garbage collection: ",t):await Kl(t)}await this.Vr(3e5)}))}}class $R{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return te.resolve(qf.ce);const s=new BR(t);return this.mr.forEachTarget(e,(r=>s.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>s.Ar(r))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ge("LruGarbageCollector","Garbage collection skipped; disabled"),te.resolve(jw)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jw):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,i,o,u,d,h;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,o=Date.now(),this.nthSequenceNumber(e,r)))).next((m=>(s=m,u=Date.now(),this.removeTargets(e,s,t)))).next((m=>(i=m,d=Date.now(),this.removeOrphanedDocuments(e,s)))).next((m=>(h=Date.now(),dl()<=Ye.DEBUG&&ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-p}ms
	Determined least recently used ${r} in `+(u-o)+`ms
	Removed ${i} targets in `+(d-u)+`ms
	Removed ${m} documents in `+(h-d)+`ms
Total Duration: ${h-p}ms`),te.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:m}))))}}function HR(n,e){return new $R(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(){this.changes=new yo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ts.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?te.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(s=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(s!==null&&mu(s.mutation,r,fn.empty(),Ce.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,Qe()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=Qe()){const r=eo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,s).next((i=>{let o=iu();return i.forEach(((u,d)=>{o=o.insert(u,d.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const s=eo();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,Qe())))}populateOverlays(e,t,s){const r=[];return s.forEach((i=>{t.has(i)||r.push(i)})),this.documentOverlayCache.getOverlays(e,r).next((i=>{i.forEach(((o,u)=>{t.set(o,u)}))}))}computeViews(e,t,s,r){let i=li();const o=pu(),u=(function(){return pu()})();return t.forEach(((d,h)=>{const p=s.get(h.key);r.has(h.key)&&(p===void 0||p.mutation instanceof _a)?i=i.insert(h.key,h):p!==void 0?(o.set(h.key,p.mutation.getFieldMask()),mu(p.mutation,h,p.mutation.getFieldMask(),Ce.now())):o.set(h.key,fn.empty())})),this.recalculateAndSaveOverlays(e,i).next((d=>(d.forEach(((h,p)=>o.set(h,p))),t.forEach(((h,p)=>u.set(h,new WR(p,o.get(h)??null)))),u)))}recalculateAndSaveOverlays(e,t){const s=pu();let r=new St(((o,u)=>o-u)),i=Qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const u of o)u.keys().forEach((d=>{const h=t.get(d);if(h===null)return;let p=s.get(d)||fn.empty();p=u.applyToLocalView(h,p),s.set(d,p);const m=(r.get(u.batchId)||Qe()).add(d);r=r.insert(u.batchId,m)}))})).next((()=>{const o=[],u=r.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),h=d.key,p=d.value,m=V1();p.forEach((x=>{if(!i.has(x)){const v=q1(t.get(x),s.get(x));v!==null&&m.set(x,v),i=i.add(x)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return te.waitFor(o)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,r){return(function(o){return Pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):D1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next((i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):te.resolve(eo());let u=_u,d=i;return o.next((h=>te.forEach(h,((p,m)=>(u<m.largestBatchId&&(u=m.largestBatchId),i.get(p)?te.resolve():this.remoteDocumentCache.getEntry(e,p).next((x=>{d=d.insert(p,x)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,d,h,Qe()))).next((p=>({batchId:u,changes:F1(p)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Pe(t)).next((s=>{let r=iu();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let o=iu();return this.indexManager.getCollectionParents(e,i).next((u=>te.forEach(u,(d=>{const h=(function(m,x){return new Xl(x,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,d.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,s,r).next((p=>{p.forEach(((m,x)=>{o=o.insert(m,x)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r)))).next((o=>{i.forEach(((d,h)=>{const p=h.getKey();o.get(p)===null&&(o=o.insert(p,Ts.newInvalidDocument(p)))}));let u=iu();return o.forEach(((d,h)=>{const p=i.get(d);p!==void 0&&mu(p.mutation,h,fn.empty(),Ce.now()),Yf(t,h)&&(u=u.insert(d,h))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return te.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Nr(r.createTime)}})(t)),te.resolve()}getNamedQuery(e,t){return te.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:OR(r.bundledQuery),readTime:Nr(r.readTime)}})(t)),te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(){this.overlays=new St(Pe.comparator),this.qr=new Map}getOverlay(e,t){return te.resolve(this.overlays.get(t))}getOverlays(e,t){const s=eo();return te.forEach(t,(r=>this.getOverlay(e,r).next((i=>{i!==null&&s.set(r,i)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((r,i)=>{this.St(e,t,i)})),te.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(s)),te.resolve()}getOverlaysForCollection(e,t,s){const r=eo(),i=t.length+1,o=new Pe(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const d=u.getNext().value,h=d.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&d.largestBatchId>s&&r.set(d.getKey(),d)}return te.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new St(((h,p)=>h-p));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>s){let p=i.get(h.largestBatchId);p===null&&(p=eo(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const u=eo(),d=i.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((h,p)=>u.set(h,p))),!(u.size()>=r)););return te.resolve(u)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new fR(t,s));let i=this.qr.get(t);i===void 0&&(i=Qe(),this.qr.set(t,i)),this.qr.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(){this.sessionToken=vs.EMPTY_BYTE_STRING}getSessionToken(e){return te.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(){this.Qr=new ss(ls.$r),this.Ur=new ss(ls.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new ls(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new ls(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new Pe(new mt([])),s=new ls(t,e),r=new ls(t,e+1),i=[];return this.Ur.forEachInRange([s,r],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Pe(new mt([])),s=new ls(t,e),r=new ls(t,e+1);let i=Qe();return this.Ur.forEachInRange([s,r],(o=>{i=i.add(o.key)})),i}containsKey(e){const t=new ls(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class ls{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Pe.comparator(e.key,t.key)||Xe(e.Yr,t.Yr)}static Kr(e,t){return Xe(e.Yr,t.Yr)||Pe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ss(ls.$r)}checkEmpty(e){return te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new hR(i,t,s,r);this.mutationQueue.push(o);for(const u of r)this.Zr=this.Zr.add(new ls(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return te.resolve(o)}lookupMutationBatch(e,t){return te.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),i=r<0?0:r;return te.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(this.mutationQueue.length===0?H0:this.tr-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new ls(t,0),r=new ls(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],(o=>{const u=this.Xr(o.Yr);i.push(u)})),te.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new ss(Xe);return t.forEach((r=>{const i=new ls(r,0),o=new ls(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(u=>{s=s.add(u.Yr)}))})),te.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;Pe.isDocumentKey(i)||(i=i.child(""));const o=new ls(new Pe(i),0);let u=new ss(Xe);return this.Zr.forEachWhile((d=>{const h=d.key.path;return!!s.isPrefixOf(h)&&(h.length===r&&(u=u.add(d.Yr)),!0)}),o),te.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((s=>{const r=this.Xr(s);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){lt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return te.forEach(t.mutations,(r=>{const i=new ls(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new ls(t,0),r=this.Zr.firstAfterOrEqual(s);return te.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,te.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e){this.ri=e,this.docs=(function(){return new St(Pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return te.resolve(s?s.document.mutableCopy():Ts.newInvalidDocument(t))}getEntries(e,t){let s=li();return t.forEach((r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():Ts.newInvalidDocument(r))})),te.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=li();const o=t.path,u=new Pe(o.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:h,value:{document:p}}=d.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Sj(Aj(p),s)<=0||(r.has(p.key)||Yf(t,p))&&(i=i.insert(p.key,p.mutableCopy()))}return te.resolve(i)}getAllFromCollectionGroup(e,t,s,r){Oe(9500)}ii(e,t){return te.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new ZR(this)}getSize(e){return te.resolve(this.size)}}class ZR extends qR{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)})),te.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(e){this.persistence=e,this.si=new yo((t=>G0(t)),K0),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new ty,this.targetCount=0,this.ai=Ll.ur()}forEachTarget(e,t){return this.si.forEach(((s,r)=>t(r))),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),te.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ll(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,te.resolve()}updateTargetData(e,t){return this.Pr(t),te.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.si.forEach(((o,u)=>{u.sequenceNumber<=t&&s.get(u.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,u.targetId)),r++)})),te.waitFor(i).next((()=>r))}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return te.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),te.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((o=>{i.push(r.markPotentiallyOrphaned(e,o))})),te.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),te.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return te.resolve(s)}containsKey(e,t){return te.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e,t){this.ui={},this.overlays={},this.ci=new qf(0),this.li=!1,this.li=!0,this.hi=new XR,this.referenceDelegate=e(this),this.Pi=new eD(this),this.indexManager=new FR,this.remoteDocumentCache=(function(r){return new JR(r)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new LR(t),this.Ii=new KR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new YR,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new QR(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){ge("MemoryPersistence","Starting transaction:",e);const r=new tD(this.ci.next());return this.referenceDelegate.Ei(),s(r).next((i=>this.referenceDelegate.di(r).next((()=>i)))).toPromise().then((i=>(r.raiseOnCommittedEvent(),i)))}Ai(e,t){return te.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class tD extends Cj{constructor(e){super(),this.currentSequenceNumber=e}}class sy{constructor(e){this.persistence=e,this.Ri=new ty,this.Vi=null}static mi(e){return new sy(e)}get fi(){if(this.Vi)return this.Vi;throw Oe(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),te.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),te.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),te.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((i=>this.fi.add(i.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.fi,(s=>{const r=Pe.fromPath(s);return this.gi(e,r).next((i=>{i||t.removeEntry(r,Ve.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return te.or([()=>te.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class _f{constructor(e,t){this.persistence=e,this.pi=new yo((s=>jj(s.path)),((s,r)=>s.isEqual(r))),this.garbageCollector=HR(this,t)}static mi(e,t){return new _f(e,t)}Ei(){}di(e){return te.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((r=>s+r))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return te.forEach(this.pi,((s,r)=>this.br(e,s,r).next((i=>i?te.resolve():t(r)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,(o=>this.br(e,o,t).next((u=>{u||(s++,i.removeEntry(o,Ve.min()))})))).next((()=>i.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),te.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),te.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),te.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),te.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Zh(e.data.value)),t}br(e,t,s){return te.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return te.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=Qe(),r=Qe();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new ny(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return RC()?8:Ij(Ps())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.ys(e,t).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,t,r,s).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new sD;return this.Ss(e,t,o).next((u=>{if(i.result=u,this.Vs)return this.bs(e,t,o,u.size)}))})).next((()=>i.result))}bs(e,t,s,r){return s.documentReadCount<this.fs?(dl()<=Ye.DEBUG&&ge("QueryEngine","SDK will not create cache indexes for query:",hl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),te.resolve()):(dl()<=Ye.DEBUG&&ge("QueryEngine","Query:",hl(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(dl()<=Ye.DEBUG&&ge("QueryEngine","The SDK decides to create cache indexes for query:",hl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Er(t))):te.resolve())}ys(e,t){if(_w(t))return te.resolve(null);let s=Er(t);return this.indexManager.getIndexType(e,s).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=$g(t,null,"F"),s=Er(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((i=>{const o=Qe(...i);return this.ps.getDocuments(e,o).next((u=>this.indexManager.getMinOffset(e,s).next((d=>{const h=this.Ds(t,u);return this.Cs(t,h,o,d.readTime)?this.ys(e,$g(t,null,"F")):this.vs(e,h,t,d)}))))})))))}ws(e,t,s,r){return _w(t)||r.isEqual(Ve.min())?te.resolve(null):this.ps.getDocuments(e,s).next((i=>{const o=this.Ds(t,i);return this.Cs(t,o,s,r)?te.resolve(null):(dl()<=Ye.DEBUG&&ge("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),hl(t)),this.vs(e,o,t,Nj(r,_u)).next((u=>u)))}))}Ds(e,t){let s=new ss(L1(e));return t.forEach(((r,i)=>{Yf(e,i)&&(s=s.add(i))})),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,s){return dl()<=Ye.DEBUG&&ge("QueryEngine","Using full collection scan to execute query:",hl(t)),this.ps.getDocumentsMatchingQuery(e,t,oa.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next((i=>(t.forEach((o=>{i=i.insert(o.key,o)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ry="LocalStore",rD=3e8;class iD{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new St(Xe),this.xs=new yo((i=>G0(i)),K0),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new GR(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function aD(n,e,t,s){return new iD(n,e,t,s)}async function iE(n,e){const t=He(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next((i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((i=>{const o=[],u=[];let d=Qe();for(const h of r){o.push(h.batchId);for(const p of h.mutations)d=d.add(p.key)}for(const h of i){u.push(h.batchId);for(const p of h.mutations)d=d.add(p.key)}return t.localDocuments.getDocuments(s,d).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:u})))}))}))}function oD(n,e){const t=He(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,d,h,p){const m=h.batch,x=m.keys();let v=te.resolve();return x.forEach((w=>{v=v.next((()=>p.getEntry(d,w))).next((E=>{const N=h.docVersions.get(w);lt(N!==null,48541),E.version.compareTo(N)<0&&(m.applyToRemoteDocument(E,h),E.isValidDocument()&&(E.setReadTime(h.commitVersion),p.addEntry(E)))}))})),v.next((()=>u.mutationQueue.removeMutationBatch(d,m)))})(t,s,e,i).next((()=>i.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(u){let d=Qe();for(let h=0;h<u.mutationResults.length;++h)u.mutationResults[h].transformResults.length>0&&(d=d.add(u.batch.mutations[h].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(s,r)))}))}function aE(n){const e=He(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function lD(n,e){const t=He(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const u=[];e.targetChanges.forEach(((p,m)=>{const x=r.get(m);if(!x)return;u.push(t.Pi.removeMatchingKeys(i,p.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(i,p.addedDocuments,m))));let v=x.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(vs.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):p.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(p.resumeToken,s)),r=r.insert(m,v),(function(E,N,A){return E.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=rD?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0})(x,v,p)&&u.push(t.Pi.updateTargetData(i,v))}));let d=li(),h=Qe();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(i,p))})),u.push(cD(i,o,e.documentUpdates).next((p=>{d=p.ks,h=p.qs}))),!s.isEqual(Ve.min())){const p=t.Pi.getLastRemoteSnapshotVersion(i).next((m=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s)));u.push(p)}return te.waitFor(u).next((()=>o.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,d,h))).next((()=>d))})).then((i=>(t.Ms=r,i)))}function cD(n,e,t){let s=Qe(),r=Qe();return t.forEach((i=>s=s.add(i))),e.getEntries(n,s).next((i=>{let o=li();return t.forEach(((u,d)=>{const h=i.get(u);d.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(u)),d.isNoDocument()&&d.version.isEqual(Ve.min())?(e.removeEntry(u,d.readTime),o=o.insert(u,d)):!h.isValidDocument()||d.version.compareTo(h.version)>0||d.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(d),o=o.insert(u,d)):ge(ry,"Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",d.version)})),{ks:o,qs:r}}))}function uD(n,e){const t=He(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=H0),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function dD(n,e){const t=He(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let r;return t.Pi.getTargetData(s,e).next((i=>i?(r=i,te.resolve(r)):t.Pi.allocateTargetId(s).next((o=>(r=new Zi(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next((()=>r)))))))})).then((s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function Kg(n,e,t){const s=He(n),r=s.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,(o=>s.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Yl(o))throw o;ge(ry,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function Mw(n,e,t){const s=He(n);let r=Ve.min(),i=Qe();return s.persistence.runTransaction("Execute query","readwrite",(o=>(function(d,h,p){const m=He(d),x=m.xs.get(p);return x!==void 0?te.resolve(m.Ms.get(x)):m.Pi.getTargetData(h,p)})(s,o,Er(e)).next((u=>{if(u)return r=u.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,u.targetId).next((d=>{i=d}))})).next((()=>s.Fs.getDocumentsMatchingQuery(o,e,t?r:Ve.min(),t?i:Qe()))).next((u=>(hD(s,Qj(e),u),{documents:u,Qs:i})))))}function hD(n,e,t){let s=n.Os.get(e)||Ve.min();t.forEach(((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)})),n.Os.set(e,s)}class Lw{constructor(){this.activeTargetIds=nR()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fD{constructor(){this.Mo=new Lw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Lw,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow="ConnectivityMonitor";class Fw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ge(Ow,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ge(Ow,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ih=null;function Yg(){return Ih===null?Ih=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ih++,"0x"+Ih.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og="RestConnection",mD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gD{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===gf?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,i){const o=Yg(),u=this.zo(e,t.toUriEncodedString());ge(og,`Sending RPC '${e}' ${o}:`,u,s);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,r,i);const{host:h}=new URL(u),p=Ir(h);return this.Jo(e,u,d,s,p).then((m=>(ge(og,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw jl(og,`RPC '${e}' ${o} failed with error: `,m,"url: ",u,"request:",s),m}))}Ho(e,t,s,r,i,o){return this.Go(e,t,s,r,i)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Gl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,i)=>e[i]=r)),s&&s.headers.forEach(((r,i)=>e[i]=r))}zo(e,t){const s=mD[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const As="WebChannelConnection";class xD extends gD{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,i){const o=Yg();return new Promise(((u,d)=>{const h=new c1;h.setWithCredentials(!0),h.listenOnce(u1.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Jh.NO_ERROR:const m=h.getResponseJson();ge(As,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),u(m);break;case Jh.TIMEOUT:ge(As,`RPC '${e}' ${o} timed out`),d(new pe(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Jh.HTTP_ERROR:const x=h.getStatus();if(ge(As,`RPC '${e}' ${o} failed with status:`,x,"response text:",h.getResponseText()),x>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const w=v?.error;if(w&&w.status&&w.message){const E=(function(A){const T=A.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(T)>=0?T:ee.UNKNOWN})(w.status);d(new pe(E,w.message))}else d(new pe(ee.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new pe(ee.UNAVAILABLE,"Connection failed."));break;default:Oe(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ge(As,`RPC '${e}' ${o} completed.`)}}));const p=JSON.stringify(r);ge(As,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",p,s,15)}))}T_(e,t,s){const r=Yg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=f1(),u=h1(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(d.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,t,s),d.encodeInitMessageHeaders=!0;const p=i.join("");ge(As,`Creating RPC '${e}' stream ${r}: ${p}`,d);const m=o.createWebChannel(p,d);this.I_(m);let x=!1,v=!1;const w=new yD({Yo:N=>{v?ge(As,`Not sending because RPC '${e}' stream ${r} is closed:`,N):(x||(ge(As,`Opening RPC '${e}' stream ${r} transport.`),m.open(),x=!0),ge(As,`RPC '${e}' stream ${r} sending:`,N),m.send(N))},Zo:()=>m.close()}),E=(N,A,T)=>{N.listen(A,(I=>{try{T(I)}catch(P){setTimeout((()=>{throw P}),0)}}))};return E(m,ru.EventType.OPEN,(()=>{v||(ge(As,`RPC '${e}' stream ${r} transport opened.`),w.o_())})),E(m,ru.EventType.CLOSE,(()=>{v||(v=!0,ge(As,`RPC '${e}' stream ${r} transport closed`),w.a_(),this.E_(m))})),E(m,ru.EventType.ERROR,(N=>{v||(v=!0,jl(As,`RPC '${e}' stream ${r} transport errored. Name:`,N.name,"Message:",N.message),w.a_(new pe(ee.UNAVAILABLE,"The operation could not be completed")))})),E(m,ru.EventType.MESSAGE,(N=>{if(!v){const A=N.data[0];lt(!!A,16349);const T=A,I=T?.error||T[0]?.error;if(I){ge(As,`RPC '${e}' stream ${r} received error:`,I);const P=I.status;let U=(function(C){const D=Yt[C];if(D!==void 0)return G1(D)})(P),O=I.message;U===void 0&&(U=ee.INTERNAL,O="Unknown error status: "+P+" with message "+I.message),v=!0,w.a_(new pe(U,O)),m.close()}else ge(As,`RPC '${e}' stream ${r} received:`,A),w.u_(A)}})),E(u,d1.STAT_EVENT,(N=>{N.stat===Lg.PROXY?ge(As,`RPC '${e}' stream ${r} detected buffering proxy`):N.stat===Lg.NOPROXY&&ge(As,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function lg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(n){return new _R(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(e,t,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&ge("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="PersistentStream";class lE{constructor(e,t,s,r,i,o,u,d){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new oE(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ee.RESOURCE_EXHAUSTED?(oi(t.toString()),oi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,r])=>{this.D_===t&&this.G_(s,r)}),(s=>{e((()=>{const r=new pe(ee.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{s((()=>this.z_(r)))})),this.stream.onMessage((r=>{s((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ge(Vw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ge(Vw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class bD extends lE{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=NR(this.serializer,e),s=(function(i){if(!("targetChange"in i))return Ve.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ve.min():o.readTime?Nr(o.readTime):Ve.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=Gg(this.serializer),t.addTarget=(function(i,o){let u;const d=o.target;if(u=Bg(d)?{documents:TR(i,d)}:{query:CR(i,d).ft},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=X1(i,o.resumeToken);const h=Hg(i,o.expectedCount);h!==null&&(u.expectedCount=h)}else if(o.snapshotVersion.compareTo(Ve.min())>0){u.readTime=wf(i,o.snapshotVersion.toTimestamp());const h=Hg(i,o.expectedCount);h!==null&&(u.expectedCount=h)}return u})(this.serializer,e);const s=PR(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=Gg(this.serializer),t.removeTarget=e,this.q_(t)}}class vD extends lE{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=SR(e.writeResults,e.commitTime),s=Nr(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=Gg(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>AR(this.serializer,s)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{}class _D extends wD{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new pe(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,qg(t,s),r,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new pe(ee.UNKNOWN,i.toString())}))}Ho(e,t,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Ho(e,qg(t,s),r,o,u,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new pe(ee.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class kD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(oi(t),this.aa=!1):ge("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co="RemoteStore";class ED{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{s.enqueueAndForget((async()=>{xo(this)&&(ge(co,"Restarting streams for network reachability change."),await(async function(d){const h=He(d);h.Ea.add(4),await Xu(h),h.Ra.set("Unknown"),h.Ea.delete(4),await ep(h)})(this))}))})),this.Ra=new kD(s,r)}}async function ep(n){if(xo(n))for(const e of n.da)await e(!0)}async function Xu(n){for(const e of n.da)await e(!1)}function cE(n,e){const t=He(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ly(t)?oy(t):Ql(t).O_()&&ay(t,e))}function iy(n,e){const t=He(n),s=Ql(t);t.Ia.delete(e),s.O_()&&uE(t,e),t.Ia.size===0&&(s.O_()?s.L_():xo(t)&&t.Ra.set("Unknown"))}function ay(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ql(n).Y_(e)}function uE(n,e){n.Va.Ue(e),Ql(n).Z_(e)}function oy(n){n.Va=new xR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ql(n).start(),n.Ra.ua()}function ly(n){return xo(n)&&!Ql(n).x_()&&n.Ia.size>0}function xo(n){return He(n).Ea.size===0}function dE(n){n.Va=void 0}async function ND(n){n.Ra.set("Online")}async function AD(n){n.Ia.forEach(((e,t)=>{ay(n,e)}))}async function SD(n,e){dE(n),ly(n)?(n.Ra.ha(e),oy(n)):n.Ra.set("Unknown")}async function TD(n,e,t){if(n.Ra.set("Online"),e instanceof Y1&&e.state===2&&e.cause)try{await(async function(r,i){const o=i.cause;for(const u of i.targetIds)r.Ia.has(u)&&(await r.remoteSyncer.rejectListen(u,o),r.Ia.delete(u),r.Va.removeTarget(u))})(n,e)}catch(s){ge(co,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await kf(n,s)}else if(e instanceof sf?n.Va.Ze(e):e instanceof K1?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ve.min()))try{const s=await aE(n.localStore);t.compareTo(s)>=0&&await(function(i,o){const u=i.Va.Tt(o);return u.targetChanges.forEach(((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const p=i.Ia.get(h);p&&i.Ia.set(h,p.withResumeToken(d.resumeToken,o))}})),u.targetMismatches.forEach(((d,h)=>{const p=i.Ia.get(d);if(!p)return;i.Ia.set(d,p.withResumeToken(vs.EMPTY_BYTE_STRING,p.snapshotVersion)),uE(i,d);const m=new Zi(p.target,d,h,p.sequenceNumber);ay(i,m)})),i.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(s){ge(co,"Failed to raise snapshot:",s),await kf(n,s)}}async function kf(n,e,t){if(!Yl(e))throw e;n.Ea.add(1),await Xu(n),n.Ra.set("Offline"),t||(t=()=>aE(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ge(co,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ep(n)}))}function hE(n,e){return e().catch((t=>kf(n,t,e)))}async function tp(n){const e=He(n),t=da(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:H0;for(;CD(e);)try{const r=await uD(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,ID(e,r)}catch(r){await kf(e,r)}fE(e)&&pE(e)}function CD(n){return xo(n)&&n.Ta.length<10}function ID(n,e){n.Ta.push(e);const t=da(n);t.O_()&&t.X_&&t.ea(e.mutations)}function fE(n){return xo(n)&&!da(n).x_()&&n.Ta.length>0}function pE(n){da(n).start()}async function PD(n){da(n).ra()}async function jD(n){const e=da(n);for(const t of n.Ta)e.ea(t.mutations)}async function RD(n,e,t){const s=n.Ta.shift(),r=J0.from(s,e,t);await hE(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await tp(n)}async function DD(n,e){e&&da(n).X_&&await(async function(s,r){if((function(o){return mR(o)&&o!==ee.ABORTED})(r.code)){const i=s.Ta.shift();da(s).B_(),await hE(s,(()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r))),await tp(s)}})(n,e),fE(n)&&pE(n)}async function Uw(n,e){const t=He(n);t.asyncQueue.verifyOperationInProgress(),ge(co,"RemoteStore received new credentials");const s=xo(t);t.Ea.add(3),await Xu(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ep(t)}async function MD(n,e){const t=He(n);e?(t.Ea.delete(2),await ep(t)):e||(t.Ea.add(2),await Xu(t),t.Ra.set("Unknown"))}function Ql(n){return n.ma||(n.ma=(function(t,s,r){const i=He(t);return i.sa(),new bD(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(n.datastore,n.asyncQueue,{Xo:ND.bind(null,n),t_:AD.bind(null,n),r_:SD.bind(null,n),H_:TD.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),ly(n)?oy(n):n.Ra.set("Unknown")):(await n.ma.stop(),dE(n))}))),n.ma}function da(n){return n.fa||(n.fa=(function(t,s,r){const i=He(t);return i.sa(),new vD(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:PD.bind(null,n),r_:DD.bind(null,n),ta:jD.bind(null,n),na:RD.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await tp(n)):(await n.fa.stop(),n.Ta.length>0&&(ge(co,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new si,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,u=new cy(e,t,o,r,i);return u.start(s),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pe(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uy(n,e){if(oi("AsyncQueue",`${e}: ${n}`),Yl(n))return new pe(ee.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{static emptySet(e){return new Al(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Pe.comparator(t.key,s.key):(t,s)=>Pe.comparator(t.key,s.key),this.keyedMap=iu(),this.sortedSet=new St(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Al)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Al;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(){this.ga=new St(Pe.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Oe(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Ol{constructor(e,t,s,r,i,o,u,d,h){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=h}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach((u=>{o.push({type:0,doc:u})})),new Ol(e,t,Al.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class OD{constructor(){this.queries=zw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=He(t),i=r.queries;r.queries=zw(),i.forEach(((o,u)=>{for(const d of u.Sa)d.onError(s)}))})(this,new pe(ee.ABORTED,"Firestore shutting down"))}}function zw(){return new yo((n=>M1(n)),Kf)}async function mE(n,e){const t=He(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new LD,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const u=uy(o,`Initialization of query '${hl(e.query)}' failed`);return void e.onError(u)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&dy(t)}async function gE(n,e){const t=He(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function FD(n,e){const t=He(n);let s=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const u of o.Sa)u.Fa(r)&&(s=!0);o.wa=r}}s&&dy(t)}function VD(n,e,t){const s=He(n),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);s.queries.delete(e)}function dy(n){n.Ca.forEach((e=>{e.next()}))}var Xg,$w;($w=Xg||(Xg={})).Ma="default",$w.Cache="cache";class yE{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Ol(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ol.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Xg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(e){this.key=e}}class bE{constructor(e){this.key=e}}class UD{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Qe(),this.mutatedKeys=Qe(),this.eu=L1(e),this.tu=new Al(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new Bw,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,u=!1;const d=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((p,m)=>{const x=r.get(p),v=Yf(this.query,m)?m:null,w=!!x&&this.mutatedKeys.has(x.key),E=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let N=!1;x&&v?x.data.isEqual(v.data)?w!==E&&(s.track({type:3,doc:v}),N=!0):this.su(x,v)||(s.track({type:2,doc:v}),N=!0,(d&&this.eu(v,d)>0||h&&this.eu(v,h)<0)&&(u=!0)):!x&&v?(s.track({type:0,doc:v}),N=!0):x&&!v&&(s.track({type:1,doc:x}),N=!0,(d||h)&&(u=!0)),N&&(v?(o=o.add(v),i=E?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),s.track({type:1,doc:p})}return{tu:o,iu:s,Cs:u,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((p,m)=>(function(v,w){const E=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oe(20277,{Rt:N})}};return E(v)-E(w)})(p.type,m.type)||this.eu(p.doc,m.doc))),this.ou(s),r=r??!1;const u=t&&!r?this._u():[],d=this.Xa.size===0&&this.current&&!r?1:0,h=d!==this.Za;return this.Za=d,o.length!==0||h?{snapshot:new Ol(this.query,e.tu,i,o,e.mutatedKeys,d===0,h,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Bw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Qe(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new bE(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new xE(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=Qe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ol.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const hy="SyncEngine";class BD{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class zD{constructor(e){this.key=e,this.hu=!1}}class $D{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new yo((u=>M1(u)),Kf),this.Iu=new Map,this.Eu=new Set,this.du=new St(Pe.comparator),this.Au=new Map,this.Ru=new ty,this.Vu={},this.mu=new Map,this.fu=Ll.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HD(n,e,t=!0){const s=NE(n);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await vE(s,e,t,!0),r}async function qD(n,e){const t=NE(n);await vE(t,e,!0,!1)}async function vE(n,e,t,s){const r=await dD(n.localStore,Er(e)),i=r.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let u;return s&&(u=await WD(n,e,i,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&cE(n.remoteStore,r),u}async function WD(n,e,t,s,r){n.pu=(m,x,v)=>(async function(E,N,A,T){let I=N.view.ru(A);I.Cs&&(I=await Mw(E.localStore,N.query,!1).then((({documents:R})=>N.view.ru(R,I))));const P=T&&T.targetChanges.get(N.targetId),U=T&&T.targetMismatches.get(N.targetId)!=null,O=N.view.applyChanges(I,E.isPrimaryClient,P,U);return qw(E,N.targetId,O.au),O.snapshot})(n,m,x,v);const i=await Mw(n.localStore,e,!0),o=new UD(e,i.Qs),u=o.ru(i.documents),d=Yu.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),h=o.applyChanges(u,n.isPrimaryClient,d);qw(n,t,h.au);const p=new BD(e,t,o);return n.Tu.set(e,p),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function GD(n,e,t){const s=He(n),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter((o=>!Kf(o,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await Kg(s.localStore,r.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(r.targetId),t&&iy(s.remoteStore,r.targetId),Qg(s,r.targetId)})).catch(Kl)):(Qg(s,r.targetId),await Kg(s.localStore,r.targetId,!0))}async function KD(n,e){const t=He(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),iy(t.remoteStore,s.targetId))}async function YD(n,e,t){const s=s4(n);try{const r=await(function(o,u){const d=He(o),h=Ce.now(),p=u.reduce(((v,w)=>v.add(w.key)),Qe());let m,x;return d.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let w=li(),E=Qe();return d.Ns.getEntries(v,p).next((N=>{w=N,w.forEach(((A,T)=>{T.isValidDocument()||(E=E.add(A))}))})).next((()=>d.localDocuments.getOverlayedDocuments(v,w))).next((N=>{m=N;const A=[];for(const T of u){const I=uR(T,m.get(T.key).overlayedDocument);I!=null&&A.push(new _a(T.key,I,S1(I.value.mapValue),In.exists(!0)))}return d.mutationQueue.addMutationBatch(v,h,A,u)})).next((N=>{x=N;const A=N.applyToLocalDocumentSet(m,E);return d.documentOverlayCache.saveOverlays(v,N.batchId,A)}))})).then((()=>({batchId:x.batchId,changes:F1(m)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),(function(o,u,d){let h=o.Vu[o.currentUser.toKey()];h||(h=new St(Xe)),h=h.insert(u,d),o.Vu[o.currentUser.toKey()]=h})(s,r.batchId,t),await Qu(s,r.changes),await tp(s.remoteStore)}catch(r){const i=uy(r,"Failed to persist write");t.reject(i)}}async function wE(n,e){const t=He(n);try{const s=await lD(t.localStore,e);e.targetChanges.forEach(((r,i)=>{const o=t.Au.get(i);o&&(lt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?lt(o.hu,14607):r.removedDocuments.size>0&&(lt(o.hu,42227),o.hu=!1))})),await Qu(t,s,e)}catch(s){await Kl(s)}}function Hw(n,e,t){const s=He(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach(((i,o)=>{const u=o.view.va(e);u.snapshot&&r.push(u.snapshot)})),(function(o,u){const d=He(o);d.onlineState=u;let h=!1;d.queries.forEach(((p,m)=>{for(const x of m.Sa)x.va(u)&&(h=!0)})),h&&dy(d)})(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function XD(n,e,t){const s=He(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new St(Pe.comparator);o=o.insert(i,Ts.newNoDocument(i,Ve.min()));const u=Qe().add(i),d=new Jf(Ve.min(),new Map,new St(Xe),o,u);await wE(s,d),s.du=s.du.remove(i),s.Au.delete(e),fy(s)}else await Kg(s.localStore,e,!1).then((()=>Qg(s,e,t))).catch(Kl)}async function QD(n,e){const t=He(n),s=e.batch.batchId;try{const r=await oD(t.localStore,e);kE(t,s,null),_E(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Qu(t,r)}catch(r){await Kl(r)}}async function JD(n,e,t){const s=He(n);try{const r=await(function(o,u){const d=He(o);return d.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let p;return d.mutationQueue.lookupMutationBatch(h,u).next((m=>(lt(m!==null,37113),p=m.keys(),d.mutationQueue.removeMutationBatch(h,m)))).next((()=>d.mutationQueue.performConsistencyCheck(h))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(h,p,u))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p))).next((()=>d.localDocuments.getDocuments(h,p)))}))})(s.localStore,e);kE(s,e,t),_E(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Qu(s,r)}catch(r){await Kl(r)}}function _E(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function kE(n,e,t){const s=He(n);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function Qg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||EE(n,s)}))}function EE(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(iy(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),fy(n))}function qw(n,e,t){for(const s of t)s instanceof xE?(n.Ru.addReference(s.key,e),ZD(n,s)):s instanceof bE?(ge(hy,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||EE(n,s.key)):Oe(19791,{wu:s})}function ZD(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(ge(hy,"New document in limbo: "+t),n.Eu.add(s),fy(n))}function fy(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Pe(mt.fromString(e)),s=n.fu.next();n.Au.set(s,new zD(t)),n.du=n.du.insert(t,s),cE(n.remoteStore,new Zi(Er(Y0(t.path)),s,"TargetPurposeLimboResolution",qf.ce))}}async function Qu(n,e,t){const s=He(n),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach(((u,d)=>{o.push(s.pu(d,e,t).then((h=>{if((h||t)&&s.isPrimaryClient){const p=h?!h.fromCache:t?.targetChanges.get(d.targetId)?.current;s.sharedClientState.updateQueryState(d.targetId,p?"current":"not-current")}if(h){r.push(h);const p=ny.As(d.targetId,h);i.push(p)}})))})),await Promise.all(o),s.Pu.H_(r),await(async function(d,h){const p=He(d);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>te.forEach(h,(x=>te.forEach(x.Es,(v=>p.persistence.referenceDelegate.addReference(m,x.targetId,v))).next((()=>te.forEach(x.ds,(v=>p.persistence.referenceDelegate.removeReference(m,x.targetId,v)))))))))}catch(m){if(!Yl(m))throw m;ge(ry,"Failed to update sequence numbers: "+m)}for(const m of h){const x=m.targetId;if(!m.fromCache){const v=p.Ms.get(x),w=v.snapshotVersion,E=v.withLastLimboFreeSnapshotVersion(w);p.Ms=p.Ms.insert(x,E)}}})(s.localStore,i))}async function e4(n,e){const t=He(n);if(!t.currentUser.isEqual(e)){ge(hy,"User change. New user:",e.toKey());const s=await iE(t.localStore,e);t.currentUser=e,(function(i,o){i.mu.forEach((u=>{u.forEach((d=>{d.reject(new pe(ee.CANCELLED,o))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Qu(t,s.Ls)}}function t4(n,e){const t=He(n),s=t.Au.get(e);if(s&&s.hu)return Qe().add(s.key);{let r=Qe();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const u=t.Tu.get(o);r=r.unionWith(u.view.nu)}return r}}function NE(n){const e=He(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=wE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=t4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XD.bind(null,e),e.Pu.H_=FD.bind(null,e.eventManager),e.Pu.yu=VD.bind(null,e.eventManager),e}function s4(n){const e=He(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=QD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=JD.bind(null,e),e}class Ef{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return aD(this.persistence,new nD,e.initialUser,this.serializer)}Cu(e){return new rE(sy.mi,this.serializer)}Du(e){return new fD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ef.provider={build:()=>new Ef};class n4 extends Ef{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){lt(this.persistence.referenceDelegate instanceof _f,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new zR(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ys.withCacheSize(this.cacheSizeBytes):Ys.DEFAULT;return new rE((s=>_f.mi(s,t)),this.serializer)}}class Jg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Hw(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=e4.bind(null,this.syncEngine),await MD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new OD})()}createDatastore(e){const t=Zf(e.databaseInfo.databaseId),s=(function(i){return new xD(i)})(e.databaseInfo);return(function(i,o,u,d){return new _D(i,o,u,d)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,r,i,o,u){return new ED(s,r,i,o,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>Hw(this.syncEngine,t,0)),(function(){return Fw.v()?new Fw:new pD})())}createSyncEngine(e,t){return(function(r,i,o,u,d,h,p){const m=new $D(r,i,o,u,d,h);return p&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=He(t);ge(co,"RemoteStore shutting down."),s.Ea.add(5),await Xu(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Jg.provider={build:()=>new Jg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):oi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha="FirestoreClient";class r4{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=Ss.UNAUTHENTICATED,this.clientId=$0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,(async o=>{ge(ha,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(s,(o=>(ge(ha,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new si;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=uy(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function cg(n,e){n.asyncQueue.verifyOperationInProgress(),ge(ha,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async r=>{s.isEqual(r)||(await iE(e.localStore,r),s=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Ww(n,e){n.asyncQueue.verifyOperationInProgress();const t=await i4(n);ge(ha,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Uw(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,r)=>Uw(e.remoteStore,r))),n._onlineComponents=e}async function i4(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ge(ha,"Using user provided OfflineComponentProvider");try{await cg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===ee.FAILED_PRECONDITION||r.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;jl("Error using user provided cache. Falling back to memory cache: "+t),await cg(n,new Ef)}}else ge(ha,"Using default OfflineComponentProvider"),await cg(n,new n4(void 0));return n._offlineComponents}async function SE(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ge(ha,"Using user provided OnlineComponentProvider"),await Ww(n,n._uninitializedComponentsProvider._online)):(ge(ha,"Using default OnlineComponentProvider"),await Ww(n,new Jg))),n._onlineComponents}function a4(n){return SE(n).then((e=>e.syncEngine))}async function TE(n){const e=await SE(n),t=e.eventManager;return t.onListen=HD.bind(null,e.syncEngine),t.onUnlisten=GD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=qD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=KD.bind(null,e.syncEngine),t}function o4(n,e,t={}){const s=new si;return n.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,d,h){const p=new AE({next:x=>{p.Nu(),o.enqueueAndForget((()=>gE(i,m)));const v=x.docs.has(u);!v&&x.fromCache?h.reject(new pe(ee.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&x.fromCache&&d&&d.source==="server"?h.reject(new pe(ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(x)},error:x=>h.reject(x)}),m=new yE(Y0(u.path),p,{includeMetadataChanges:!0,qa:!0});return mE(i,m)})(await TE(n),n.asyncQueue,e,t,s))),s.promise}function l4(n,e,t={}){const s=new si;return n.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,d,h){const p=new AE({next:x=>{p.Nu(),o.enqueueAndForget((()=>gE(i,m))),x.fromCache&&d.source==="server"?h.reject(new pe(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(x)},error:x=>h.reject(x)}),m=new yE(u,p,{includeMetadataChanges:!0,qa:!0});return mE(i,m)})(await TE(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CE(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="firestore.googleapis.com",Kw=!0;class Yw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new pe(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=IE,this.ssl=Kw}else this.host=e.host,this.ssl=e.ssl??Kw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=nE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<UR)throw new pe(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ej("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CE(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new pe(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new pe(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new pe(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,r){return s.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sp{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pe(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pe(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new pj;switch(s.type){case"firstParty":return new xj(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new pe(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=Gw.get(t);s&&(ge("ComponentProvider","Removing Datastore"),Gw.delete(t),s.terminate())})(this),Promise.resolve()}}function c4(n,e,t,s={}){n=Yn(n,sp);const r=Ir(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},u=`${e}:${t}`;r&&(Ff(`https://${u}`),Vf("Firestore",!0)),i.host!==IE&&i.host!==u&&jl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...i,host:u,ssl:r,emulatorOptions:s};if(!io(d,o)&&(n._setSettings(d),s.mockUserToken)){let h,p;if(typeof s.mockUserToken=="string")h=s.mockUserToken,p=Ss.MOCK_USER;else{h=_k(s.mockUserToken,n._app?.options.projectId);const m=s.mockUserToken.sub||s.mockUserToken.user_id;if(!m)throw new pe(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Ss(m)}n._authCredentials=new mj(new m1(h,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new bo(this.firestore,e,this._query)}}class Bt{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ra(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Bt(this.firestore,e,this._key)}toJSON(){return{type:Bt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Gu(t,Bt._jsonSchema))return new Bt(e,s||null,new Pe(mt.fromString(t.referencePath)))}}Bt._jsonSchemaVersion="firestore/documentReference/1.0",Bt._jsonSchema={type:Qt("string",Bt._jsonSchemaVersion),referencePath:Qt("string")};class ra extends bo{constructor(e,t,s){super(e,t,Y0(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Bt(this.firestore,null,new Pe(e))}withConverter(e){return new ra(this.firestore,e,this._path)}}function Rn(n,e,...t){if(n=bt(n),g1("collection","path",e),n instanceof sp){const s=mt.fromString(e,...t);return lw(s),new ra(n,null,s)}{if(!(n instanceof Bt||n instanceof ra))throw new pe(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(mt.fromString(e,...t));return lw(s),new ra(n.firestore,null,s)}}function Nt(n,e,...t){if(n=bt(n),arguments.length===1&&(e=$0.newId()),g1("doc","path",e),n instanceof sp){const s=mt.fromString(e,...t);return ow(s),new Bt(n,null,new Pe(s))}{if(!(n instanceof Bt||n instanceof ra))throw new pe(ee.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(mt.fromString(e,...t));return ow(s),new Bt(n.firestore,n instanceof ra?n.converter:null,new Pe(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw="AsyncQueue";class Qw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new oE(this,"async_queue_retry"),this._c=()=>{const s=lg();s&&ge(Xw,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=lg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=lg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new si;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Yl(e))throw e;ge(Xw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,oi("INTERNAL UNHANDLED ERROR: ",Jw(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=cy.createAndSchedule(this,e,t,s,(i=>this.hc(i)));return this.tc.push(r),r}uc(){this.nc&&Oe(47125,{Pc:Jw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Jw(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class vo extends sp{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new Qw,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Qw(e),this._firestoreClient=void 0,await e}}}function u4(n,e){const t=typeof n=="object"?n:Uf(),s=typeof n=="string"?n:gf,r=zu(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=P0("firestore");i&&c4(r,...i)}return r}function py(n){if(n._terminated)throw new pe(ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||d4(n),n._firestoreClient}function d4(n){const e=n._freezeSettings(),t=(function(r,i,o,u){return new Mj(r,i,o,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,CE(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new r4(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const i=r?._online.build();return{_offline:r?._offline.build(i),_online:i}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Tn(vs.fromBase64String(e))}catch(t){throw new pe(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Tn(vs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Tn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Gu(e,Tn._jsonSchema))return Tn.fromBase64String(e.bytes)}}Tn._jsonSchemaVersion="firestore/bytes/1.0",Tn._jsonSchema={type:Qt("string",Tn._jsonSchemaVersion),bytes:Qt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new pe(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new pe(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new pe(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Xe(this._lat,e._lat)||Xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ar._jsonSchemaVersion}}static fromJSON(e){if(Gu(e,Ar._jsonSchema))return new Ar(e.latitude,e.longitude)}}Ar._jsonSchemaVersion="firestore/geoPoint/1.0",Ar._jsonSchema={type:Qt("string",Ar._jsonSchemaVersion),latitude:Qt("number"),longitude:Qt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Sr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Gu(e,Sr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Sr(e.vectorValues);throw new pe(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Sr._jsonSchemaVersion="firestore/vectorValue/1.0",Sr._jsonSchema={type:Qt("string",Sr._jsonSchemaVersion),vectorValues:Qt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=/^__.*__$/;class f4{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new _a(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ku(e,this.data,t,this.fieldTransforms)}}class PE{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new _a(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function jE(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oe(40011,{Ac:n})}}class gy{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new gy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Nf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(jE(this.Ac)&&h4.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class p4{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Zf(e)}Cc(e,t,s,r=!1){return new gy({Ac:e,methodName:t,Dc:s,path:xs.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rp(n){const e=n._freezeSettings(),t=Zf(n._databaseId);return new p4(n._databaseId,!!e.ignoreUndefinedProperties,t)}function RE(n,e,t,s,r,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,r);yy("Data must be an object, but it was:",o,s);const u=DE(s,o);let d,h;if(i.merge)d=new fn(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const m of i.mergeFields){const x=Zg(e,m,t);if(!o.contains(x))throw new pe(ee.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);LE(p,x)||p.push(x)}d=new fn(p),h=o.fieldTransforms.filter((m=>d.covers(m.field)))}else d=null,h=o.fieldTransforms;return new f4(new Qs(u),d,h)}class ip extends my{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ip}}function m4(n,e,t,s){const r=n.Cc(1,e,t);yy("Data must be an object, but it was:",r,s);const i=[],o=Qs.empty();wa(s,((d,h)=>{const p=xy(e,d,t);h=bt(h);const m=r.yc(p);if(h instanceof ip)i.push(p);else{const x=Ju(h,m);x!=null&&(i.push(p),o.set(p,x))}}));const u=new fn(i);return new PE(o,u,r.fieldTransforms)}function g4(n,e,t,s,r,i){const o=n.Cc(1,e,t),u=[Zg(e,s,t)],d=[r];if(i.length%2!=0)throw new pe(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<i.length;x+=2)u.push(Zg(e,i[x])),d.push(i[x+1]);const h=[],p=Qs.empty();for(let x=u.length-1;x>=0;--x)if(!LE(h,u[x])){const v=u[x];let w=d[x];w=bt(w);const E=o.yc(v);if(w instanceof ip)h.push(v);else{const N=Ju(w,E);N!=null&&(h.push(v),p.set(v,N))}}const m=new fn(h);return new PE(p,m,o.fieldTransforms)}function y4(n,e,t,s=!1){return Ju(t,n.Cc(s?4:3,e))}function Ju(n,e){if(ME(n=bt(n)))return yy("Unsupported field value:",e,n),DE(n,e);if(n instanceof my)return(function(s,r){if(!jE(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,r){const i=[];let o=0;for(const u of s){let d=Ju(u,r.wc(o));d==null&&(d={nullValue:"NULL_VALUE"}),i.push(d),o++}return{arrayValue:{values:i}}})(n,e)}return(function(s,r){if((s=bt(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return rR(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=Ce.fromDate(s);return{timestampValue:wf(r.serializer,i)}}if(s instanceof Ce){const i=new Ce(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:wf(r.serializer,i)}}if(s instanceof Ar)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Tn)return{bytesValue:X1(r.serializer,s._byteString)};if(s instanceof Bt){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ey(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Sr)return(function(o,u){return{mapValue:{fields:{[N1]:{stringValue:A1},[yf]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw u.Sc("VectorValues must only contain numeric values.");return X0(u.serializer,h)}))}}}}}})(s,r);throw r.Sc(`Unsupported field value: ${Hf(s)}`)})(n,e)}function DE(n,e){const t={};return b1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wa(n,((s,r)=>{const i=Ju(r,e.mc(s));i!=null&&(t[s]=i)})),{mapValue:{fields:t}}}function ME(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ce||n instanceof Ar||n instanceof Tn||n instanceof Bt||n instanceof my||n instanceof Sr)}function yy(n,e,t){if(!ME(t)||!y1(t)){const s=Hf(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function Zg(n,e,t){if((e=bt(e))instanceof np)return e._internalPath;if(typeof e=="string")return xy(n,e);throw Nf("Field path arguments must be of type string or ",n,!1,void 0,t)}const x4=new RegExp("[~\\*/\\[\\]]");function xy(n,e,t){if(e.search(x4)>=0)throw Nf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new np(...e.split("."))._internalPath}catch{throw Nf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Nf(n,e,t,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let d="";return(i||o)&&(d+=" (found",i&&(d+=` in field ${s}`),o&&(d+=` in document ${r}`),d+=")"),new pe(ee.INVALID_ARGUMENT,u+n+d)}function LE(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Bt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new b4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ap("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class b4 extends OE{data(){return super.data()}}function ap(n,e){return typeof e=="string"?xy(n,e):e instanceof np?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new pe(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class by{}class FE extends by{}function $t(n,e,...t){let s=[];e instanceof by&&s.push(e),s=s.concat(t),(function(i){const o=i.filter((d=>d instanceof vy)).length,u=i.filter((d=>d instanceof op)).length;if(o>1||o>0&&u>0)throw new pe(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const r of s)n=r._apply(n);return n}class op extends FE{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new op(e,t,s)}_apply(e){const t=this._parse(e);return VE(e._query,t),new bo(e.firestore,e.converter,zg(e._query,t))}_parse(e){const t=rp(e.firestore);return(function(i,o,u,d,h,p,m){let x;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new pe(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){e_(m,p);const w=[];for(const E of m)w.push(Zw(d,i,E));x={arrayValue:{values:w}}}else x=Zw(d,i,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||e_(m,p),x=y4(u,o,m,p==="in"||p==="not-in");return Xt.create(h,p,x)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Jt(n,e,t){const s=e,r=ap("where",n);return op._create(r,s,t)}class vy extends by{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vy(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:Xn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,i){let o=r;const u=i.getFlattenedFilters();for(const d of u)VE(o,d),o=zg(o,d)})(e._query,t),new bo(e.firestore,e.converter,zg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class wy extends FE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new wy(e,t)}_apply(e){const t=(function(r,i,o){if(r.startAt!==null)throw new pe(ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new pe(ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Au(i,o)})(e._query,this._field,this._direction);return new bo(e.firestore,e.converter,(function(r,i){const o=r.explicitOrderBy.concat([i]);return new Xl(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)})(e._query,t))}}function fi(n,e="asc"){const t=e,s=ap("orderBy",n);return wy._create(s,t)}function Zw(n,e,t){if(typeof(t=bt(t))=="string"){if(t==="")throw new pe(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!D1(e)&&t.indexOf("/")!==-1)throw new pe(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(mt.fromString(t));if(!Pe.isDocumentKey(s))throw new pe(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return gw(n,new Pe(s))}if(t instanceof Bt)return gw(n,t._key);throw new pe(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hf(t)}.`)}function e_(n,e){if(!Array.isArray(n)||n.length===0)throw new pe(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VE(n,e){const t=(function(r,i){for(const o of r)for(const u of o.getFlattenedFilters())if(i.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new pe(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pe(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class w4{convertValue(e,t="none"){switch(ua(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ca(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Oe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return wa(e,((r,i)=>{s[r]=this.convertValue(i,t)})),s}convertVectorValue(e){const t=e.fields?.[yf].arrayValue?.values?.map((s=>Vt(s.doubleValue)));return new Sr(t)}convertGeoPoint(e){return new Ar(Vt(e.latitude),Vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Gf(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(ku(e));default:return null}}convertTimestamp(e){const t=la(e);return new Ce(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=mt.fromString(e);lt(sE(s),9688,{name:e});const r=new Eu(s.get(1),s.get(3)),i=new Pe(s.popFirst(5));return r.isEqual(t)||oi(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class ou{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class so extends OE{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new nf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(ap("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pe(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=so._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}so._jsonSchemaVersion="firestore/documentSnapshot/1.0",so._jsonSchema={type:Qt("string",so._jsonSchemaVersion),bundleSource:Qt("string","DocumentSnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class nf extends so{data(e={}){return super.data(e)}}class Sl{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ou(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new nf(this._firestore,this._userDataWriter,s.key,s,new ou(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new pe(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((u=>{const d=new nf(r._firestore,r._userDataWriter,u.doc.key,u.doc,new ou(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((u=>i||u.type!==3)).map((u=>{const d=new nf(r._firestore,r._userDataWriter,u.doc.key,u.doc,new ou(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,p=-1;return u.type!==0&&(h=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),p=o.indexOf(u.doc.key)),{type:_4(u.type),doc:d,oldIndex:h,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pe(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Sl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=$0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function _4(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Oe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(n){n=Yn(n,Bt);const e=Yn(n.firestore,vo);return o4(py(e),n._key).then((t=>k4(e,n,t)))}Sl._jsonSchemaVersion="firestore/querySnapshot/1.0",Sl._jsonSchema={type:Qt("string",Sl._jsonSchemaVersion),bundleSource:Qt("string","QuerySnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class BE extends w4{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Bt(this.firestore,null,t)}}function Rt(n){n=Yn(n,bo);const e=Yn(n.firestore,vo),t=py(e),s=new BE(e);return v4(n._query),l4(t,n._query).then((r=>new Sl(e,s,n,r)))}function _y(n,e,t){n=Yn(n,Bt);const s=Yn(n.firestore,vo),r=UE(n.converter,e,t);return cp(s,[RE(rp(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,In.none())])}function Zs(n,e,t,...s){n=Yn(n,Bt);const r=Yn(n.firestore,vo),i=rp(r);let o;return o=typeof(e=bt(e))=="string"||e instanceof np?g4(i,"updateDoc",n._key,e,t,s):m4(i,"updateDoc",n._key,e),cp(r,[o.toMutation(n._key,In.exists(!0))])}function ky(n){return cp(Yn(n.firestore,vo),[new Q0(n._key,In.none())])}function ci(n,e){const t=Yn(n.firestore,vo),s=Nt(n),r=UE(n.converter,e);return cp(t,[RE(rp(n.firestore),"addDoc",s._key,r,n.converter!==null,{}).toMutation(s._key,In.exists(!1))]).then((()=>s))}function cp(n,e){return(function(s,r){const i=new si;return s.asyncQueue.enqueueAndForget((async()=>YD(await a4(s),r,i))),i.promise})(py(n),e)}function k4(n,e,t){const s=t.docs.get(e._key),r=new BE(n);return new so(n,r,e._key,s,new ou(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){Gl=r})(mo),aa(new ri("firestore",((s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),u=new vo(new gj(s.getProvider("auth-internal")),new bj(o,s.getProvider("app-check-internal")),(function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new pe(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Eu(h.options.projectId,p)})(o,r),o);return i={useFetchStreams:t,...i},u._setSettings(i),u}),"PUBLIC").setMultipleInstances(!0)),Cn(nw,rw,e),Cn(nw,rw,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="firebasestorage.googleapis.com",$E="storageBucket",E4=120*1e3,N4=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt extends Qn{constructor(e,t,s=0){super(ug(e),`Firebase Storage: ${t} (${ug(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Dt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ug(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var jt;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(jt||(jt={}));function ug(n){return"storage/"+n}function Ey(){const n="An unknown error occurred, please check the error payload for server response.";return new Dt(jt.UNKNOWN,n)}function A4(n){return new Dt(jt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function S4(n){return new Dt(jt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function T4(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Dt(jt.UNAUTHENTICATED,n)}function C4(){return new Dt(jt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function I4(n){return new Dt(jt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function P4(){return new Dt(jt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function j4(){return new Dt(jt.CANCELED,"User canceled the upload/download.")}function R4(n){return new Dt(jt.INVALID_URL,"Invalid URL '"+n+"'.")}function D4(n){return new Dt(jt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function M4(){return new Dt(jt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+$E+"' property when initializing the app?")}function L4(){return new Dt(jt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function O4(){return new Dt(jt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function F4(n){return new Dt(jt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function e0(n){return new Dt(jt.INVALID_ARGUMENT,n)}function HE(){return new Dt(jt.APP_DELETED,"The Firebase app was deleted.")}function V4(n){return new Dt(jt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function gu(n,e){return new Dt(jt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Yc(n){throw new Dt(jt.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=pn.makeFromUrl(e,t)}catch{return new pn(e,"")}if(s.path==="")return s;throw D4(e)}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",u=new RegExp("^gs://"+r+o,"i"),d={bucket:1,path:3};function h(P){P.path_=decodeURIComponent(P.path)}const p="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",v=new RegExp(`^https?://${m}/${p}/b/${r}/o${x}`,"i"),w={bucket:1,path:3},E=t===zE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,N="([^?#]*)",A=new RegExp(`^https?://${E}/${r}/${N}`,"i"),I=[{regex:u,indices:d,postModify:i},{regex:v,indices:w,postModify:h},{regex:A,indices:{bucket:1,path:2},postModify:h}];for(let P=0;P<I.length;P++){const U=I[P],O=U.regex.exec(e);if(O){const R=O[U.indices.bucket];let C=O[U.indices.path];C||(C=""),s=new pn(R,C),U.postModify(s);break}}if(s==null)throw R4(e);return s}}class U4{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B4(n,e,t){let s=1,r=null,i=null,o=!1,u=0;function d(){return u===2}let h=!1;function p(...N){h||(h=!0,e.apply(null,N))}function m(N){r=setTimeout(()=>{r=null,n(v,d())},N)}function x(){i&&clearTimeout(i)}function v(N,...A){if(h){x();return}if(N){x(),p.call(null,N,...A);return}if(d()||o){x(),p.call(null,N,...A);return}s<64&&(s*=2);let I;u===1?(u=2,I=0):I=(s+Math.random())*1e3,m(I)}let w=!1;function E(N){w||(w=!0,x(),!h&&(r!==null?(N||(u=2),clearTimeout(r),m(0)):N||(u=1)))}return m(0),i=setTimeout(()=>{o=!0,E(!0)},t),E}function z4(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $4(n){return n!==void 0}function H4(n){return typeof n=="object"&&!Array.isArray(n)}function Ny(n){return typeof n=="string"||n instanceof String}function t_(n){return Ay()&&n instanceof Blob}function Ay(){return typeof Blob<"u"}function s_(n,e,t,s){if(s<e)throw e0(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw e0(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sy(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function qE(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var no;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(no||(no={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q4(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,t,s,r,i,o,u,d,h,p,m,x=!0,v=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=u,this.errorCallback_=d,this.timeout_=h,this.progressCallback_=p,this.connectionFactory_=m,this.retry=x,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,E)=>{this.resolve_=w,this.reject_=E,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Ph(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=u=>{const d=u.loaded,h=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,h)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const u=i.getErrorCode()===no.NO_ERROR,d=i.getStatus();if(!u||q4(d,this.additionalRetryCodes_)&&this.retry){const p=i.getErrorCode()===no.ABORT;s(!1,new Ph(!1,null,p));return}const h=this.successCodes_.indexOf(d)!==-1;s(!0,new Ph(h,i))})},t=(s,r)=>{const i=this.resolve_,o=this.reject_,u=r.connection;if(r.wasSuccessCode)try{const d=this.callback_(u,u.getResponse());$4(d)?i(d):i()}catch(d){o(d)}else if(u!==null){const d=Ey();d.serverResponse=u.getErrorText(),this.errorCallback_?o(this.errorCallback_(u,d)):o(d)}else if(r.canceled){const d=this.appDelete_?HE():j4();o(d)}else{const d=P4();o(d)}};this.canceled_?t(!1,new Ph(!1,null,!0)):this.backoffId_=B4(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&z4(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ph{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function G4(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function K4(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Y4(n,e){e&&(n["X-Firebase-GMPID"]=e)}function X4(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Q4(n,e,t,s,r,i,o=!0,u=!1){const d=qE(n.urlParams),h=n.url+d,p=Object.assign({},n.headers);return Y4(p,e),G4(p,t),K4(p,i),X4(p,s),new W4(h,n.method,p,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J4(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Z4(...n){const e=J4();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(Ay())return new Blob(n);throw new Dt(jt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function eM(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tM(n){if(typeof atob>"u")throw F4("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class dg{constructor(e,t){this.data=e,this.contentType=t||null}}function sM(n,e){switch(n){case wr.RAW:return new dg(WE(e));case wr.BASE64:case wr.BASE64URL:return new dg(GE(n,e));case wr.DATA_URL:return new dg(rM(e),iM(e))}throw Ey()}function WE(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=n.charCodeAt(++t);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function nM(n){let e;try{e=decodeURIComponent(n)}catch{throw gu(wr.DATA_URL,"Malformed data URL.")}return WE(e)}function GE(n,e){switch(n){case wr.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw gu(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case wr.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw gu(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=tM(e)}catch(r){throw r.message.includes("polyfill")?r:gu(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}class KE{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw gu(wr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=aM(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function rM(n){const e=new KE(n);return e.base64?GE(wr.BASE64,e.rest):nM(e.rest)}function iM(n){return new KE(n).contentType}function aM(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,t){let s=0,r="";t_(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(t_(this.data_)){const s=this.data_,r=eM(s,e,t);return r===null?null:new Qi(r)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new Qi(s,!0)}}static getBlob(...e){if(Ay()){const t=e.map(s=>s instanceof Qi?s.data_:s);return new Qi(Z4.apply(null,t))}else{const t=e.map(o=>Ny(o)?sM(wr.RAW,o).data:o.data_);let s=0;t.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return t.forEach(o=>{for(let u=0;u<o.length;u++)r[i++]=o[u]}),new Qi(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YE(n){let e;try{e=JSON.parse(n)}catch{return null}return H4(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oM(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function lM(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function XE(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(n,e){return e}class Ds{constructor(e,t,s,r){this.server=e,this.local=t||e,this.writable=!!s,this.xform=r||cM}}let jh=null;function uM(n){return!Ny(n)||n.length<2?n:XE(n)}function QE(){if(jh)return jh;const n=[];n.push(new Ds("bucket")),n.push(new Ds("generation")),n.push(new Ds("metageneration")),n.push(new Ds("name","fullPath",!0));function e(i,o){return uM(o)}const t=new Ds("name");t.xform=e,n.push(t);function s(i,o){return o!==void 0?Number(o):o}const r=new Ds("size");return r.xform=s,n.push(r),n.push(new Ds("timeCreated")),n.push(new Ds("updated")),n.push(new Ds("md5Hash",null,!0)),n.push(new Ds("cacheControl",null,!0)),n.push(new Ds("contentDisposition",null,!0)),n.push(new Ds("contentEncoding",null,!0)),n.push(new Ds("contentLanguage",null,!0)),n.push(new Ds("contentType",null,!0)),n.push(new Ds("metadata","customMetadata",!0)),jh=n,jh}function dM(n,e){function t(){const s=n.bucket,r=n.fullPath,i=new pn(s,r);return e._makeStorageReference(i)}Object.defineProperty(n,"ref",{get:t})}function hM(n,e,t){const s={};s.type="file";const r=t.length;for(let i=0;i<r;i++){const o=t[i];s[o.local]=o.xform(s,e[o.server])}return dM(s,n),s}function JE(n,e,t){const s=YE(e);return s===null?null:hM(n,s,t)}function fM(n,e,t,s){const r=YE(e);if(r===null||!Ny(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(h=>{const p=n.bucket,m=n.fullPath,x="/b/"+o(p)+"/o/"+o(m),v=Sy(x,t,s),w=qE({alt:"media",token:h});return v+w})[0]}function pM(n,e){const t={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(t[i.server]=n[i.local])}return JSON.stringify(t)}class ZE{constructor(e,t,s,r){this.url=e,this.method=t,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eN(n){if(!n)throw Ey()}function mM(n,e){function t(s,r){const i=JE(n,r,e);return eN(i!==null),i}return t}function gM(n,e){function t(s,r){const i=JE(n,r,e);return eN(i!==null),fM(i,r,n.host,n._protocol)}return t}function tN(n){function e(t,s){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=C4():r=T4():t.getStatus()===402?r=S4(n.bucket):t.getStatus()===403?r=I4(n.path):r=s,r.status=t.getStatus(),r.serverResponse=s.serverResponse,r}return e}function yM(n){const e=tN(n);function t(s,r){let i=e(s,r);return s.getStatus()===404&&(i=A4(n.path)),i.serverResponse=r.serverResponse,i}return t}function xM(n,e,t){const s=e.fullServerUrl(),r=Sy(s,n.host,n._protocol),i="GET",o=n.maxOperationRetryTime,u=new ZE(r,i,gM(n,t),o);return u.errorHandler=yM(e),u}function bM(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function vM(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=bM(null,e)),s}function wM(n,e,t,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function u(){let I="";for(let P=0;P<2;P++)I=I+Math.random().toString().slice(2);return I}const d=u();o["Content-Type"]="multipart/related; boundary="+d;const h=vM(e,s,r),p=pM(h,t),m="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+d+`\r
Content-Type: `+h.contentType+`\r
\r
`,x=`\r
--`+d+"--",v=Qi.getBlob(m,s,x);if(v===null)throw L4();const w={name:h.fullPath},E=Sy(i,n.host,n._protocol),N="POST",A=n.maxUploadRetryTime,T=new ZE(E,N,mM(n,t),A);return T.urlParams=w,T.headers=o,T.body=v.uploadData(),T.errorHandler=tN(e),T}class _M{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=no.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=no.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=no.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,r,i){if(this.sent_)throw Yc("cannot .send() more than once");if(Ir(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Yc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Yc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Yc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Yc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class kM extends _M{initXhr(){this.xhr_.responseType="text"}}function sN(){return new kM}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,t){this._service=e,t instanceof pn?this._location=t:this._location=pn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new uo(e,t)}get root(){const e=new pn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return XE(this._location.path)}get storage(){return this._service}get parent(){const e=oM(this._location.path);if(e===null)return null;const t=new pn(this._location.bucket,e);return new uo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw V4(e)}}function EM(n,e,t){n._throwIfRoot("uploadBytes");const s=wM(n.storage,n._location,QE(),new Qi(e,!0),t);return n.storage.makeRequestWithTokens(s,sN).then(r=>({metadata:r,ref:n}))}function NM(n){n._throwIfRoot("getDownloadURL");const e=xM(n.storage,n._location,QE());return n.storage.makeRequestWithTokens(e,sN).then(t=>{if(t===null)throw O4();return t})}function AM(n,e){const t=lM(n._location.path,e),s=new pn(n._location.bucket,t);return new uo(n.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SM(n){return/^[A-Za-z]+:\/\//.test(n)}function TM(n,e){return new uo(n,e)}function nN(n,e){if(n instanceof Ty){const t=n;if(t._bucket==null)throw M4();const s=new uo(t,t._bucket);return e!=null?nN(s,e):s}else return e!==void 0?AM(n,e):n}function CM(n,e){if(e&&SM(e)){if(n instanceof Ty)return TM(n,e);throw e0("To use ref(service, url), the first argument must be a Storage instance.")}else return nN(n,e)}function n_(n,e){const t=e?.[$E];return t==null?null:pn.makeFromBucketSpec(t,n)}function IM(n,e,t,s={}){n.host=`${e}:${t}`;const r=Ir(e);r&&(Ff(`https://${n.host}/b`),Vf("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(n._overrideAuthToken=typeof i=="string"?i:_k(i,n.app.options.projectId))}class Ty{constructor(e,t,s,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=zE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=E4,this._maxUploadRetryTime=N4,this._requests=new Set,r!=null?this._bucket=pn.makeFromBucketSpec(r,this._host):this._bucket=n_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=pn.makeFromBucketSpec(this._url,e):this._bucket=n_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){s_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){s_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Xs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new uo(this,e)}_makeRequest(e,t,s,r,i=!0){if(this._deleted)return new U4(HE());{const o=Q4(e,this._appId,s,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()}}const r_="@firebase/storage",i_="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN="storage";function Cy(n,e,t){return n=bt(n),EM(n,e,t)}function Iy(n){return n=bt(n),NM(n)}function Py(n,e){return n=bt(n),CM(n,e)}function PM(n=Uf(),e){n=bt(n);const s=zu(n,rN).getImmediate({identifier:e}),r=P0("storage");return r&&jM(s,...r),s}function jM(n,e,t,s={}){IM(n,e,t,s)}function RM(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new Ty(t,s,r,e,mo)}function DM(){aa(new ri(rN,RM,"PUBLIC").setMultipleInstances(!0)),Cn(r_,i_,""),Cn(r_,i_,"esm2020")}DM();const MM={apiKey:"AIzaSyCI5qUXSrau6XMBNMyHnUtgyGFS3rfJknU",authDomain:"notzy-83166.firebaseapp.com",projectId:"notzy-83166",storageBucket:"notzy-83166.firebasestorage.app",messagingSenderId:"471992545792",appId:"1:471992545792:web:e6e7712f07facc9bda1ee5",measurementId:"G-CL4XNKKH8X"},jy=Nk(MM),Rh=uj(jy),gn=u4(jy),Ry=PM(jy),ka=Rn(gn,"users"),ui=Rn(gn,"notes"),Dy=Rn(gn,"purchases"),Fl=Rn(gn,"bookmarks"),up=Rn(gn,"reviews"),Vl=Rn(gn,"payouts"),Zu=Rn(gn,"noteRequests"),My=Rn(gn,"freePYQs"),t0=Nt(gn,"settings","platform");async function LM(n,e){await _y(Nt(ka,n),{name:e.name,email:e.email,avatarUrl:e.avatarUrl||"",totalEarnings:0,createdAt:Ce.now()})}async function hg(n){const e=await lp(Nt(ka,n));if(!e.exists())return null;const t=e.data(),s=await aN(n);return{id:n,name:t.name,email:t.email,avatarUrl:t.avatarUrl||"",bio:t.bio||"",totalEarnings:t.totalEarnings||0,uploadedNotes:s,isAdmin:t.isAdmin||!1,isVerified:t.isVerified||!1,isBlocked:t.isBlocked||!1}}async function a_(n,e){await Zs(Nt(ka,n),e)}async function Ly(){const n=$t(ui,fi("uploadDate","desc"));return(await Rt(n)).docs.map(t=>{const s=t.data();return{id:t.id,title:s.title,description:s.description,category:s.category,price:s.price,rating:s.rating||0,reviewCount:s.reviewCount||0,salesCount:s.salesCount||0,previewPages:s.previewPages||[],thumbnailUrl:s.thumbnailUrl||"",pdfUrls:s.pdfUrls||[],uploaderId:s.uploaderId,uploaderName:s.uploaderName,uploadDate:s.uploadDate instanceof Ce?s.uploadDate.toDate().toISOString().split("T")[0]:s.uploadDate}})}async function iN(n){const e=await lp(Nt(ui,n));if(!e.exists())return null;const t=e.data();return{id:e.id,title:t.title,description:t.description,category:t.category,price:t.price,rating:t.rating||0,reviewCount:t.reviewCount||0,salesCount:t.salesCount||0,previewPages:t.previewPages||[],thumbnailUrl:t.thumbnailUrl||"",pdfUrls:t.pdfUrls||[],uploaderId:t.uploaderId,uploaderName:t.uploaderName,uploadDate:t.uploadDate instanceof Ce?t.uploadDate.toDate().toISOString().split("T")[0]:t.uploadDate}}async function OM(n){return(await ci(ui,{...n,rating:0,reviewCount:0,salesCount:0,uploadDate:Ce.now()})).id}async function aN(n){const e=$t(ui,Jt("uploaderId","==",n));return(await Rt(e)).docs.map(s=>{const r=s.data();return{id:s.id,title:r.title,description:r.description,category:r.category,price:r.price,rating:r.rating||0,reviewCount:r.reviewCount||0,salesCount:r.salesCount||0,previewPages:r.previewPages||[],thumbnailUrl:r.thumbnailUrl||"",pdfUrls:r.pdfUrls||[],uploaderId:r.uploaderId,uploaderName:r.uploaderName,uploadDate:r.uploadDate instanceof Ce?r.uploadDate.toDate().toISOString().split("T")[0]:r.uploadDate}})}async function FM(n){const e=$t(Dy,Jt("userId","==",n)),s=(await Rt(e)).docs.map(i=>i.data().noteId);if(s.length===0)return[];const r=[];for(const i of s){const o=await iN(i);o&&r.push(o)}return r}async function oN(n,e){const t=$t(Dy,Jt("userId","==",n),Jt("noteId","==",e));return!(await Rt(t)).empty}async function VM(n){const e=$t(Fl,Jt("userId","==",n)),s=(await Rt(e)).docs.map(i=>i.data().noteId);if(s.length===0)return[];const r=[];for(const i of s){const o=await iN(i);o&&r.push(o)}return r}async function UM(n,e){const t=$t(Fl,Jt("userId","==",n),Jt("noteId","==",e));(await Rt(t)).empty&&await ci(Fl,{userId:n,noteId:e,createdAt:Ce.now()})}async function BM(n,e){const t=$t(Fl,Jt("userId","==",n),Jt("noteId","==",e)),s=await Rt(t);for(const r of s.docs)await ky(Nt(Fl,r.id))}async function zM(n){const e=$t(Fl,Jt("userId","==",n));return(await Rt(e)).docs.map(s=>s.data().noteId)}async function $M(n){const e=$t(Dy,Jt("userId","==",n));return(await Rt(e)).docs.map(s=>s.data().noteId)}async function HM(n){const e=$t(up,Jt("noteId","==",n),fi("date","desc"));return(await Rt(e)).docs.map(s=>{const r=s.data();return{id:s.id,noteId:r.noteId,userId:r.userId,userName:r.userName,rating:r.rating,comment:r.comment,date:r.date instanceof Ce?r.date.toDate().toISOString().split("T")[0]:r.date}})}async function lN(n,e){const t=$t(up,Jt("userId","==",n),Jt("noteId","==",e));return!(await Rt(t)).empty}async function qM(n){if(await lN(n.userId,n.noteId))throw new Error("You have already reviewed this note");if(!await oN(n.userId,n.noteId))throw new Error("You must purchase this note before reviewing");await ci(up,{...n,date:Ce.now()}),await WM(n.noteId)}async function WM(n){const e=$t(up,Jt("noteId","==",n)),t=await Rt(e);if(t.empty){await Zs(Nt(ui,n),{rating:0,reviewCount:0});return}let s=0;t.docs.forEach(i=>{s+=i.data().rating});const r=Math.round(s/t.docs.length*10)/10;await Zs(Nt(ui,n),{rating:r,reviewCount:t.docs.length})}const ed=Rn(gn,"supportChats");async function Oy(){const n=await Rt(ka),e=[];for(const t of n.docs){const s=t.data(),r=await aN(t.id);e.push({id:t.id,name:s.name,email:s.email,avatarUrl:s.avatarUrl||"",totalEarnings:s.totalEarnings||0,uploadedNotes:r,isAdmin:s.isAdmin||!1,isVerified:s.isVerified||!1,isBlocked:s.isBlocked||!1})}return e}async function GM(n,e){await Zs(Nt(ka,n),{isVerified:e})}async function KM(n,e){await Zs(Nt(ka,n),{isBlocked:e})}async function YM(n,e){await Zs(Nt(ui,n),{isTopSelling:e})}async function XM(n,e){await Zs(Nt(ui,n),{isVerified:e})}async function QM(n){await ky(Nt(ui,n))}async function JM(n,e,t,s){const r=await ci(ed,{userId:n,userName:e,userEmail:t,status:"open",createdAt:Ce.now(),lastMessage:s,lastMessageAt:Ce.now()}),i=Rn(gn,"supportChats",r.id,"messages");return await ci(i,{senderId:n,senderName:e,isAdmin:!1,text:s,timestamp:Ce.now()}),r.id}async function cN(n,e,t,s,r){const i=Rn(gn,"supportChats",n,"messages");await ci(i,{senderId:e,senderName:t,isAdmin:s,text:r,timestamp:Ce.now()}),await Zs(Nt(ed,n),{lastMessage:r,lastMessageAt:Ce.now()})}async function uN(n){const e=Rn(gn,"supportChats",n,"messages"),t=$t(e,fi("timestamp","asc"));return(await Rt(t)).docs.map(r=>{const i=r.data();return{id:r.id,senderId:i.senderId,senderName:i.senderName,isAdmin:i.isAdmin,text:i.text,timestamp:i.timestamp instanceof Ce?i.timestamp.toDate().toISOString():i.timestamp}})}async function ZM(n){const e=$t(ed,Jt("userId","==",n));return(await Rt(e)).docs.map(r=>{const i=r.data();return{id:r.id,userId:i.userId,userName:i.userName,userEmail:i.userEmail,status:i.status,createdAt:i.createdAt instanceof Ce?i.createdAt.toDate().toISOString():i.createdAt,lastMessage:i.lastMessage,lastMessageAt:i.lastMessageAt instanceof Ce?i.lastMessageAt.toDate().toISOString():i.lastMessageAt}}).sort((r,i)=>new Date(i.lastMessageAt).getTime()-new Date(r.lastMessageAt).getTime())}async function eL(){const n=$t(ed,fi("lastMessageAt","desc"));return(await Rt(n)).docs.map(t=>{const s=t.data();return{id:t.id,userId:s.userId,userName:s.userName,userEmail:s.userEmail,status:s.status,createdAt:s.createdAt instanceof Ce?s.createdAt.toDate().toISOString():s.createdAt,lastMessage:s.lastMessage,lastMessageAt:s.lastMessageAt instanceof Ce?s.lastMessageAt.toDate().toISOString():s.lastMessageAt}})}async function tL(n,e){await Zs(Nt(ed,n),{status:e})}async function Fy(){const n=await lp(t0);return n.exists()?n.data().platformFee||30:(await _y(t0,{platformFee:30}),30)}async function sL(n){await _y(t0,{platformFee:n},{merge:!0})}async function nL(n,e,t,s,r){const i=await Fy(),o=r*(1-i/100),u=await ci(Vl,{userId:n,userName:e,userEmail:t,upiId:s,grossAmount:r,platformFee:i,netAmount:o,status:"pending",requestedAt:Ce.now()});return await Zs(Nt(ka,n),{pendingPayout:!0}),u.id}async function rL(){const n=$t(Vl,Jt("status","==","pending"),fi("requestedAt","desc"));return(await Rt(n)).docs.map(t=>{const s=t.data();return{id:t.id,userId:s.userId,userName:s.userName,userEmail:s.userEmail,upiId:s.upiId,grossAmount:s.grossAmount,platformFee:s.platformFee,netAmount:s.netAmount,status:s.status,requestedAt:s.requestedAt instanceof Ce?s.requestedAt.toDate().toISOString():s.requestedAt}})}async function iL(){const n=$t(Vl,fi("requestedAt","desc"));return(await Rt(n)).docs.map(t=>{const s=t.data();return{id:t.id,userId:s.userId,userName:s.userName,userEmail:s.userEmail,upiId:s.upiId,grossAmount:s.grossAmount,platformFee:s.platformFee,netAmount:s.netAmount,status:s.status,requestedAt:s.requestedAt instanceof Ce?s.requestedAt.toDate().toISOString():s.requestedAt,completedAt:s.completedAt instanceof Ce?s.completedAt.toDate().toISOString():s.completedAt}})}async function aL(n){const e=await lp(Nt(Vl,n));if(!e.exists())throw new Error("Payout request not found");const s=e.data().userId;await Zs(Nt(Vl,n),{status:"completed",completedAt:Ce.now()}),await Zs(Nt(ka,s),{totalEarnings:0,pendingPayout:!1})}async function o_(n){const e=$t(Vl,Jt("userId","==",n),Jt("status","==","pending")),t=await Rt(e);if(t.empty)return null;const s=t.docs[0],r=s.data();return{id:s.id,userId:r.userId,userName:r.userName,userEmail:r.userEmail,upiId:r.upiId,grossAmount:r.grossAmount,platformFee:r.platformFee,netAmount:r.netAmount,status:r.status,requestedAt:r.requestedAt instanceof Ce?r.requestedAt.toDate().toISOString():r.requestedAt}}async function oL(n,e,t,s,r,i){return(await ci(Zu,{userId:n,userName:e,userEmail:t,title:s,description:r,category:i,status:"pending",createdAt:Ce.now()})).id}async function lL(n){const e=$t(Zu,Jt("userId","==",n),fi("createdAt","desc"));return(await Rt(e)).docs.map(s=>{const r=s.data();return{id:s.id,userId:r.userId,userName:r.userName,userEmail:r.userEmail,title:r.title,description:r.description,category:r.category,status:r.status,createdAt:r.createdAt instanceof Ce?r.createdAt.toDate().toISOString():r.createdAt,response:r.response,responseLink:r.responseLink,respondedAt:r.respondedAt instanceof Ce?r.respondedAt.toDate().toISOString():r.respondedAt}})}async function cL(){const n=$t(Zu,fi("createdAt","desc"));return(await Rt(n)).docs.map(t=>{const s=t.data();return{id:t.id,userId:s.userId,userName:s.userName,userEmail:s.userEmail,title:s.title,description:s.description,category:s.category,status:s.status,createdAt:s.createdAt instanceof Ce?s.createdAt.toDate().toISOString():s.createdAt,response:s.response,responseLink:s.responseLink,respondedAt:s.respondedAt instanceof Ce?s.respondedAt.toDate().toISOString():s.respondedAt}})}async function uL(n,e,t){await Zs(Nt(Zu,n),{status:"responded",response:e,responseLink:t||null,respondedAt:Ce.now()})}async function dL(n){await Zs(Nt(Zu,n),{status:"closed"})}async function hL(n,e,t,s){return(await ci(My,{courseCode:n,courseName:e,driveLink:t,addedAt:Ce.now(),addedBy:s})).id}async function dN(){const n=$t(My,fi("addedAt","desc"));return(await Rt(n)).docs.map(t=>{const s=t.data();return{id:t.id,courseCode:s.courseCode,courseName:s.courseName,driveLink:s.driveLink,addedAt:s.addedAt instanceof Ce?s.addedAt.toDate().toISOString():s.addedAt,addedBy:s.addedBy}})}async function fL(n){await ky(Nt(My,n))}const hN=F.createContext(void 0);function pL({children:n}){const[e,t]=F.useState(null),[s,r]=F.useState(null),[i,o]=F.useState(!0),[u,d]=F.useState(!1);F.useEffect(()=>{const E=JI(Rh,async N=>{if(t(N),N){d(!1);const A=await hg(N.uid);r(A)}else r(null);o(!1)});return()=>E()},[]);const h=async()=>{if(e){const E=await hg(e.uid);r(E)}},p=()=>{d(!0)},m=()=>{d(!1)},x=async(E,N)=>{try{return await YI(Rh,E,N),d(!1),{success:!0}}catch(A){let T="Failed to sign in";return A.code==="auth/user-not-found"?T="No account found with this email":A.code==="auth/wrong-password"?T="Incorrect password":A.code==="auth/invalid-email"?T="Invalid email address":A.code==="auth/invalid-credential"&&(T="Invalid email or password"),{success:!1,error:T}}},v=async(E,N,A)=>{try{const T=await KI(Rh,N,A);await LM(T.user.uid,{name:E,email:N});const I=await hg(T.user.uid);return r(I),d(!1),{success:!0}}catch(T){let I="Failed to create account";return T.code==="auth/email-already-in-use"?I="An account with this email already exists":T.code==="auth/weak-password"?I="Password should be at least 6 characters":T.code==="auth/invalid-email"&&(I="Invalid email address"),{success:!1,error:I}}},w=async()=>{await ZI(Rh),t(null),r(null),d(!1)};return l.jsx(hN.Provider,{value:{user:e,userProfile:s,isAuthenticated:!!e,isGuest:u,isLoading:i,login:x,signup:v,logout:w,refreshUserProfile:h,enterGuestMode:p,exitGuestMode:m},children:n})}function Us(){const n=F.useContext(hN);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gL=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),l_=n=>{const e=gL(n);return e.charAt(0).toUpperCase()+e.slice(1)},fN=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xL=F.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...u},d)=>F.createElement("svg",{ref:d,...yL,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:fN("lucide",r),...u},[...o.map(([h,p])=>F.createElement(h,p)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=(n,e)=>{const t=F.forwardRef(({className:s,...r},i)=>F.createElement(xL,{ref:i,iconNode:e,className:fN(`lucide-${mL(l_(n))}`,`lucide-${n}`,s),...r}));return t.displayName=l_(n),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bL=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],zt=Te("arrow-left",bL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],Dh=Te("ban",vL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wL=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],_L=Te("bell",wL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kL=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ia=Te("book-open",kL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EL=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],Cu=Te("bookmark",EL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],AL=Te("calendar",NL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SL=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],TL=Te("camera",SL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CL=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],s0=Te("chevron-left",CL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IL=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],n0=Te("chevron-right",IL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],pN=Te("circle-alert",PL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ut=Te("circle-check-big",jL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],c_=Te("circle-x",RL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],fa=Te("clock",DL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],qn=Te("download",ML);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LL=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],dp=Te("external-link",LL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],mN=Te("eye-off",OL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FL=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],hp=Te("eye",FL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],gN=Te("file-check",VL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],ea=Te("file-question",UL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BL=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Vs=Te("file-text",BL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],r0=Te("file",zL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $L=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],i0=Te("graduation-cap",$L);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HL=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],fg=Te("house",HL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qL=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],WL=Te("image",qL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GL=[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]],Fs=Te("indian-rupee",GL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],YL=Te("info",KL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XL=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],QL=Te("library",XL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],yN=Te("link",JL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],e6=Te("loader-circle",ZL);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]],xN=Te("log-in",t6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],Af=Te("log-out",s6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],Ul=Te("mail",n6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],bN=Te("menu",r6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i6=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],mn=Te("message-square",i6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a6=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],pa=Te("moon",a6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],vN=Te("plus",o6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l6=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],c6=Te("save",l6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],ma=Te("search",u6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d6=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Iu=Te("send",d6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],a0=Te("settings",h6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f6=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],o0=Te("shield-check",f6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p6=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Wn=Te("shield",p6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m6=[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]],g6=Te("shopping-bag",m6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],x6=Te("shopping-cart",y6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],v6=Te("square-pen",b6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w6=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ro=Te("star",w6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _6=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],ga=Te("sun",_6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k6=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],E6=Te("tag",k6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N6=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],wN=Te("trash-2",N6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A6=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],Sf=Te("trending-up",A6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],fp=Te("truck",S6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T6=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Is=Te("upload",T6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],I6=Te("user-plus",C6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],di=Te("user",P6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Pu=Te("users",j6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],l0=Te("wallet",R6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],pi=Te("x",D6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],L6=Te("zoom-in",M6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],F6=Te("zoom-out",O6);function V6({currentPage:n,onNavigate:e,onLoginRequest:t}){const[s,r]=F.useState(!1),{isDark:i,toggleTheme:o}=Vu(),{userProfile:u,logout:d,isGuest:h,exitGuestMode:p}=Us(),m=u?.isAdmin||!1,x=["downloads","bookmarks","my-requests","earnings","profile","upload","support","settings"],v=[{id:"home",label:"Home",icon:fg},{id:"downloads",label:"Downloads",icon:qn},{id:"bookmarks",label:"Bookmarks",icon:Cu},{id:"my-requests",label:"My Requests",icon:ea},{id:"earnings",label:"Earnings",icon:Fs},{id:"profile",label:"My Profile",icon:di},{id:"upload",label:"Upload",icon:Is},{id:"support",label:"Support",icon:mn},{id:"settings",label:"Settings",icon:a0}],w=h?v.filter(P=>!x.includes(P.id)):v,N=m&&!h?[{id:"admin",label:"Dashboard",icon:Wn},{id:"admin-users",label:"Manage Users",icon:Pu},{id:"admin-pyqs",label:"Free PYQs",icon:ia},{id:"admin-payouts",label:"Payouts",icon:l0},{id:"admin-requests",label:"Note Requests",icon:ea},{id:"admin-earnings",label:"User Earnings",icon:Fs},{id:"admin-notes",label:"Manage Notes",icon:Vs},{id:"admin-chats",label:"Support Chats",icon:mn}]:w,A=m&&!h?[{id:"admin",label:"Dashboard",icon:Wn},{id:"admin-users",label:"Users",icon:Pu},{id:"admin-notes",label:"Notes",icon:Vs},{id:"admin-chats",label:"Chats",icon:mn}]:h?[{id:"home",label:"Home",icon:fg}]:[{id:"home",label:"Home",icon:fg},{id:"downloads",label:"Downloads",icon:qn},{id:"upload",label:"Upload",icon:Is},{id:"earnings",label:"Earnings",icon:Fs},{id:"profile",label:"Profile",icon:di}],T=m&&!h?[{id:"admin-pyqs",label:"Free PYQs",icon:ia},{id:"admin-payouts",label:"Payouts",icon:l0},{id:"admin-requests",label:"Note Requests",icon:ea},{id:"admin-earnings",label:"User Earnings",icon:Fs}]:h?[]:[{id:"my-requests",label:"My Requests",icon:ea},{id:"bookmarks",label:"Bookmarks",icon:Cu},{id:"support",label:"Support",icon:mn},{id:"settings",label:"Settings",icon:a0}],I=()=>{d()};return l.jsxs(l.Fragment,{children:[l.jsxs("aside",{className:"hidden lg:flex flex-col fixed left-0 top-0 h-screen w-64 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 z-50 isolate",style:{backgroundColor:"var(--sidebar-bg, #ffffff)"},children:[l.jsx("style",{children:".dark aside { --sidebar-bg: #0f172a !important; }"}),l.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-10 h-10 ${m?"bg-gradient-to-br from-purple-600 to-pink-600":"bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500"} rounded-xl flex items-center justify-center shadow-lg`,children:m?l.jsx(Wn,{className:"w-6 h-6 text-white"}):l.jsx(Is,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white",children:m?"Admin Panel":"Notezy"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400",children:m?"Management Console":"Knowledge Marketplace"})]})]})}),l.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:N.map(P=>{const U=P.icon,O=n===P.id;return l.jsxs("button",{onClick:()=>e(P.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${O?"text-white shadow-lg":"text-gray-700 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-800"}`,style:O?{backgroundColor:m?"#db2777":"#2563eb"}:{},children:[l.jsx(U,{className:"w-5 h-5"}),l.jsx("span",{children:P.label})]},P.id)})}),l.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 space-y-1",children:[l.jsx("button",{onClick:o,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-gray-700 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:i?l.jsxs(l.Fragment,{children:[l.jsx(ga,{className:"w-5 h-5"}),l.jsx("span",{children:"Light Mode"})]}):l.jsxs(l.Fragment,{children:[l.jsx(pa,{className:"w-5 h-5"}),l.jsx("span",{children:"Dark Mode"})]})}),h?l.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",children:[l.jsx(xN,{className:"w-5 h-5"}),l.jsx("span",{children:"Login / Sign Up"})]}):m&&l.jsxs("button",{onClick:I,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[l.jsx(Af,{className:"w-5 h-5"}),l.jsx("span",{children:"Logout"})]})]})]}),l.jsx("header",{className:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-white dark:bg-slate-900 border-b border-gray-200 dark:border-slate-700",children:l.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:`w-8 h-8 ${m?"bg-gradient-to-br from-purple-600 to-pink-600":"bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500"} rounded-lg flex items-center justify-center`,children:m?l.jsx(Wn,{className:"w-5 h-5 text-white"}):l.jsx(Is,{className:"w-5 h-5 text-white"})}),l.jsx("span",{className:"text-gray-900 dark:text-white font-semibold",children:m?"Admin":"Notezy"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:o,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800",children:i?l.jsx(ga,{className:"w-5 h-5 text-gray-700 dark:text-slate-300"}):l.jsx(pa,{className:"w-5 h-5 text-gray-700 dark:text-slate-300"})}),m&&l.jsx("button",{onClick:I,className:"p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20",children:l.jsx(Af,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),T.length>0&&l.jsx("button",{onClick:()=>r(!s),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800",children:s?l.jsx(pi,{className:"w-6 h-6 text-gray-700 dark:text-slate-300"}):l.jsx(bN,{className:"w-6 h-6 text-gray-700 dark:text-slate-300"})})]})]})}),s&&T.length>0&&l.jsx("div",{className:"lg:hidden fixed left-0 right-0 z-40 bg-white dark:bg-slate-900 border-b border-gray-200 dark:border-slate-700 shadow-lg",style:{top:"56px"},children:l.jsx("nav",{className:"p-2",children:T.map(P=>{const U=P.icon,O=n===P.id;return l.jsxs("button",{onClick:()=>{e(P.id),r(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${O?"bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-white":"text-gray-700 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-800"}`,children:[l.jsx(U,{className:"w-5 h-5"}),l.jsx("span",{children:P.label})]},P.id)})})}),l.jsx("nav",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-slate-900 border-t border-gray-200 dark:border-slate-700",children:l.jsx("div",{className:"flex justify-around items-center h-16",children:A.map(P=>{const U=P.icon,O=n===P.id;return l.jsxs("button",{onClick:()=>e(P.id),className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${O?m?"text-purple-600 dark:text-purple-400":"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-slate-400"}`,children:[l.jsx(U,{className:"w-5 h-5"}),l.jsx("span",{className:"text-[10px] mt-1",children:P.label})]},P.id)})})})]})}function U6({searchQuery:n,onSearchChange:e,showSearch:t=!0}){const{userProfile:s}=Us();return l.jsx("div",{className:"sticky top-0 z-30 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 lg:ml-64",children:l.jsxs("div",{className:"flex items-center gap-4 px-4 lg:px-8 py-4",children:[t&&l.jsx("div",{className:"flex-1 max-w-2xl",children:l.jsxs("div",{className:"relative",children:[l.jsx(ma,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 dark:text-gray-500"}),l.jsx("input",{type:"text",placeholder:"Search for notes, assignments, PYQs...",value:n,onChange:r=>e(r.target.value),className:"w-full pl-12 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-600 focus:border-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]})}),l.jsxs("div",{className:"hidden lg:flex items-center gap-3 ml-auto",children:[l.jsxs("button",{className:"relative p-2.5 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 transition-colors",children:[l.jsx(_L,{className:"w-5 h-5"}),l.jsx("span",{className:"absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full"})]}),l.jsxs("div",{className:"flex items-center gap-3 pl-3 border-l border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:s?.name||"User"}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:s?.uploadedNotes&&s.uploadedNotes.length>0?"Seller":"Member"})]}),l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center",children:l.jsx(di,{className:"w-5 h-5 text-white"})})]})]})]})})}function Vy({note:n,onPreview:e,onBookmark:t,onPurchase:s,onViewNotes:r,isBookmarked:i=!1,isPurchased:o=!1}){return l.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl overflow-hidden shadow-md hover:shadow-2xl transition-all border border-gray-200 dark:border-slate-800 group",children:[l.jsxs("div",{className:"relative h-48 bg-gray-200 dark:bg-slate-800 cursor-pointer overflow-hidden",onClick:()=>e(n),children:[l.jsx("img",{src:n.thumbnailUrl,alt:n.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/0 to-black/0 opacity-0 group-hover:opacity-100 transition-all flex items-center justify-center",children:l.jsx(hp,{className:"w-12 h-12 text-white transform translate-y-4 group-hover:translate-y-0 transition-transform"})}),l.jsx("div",{className:"absolute top-3 right-3",children:t&&l.jsx("button",{onClick:u=>{u.stopPropagation(),t(n.id)},className:`p-2.5 rounded-xl ${i?"bg-yellow-500 text-white shadow-lg":"bg-white/90 dark:bg-slate-900/90 text-gray-700 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-900 backdrop-blur-sm"} transition-all`,children:l.jsx(Cu,{className:`w-4 h-4 ${i?"fill-current":""}`})})})]}),l.jsxs("div",{className:"p-5",children:[l.jsxs("div",{className:"flex items-start justify-between gap-2 mb-3",children:[l.jsx("h3",{className:"text-gray-900 dark:text-white line-clamp-2 flex-1",children:n.title}),l.jsxs("span",{className:"bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 bg-clip-text text-transparent whitespace-nowrap",children:["",n.price]})]}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400 text-sm line-clamp-2 mb-4",children:n.description}),l.jsxs("div",{className:"flex items-center gap-3 mb-4 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ro,{className:"w-4 h-4 fill-yellow-500 text-yellow-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:n.rating})]}),l.jsxs("span",{className:"text-gray-500 dark:text-slate-400",children:["(",n.reviewCount,")"]}),l.jsx("span",{className:"text-gray-400 dark:text-slate-600",children:""}),l.jsxs("span",{className:"text-gray-600 dark:text-slate-400",children:[n.salesCount," sales"]})]}),l.jsxs("div",{className:"text-sm text-gray-500 dark:text-slate-400 mb-4",children:["by ",n.uploaderName]}),!o&&s&&l.jsxs("button",{onClick:()=>s(n.id),className:"w-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-white py-2.5 px-4 rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[l.jsx(x6,{className:"w-4 h-4"}),"Purchase Now"]}),o&&l.jsxs("button",{onClick:()=>r?r(n.id):e(n),className:"w-full bg-gradient-to-r from-green-600 to-teal-600 text-white py-2.5 px-4 rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),"View Notes"]})]})]})}function B6({notes:n,freePYQs:e,onPreview:t,onBookmark:s,onPurchase:r,onViewNotes:i,bookmarkedIds:o,purchasedIds:u,searchQuery:d,onSearchChange:h,onRequestNotes:p}){const[m,x]=F.useState(null),v=[{id:"assignment",label:"Assignments",icon:Vs,color:"from-blue-500 to-blue-600"},{id:"pyq",label:"PYQ Papers",icon:ia,color:"from-green-500 to-green-600"},{id:"lecture-notes",label:"Lecture Notes",icon:QL,color:"from-purple-500 to-purple-600"}],w=n.filter(T=>{const I=T.title.toLowerCase().includes(d.toLowerCase())||T.description.toLowerCase().includes(d.toLowerCase()),P=!m||m==="pyq"||T.category===m;return I&&P}),E=e.filter(T=>T.courseCode.toLowerCase().includes(d.toLowerCase())||T.courseName.toLowerCase().includes(d.toLowerCase())),N=[...n].sort((T,I)=>I.salesCount-T.salesCount).slice(0,8),A=m==="pyq";return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[h&&l.jsx("div",{className:"lg:hidden mb-6",children:l.jsxs("div",{className:"relative",children:[l.jsx(ma,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 dark:text-slate-500"}),l.jsx("input",{type:"text",placeholder:"Search for notes, assignments, PYQs...",value:d,onChange:T=>h(T.target.value),className:"w-full pl-12 pr-4 py-3 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-600 focus:border-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-slate-500"})]})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:v.map(T=>{const I=T.icon,P=m===T.id,U=T.id==="pyq"?e.length:n.filter(O=>O.category===T.id).length;return l.jsxs("button",{onClick:()=>x(P?null:T.id),className:`bg-gradient-to-br ${T.color} ${P?"ring-4 ring-offset-2 dark:ring-offset-gray-950 ring-gray-400 dark:ring-gray-600":""} text-white p-6 rounded-2xl hover:shadow-2xl transition-all flex items-center gap-4 shadow-lg`,children:[l.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl backdrop-blur-sm",children:l.jsx(I,{className:"w-8 h-8"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("div",{className:"text-white",children:T.label}),l.jsxs("div",{className:"text-white text-opacity-90 text-sm",children:[U," ",T.id==="pyq"?"free papers":"items"]})]})]},T.id)})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-gray-900 dark:text-white mb-6",children:m?`${v.find(T=>T.id===m)?.label}${A?" (Free)":""}`:"Top Purchased Notes"}),A?E.length>0?l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:E.map(T=>l.jsxs("a",{href:T.driveLink,target:"_blank",rel:"noopener noreferrer",className:"bg-white dark:bg-slate-900 rounded-2xl border border-gray-200 dark:border-slate-800 p-6 hover:shadow-xl hover:border-green-300 dark:hover:border-green-700 transition-all group",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsx("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 p-3 rounded-xl",children:l.jsx(ia,{className:"w-6 h-6 text-white"})}),l.jsx("span",{className:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs px-2 py-1 rounded-lg font-medium",children:"FREE"})]}),l.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-1 group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors",children:T.courseCode}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 line-clamp-2",children:T.courseName}),l.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400 text-sm font-medium",children:[l.jsx(dp,{className:"w-4 h-4"}),"Open in Google Drive"]})]},T.id))}):l.jsxs("div",{className:"text-center py-16 bg-white dark:bg-slate-900 rounded-2xl border border-gray-200 dark:border-slate-800",children:[l.jsx(ia,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-slate-700"}),l.jsx("p",{className:"text-gray-500 dark:text-slate-400",children:"No PYQ papers available yet"})]}):w.length>0?l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:(m?w:N).map(T=>l.jsx(Vy,{note:T,onPreview:t,onBookmark:s,onPurchase:r,onViewNotes:i,isBookmarked:o.includes(T.id),isPurchased:u.includes(T.id)},T.id))}):l.jsxs("div",{className:"text-center py-16 bg-white dark:bg-slate-900 rounded-2xl border border-gray-200 dark:border-slate-800",children:[l.jsx(ma,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-slate-700"}),l.jsx("p",{className:"text-gray-500 dark:text-slate-400 mb-4",children:"No notes found matching your search"}),p&&d&&l.jsxs("button",{onClick:p,className:"inline-flex items-center gap-2 px-6 py-3 text-white rounded-xl hover:opacity-90 transition-colors",style:{backgroundColor:"#8b5cf6"},children:[l.jsx(ea,{className:"w-5 h-5"}),'Request "',d,'"']})]})]})]})})}function z6({purchasedNotes:n}){const e=(s,r)=>{window.open(s,"_blank")},t=s=>{s.pdfUrls&&s.pdfUrls.length>0&&s.pdfUrls.forEach((r,i)=>{setTimeout(()=>{window.open(r,"_blank")},i*500)})};return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(qn,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white",children:"My Downloads"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Download your purchased notes"})]})]}),n.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800/50 rounded-xl p-4 mb-6",children:l.jsxs("p",{className:"text-blue-900 dark:text-blue-200",children:["You have purchased ",n.length," notes"]})}),l.jsx("div",{className:"space-y-4",children:n.map(s=>l.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl border border-gray-200 dark:border-slate-800 overflow-hidden shadow-lg",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[l.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center flex-shrink-0",children:l.jsx(Vs,{className:"w-8 h-8 text-white"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-1",children:s.title}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400 text-sm line-clamp-2",children:s.description}),l.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500 dark:text-slate-500",children:[l.jsx("span",{className:"capitalize",children:s.category}),l.jsx("span",{children:""}),l.jsxs("span",{children:["By ",s.uploaderName]}),s.pdfUrls&&s.pdfUrls.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsxs("span",{children:[s.pdfUrls.length," PDF file(s)"]})]})]})]}),l.jsx("div",{className:"px-3 py-1 bg-green-500 text-white text-xs rounded-full flex-shrink-0",children:"Purchased"})]}),s.pdfUrls&&s.pdfUrls.length>0?l.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800 rounded-xl p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("span",{className:"text-sm text-gray-700 dark:text-slate-300",children:[s.pdfUrls.length," PDF file(s) available"]}),s.pdfUrls.length>1&&l.jsxs("button",{onClick:()=>t(s),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white text-sm rounded-lg hover:shadow-lg transition-all",children:[l.jsx(qn,{className:"w-4 h-4"}),"Download All"]})]}),l.jsx("div",{className:"space-y-2",children:s.pdfUrls.map((r,i)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(r0,{className:"w-5 h-5 text-red-500"}),l.jsxs("span",{className:"text-sm text-gray-700 dark:text-slate-300",children:[s.title," - File ",i+1,".pdf"]})]}),l.jsxs("button",{onClick:()=>e(r,`${s.title}_${i+1}.pdf`),className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors",children:[l.jsx(qn,{className:"w-4 h-4"}),"Download"]})]},i))})]}):l.jsx("div",{className:"bg-gray-50 dark:bg-slate-800 rounded-xl p-4 text-center",children:l.jsx("p",{className:"text-gray-500 dark:text-slate-400 text-sm",children:"No PDF files available for this note"})})]})},s.id))})]}):l.jsxs("div",{className:"text-center py-20 bg-white dark:bg-slate-900 rounded-2xl border border-gray-200 dark:border-slate-800",children:[l.jsx(qn,{className:"w-20 h-20 mx-auto mb-4 text-gray-300 dark:text-slate-700"}),l.jsx("h3",{className:"text-gray-900 dark:text-white mb-2",children:"No Downloads Yet"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"Purchase some notes to see them here"})]})]})})}function $6({bookmarkedNotes:n,onPreview:e,onBookmark:t,onPurchase:s,onViewNotes:r,purchasedIds:i}){return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(Cu,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white",children:"My Bookmarks"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Your saved notes collection"})]})]}),n.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800/50 rounded-xl p-4 mb-6",children:l.jsxs("p",{className:"text-yellow-900 dark:text-yellow-200",children:["You have ",n.length," bookmarked notes"]})}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:n.map(o=>l.jsx(Vy,{note:o,onPreview:e,onBookmark:t,onPurchase:s,onViewNotes:r,isBookmarked:!0,isPurchased:i.includes(o.id)},o.id))})]}):l.jsxs("div",{className:"text-center py-20 bg-white dark:bg-slate-900 rounded-2xl border border-gray-200 dark:border-slate-800",children:[l.jsx(Cu,{className:"w-20 h-20 mx-auto mb-4 text-gray-300 dark:text-slate-700"}),l.jsx("h3",{className:"text-gray-900 dark:text-white mb-2",children:"No Bookmarks Yet"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"Bookmark notes to save them for later"})]})]})})}function H6({totalEarnings:n,uploadedNotes:e}){const{user:t,userProfile:s}=Us(),[r,i]=F.useState(!1),[o,u]=F.useState(""),[d,h]=F.useState(30),[p,m]=F.useState(null),[x,v]=F.useState(!1),[w,E]=F.useState(""),N=e.reduce((P,U)=>P+U.salesCount,0),A=e.map(P=>({...P,earnings:P.price*P.salesCount})).sort((P,U)=>U.earnings-P.earnings),T=n*(1-d/100);F.useEffect(()=>{async function P(){try{const U=await Fy();if(h(U),t?.uid){const O=await o_(t.uid);m(O)}}catch(U){console.error("Error loading payout data:",U)}}P()},[t?.uid]);async function I(P){if(P.preventDefault(),!t||!s||!o.trim())return;if(!/^[\w.-]+@[\w]+$/.test(o.trim())){E("Invalid UPI ID format (e.g., name@upi)");return}v(!0),E("");try{await nL(t.uid,s.name,s.email,o.trim(),n);const O=await o_(t.uid);m(O),i(!1),u("")}catch(O){E(O.message||"Failed to submit request")}finally{v(!1)}}return l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:[l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-emerald-600 rounded-xl flex items-center justify-center",children:l.jsx(Fs,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white",children:"My Earnings"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Track your sales performance"})]})]}),p&&l.jsx("div",{className:"mb-6 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-2xl p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(fa,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-yellow-800 dark:text-yellow-200 font-medium",children:"Payout Request Pending"}),l.jsxs("p",{className:"text-yellow-600 dark:text-yellow-400 text-sm",children:["",p.netAmount.toFixed(2)," will be sent to ",p.upiId]})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[l.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 text-white p-6 rounded-2xl shadow-xl",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx(Fs,{className:"w-8 h-8"}),l.jsx("span",{className:"text-white text-opacity-90",children:"Available Balance"})]}),l.jsxs("div",{className:"text-white text-3xl",children:["",n.toFixed(2)]}),l.jsxs("div",{className:"text-white text-opacity-75 text-sm mt-1",children:["You'll receive ",T.toFixed(2)," (",100-d,"% after ",d,"% platform fee)"]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-2xl shadow-xl",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx(g6,{className:"w-8 h-8"}),l.jsx("span",{className:"text-white text-opacity-90",children:"Total Sales"})]}),l.jsx("div",{className:"text-white text-3xl",children:N}),l.jsx("div",{className:"text-white text-opacity-75 text-sm mt-1",children:"Notes sold"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-2xl shadow-xl",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx(Vs,{className:"w-8 h-8"}),l.jsx("span",{className:"text-white text-opacity-90",children:"Active Listings"})]}),l.jsx("div",{className:"text-white text-3xl",children:e.length}),l.jsx("div",{className:"text-white text-opacity-75 text-sm mt-1",children:"Available for sale"})]})]}),n>0&&!p&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("button",{onClick:()=>i(!0),className:"w-full md:w-auto px-8 py-4 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-2xl font-medium text-lg shadow-xl hover:shadow-2xl transition-all flex items-center justify-center gap-3",children:[l.jsx(l0,{className:"w-6 h-6"}),"Redeem ",T.toFixed(2)," to UPI"]}),l.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-2",children:["Platform fee: ",d,"%  You'll receive ",100-d,"% of your earnings"]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 overflow-hidden shadow-lg",children:[l.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-800",children:l.jsx("h2",{className:"text-gray-900 dark:text-white",children:"Earnings Breakdown"})}),A.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Note Title"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Price"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Sales"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Rating"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Earnings"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:A.map(P=>l.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4 text-gray-900 dark:text-white",children:P.title}),l.jsxs("td",{className:"px-6 py-4 text-gray-700 dark:text-gray-300",children:["",P.price]}),l.jsx("td",{className:"px-6 py-4 text-gray-700 dark:text-gray-300",children:P.salesCount}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-1 text-yellow-500",children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:P.rating}),l.jsxs("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:["(",P.reviewCount,")"]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("span",{className:"bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent",children:["",P.earnings.toFixed(2)]})})]},P.id))})]})}):l.jsxs("div",{className:"p-12 text-center text-gray-500 dark:text-gray-400",children:[l.jsx(Sf,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-700"}),l.jsx("p",{children:"No earnings yet. Start uploading notes to earn!"})]})]})]}),r&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"Redeem Earnings"}),l.jsx("button",{onClick:()=>i(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors",children:l.jsx(pi,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 rounded-xl mb-6 border border-green-200 dark:border-green-800",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Earnings"}),l.jsxs("span",{className:"text-gray-900 dark:text-white font-medium",children:["",n.toFixed(2)]})]}),l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Platform Fee (",d,"%)"]}),l.jsxs("span",{className:"text-red-600 dark:text-red-400",children:["-",(n*d/100).toFixed(2)]})]}),l.jsx("div",{className:"border-t border-green-200 dark:border-green-700 pt-2 mt-2",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-green-700 dark:text-green-400 font-medium",children:"You'll Receive"}),l.jsxs("span",{className:"text-green-700 dark:text-green-400 font-bold text-xl",children:["",T.toFixed(2)]})]})})]}),l.jsxs("form",{onSubmit:I,children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm mb-2",children:"Your UPI ID"}),l.jsx("input",{type:"text",value:o,onChange:P=>u(P.target.value),placeholder:"yourname@upi",className:"w-full px-4 py-3 bg-gray-100 dark:bg-gray-800 border-0 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 text-gray-900 dark:text-white",required:!0}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs mt-2",children:"Enter your UPI ID (e.g., name@paytm, name@gpay, 9876543210@ybl)"})]}),w&&l.jsx("div",{className:"mb-4 text-red-600 dark:text-red-400 text-sm",children:w}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 py-3 px-4 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:x||!o.trim(),className:"flex-1 py-3 px-4 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-xl font-medium hover:shadow-lg transition-all disabled:opacity-50",children:x?"Submitting...":"Submit Request"})]})]}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs text-center mt-4",children:"Admin will manually process your payout within 24-48 hours"})]})})]})}async function q6(n,e,t){const s=n.name.split(".").pop()||"jpg",r=`notes/${e}/preview_${t}.${s}`,i=Py(Ry,r);return await Cy(i,n),await Iy(i)}async function W6(n,e){const t=n.name.split(".").pop()||"pdf",s=`notes/${e}/document.${t}`,r=Py(Ry,s);return await Cy(r,n),await Iy(r)}async function G6(n,e){const t=n.name.split(".").pop()||"jpg",s=`avatars/${e}/avatar.${t}`,r=Py(Ry,s);return await Cy(r,n),await Iy(r)}function K6({user:n,onPreview:e}){const{user:t,refreshUserProfile:s}=Us(),[r,i]=F.useState(!1),[o,u]=F.useState(n.name),[d,h]=F.useState(n.email),[p,m]=F.useState(n.bio||""),[x,v]=F.useState(n.avatarUrl),[w,E]=F.useState(!1),N=F.useRef(null),A=async()=>{if(t)try{await a_(t.uid,{name:o,avatarUrl:x,bio:p}),s&&await s(),i(!1)}catch(P){console.error("Error updating profile:",P)}},T=()=>{N.current?.click()},I=async P=>{if(!P.target.files||!P.target.files[0]||!t)return;const U=P.target.files[0];E(!0);try{const O=await G6(U,t.uid);v(O),await a_(t.uid,{avatarUrl:O}),s&&await s()}catch(O){console.error("Error uploading avatar:",O)}finally{E(!1)}};return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 p-6 mb-8 shadow-lg",children:l.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-6",children:[l.jsxs("div",{className:"relative group",children:[l.jsxs("div",{className:"w-24 h-24 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center flex-shrink-0 shadow-xl overflow-hidden",children:[x?l.jsx("img",{src:x,alt:n.name,className:"w-full h-full rounded-2xl object-cover"}):l.jsx(di,{className:"w-12 h-12 text-white"}),w&&l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-2xl",children:l.jsx("div",{className:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),l.jsx("button",{onClick:T,disabled:w,className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-50 flex items-center justify-center rounded-2xl transition-all cursor-pointer group",children:l.jsx(TL,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})}),l.jsx("input",{ref:N,type:"file",accept:"image/*",onChange:I,className:"hidden"}),l.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-green-500 rounded-lg border-4 border-white dark:border-gray-900"})]}),l.jsx("div",{className:"flex-1",children:r?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-1 text-sm",children:"Name"}),l.jsx("input",{type:"text",value:o,onChange:P=>u(P.target.value),className:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-1 text-sm",children:"Email"}),l.jsx("input",{type:"email",value:d,onChange:P=>h(P.target.value),disabled:!0,className:"w-full px-4 py-2.5 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-700 rounded-xl text-gray-500 dark:text-gray-400 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Email cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-1 text-sm",children:"Bio"}),l.jsx("textarea",{value:p,onChange:P=>m(P.target.value),placeholder:"Tell us about yourself...",rows:3,maxLength:200,className:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white resize-none"}),l.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[p.length,"/200 characters"]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:A,className:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all",children:"Save Changes"}),l.jsx("button",{onClick:()=>{i(!1),u(n.name),h(n.email),m(n.bio||""),v(n.avatarUrl)},className:"px-6 py-2.5 bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors",children:"Cancel"})]})]}):l.jsxs(l.Fragment,{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white mb-2",children:n.name}),n.bio&&l.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-3 italic",children:['"',n.bio,'"']}),l.jsxs("div",{className:"flex flex-col gap-2 text-gray-600 dark:text-gray-400 mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ul,{className:"w-4 h-4"}),l.jsx("span",{children:n.email})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(AL,{className:"w-4 h-4"}),l.jsx("span",{children:"Member since 2024"})]})]}),l.jsxs("button",{onClick:()=>i(!0),className:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all flex items-center gap-2",children:[l.jsx(v6,{className:"w-4 h-4"}),"Edit Profile"]})]})}),l.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 text-white rounded-2xl p-6 text-center shadow-xl",children:[l.jsx("div",{className:"text-white text-opacity-90 text-sm mb-1",children:"Total Earnings"}),l.jsxs("div",{className:"text-white text-3xl",children:["",n.totalEarnings.toFixed(2)]})]})]})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-gray-900 dark:text-white mb-6",children:["My Uploaded Notes (",n.uploadedNotes.length,")"]}),n.uploadedNotes.length>0?l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:n.uploadedNotes.map(P=>l.jsx(Vy,{note:P,onPreview:e,isPurchased:!0},P.id))}):l.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800",children:[l.jsx(di,{className:"w-20 h-20 mx-auto mb-4 text-gray-300 dark:text-gray-700"}),l.jsx("h3",{className:"text-gray-900 dark:text-white mb-2",children:"No Uploaded Notes"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Start uploading notes to build your collection"})]})]})]})})}const Ls=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),c0=[.001,0,0,.001,0,0],pg=1.35,dn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ji={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ju="pdfjs_internal_editor_",qe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ze={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Y6={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},u0={TRIANGLES:1,LATTICE:2},fs={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},rf={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Kt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ml={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},pp={ERRORS:0,WARNINGS:1,INFOS:5},Ru={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Xc={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},X6={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let mp=pp.WARNINGS;function Q6(n){Number.isInteger(n)&&(mp=n)}function J6(){return mp}function gp(n){mp>=pp.INFOS&&console.info(`Info: ${n}`)}function ze(n){mp>=pp.WARNINGS&&console.warn(`Warning: ${n}`)}function ft(n){throw new Error(n)}function et(n,e){n||ft(e)}function Z6(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function _N(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=rO(n)}catch{}const s=e?URL.parse(n,e):URL.parse(n);return Z6(s)?s:null}function kN(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&_N(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function $e(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const wo=(function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e})();class u_ extends wo{constructor(e,t){super(e,"PasswordException"),this.code=t}}class mg extends wo{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class d0 extends wo{constructor(e){super(e,"InvalidPDFException")}}class Tf extends wo{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class eO extends wo{constructor(e){super(e,"FormatError")}}class ya extends wo{constructor(e){super(e,"AbortException")}}function EN(n){(typeof n!="object"||n?.length===void 0)&&ft("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let r=0;r<e;r+=t){const i=Math.min(r+t,e),o=n.subarray(r,i);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function td(n){typeof n!="string"&&ft("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function tO(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function sO(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function nO(){try{return new Function(""),!0}catch{return!1}}class bs{static get isLittleEndian(){return $e(this,"isLittleEndian",sO())}static get isEvalSupported(){return $e(this,"isEvalSupported",nO())}static get isOffscreenCanvasSupported(){return $e(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return $e(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return $e(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return $e(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return $e(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return $e(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const gg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class we{static makeHexColor(e,t,s){return`#${gg[e]}${gg[t]}${gg[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const r=e[s],i=e[s+1];e[s]=r*t[0]+i*t[2]+t[4],e[s+1]=r*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const r=t[0],i=t[1],o=t[2],u=t[3],d=t[4],h=t[5];for(let p=0;p<6;p+=2){const m=e[s+p],x=e[s+p+1];e[s+p]=m*r+x*o+d,e[s+p+1]=m*i+x*u+h}}static applyInverseTransform(e,t){const s=e[0],r=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-s*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,s){const r=t[0],i=t[1],o=t[2],u=t[3],d=t[4],h=t[5],p=e[0],m=e[1],x=e[2],v=e[3];let w=r*p+d,E=w,N=r*x+d,A=N,T=u*m+h,I=T,P=u*v+h,U=P;if(i!==0||o!==0){const O=i*p,R=i*x,C=o*m,D=o*v;w+=C,A+=C,N+=D,E+=D,T+=O,U+=O,P+=R,I+=R}s[0]=Math.min(s[0],w,N,E,A),s[1]=Math.min(s[1],T,P,I,U),s[2]=Math.max(s[2],w,N,E,A),s[3]=Math.max(s[3],T,P,I,U)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],r=e[1],i=e[2],o=e[3],u=s**2+r**2,d=s*i+r*o,h=i**2+o**2,p=(u+h)/2,m=Math.sqrt(p**2-(u*h-d**2));t[0]=Math.sqrt(p+m||1),t[1]=Math.sqrt(p-m||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>r)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>o?null:[s,i,r,o]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,r,i){i[0]=Math.min(i[0],e,s),i[1]=Math.min(i[1],t,r),i[2]=Math.max(i[2],e,s),i[3]=Math.max(i[3],t,r)}static#e(e,t,s,r,i,o,u,d,h,p){if(h<=0||h>=1)return;const m=1-h,x=h*h,v=x*h,w=m*(m*(m*e+3*h*t)+3*x*s)+v*r,E=m*(m*(m*i+3*h*o)+3*x*u)+v*d;p[0]=Math.min(p[0],w),p[1]=Math.min(p[1],E),p[2]=Math.max(p[2],w),p[3]=Math.max(p[3],E)}static#t(e,t,s,r,i,o,u,d,h,p,m,x){if(Math.abs(h)<1e-12){Math.abs(p)>=1e-12&&this.#e(e,t,s,r,i,o,u,d,-m/p,x);return}const v=p**2-4*m*h;if(v<0)return;const w=Math.sqrt(v),E=2*h;this.#e(e,t,s,r,i,o,u,d,(-p+w)/E,x),this.#e(e,t,s,r,i,o,u,d,(-p-w)/E,x)}static bezierBoundingBox(e,t,s,r,i,o,u,d,h){h[0]=Math.min(h[0],e,u),h[1]=Math.min(h[1],t,d),h[2]=Math.max(h[2],e,u),h[3]=Math.max(h[3],t,d),this.#t(e,s,i,u,t,r,o,d,3*(-e+3*(s-i)+u),6*(e-2*s+i),3*(s-e),h),this.#t(e,s,i,u,t,r,o,d,3*(-t+3*(r-o)+d),6*(t-2*r+o),3*(r-t),h)}}function rO(n){return decodeURIComponent(escape(n))}let yg=null,d_=null;function iO(n){return yg||(yg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,d_=new Map([["","t"]])),n.replaceAll(yg,(e,t,s)=>t?t.normalize("NFKC"):d_.get(s))}function NN(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),EN(n)}const bl="pdfjs_internal_id_";function aO(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,r,...i]=t;if(!n(s)&&!Number.isInteger(s)||!e(r))return!1;const o=i.length;let u=!0;switch(r.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;u=!1;break;default:return!1}for(const d of i)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function Os(n,e,t){return Math.min(Math.max(n,e),t)}function AN(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(EN(n))}function oO(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):td(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class Du{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function r(i){if(!i)return;let o=null;const u=i.name;if(u==="#text")o=i.value;else if(Du.shouldBuildText(u))i?.attributes?.textContent?o=i.attributes.textContent:i.value&&(o=i.value);else return;if(o!==null&&t.push({str:o}),!!i.children)for(const d of i.children)r(d)}return r(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class SN{static setupStorage(e,t,s,r,i){const o=r.getValue(t,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),i==="print")break;e.addEventListener("input",u=>{r.setValue(t,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?e.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",u=>{r.setValue(t,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),i==="print")break;e.addEventListener("input",u=>{r.setValue(t,{value:u.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const u of s.children)u.attributes.value===o.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}e.addEventListener("input",u=>{const d=u.target.options,h=d.selectedIndex===-1?"":d[d.selectedIndex].value;r.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:r,linkService:i}){const{attributes:o}=t,u=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(const[d,h]of Object.entries(o))if(h!=null)switch(d){case"class":h.length&&e.setAttribute(d,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!u||d!=="href"&&d!=="newWindow")&&e.setAttribute(d,h)}u&&i.addLinkAttributes(e,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(e,o.dataId,t,s)}static render(e){const t=e.annotationStorage,s=e.linkService,r=e.xfaHtml,i=e.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:i,linkService:s});const u=i!=="richText",d=e.div;if(d.append(o),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;d.style.transform=m}u&&d.setAttribute("class","xfaLayer xfaFont");const h=[];if(r.children.length===0){if(r.value){const m=document.createTextNode(r.value);o.append(m),u&&Du.shouldBuildText(r.name)&&h.push(m)}return{textDivs:h}}const p=[[r,-1,o]];for(;p.length>0;){const[m,x,v]=p.at(-1);if(x+1===m.children.length){p.pop();continue}const w=m.children[++p.at(-1)[1]];if(w===null)continue;const{name:E}=w;if(E==="#text"){const A=document.createTextNode(w.value);h.push(A),v.append(A);continue}const N=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,E):document.createElement(E);if(v.append(N),w.attributes&&this.setAttributes({html:N,element:w,storage:t,intent:i,linkService:s}),w.children?.length>0)p.push([w,-1,N]);else if(w.value){const A=document.createTextNode(w.value);u&&Du.shouldBuildText(E)&&h.push(A),N.append(A)}}for(const m of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Xr="http://www.w3.org/2000/svg";class Bl{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function sd(n,e="text"){if(lu(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class nd{constructor({viewBox:e,userUnit:t,scale:s,rotation:r,offsetX:i=0,offsetY:o=0,dontFlip:u=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=r,this.offsetX=i,this.offsetY=o,s*=t;const d=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let p,m,x,v;switch(r%=360,r<0&&(r+=360),r){case 180:p=-1,m=0,x=0,v=1;break;case 90:p=0,m=1,x=1,v=0;break;case 270:p=0,m=-1,x=-1,v=0;break;case 0:p=1,m=0,x=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(x=-x,v=-v);let w,E,N,A;p===0?(w=Math.abs(h-e[1])*s+i,E=Math.abs(d-e[0])*s+o,N=(e[3]-e[1])*s,A=(e[2]-e[0])*s):(w=Math.abs(d-e[0])*s+i,E=Math.abs(h-e[1])*s+o,N=(e[2]-e[0])*s,A=(e[3]-e[1])*s),this.transform=[p*s,m*s,x*s,v*s,w-p*s*d-x*s*h,E-m*s*d-v*s*h],this.width=N,this.height=A}get rawDims(){const e=this.viewBox;return $e(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:i=!1}={}){return new nd({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:r,dontFlip:i})}convertToViewportPoint(e,t){const s=[e,t];return we.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];we.applyTransform(t,this.transform);const s=[e[2],e[3]];return we.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return we.applyInverseTransform(s,this.transform),s}}class Uy extends wo{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function yp(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function By(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function lO(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function cO(n,e="document.pdf"){if(typeof n!="string")return e;if(yp(n))return ze('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const r=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},i=/\.pdf$/i,o=s.pathname.split("/").at(-1);if(i.test(o))return r(o);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const h of u)if(i.test(h))return r(h);const d=Array.from(s.searchParams.keys()).reverse();for(const h of d)if(i.test(h))return r(h)}if(s.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(d)return r(d[0])}return e}class h_{started=Object.create(null);times=[];time(e){e in this.started&&ze(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ze(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:r,end:i}of this.times)e.push(`${s.padEnd(t)} ${i-r}ms
`);return e.join("")}}function lu(n,e){const t=e?URL.parse(n,e):URL.parse(n);return t?.protocol==="http:"||t?.protocol==="https:"}function Pn(n){n.preventDefault()}function Pt(n){n.preventDefault(),n.stopPropagation()}function uO(n){console.log("Deprecated API usage: "+n)}class h0{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const s=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let u=parseInt(t[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(t[6],10);d=d>=0&&d<=59?d:0;const h=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let m=parseInt(t[9],10)||0;return m=m>=0&&m<=59?m:0,h==="-"?(o+=p,u+=m):h==="+"&&(o-=p,u-=m),new Date(Date.UTC(s,r,i,o,u,d))}}function dO(n,{scale:e=1,rotation:t=0}){const{width:s,height:r}=n.attributes.style,i=[0,0,parseInt(s),parseInt(r)];return new nd({viewBox:i,userUnit:1,scale:e,rotation:t})}function rd(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ze(`Not a valid color format: "${n}"`),[0,0,0])}function hO(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,rd(s))}e.remove()}function kt(n){const{a:e,b:t,c:s,d:r,e:i,f:o}=n.getTransform();return[e,t,s,r,i,o]}function gr(n){const{a:e,b:t,c:s,d:r,e:i,f:o}=n.getTransform().invertSelf();return[e,t,s,r,i,o]}function ho(n,e,t=!1,s=!0){if(e instanceof nd){const{pageWidth:r,pageHeight:i}=e.rawDims,{style:o}=n,u=bs.isCSSRoundSupported,d=`var(--total-scale-factor) * ${r}px`,h=`var(--total-scale-factor) * ${i}px`,p=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,m=u?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!t||e.rotation%180===0?(o.width=p,o.height=m):(o.width=m,o.height=p)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Cr{constructor(){const{pixelRatio:e}=Cr;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,r,i=-1){let o=1/0,u=1/0,d=1/0;s=Cr.capPixels(s,i),s>0&&(o=Math.sqrt(s/(e*t))),r!==-1&&(u=r/e,d=r/t);const h=Math.min(o,u,d);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const f0=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class fO{static get isDarkMode(){return $e(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class pO{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:s}=window.getComputedStyle(e);return e.remove(),$e(this,"commentForegroundColor",rd(s))}}function mO(n,e,t,s){s=Math.min(Math.max(s??1,0),1);const r=255*(1-s);return n=Math.round(n*s+r),e=Math.round(e*s+r),t=Math.round(t*s+r),[n,e,t]}function f_(n,e){const t=n[0]/255,s=n[1]/255,r=n[2]/255,i=Math.max(t,s,r),o=Math.min(t,s,r),u=(i+o)/2;if(i===o)e[0]=e[1]=0;else{const d=i-o;switch(e[1]=u<.5?d/(i+o):d/(2-i-o),i){case t:e[0]=((s-r)/d+(s<r?6:0))*60;break;case s:e[0]=((r-t)/d+2)*60;break;case r:e[0]=((t-s)/d+4)*60;break}}e[2]=u}function p0(n,e){const t=n[0],s=n[1],r=n[2],i=(1-Math.abs(2*r-1))*s,o=i*(1-Math.abs(t/60%2-1)),u=r-i/2;switch(Math.floor(t/60)){case 0:e[0]=i+u,e[1]=o+u,e[2]=u;break;case 1:e[0]=o+u,e[1]=i+u,e[2]=u;break;case 2:e[0]=u,e[1]=i+u,e[2]=o+u;break;case 3:e[0]=u,e[1]=o+u,e[2]=i+u;break;case 4:e[0]=o+u,e[1]=u,e[2]=i+u;break;case 5:case 6:e[0]=i+u,e[1]=u,e[2]=o+u;break}}function p_(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function m_(n,e,t){p0(n,t),t.map(p_);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];p0(e,t),t.map(p_);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];return s>r?(s+.05)/(r+.05):(r+.05)/(s+.05)}const g_=new Map;function gO(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let s=g_.get(t);if(s)return s;const r=new Float32Array(9),i=r.subarray(0,3),o=r.subarray(3,6);f_(n,o);const u=r.subarray(6,9);f_(e,u);const d=u[2]<.5,h=d?12:4.5;if(o[2]=d?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),m_(o,u,i)<h){let p,m;d?(p=o[2],m=1):(p=0,m=o[2]);const x=.005;for(;m-p>x;){const v=o[2]=(p+m)/2;d===m_(o,u,i)<h?p=v:m=v}o[2]=d?m:p}return p0(o,i),s=we.makeHexColor(Math.round(i[0]*255),Math.round(i[1]*255),Math.round(i[2]*255)),g_.set(t,s),s}function TN({html:n,dir:e,className:t},s){const r=document.createDocumentFragment();if(typeof n=="string"){const i=document.createElement("p");i.dir=e||"auto";const o=n.split(/(?:\r\n?|\n)/);for(let u=0,d=o.length;u<d;++u){const h=o[u];i.append(document.createTextNode(h)),u<d-1&&i.append(document.createElement("br"))}r.append(i)}else SN.render({xfaHtml:n,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",t),s.append(r)}function CN(n){const e=new Path2D;if(!n)return e;for(let t=0,s=n.length;t<s;)switch(n[t++]){case Xc.moveTo:e.moveTo(n[t++],n[t++]);break;case Xc.lineTo:e.lineTo(n[t++],n[t++]);break;case Xc.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case Xc.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case Xc.closePath:e.closePath();break;default:ze(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}class yu{#e=null;#t=null;#n;#s=null;#a=null;#i=null;#r=null;#o=null;static#c=null;constructor(e){this.#n=e,yu.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Pn,{signal:t}),e.addEventListener("pointerdown",yu.#l,{signal:t}));const s=this.#s=document.createElement("div");s.className="buttons",e.append(s);const r=this.#n.toolbarPosition;if(r){const{style:i}=e,o=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];i.insetInlineEnd=`${100*o}%`,i.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#h(e){this.#n._focusEventsAllowed=!1,Pt(e)}#d(e){this.#n._focusEventsAllowed=!0,Pt(e)}#f(e){const t=this.#n._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Pn,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#a?.shown(),this.#i?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",yu.#c[e]),this.#f(s)&&s.addEventListener("click",r=>{t.delete()},{signal:t._signal}),this.#s.append(s)}get#g(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#s.append(t,this.#g),this.#a=e}addComment(e,t=null){if(this.#i)return;const s=e.renderForToolbar();if(!s)return;this.#f(s);const r=this.#r=this.#g;t?(this.#s.insertBefore(s,t),this.#s.insertBefore(r,t)):this.#s.append(s,r),this.#i=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#s.append(t,this.#g)}async addEditSignatureButton(e){const t=this.#o=await e.renderEditButton(this.#n);this.#f(t),this.#s.append(t,this.#g)}removeButton(e){switch(e){case"comment":this.#i?.removeToolbarCommentButton(),this.#i=null,this.#r?.remove(),this.#r=null;break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,s){if(!t&&e==="comment")return;const r=this.#s.querySelector(s);r&&e==="comment"&&this.addComment(t,r)}updateEditSignatureButton(e){this.#o&&(this.#o.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class yO{#e=null;#t=null;#n;constructor(e){this.#n=e}#s(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#n._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Pn,{signal:t});const s=this.#e=document.createElement("div");return s.className="buttons",e.append(s),this.#n.hasCommentManager()&&this.#i("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#i("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),e}#a(e,t){let s=0,r=0;for(const i of e){const o=i.y+i.height;if(o<s)continue;const u=i.x+(t?i.width:0);if(o>s){r=u,s=o;continue}t?u>r&&(r=u):u<r&&(r=u)}return[t?1-r:r,s]}show(e,t,s){const[r,i]=this.#a(t,s),{style:o}=this.#t||=this.#s();e.append(this.#t),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#i(e,t,s,r){const i=document.createElement("button");i.classList.add("basic",e),i.tabIndex=0,i.setAttribute("data-l10n-id",t);const o=document.createElement("span");i.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(i.addEventListener("contextmenu",Pn,{signal:u}),i.addEventListener("click",r,{signal:u})),this.#e.append(i)}}function IN(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}class ot{static#e=NaN;static#t=null;static#n=NaN;static#s=null;static initializeAndAddPointerId(e){(ot.#t||=new Set).add(e)}static setPointer(e,t){ot.#e||=t,ot.#s??=e}static setTimeStamp(e){ot.#n=e}static isSamePointerId(e){return ot.#e===e}static isSamePointerIdOrRemove(e){return ot.#e===e?!0:(ot.#t?.delete(e),!1)}static isSamePointerType(e){return ot.#s===e}static isInitializedAndDifferentPointerType(e){return ot.#s!==null&&!ot.isSamePointerType(e)}static isSameTimeStamp(e){return ot.#n===e}static isUsingMultiplePointers(){return ot.#t?.size>=1}static clearPointerType(){ot.#s=null}static clearPointerIds(){ot.#e=NaN,ot.#t=null}static clearTimeStamp(){ot.#n=NaN}}class xO{#e=0;get id(){return`${ju}${this.#e++}`}}class zy{#e=NN();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const i=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return $e(this,"_isSVGFittingCanvas",i)}async#s(e,t){this.#n||=new Map;let s=this.#n.get(e);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let r;if(typeof t=="string"?(s.url=t,r=await sd(t,"blob")):t instanceof File?r=s.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const i=zy._isSVGFittingCanvas,o=new FileReader,u=new Image,d=new Promise((h,p)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,h()},o.onload=async()=>{const m=s.svgUrl=o.result;u.src=await i?`${m}#svgView(preserveAspectRatio(none))`:m},u.onerror=o.onerror=p});o.readAsDataURL(r),await d}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){ze(r),s=null}return this.#n.set(e,s),s&&this.#n.set(s.id,s),s}async getFromFile(e){const{lastModified:t,name:s,size:r,type:i}=e;return this.#s(`${t}_${s}_${r}_${i}`,e)}async getFromUrl(e){return this.#s(e,e)}async getFromBlob(e,t){const s=await t;return this.#s(e,s)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let s=this.#n.get(e);if(s?.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,s),this.#n.set(s.id,s),s}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}s.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class bO{#e=[];#t=!1;#n;#s=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:s,mustExec:r,type:i=NaN,overwriteIfSameType:o=!1,keepUndo:u=!1}){if(r&&e(),this.#t)return;const d={cmd:e,undo:t,post:s,type:i};if(this.#s===-1){this.#e.length>0&&(this.#e.length=0),this.#s=0,this.#e.push(d);return}if(o&&this.#e[this.#s].type===i){u&&(d.undo=this.#e[this.#s].undo),this.#e[this.#s]=d;return}const h=this.#s+1;h===this.#n?this.#e.splice(0,1):(this.#s=h,h<this.#e.length&&this.#e.splice(h)),this.#e.push(d)}undo(){if(this.#s===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#s];e(),t?.(),this.#t=!1,this.#s-=1}redo(){if(this.#s<this.#e.length-1){this.#s+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#s];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#e.length-1}cleanType(e){if(this.#s!==-1){for(let t=this.#s;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#s-t),this.#s=t;return}this.#e.length=0,this.#s=-1}}destroy(){this.#e=null}}class id{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=bs.platform;for(const[s,r,i={}]of e)for(const o of s){const u=o.startsWith("mac+");t&&u?(this.callbacks.set(o.slice(4),{callback:r,options:i}),this.allKeys.add(o.split("+").at(-1))):!t&&!u&&(this.callbacks.set(o,{callback:r,options:i}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(this.#e(t));if(!s)return;const{callback:r,options:{bubbles:i=!1,args:o=[],checker:u=null}}=s;u&&!u(e,t)||(r.bind(e,...o,t)(),i||Pt(t))}}class $y{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return hO(e),$e(this,"_colors",e)}convert(e){const t=rd(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,r]of this._colors)if(r.every((i,o)=>i===t[o]))return $y._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?we.makeHexColor(...t):e}}class xa{#e=new AbortController;#t=null;#n=null;#s=new Map;#a=new Map;#i=null;#r=null;#o=null;#c=new bO;#l=null;#h=null;#d=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#b=!1;#x=!1;#N=null;#k=null;#w=null;#S=null;#v=!1;#E=null;#I=new xO;#T=!1;#C=!1;#O=!1;#j=null;#D=null;#F=null;#M=null;#H=null;#A=qe.NONE;#_=new Set;#R=null;#V=null;#B=null;#G=null;#W=null;#K={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#L=null;#q=null;#J=null;#Z=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=xa.prototype,t=o=>o.#q.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},r=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return $e(this,"_keyboardManager",new id([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#q.contains(u)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#q.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}constructor(e,t,s,r,i,o,u,d,h,p,m,x,v,w,E,N){const A=this._signal=this.#e.signal;this.#q=e,this.#J=t,this.#Z=s,this.#i=r,this.#l=i,this.#V=o,this.#W=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:A}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),u._on("setpreference",this.onSetPreference.bind(this),{signal:A}),u._on("switchannotationeditorparams",T=>this.updateParams(T.type,T.value),{signal:A}),window.addEventListener("pointerdown",()=>{this.#C=!0},{capture:!0,signal:A}),window.addEventListener("pointerup",()=>{this.#C=!1},{capture:!0,signal:A}),this.#ae(),this.#he(),this.#te(),this.#r=d.annotationStorage,this.#N=d.filterFactory,this.#B=h,this.#S=p||null,this.#y=m,this.#b=x,this.#x=v,this.#H=w||null,this.viewParameters={realScale:Bl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=E||null,this._supportsPinchToZoom=N!==!1,i?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#a.values())e.destroy();this.#a.clear(),this.#s.clear(),this.#p.clear(),this.#M?.clear(),this.#t=null,this.#_.clear(),this.#c.destroy(),this.#i?.destroy(),this.#l?.destroy(),this.#V?.destroy(),this.#E?.hide(),this.#E=null,this.#F?.destroy(),this.#F=null,this.#n=null,this.#k&&(clearTimeout(this.#k),this.#k=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy(),this.#W=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#H}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#x}get hcmFilter(){return $e(this,"hcmFilter",this.#B?this.#N.addHCMFilter(this.#B.foreground,this.#B.background):"none")}get direction(){return $e(this,"direction",getComputedStyle(this.#q).direction)}get _highlightColors(){return $e(this,"_highlightColors",this.#S?new Map(this.#S.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return $e(this,"highlightColors",null);const t=new Map,s=!!this.#B;for(const[r,i]of e){const o=r.endsWith("_HCM");if(s&&o){t.set(r.replace("_HCM",""),i);continue}!s&&!o&&t.set(r,i)}return $e(this,"highlightColors",t)}get highlightColorNames(){return $e(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#d=e}setMainHighlightColorPicker(e){this.#F=e}editAltText(e,t=!1){this.#i?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,s,r){this.#l?.showDialog(this,e,t,s,r)}selectComment(e,t){this.#a.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,s=void 0){this.#l?.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#a.has(e-1))return;const{resolve:t,promise:s}=Promise.withResolvers(),r=i=>{i.pageNumber===e&&(this._eventBus._off("editorsrendered",r),t())};this._eventBus.on("editorsrendered",r),await s}getSignature(e){this.#V?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#V}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#x=t;break}}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#q.focus()}findParent(e,t){for(const s of this.#a.values()){const{x:r,y:i,width:o,height:u}=s.div.getBoundingClientRect();if(e>=r&&e<=r+o&&t>=i&&t<=i+u)return s}return null}disableUserSelect(e=!1){this.#J.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Bl.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#d?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Q({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of this.#a.values())if(s.hasTextLayer(e))return s;return null}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:u}=s,d=s.toString(),p=this.#Q(s).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;s.empty();const x=this.#ee(p),v=this.#A===qe.NONE,w=()=>{const E=x?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:m,anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:u,text:d});v&&this.showAllEditors("highlight",!0,!0),t&&E?.editComment()};if(v){this.switchToMode(qe.HIGHLIGHT,w);return}w()}commentSelection(e=""){this.highlightSelection(e,!0)}#re(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=this.#Q(e).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(this.#E||=new yO(this),this.#E.show(s,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#r)return null;const t=`${ju}${e}`,s=this.#r.getRawValue(t);return s&&this.#r.remove(t),s}addToAnnotationStorage(e){!e.isEmpty()&&this.#r&&!this.#r.has(e.id)&&this.#r.setValue(e.id,e)}a11yAlert(e,t=null){const s=this.#Z;s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}#ie(){const e=document.getSelection();if(!e||e.isCollapsed){this.#R&&(this.#E?.hide(),this.#R=null,this.#P({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#R)return;const r=this.#Q(e).closest(".textLayer");if(!r){this.#R&&(this.#E?.hide(),this.#R=null,this.#P({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#R=t,this.#P({hasSelectedText:!0}),!(this.#A!==qe.HIGHLIGHT&&this.#A!==qe.NONE)&&(this.#A===qe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#v=this.isShiftKeyDown,!this.isShiftKeyDown)){const i=this.#A===qe.HIGHLIGHT?this.#ee(r):null;if(i?.toggleDrawing(),this.#C){const o=new AbortController,u=this.combinedSignal(o),d=h=>{h.type==="pointerup"&&h.button!==0||(o.abort(),i?.toggleDrawing(!0),h.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else i?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(e=""){this.#A===qe.HIGHLIGHT?this.highlightSelection(e):this.#y&&this.#re()}#ae(){document.addEventListener("selectionchange",this.#ie.bind(this),{signal:this._signal})}#oe(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#le(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#v&&(this.#v=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#_)if(t.div.contains(e)){this.#D=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#D)return;const[e,t]=this.#D;this.#D=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#j)return;this.#j=new AbortController;const e=this.combinedSignal(this.#j);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ce(){this.#j?.abort(),this.#j=null}#ue(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#de(){this.#h?.abort(),this.#h=null}#he(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.setEditingState(!0)}removeEditListeners(){this.#ce(),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of this.#_){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const o of this.#u)if(o.isHandlingMimeForPasting(i.type)){o.paste(i,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(i){ze(`paste: "${i.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const i=[];for(const d of s){const h=await r.deserialize(d);if(!h)return;i.push(h)}const o=()=>{for(const d of i)this.#se(d);this.#ne(i)},u=()=>{for(const d of i)d.remove()};this.addCommands({cmd:o,undo:u,mustExec:!0})}catch(i){ze(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==qe.NONE&&!this.isEditorHandlingKeyboard&&xa._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#v&&(this.#v=!1,this.#Y("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#P(e){Object.entries(e).some(([s,r])=>this.#K[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#K,e)}),this.#A===qe.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#$([[Ze.HIGHLIGHT_FREE,!0]]))}#$(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#oe(),this.#ue(),this.#P({isEditing:this.#A!==qe.NONE,isEmpty:this.#X(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#de(),this.#P({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#u){this.#u=e;for(const t of this.#u)this.#$(t.defaultPropertiesToUpdate)}}getId(){return this.#I.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(e){return this.#a.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#a.set(e.pageIndex,e),this.#T?e.enable():e.disable()}removeLayer(e){this.#a.delete(e.pageIndex)}async updateMode(e,t=null,s=!1,r=!1,i=!1){if(this.#A!==e&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#d?.commitOrRemove(),this.#A===qe.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#A=e,e===qe.NONE){this.setEditingState(!1),this.#pe();for(const o of this.#s.values())o.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const o of this.#s.values())o.addStandaloneCommentButton();e===qe.SIGNATURE&&await this.#V?.loadSignatures(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const o of this.#a.values())o.updateMode(e);if(e===qe.POPUP){this.#n||=await this.#W.getAnnotationsByType(new Set(this.#u.map(d=>d._editorType)));const o=new Set,u=[];for(const d of this.#s.values()){const{annotationElementId:h,hasComment:p,deleted:m}=d;h&&o.add(h),p&&!m&&u.push(d.getData())}for(const d of this.#n){const{id:h,popupRef:p,contentsObj:m}=d;p&&m?.str&&!o.has(h)&&!this.#g.has(h)&&u.push(d)}this.#l?.showSidebar(u)}if(!t){s&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const o of this.#s.values())o.uid===t?(this.setSelected(o),i?o.editComment():r?o.enterInEditMode():o.focus()):o.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#u){switch(e){case Ze.CREATE:this.currentLayer.addNewEditor(t);return;case Ze.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of this.#_)s.updateParams(e,t);else for(const s of this.#u)s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){for(const i of this.#s.values())i.editorType===e&&i.show(t);(this.#G?.get(Ze.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#$([[Ze.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#O!==e){this.#O=e;for(const t of this.#a.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#T){this.#T=!0;const e=[];for(const t of this.#a.values())e.push(t.enable());await Promise.all(e);for(const t of this.#s.values())t.enable()}}#pe(){if(this.unselectAll(),this.#T){this.#T=!1;for(const e of this.#a.values())e.disable();for(const e of this.#s.values())e.disable()}}*getEditors(e){for(const t of this.#s.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#s.get(e)}addEditor(e){this.#s.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#k&&clearTimeout(this.#k),this.#k=setTimeout(()=>{this.focusMainContainer(),this.#k=null},0)),this.#s.delete(e.id),e.annotationElementId&&this.#M?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#g.has(e.annotationElementId))&&this.#r?.remove(e.id)}addDeletedAnnotationElement(e){this.#g.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#g.has(e)}removeDeletedAnnotationElement(e){this.#g.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#se(e){const t=this.#a.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#$(e.propertiesToUpdate))}get#me(){let e=null;for(e of this.#_);return e}updateUI(e){this.#me===e&&this.#$(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#$(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#_.has(e)){this.#_.delete(e),e.unselect(),this.#P({hasSelectedEditor:this.hasSelection});return}this.#_.add(e),e.select(),this.#$(e.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.uid}),this.#d?.commitOrRemove();for(const t of this.#_)t!==e&&t.unselect();this.#_.clear(),this.#_.add(e),e.select(),this.#$(e.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}isSelected(e){return this.#_.has(e)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(e){e.unselect(),this.#_.delete(e),this.#P({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#P({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#X()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#X()})}addCommands(e){this.#c.add(e),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#X()})}cleanUndoStack(e){this.#c.cleanType(e)}#X(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const e of this.#s.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#_],s=()=>{this._editorUndoBar?.show(r,t.length===1?t[0].editorType:t.length);for(const i of t)i.remove()},r=()=>{for(const i of t)this.#se(i)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ne(e){for(const t of this.#_)t.unselect();this.#_.clear();for(const t of e)t.isEmpty()||(this.#_.add(t),t.select());this.#P({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#_)e.commit();this.#ne(this.#s.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#A!==qe.NONE))&&!this.#d?.commitOrRemove()&&this.hasSelection){for(const e of this.#_)e.unselect();this.#_.clear(),this.#P({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=e,this.#z[1]+=t;const[r,i]=this.#z,o=[...this.#_],u=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const d of o)this.#s.has(d.id)&&(d.translateInPage(r,i),d.translationDone())},undo:()=>{for(const d of o)this.#s.has(d.id)&&(d.translateInPage(-r,-i),d.translationDone())},mustExec:!1})},u);for(const d of o)d.translateInPage(e,t),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const e of this.#_)this.#m.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const e=this.#m;this.#m=null;let t=!1;for(const[{x:r,y:i,pageIndex:o},u]of e)u.newX=r,u.newY=i,u.newPageIndex=o,t||=r!==u.savedX||i!==u.savedY||o!==u.savedPageIndex;if(!t)return!1;const s=(r,i,o,u)=>{if(this.#s.has(r.id)){const d=this.#a.get(u);d?r._setParentAndPosition(d,i,o):(r.pageIndex=u,r.x=i,r.y=o)}};return this.addCommands({cmd:()=>{for(const[r,{newX:i,newY:o,newPageIndex:u}]of e)s(r,i,o,u)},undo:()=>{for(const[r,{savedX:i,savedY:o,savedPageIndex:u}]of e)s(r,i,o,u)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#m)for(const s of this.#m.keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#A}isEditingMode(){return this.#A!==qe.NONE}get imageManager(){return $e(this,"imageManager",new zy)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,p=t.rangeCount;h<p;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:s,y:r,width:i,height:o}=e.getBoundingClientRect();let u;switch(e.getAttribute("data-main-rotation")){case"90":u=(h,p,m,x)=>({x:(p-r)/o,y:1-(h+m-s)/i,width:x/o,height:m/i});break;case"180":u=(h,p,m,x)=>({x:1-(h+m-s)/i,y:1-(p+x-r)/o,width:m/i,height:x/o});break;case"270":u=(h,p,m,x)=>({x:1-(p+x-r)/o,y:(h-s)/i,width:x/o,height:m/i});break;default:u=(h,p,m,x)=>({x:(h-s)/i,y:(p-r)/o,width:m/i,height:x/o});break}const d=[];for(let h=0,p=t.rangeCount;h<p;h++){const m=t.getRangeAt(h);if(!m.collapsed)for(const{x,y:v,width:w,height:E}of m.getClientRects())w===0||E===0||d.push(u(x,v,w,E))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const s=this.#r.getRawValue(t);s&&(this.#A===qe.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){const r=this.#M?.get(e);r&&(r.setCanvas(t,s),this.#M.delete(e))}addMissingCanvas(e,t){(this.#M||=new Map).set(e,t)}}class vr{#e=null;#t=!1;#n=null;#s=null;#a=null;#i=null;#r=!1;#o=null;#c=null;#l=null;#h=null;#d=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#d=e._uiManager.useNewAltTextFlow,vr.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){vr._l10n??=e}async render(){const e=this.#n=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#s=document.createElement("span");e.append(t),this.#d?(e.classList.add("new"),e.setAttribute("data-l10n-id",vr.#f.missing),t.setAttribute("data-l10n-id",vr.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;e.addEventListener("contextmenu",Pn,{signal:s}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const r=i=>{i.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#d&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return e.addEventListener("click",r,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(this.#r=!0,r(i))},{signal:s}),await this.#m(),e}get#g(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#d?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#d?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#h=await vr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#m())}toggleAltTextBadge(e=!1){if(!this.#d||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:r,cancel:i=!1}){s&&(this.#l=s,this.#h=r),!(this.#e===e&&this.#t===t)&&(i||(this.#e=e,this.#t=t),this.#m())}toggle(e=!1){this.#n&&(!e&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#n.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#n?.remove(),this.#n=null,this.#s=null,this.#a=null,this.#o?.remove(),this.#o=null}async#m(){const e=this.#n;if(!e)return;if(this.#d){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",vr.#f[this.#g]),this.#s?.setAttribute("data-l10n-id",vr.#f[`${this.#g}-label`]),!this.#e){this.#a?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#a?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#a;if(!t){this.#a=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const r=100,i=this.#c._uiManager._signal;i.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:i}),e.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#a?.classList.remove("show")},{signal:i})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Mh{#e=null;#t=null;#n=!1;#s=null;#a=null;#i=null;#r=null;#o=null;#c=!1;#l=null;constructor(e){this.#s=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#h(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#s.commentButtonPosition;if(t){const{style:s}=e;s.insetInlineEnd=`calc(${100*(this.#s._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const r=this.#s.commentButtonColor;r&&(s.backgroundColor=r)}return this.#h(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#s.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#s._uiManager.updatePopupColor(this.#s)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#s.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:s}=this.#e.getBoundingClientRect(),{x:r,y:i,width:o,height:u}=this.#s.parent.boundingClientRect;return[(e-r)/o,(t+s-i)/u]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#h(e,t){if(!this.#s._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#s._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#s._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return e;e.addEventListener("contextmenu",Pn,{signal:s}),t&&(e.addEventListener("focusin",i=>{this.#s._focusEventsAllowed=!1,Pt(i)},{capture:!0,signal:s}),e.addEventListener("focusout",i=>{this.#s._focusEventsAllowed=!0,Pt(i)},{capture:!0,signal:s})),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const r=i=>{i.preventDefault(),e===this.#t?this.edit():this.#s.toggleComment(!0)};return e.addEventListener("click",r,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(this.#n=!0,r(i))},{signal:s}),e.addEventListener("pointerenter",()=>{this.#s.toggleComment(!1,!0)},{signal:s}),e.addEventListener("pointerleave",()=>{this.#s.toggleComment(!1,!1)},{signal:s}),e}edit(e){const t=this.commentPopupPositionInLayer;let s,r;if(t)[s,r]=t;else{[s,r]=this.#s.commentButtonPosition;const{width:p,height:m,x,y:v}=this.#s;s=x+s*p,r=v+r*m}const i=this.#s.parent.boundingClientRect,{x:o,y:u,width:d,height:h}=i;this.#s._uiManager.editComment(this.#s,o+s*d,u+r*h,{...e,parentDimensions:i})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#a}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#i,date:this.#o,deleted:this.isDeleted()}}set data(e){if(e!==this.#r&&(this.#i=null),e===null){this.#r="",this.#c=!0;return}this.#r=e,this.#o=new Date,this.#c=!1}setInitialText(e,t=null){this.#a=e,this.data=e,this.#o=null,this.#i=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#r="",this.#i=null,this.#o=null,this.#s=null,this.#n=!1,this.#c=!1}}class xp{#e;#t=!1;#n=null;#s;#a;#i;#r;#o=null;#c;#l=null;#h;#d=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:i=null,onPinchEnd:o=null,signal:u}){this.#e=e,this.#n=s,this.#s=t,this.#a=r,this.#i=i,this.#r=o,this.#h=new AbortController,this.#c=AbortSignal.any([u,this.#h.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Cr.pixelRatio}#f(e){if(this.#s?.())return;if(e.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,i=AbortSignal.any([this.#c,r.signal]),o=this.#e,u={capture:!0,signal:i,passive:!1},d=h=>{h.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",h=>{h.pointerType==="touch"&&(Pt(h),d(h))},u),o.addEventListener("pointerup",d,u),o.addEventListener("pointercancel",d,u);return}if(!this.#d){this.#d=new AbortController;const r=AbortSignal.any([this.#c,this.#d.signal]),i=this.#e,o={signal:r,capture:!1,passive:!1};i.addEventListener("touchmove",this.#g.bind(this),o);const u=this.#m.bind(this);i.addEventListener("touchend",u,o),i.addEventListener("touchcancel",u,o),o.capture=!0,i.addEventListener("pointerdown",Pt,o),i.addEventListener("pointermove",Pt,o),i.addEventListener("pointercancel",Pt,o),i.addEventListener("pointerup",Pt,o),this.#a?.()}if(Pt(e),e.touches.length!==2||this.#n?.()){this.#l=null;return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#g(e){if(!this.#l||e.touches.length!==2)return;Pt(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:r,screenY:i}=t,{screenX:o,screenY:u}=s,d=this.#l,{touch0X:h,touch0Y:p,touch1X:m,touch1Y:x}=d,v=m-h,w=x-p,E=o-r,N=u-i,A=Math.hypot(E,N)||1,T=Math.hypot(v,w)||1;if(!this.#t&&Math.abs(T-A)<=xp.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=r,d.touch0Y=i,d.touch1X=o,d.touch1Y=u,!this.#t){this.#t=!0;return}const I=[(r+o)/2,(i+u)/2];this.#i?.(I,T,A)}#m(e){e.touches.length>=2||(this.#d&&(this.#d.abort(),this.#d=null,this.#r?.()),this.#l&&(Pt(e),this.#l=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#o?.abort(),this.#o=null}}class Ie{#e=null;#t=null;#n=null;#s=null;#a=null;#i=!1;#r=null;#o="";#c=null;#l=null;#h=null;#d=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#b=!1;#x=null;#N=0;#k=0;#w=null;#S=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#v=!1;#E=Ie._zIndex++;static _borderLineWidth=-1;static _colorManager=new $y;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Ie.prototype._resizeWithKeyboard,t=xa.TRANSLATE_SMALL,s=xa.TRANSLATE_BIG;return $e(this,"_resizerKeyboardManager",new id([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],Ie.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:s,pageHeight:r,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[i,o];const[u,d]=this.parentDimensions;this.x=e.x/u,this.y=e.y/d,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return $e(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new vO({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ie._l10n??=e,Ie._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Ie._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);Ie._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){ft("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#v}set _isDraggable(e){this.#v=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#L(),this.#d?.remove(),this.#d=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,r){const[i,o]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(e+s)/i,this.y=(t+r)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,r]=this.parentDimensions;this.setAt(e*s,t*r,this.width*s,this.height*r),this._onTranslated()}#I([e,t],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#I(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y,this.width,this.height],this.#I(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[r,i]}=this;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:x}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,x)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:u}=this;const[d,h]=this.getBaseTranslation();o+=d,u+=h;const{style:p}=s;p.left=`${(100*o).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(o,u),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=Ie,r=s/e,i=s/t;switch(this.rotation){case 90:return[-r,i];case 180:return[r,i];case 270:return[r,-i];default:return[-r,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,r]}=this;let{x:i,y:o,width:u,height:d}=this;if(u*=s,d*=r,i*=s,o*=r,this._mustFixPosition)switch(e){case 0:i=Os(i,0,s-u),o=Os(o,0,r-d);break;case 90:i=Os(i,0,s-d),o=Os(o,u,r);break;case 180:i=Os(i,u,s),o=Os(o,d,r);break;case 270:i=Os(i,d,s),o=Os(o,0,r-u);break}this.x=i/=s,this.y=o/=r;const[h,p]=this.getBaseTranslation();i+=h,o+=p,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#T(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Ie.#T(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Ie.#T(e,t,360-this.parentRotation)}#C(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(){const{div:{style:e},width:t,height:s}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#O(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",this.#j.bind(this,s),{signal:t}),r.addEventListener("contextmenu",Pn,{signal:t}),r.tabIndex=-1}this.div.prepend(this.#c)}#j(e,t){t.preventDefault();const{isMac:s}=bs.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const i=new AbortController,o=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#M.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Pt,{passive:!1,signal:o}),window.addEventListener("contextmenu",Pn,{signal:o}),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{i.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#F()};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}#D(e,t,s,r){this.width=s,this.height=r,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#h)return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:r}=this.#h;this.#h=null;const i=this.x,o=this.y,u=this.width,d=this.height;i===e&&o===t&&u===s&&d===r||this.addCommands({cmd:this.#D.bind(this,i,o,u,d),undo:this.#D.bind(this,e,t,s,r),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#M(e,t){const[s,r]=this.parentDimensions,i=this.x,o=this.y,u=this.width,d=this.height,h=Ie.MIN_SIZE/s,p=Ie.MIN_SIZE/r,m=this.#C(this.rotation),x=(ie,oe)=>[m[0]*ie+m[2]*oe,m[1]*ie+m[3]*oe],v=this.#C(360-this.rotation),w=(ie,oe)=>[v[0]*ie+v[2]*oe,v[1]*ie+v[3]*oe];let E,N,A=!1,T=!1;switch(e){case"topLeft":A=!0,E=(ie,oe)=>[0,0],N=(ie,oe)=>[ie,oe];break;case"topMiddle":E=(ie,oe)=>[ie/2,0],N=(ie,oe)=>[ie/2,oe];break;case"topRight":A=!0,E=(ie,oe)=>[ie,0],N=(ie,oe)=>[0,oe];break;case"middleRight":T=!0,E=(ie,oe)=>[ie,oe/2],N=(ie,oe)=>[0,oe/2];break;case"bottomRight":A=!0,E=(ie,oe)=>[ie,oe],N=(ie,oe)=>[0,0];break;case"bottomMiddle":E=(ie,oe)=>[ie/2,oe],N=(ie,oe)=>[ie/2,0];break;case"bottomLeft":A=!0,E=(ie,oe)=>[0,oe],N=(ie,oe)=>[ie,0];break;case"middleLeft":T=!0,E=(ie,oe)=>[0,oe/2],N=(ie,oe)=>[ie,oe/2];break}const I=E(u,d),P=N(u,d);let U=x(...P);const O=Ie._round(i+U[0]),R=Ie._round(o+U[1]);let C=1,D=1,B,V;if(t.fromKeyboard)({deltaX:B,deltaY:V}=t);else{const{screenX:ie,screenY:oe}=t,[Y,he]=this.#l;[B,V]=this.screenToPageTranslation(ie-Y,oe-he),this.#l[0]=ie,this.#l[1]=oe}if([B,V]=w(B/s,V/r),A){const ie=Math.hypot(u,d);C=D=Math.max(Math.min(Math.hypot(P[0]-I[0]-B,P[1]-I[1]-V)/ie,1/u,1/d),h/u,p/d)}else T?C=Os(Math.abs(P[0]-I[0]-B),h,1)/u:D=Os(Math.abs(P[1]-I[1]-V),p,1)/d;const $=Ie._round(u*C),L=Ie._round(d*D);U=x(...N($,L));const de=O-U[0],ye=R-U[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=$,this.height=L,this.x=de,this.y=ye,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new yu(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(vr.initialize(Ie._l10n),this.#n=new vr(this),this.#e&&(this.#n.data=this.#e,this.#e=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#s?.focusButton()}addCommentButton(){return this.canAddComment?this.#s||=new Mh(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#s.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#s.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:s,deleted:r}}=this.#s;return{text:t,richText:e,date:s,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#s||=new Mh(this),this.#s.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:s}){if(!t||(this.#s||=new Mh(this),this.#s.setInitialText(e,s),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#s?.hasBeenEdited()}get hasDeletedComment(){return this.#s?.isDeleted()}get hasComment(){return!!this.#s&&!this.#s.isEmpty()&&!this.#s.isDeleted()}async editComment(e){this.#s||=new Mh(this),this.#s.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#s.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,r]=e.rect,[i]=this.pageDimensions,[o]=this.pageTranslation,u=o+i+1,d=r-100,h=u+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,h,r]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#s.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#i?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#B();const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[r,i]=this.getInitialTranslation();return this.translate(r,i),IN(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#S||=new xp({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#H.bind(this),onPinching:this.#A.bind(this),onPinchEnd:this.#_.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#H(){this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#A(e,t,s){let i=.7*(s/t)+1-.7;if(i===1)return;const o=this.#C(this.rotation),u=(O,R)=>[o[0]*O+o[2]*R,o[1]*O+o[3]*R],[d,h]=this.parentDimensions,p=this.x,m=this.y,x=this.width,v=this.height,w=Ie.MIN_SIZE/d,E=Ie.MIN_SIZE/h;i=Math.max(Math.min(i,1/x,1/v),w/x,E/v);const N=Ie._round(x*i),A=Ie._round(v*i);if(N===x&&A===v)return;this.#u||=[p,m,x,v];const T=u(x/2,v/2),I=Ie._round(p+T[0]),P=Ie._round(m+T[1]),U=u(N/2,A/2);this.x=I-U[0],this.y=P-U[1],this.width=N,this.height=A,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#_(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(e){const{isMac:t}=bs.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#V(e);return}this.#R(e)}#R(e){const{isMac:t}=bs.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#V(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,i=this._uiManager.combinedSignal(r),o={capture:!0,passive:!1,signal:i},u=h=>{r.abort(),this.#r=null,this.#m=!1,this._uiManager.endDragSession()||this.#R(h),s&&this._onStopDragging()};t&&(this.#N=e.clientX,this.#k=e.clientY,this.#r=e.pointerId,this.#o=e.pointerType,window.addEventListener("pointermove",h=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:m,pointerId:x}=h;if(x!==this.#r){Pt(h);return}const[v,w]=this.screenToPageTranslation(p-this.#N,m-this.#k);this.#N=p,this.#k=m,this._uiManager.dragSelectedEditors(v,w)},o),window.addEventListener("touchmove",Pt,o),window.addEventListener("pointerdown",h=>{h.pointerType===this.#o&&(this.#S||h.isPrimary)&&u(h),Pt(h)},o));const d=h=>{if(!this.#r||this.#r===h.pointerId){u(h);return}Pt(h)};window.addEventListener("pointerup",d,{signal:i}),window.addEventListener("blur",d,{signal:i})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const r=this.parentScale,[i,o]=this.pageDimensions,[u,d]=this.pageTranslation,h=e/r,p=t/r,m=this.x*i,x=this.y*o,v=this.width*i,w=this.height*o;switch(s){case 0:return[m+h+u,o-x-p-w+d,m+h+v+u,o-x-p+d];case 90:return[m+p+u,o-x+h+d,m+p+w+u,o-x+h+v+d];case 180:return[m-h-v+u,o-x+p+d,m-h+u,o-x+p+w+d];case 270:return[m-p-w+u,o-x-h-v+d,m-p+u,o-x-h+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,r,i,o]=e,u=i-s,d=o-r;switch(this.rotation){case 0:return[s,t-o,u,d];case 90:return[s,t-r,d,u];case 180:return[i,t-r,u,d];case 270:return[i,t-o,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Ie._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#s?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:s,opacity:r,deleted:i,richText:o},uid:u,pageIndex:d,creationDate:h,modificationDate:p}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:h,modificationDate:s||p,popupRef:!i,color:t,opacity:r}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:i,innerWidth:o}=window;return t<o&&r>0&&e<i&&s>0}#B(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#B()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,s){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});r.rotation=e.rotation,r.#e=e.accessibilityData,r._isCopy=e.isCopy||!1;const[i,o]=r.pageDimensions,[u,d,h,p]=r.getRectInCurrentCoords(e.rect,o);return r.x=u/i,r.y=d/o,r.width=h/i,r.height=p/o,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#x&&(clearTimeout(this.#x),this.#x=null),this.#L(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#S?.destroy(),this.#S=null,this.#d?.remove(),this.#d=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#O(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[s,r,i,o]=this.getPDFRect();return[Ie._round(s+(i-s)*e),Ie._round(r+(o-r)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#s.commentPopupPositionInLayer}set commentPopupPosition(e){this.#s.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#s.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#s.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#s?.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const o=this.#G.bind(this),u=this.#W.bind(this),d=this._uiManager._signal;for(const h of this.#t){const p=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",o,{signal:d}),h.addEventListener("blur",u,{signal:d}),h.addEventListener("focus",this.#K.bind(this,p),{signal:d}),h.setAttribute("data-l10n-id",Ie._l10nResizer[p])}}const s=this.#t[0];let r=0;for(const o of t){if(o===s)break;r++}const i=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(i!==r){if(i<r)for(let u=0;u<r-i;u++)this.#c.append(this.#c.firstElementChild);else if(i>r)for(let u=0;u<i-r;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let o=0;for(const u of t){const h=this.#t[o++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Ie._l10nResizer[h])}}this.#z(0),this.#b=!0,this.#c.firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#G(e){Ie._resizerKeyboardManager.exec(this,e)}#W(e){this.#b&&e.relatedTarget?.parentNode!==this.#c&&this.#L()}#K(e){this.#g=this.#b?e:""}#z(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#b&&this.#M(this.#g,{deltaX:e,deltaY:t,fromKeyboard:!0})}#L(){this.#b=!1,this.#z(-1),this.#F()}_stopResizingWithKeyboard(){this.#L(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:s}=e;let r=this.#w.get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(s),this.#w.size===0&&(this.#w=null)},Ie._telemetryTimeout),this.#w.set(s,r);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}updateFakeAnnotationElement(e){if(!this.#d&&!this.deleted){this.#d=e.addFakeAnnotation(this);return}if(this.deleted){this.#d.remove(),this.#d=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#d.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class vO extends Ie{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const y_=3285377520,Nn=4294901760,yr=65535;class PN{constructor(e){this.h1=e?e&4294967295:y_,this.h2=e?e&4294967295:y_}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let E=0,N=e.length;E<N;E++){const A=e.charCodeAt(E);A<=255?t[s++]=A:(t[s++]=A>>>8,t[s++]=A&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,i=s-r*4,o=new Uint32Array(t.buffer,0,r);let u=0,d=0,h=this.h1,p=this.h2;const m=3432918353,x=461845907,v=m&yr,w=x&yr;for(let E=0;E<r;E++)E&1?(u=o[E],u=u*m&Nn|u*v&yr,u=u<<15|u>>>17,u=u*x&Nn|u*w&yr,h^=u,h=h<<13|h>>>19,h=h*5+3864292196):(d=o[E],d=d*m&Nn|d*v&yr,d=d<<15|d>>>17,d=d*x&Nn|d*w&yr,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,i){case 3:u^=t[r*4+2]<<16;case 2:u^=t[r*4+1]<<8;case 1:u^=t[r*4],u=u*m&Nn|u*v&yr,u=u<<15|u>>>17,u=u*x&Nn|u*w&yr,r&1?h^=u:p^=u}this.h1=h,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Nn|e*36045&yr,t=t*4283543511&Nn|((t<<16|e>>>16)*2950163797&Nn)>>>16,e^=t>>>1,e=e*444984403&Nn|e*60499&yr,t=t*3301882366&Nn|((t<<16|e>>>16)*3120437893&Nn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const m0=Object.freeze({map:null,hash:"",transfer:void 0});class Hy{#e=!1;#t=null;#n=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=this.#s.get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return this.#s.get(e)}remove(e){const t=this.#s.get(e);if(t!==void 0&&(t instanceof Ie&&this.#n.delete(t.annotationElementId),this.#s.delete(e),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#s.values())if(s instanceof Ie)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=this.#s.get(e);let r=!1;if(s!==void 0)for(const[i,o]of Object.entries(t))s[i]!==o&&(r=!0,s[i]=o);else r=!0,this.#s.set(e,t);r&&this.#a(),t instanceof Ie&&((this.#n||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#s.has(e)}get size(){return this.#s.size}#a(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new jN(this)}get serializable(){if(this.#s.size===0)return m0;const e=new Map,t=new PN,s=[],r=Object.create(null);let i=!1;for(const[o,u]of this.#s){const d=u instanceof Ie?u.serialize(!1,r):u;d&&(e.set(o,d),t.update(`${o}:${JSON.stringify(d)}`),i||=!!d.bitmap)}if(i)for(const o of e.values())o.bitmap&&s.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:m0}get editorStats(){let e=null;const t=new Map;let s=0,r=0;for(const i of this.#s.values()){if(!(i instanceof Ie)){i.popup&&(i.popup.deleted?r+=1:s+=1);continue}i.isCommentDeleted?r+=1:i.hasEditedComment&&(s+=1);const o=i.telemetryFinalData;if(!o)continue;const{type:u}=o;t.has(u)||t.set(u,Object.getPrototypeOf(i).constructor),e||=Object.create(null);const d=e[u]||=new Map;for(const[h,p]of Object.entries(o)){if(h==="type")continue;let m=d.get(h);m||(m=new Map,d.set(h,m));const x=m.get(p)??0;m.set(p,x+1)}}if((r>0||s>0)&&(e||=Object.create(null),e.comments={deleted:r,edited:s}),!e)return null;for(const[i,o]of t)e[i]=o.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const s=this.#n?.get(e);return s?(s.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#n?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#n)for(const t of this.#n.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#s.entries()}}class jN extends Hy{#e;constructor(e){super();const{map:t,hash:s,transfer:r}=e.serializable,i=structuredClone(t,r?{transfer:r}:null);this.#e={map:i,hash:s,transfer:r}}get print(){ft("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return $e(this,"modifiedIds",{ids:new Set,hash:""})}}class wO{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||this.#e.has(e.loadedName))){if(et(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:i,style:o}=e,u=new FontFace(r,i,o);this.addNativeFontFace(u);try{await u.load(),this.#e.add(r),s?.(e)}catch{ze(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}ft("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw ze(`Failed to load font '${s.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return $e(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return $e(this,"isSyncFontLoadingSupported",Ls||bs.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(et(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:t,callback:e};return s.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return $e(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(P,U){return P.charCodeAt(U)<<24|P.charCodeAt(U+1)<<16|P.charCodeAt(U+2)<<8|P.charCodeAt(U+3)&255}function r(P,U,O,R){const C=P.substring(0,U),D=P.substring(U+O);return C+R+D}let i,o;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let h=0;function p(P,U){if(++h>30){ze("Load test font never loaded."),U();return}if(d.font="30px "+P,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){U();return}setTimeout(p.bind(null,P,U))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let x=this._loadTestFont;x=r(x,976,m.length,m);const w=16,E=1482184792;let N=s(x,w);for(i=0,o=m.length-3;i<o;i+=4)N=N-E+s(m,i)|0;i<m.length&&(N=N-E+s(m+"XXX",i)|0),x=r(x,w,4,tO(N));const A=`url(data:font/opentype;base64,${btoa(x)});`,T=`@font-face {font-family:"${m}";src:${A}}`;this.insertRule(T);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const P of[e.loadedName,m]){const U=this._document.createElement("span");U.textContent="Hi",U.style.fontFamily=P,I.append(U)}this._document.body.append(I),p(m,()=>{I.remove(),t.complete()})}}class _O{#e;constructor(e,t=null,s,r){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,s&&Object.assign(this,s),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${AN(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let r;try{r=e.get(s)}catch(o){ze(`getPathGenerator - ignoring character: "${o}".`)}const i=CN(r);return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=i}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}set disableFontFace(e){$e(this,"disableFontFace",!!e)}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}set bbox(e){$e(this,"bbox",e)}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}class Tl{#e;#t;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,s={};let r=0;for(const h of Tl.strings){const p=t.encode(e[h]);s[h]=p,r+=4+p.length}const i=new ArrayBuffer(r),o=new Uint8Array(i),u=new DataView(i);let d=0;for(const h of Tl.strings){const p=s[h],m=p.length;u.setUint32(d,m),o.set(p,d+4),d+=4+m}return et(d===i.byteLength,"CssFontInfo.write: Buffer overflow"),i}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#n=new TextDecoder}#s(e){et(e<Tl.strings.length,"Invalid string index");let t=0;for(let r=0;r<e;r++)t+=this.#t.getUint32(t)+4;const s=this.#t.getUint32(t);return this.#n.decode(new Uint8Array(this.#e,t+4,s))}get fontFamily(){return this.#s(0)}get fontWeight(){return this.#s(1)}get italicAngle(){return this.#s(2)}}class Cl{#e;#t;#n;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,s={};let r=0;for(const x of Cl.strings){const v=t.encode(e[x]);s[x]=v,r+=4+v.length}r+=4;let i,o,u=1+r;e.style&&(i=t.encode(e.style.style),o=t.encode(e.style.weight),u+=4+i.length+4+o.length);const d=new ArrayBuffer(u),h=new Uint8Array(d),p=new DataView(d);let m=0;p.setUint8(m++,e.guessFallback?1:0),p.setUint32(m,0),m+=4,r=0;for(const x of Cl.strings){const v=s[x],w=v.length;r+=4+w,p.setUint32(m,w),h.set(v,m+4),m+=4+w}return p.setUint32(m-r-4,r),e.style&&(p.setUint32(m,i.length),h.set(i,m+4),m+=4+i.length,p.setUint32(m,o.length),h.set(o,m+4),m+=4+o.length),et(m<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(m)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#n=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#s(e){et(e<Cl.strings.length,"Invalid string index");let t=5;for(let r=0;r<e;r++)t+=this.#t.getUint32(t)+4;const s=this.#t.getUint32(t);return this.#n.decode(new Uint8Array(this.#e,t+4,s))}get css(){return this.#s(0)}get loadedName(){return this.#s(1)}get baseFontName(){return this.#s(2)}get src(){return this.#s(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),s=this.#n.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const r=this.#t.getUint32(e),i=this.#n.decode(new Uint8Array(this.#e,e+4,r));return{style:s,weight:i}}}class ut{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#n=this.#t+1+8;static#s=this.#n+1+48;static#a=this.#s+1+6;#i;#r;#o;constructor({data:e,extra:t}){this.#i=e,this.#r=new TextDecoder,this.#o=new DataView(this.#i),t&&Object.assign(this,t)}#c(e){et(e<ut.bools.length,"Invalid boolean index");const t=Math.floor(e/4),s=e*2%8,r=this.#o.getUint8(t)>>s&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return et(e<ut.numbers.length,"Invalid number index"),this.#o.getFloat64(ut.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=ut.#t;if(this.#o.getUint8(e)===0)return;e+=1;const s=[];for(let r=0;r<4;r++)s.push(this.#o.getInt16(e,!0)),e+=2;return s}get fontMatrix(){let e=ut.#n;if(this.#o.getUint8(e)===0)return;e+=1;const s=[];for(let r=0;r<6;r++)s.push(this.#o.getFloat64(e,!0)),e+=8;return s}get defaultVMetrics(){let e=ut.#s;if(this.#o.getUint8(e)===0)return;e+=1;const s=[];for(let r=0;r<3;r++)s.push(this.#o.getInt16(e,!0)),e+=2;return s}#h(e){et(e<ut.strings.length,"Invalid string index");let t=ut.#a+4;for(let i=0;i<e;i++)t+=this.#o.getUint32(t)+4;const s=this.#o.getUint32(t),r=new Uint8Array(s);return r.set(new Uint8Array(this.#i,t+4,s)),this.#r.decode(r)}get fallbackName(){return this.#h(0)}get loadedName(){return this.#h(1)}get mimetype(){return this.#h(2)}get name(){return this.#h(3)}get data(){let e=ut.#a;const t=this.#o.getUint32(e);e+=4+t;const s=this.#o.getUint32(e);e+=4+s;const r=this.#o.getUint32(e);e+=4+r;const i=this.#o.getUint32(e);if(i!==0)return new Uint8Array(this.#i,e+4,i)}clearData(){let e=ut.#a;const t=this.#o.getUint32(e);e+=4+t;const s=this.#o.getUint32(e);e+=4+s;const r=this.#o.getUint32(e);e+=4+r;const i=this.#o.getUint32(e);new Uint8Array(this.#i,e+4,i).fill(0),this.#o.setUint32(e,0)}get cssFontInfo(){let e=ut.#a;const t=this.#o.getUint32(e);e+=4+t;const s=this.#o.getUint32(e);e+=4+s;const r=this.#o.getUint32(e);if(r===0)return null;const i=new Uint8Array(r);return i.set(new Uint8Array(this.#i,e+4,r)),new Tl(i.buffer)}get systemFontInfo(){let e=ut.#a;const t=this.#o.getUint32(e);e+=4+t;const s=this.#o.getUint32(e);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(this.#i,e+4,s)),new Cl(r.buffer)}static write(e){const t=e.systemFontInfo?Cl.write(e.systemFontInfo):null,s=e.cssFontInfo?Tl.write(e.cssFontInfo):null,r=new TextEncoder,i={};let o=0;for(const E of ut.strings)i[E]=r.encode(e[E]),o+=4+i[E].length;const u=ut.#a+4+o+4+(t?t.byteLength:0)+4+(s?s.byteLength:0)+4+(e.data?e.data.length:0),d=new ArrayBuffer(u),h=new Uint8Array(d),p=new DataView(d);let m=0;const x=ut.bools.length;let v=0,w=0;for(let E=0;E<x;E++){const N=e[ut.bools[E]];v|=(N===void 0?0:N?2:1)<<w,w+=2,(w===8||E===x-1)&&(p.setUint8(m++,v),v=0,w=0)}et(m===ut.#e,"FontInfo.write: Boolean properties offset mismatch");for(const E of ut.numbers)p.setFloat64(m,e[E]),m+=8;if(et(m===ut.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){p.setUint8(m++,4);for(const E of e.bbox)p.setInt16(m,E,!0),m+=2}else p.setUint8(m++,0),m+=8;if(et(m===ut.#n,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){p.setUint8(m++,6);for(const E of e.fontMatrix)p.setFloat64(m,E,!0),m+=8}else p.setUint8(m++,0),m+=48;if(et(m===ut.#s,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){p.setUint8(m++,1);for(const E of e.defaultVMetrics)p.setInt16(m,E,!0),m+=2}else p.setUint8(m++,0),m+=6;et(m===ut.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(ut.#a,0),m+=4;for(const E of ut.strings){const N=i[E],A=N.length;p.setUint32(m,A),h.set(N,m+4),m+=4+A}if(p.setUint32(ut.#a,m-ut.#a-4),!t)p.setUint32(m,0),m+=4;else{const E=t.byteLength;p.setUint32(m,E),et(m+4+E<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),h.set(new Uint8Array(t),m+4),m+=4+E}if(!s)p.setUint32(m,0),m+=4;else{const E=s.byteLength;p.setUint32(m,E),et(m+4+E<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),h.set(new Uint8Array(s),m+4),m+=4+E}return e.data===void 0?(p.setUint32(m,0),m+=4):(p.setUint32(m,e.data.length),h.set(e.data,m+4),m+=4+e.data.length),et(m<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(m)}}class as{static#e=0;static#t=1;static#n=2;static#s=3;static#a=4;static#i=8;static#r=12;static#o=16;constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,s=null,r=[],i=[],o=[],u=[],d=null,h=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,s=e[2],o=e[3],t===1?r.push(...e[4],...e[5]):r.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,d=e[1],r=e[2],i=e[3],u=e[4]||[],s=e[6],h=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const p=Math.floor(r.length/2),m=Math.floor(i.length/3),x=o.length,v=u.length;let w=0;for(const U of u)w+=1,w=Math.ceil(w/4)*4,w+=4+U.coords.length*4,w+=4+U.colors.length*4,U.verticesPerRow!==void 0&&(w+=4);const E=20+p*8+m*3+x*8+(s?16:0)+(h?3:0)+w,N=new ArrayBuffer(E),A=new DataView(N),T=new Uint8Array(N);A.setUint8(as.#e,t),A.setUint8(as.#t,s?1:0),A.setUint8(as.#n,h?1:0),A.setUint8(as.#s,d),A.setUint32(as.#a,p,!0),A.setUint32(as.#i,m,!0),A.setUint32(as.#r,x,!0),A.setUint32(as.#o,v,!0);let I=20;new Float32Array(N,I,p*2).set(r),I+=p*8,T.set(i,I),I+=m*3;for(const[U,O]of o)A.setFloat32(I,U,!0),I+=4,A.setUint32(I,parseInt(O.slice(1),16),!0),I+=4;if(s)for(const U of s)A.setFloat32(I,U,!0),I+=4;h&&(T.set(h,I),I+=3);for(let U=0;U<u.length;U++){const O=u[U];A.setUint8(I,O.type),I+=1,I=Math.ceil(I/4)*4,A.setUint32(I,O.coords.length,!0),I+=4,new Int32Array(N,I,O.coords.length).set(O.coords),I+=O.coords.length*4,A.setUint32(I,O.colors.length,!0),I+=4,new Int32Array(N,I,O.colors.length).set(O.colors),I+=O.colors.length*4,O.verticesPerRow!==void 0&&(A.setUint32(I,O.verticesPerRow,!0),I+=4)}return N}getIR(){const e=this.view,t=this.data[as.#e],s=!!this.data[as.#t],r=!!this.data[as.#n],i=e.getUint32(as.#a,!0),o=e.getUint32(as.#i,!0),u=e.getUint32(as.#r,!0),d=e.getUint32(as.#o,!0);let h=20;const p=new Float32Array(this.buffer,h,i*2);h+=i*8;const m=new Uint8Array(this.buffer,h,o*3);h+=o*3;const x=[];for(let N=0;N<u;++N){const A=e.getFloat32(h,!0);h+=4;const T=e.getUint32(h,!0);h+=4,x.push([A,`#${T.toString(16).padStart(6,"0")}`])}let v=null;if(s){v=[];for(let N=0;N<4;++N)v.push(e.getFloat32(h,!0)),h+=4}let w=null;r&&(w=new Uint8Array(this.buffer,h,3),h+=3);const E=[];for(let N=0;N<d;++N){const A=e.getUint8(h);h+=1,h=Math.ceil(h/4)*4;const T=e.getUint32(h,!0);h+=4;const I=new Int32Array(this.buffer,h,T);h+=T*4;const P=e.getUint32(h,!0);h+=4;const U=new Int32Array(this.buffer,h,P);h+=P*4;const O={type:A,coords:I,colors:U};A===u0.LATTICE&&(O.verticesPerRow=e.getUint32(h,!0),h+=4),E.push(O)}if(t===1)return["RadialAxial","axial",v,x,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",v,x,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(t===3){const N=this.data[as.#s];let A=null;if(p.length>0){let T=p[0],I=p[0],P=p[1],U=p[1];for(let O=0;O<p.length;O+=2){const R=p[O],C=p[O+1];T=T>R?R:T,P=P>C?C:P,I=I<R?R:I,U=U<C?C:U}A=[T,P,I,U]}return["Mesh",N,p,m,E,A,v,w]}throw new Error(`Unsupported pattern kind: ${t}`)}}function kO(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Ls)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function EO(n){if(Ls&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return td(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Lh(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const g0=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,NO=n=>typeof n=="object"&&typeof n?.name=="string",AO=aO.bind(null,g0,NO);class SO{#e=new Map;#t=Promise.resolve();postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[r]of this.#e)r.call(this,s)})}addEventListener(e,t,s=null){let r=null;if(s?.signal instanceof AbortSignal){const{signal:i}=s;if(i.aborted){ze("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);r=()=>i.removeEventListener("abort",o),i.addEventListener("abort",o)}this.#e.set(t,r)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const Oh={DATA:1,ERROR:2},Gt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function x_(){}function Gs(n){if(n instanceof ya||n instanceof d0||n instanceof u_||n instanceof Tf||n instanceof mg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||ft('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new ya(n.message);case"InvalidPDFException":return new d0(n.message);case"PasswordException":return new u_(n.message,n.code);case"ResponseException":return new Tf(n.message,n.status,n.missing);case"UnknownErrorException":return new mg(n.message,n.details)}return new mg(n.message,n.toString())}class cu{#e=new AbortController;constructor(e,t,s){this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#s(e);return}if(e.callback){const s=e.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Oh.DATA)r.resolve(e.data);else if(e.callback===Oh.ERROR)r.reject(Gs(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,r=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(o){i.postMessage({sourceName:s,targetName:r,callback:Oh.DATA,callbackId:e.callbackId,data:o})},function(o){i.postMessage({sourceName:s,targetName:r,callback:Oh.ERROR,callbackId:e.callbackId,reason:Gs(o)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const r=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[r]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},s)}catch(o){i.reject(o)}return i.promise}sendWithStream(e,t,s,r){const i=this.streamId++,o=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:h=>{const p=Promise.withResolvers();return this.streamControllers[i]={controller:h,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:o,targetName:u,action:e,streamId:i,data:t,desiredSize:h.desiredSize},r),p.promise},pull:h=>{const p=Promise.withResolvers();return this.streamControllers[i].pullCall=p,d.postMessage({sourceName:o,targetName:u,stream:Gt.PULL,streamId:i,desiredSize:h.desiredSize}),p.promise},cancel:h=>{et(h instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[i].cancelCall=p,this.streamControllers[i].isClosed=!0,d.postMessage({sourceName:o,targetName:u,stream:Gt.CANCEL,streamId:i,reason:Gs(h)}),p.promise}},s)}#n(e){const t=e.streamId,s=this.sourceName,r=e.sourceName,i=this.comObj,o=this,u=this.actionHandler[e.action],d={enqueue(h,p=1,m){if(this.isCancelled)return;const x=this.desiredSize;this.desiredSize-=p,x>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:s,targetName:r,stream:Gt.ENQUEUE,streamId:t,chunk:h},m)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:r,stream:Gt.CLOSE,streamId:t}),delete o.streamSinks[t])},error(h){et(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:r,stream:Gt.ERROR,streamId:t,reason:Gs(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[t]=d,Promise.try(u,e.data,d).then(function(){i.postMessage({sourceName:s,targetName:r,stream:Gt.START_COMPLETE,streamId:t,success:!0})},function(h){i.postMessage({sourceName:s,targetName:r,stream:Gt.START_COMPLETE,streamId:t,reason:Gs(h)})})}#s(e){const t=e.streamId,s=this.sourceName,r=e.sourceName,i=this.comObj,o=this.streamControllers[t],u=this.streamSinks[t];switch(e.stream){case Gt.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Gs(e.reason));break;case Gt.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Gs(e.reason));break;case Gt.PULL:if(!u){i.postMessage({sourceName:s,targetName:r,stream:Gt.PULL_COMPLETE,streamId:t,success:!0});break}u.desiredSize<=0&&e.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=e.desiredSize,Promise.try(u.onPull||x_).then(function(){i.postMessage({sourceName:s,targetName:r,stream:Gt.PULL_COMPLETE,streamId:t,success:!0})},function(h){i.postMessage({sourceName:s,targetName:r,stream:Gt.PULL_COMPLETE,streamId:t,reason:Gs(h)})});break;case Gt.ENQUEUE:if(et(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Gt.CLOSE:if(et(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#a(o,t);break;case Gt.ERROR:et(o,"error should have stream controller"),o.controller.error(Gs(e.reason)),this.#a(o,t);break;case Gt.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Gs(e.reason)),this.#a(o,t);break;case Gt.CANCEL:if(!u)break;const d=Gs(e.reason);Promise.try(u.onCancel||x_,d).then(function(){i.postMessage({sourceName:s,targetName:r,stream:Gt.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){i.postMessage({sourceName:s,targetName:r,stream:Gt.CANCEL_COMPLETE,streamId:t,reason:Gs(h)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#a(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class RN{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){ft("Abstract method `_createCanvas` called.")}}class TO extends RN{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class DN{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){ft("Abstract method `_fetch` called.")}}class b_ extends DN{async _fetch(e){const t=await sd(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):td(t)}}class MN{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,r,i){return"none"}destroy(e=!1){}}class CO extends MN{#e;#t;#n;#s;#a;#i;#r=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#s=e,this.#a=t}get#o(){return this.#t||=new Map}get#c(){return this.#i||=new Map}get#l(){if(!this.#n){const e=this.#a.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=this.#a.createElementNS(Xr,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#a.createElementNS(Xr,"defs"),e.append(s),s.append(this.#n),this.#a.body.append(e)}return this.#n}#h(e){if(e.length===1){const d=e[0],h=new Array(256);for(let m=0;m<256;m++)h[m]=d[m]/255;const p=h.join(",");return[p,p,p]}const[t,s,r]=e,i=new Array(256),o=new Array(256),u=new Array(256);for(let d=0;d<256;d++)i[d]=t[d]/255,o[d]=s[d]/255,u[d]=r[d]/255;return[i.join(","),o.join(","),u.join(",")]}#d(e){if(this.#e===void 0){this.#e="";const t=this.#a.URL;t!==this.#a.baseURI&&(yp(t)?ze('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=kN(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[s,r,i]=this.#h(e),o=e.length===1?s:`${s}${r}${i}`;if(t=this.#o.get(o),t)return this.#o.set(e,t),t;const u=`g_${this.#s}_transfer_map_${this.#r++}`,d=this.#d(u);this.#o.set(e,d),this.#o.set(o,d);const h=this.#m(u);return this.#p(s,r,i,h),d}addHCMFilter(e,t){const s=`${e}-${t}`,r="base";let i=this.#c.get(r);if(i?.key===s||(i?(i.filter?.remove(),i.key=s,i.url="none",i.filter=null):(i={key:s,url:"none",filter:null},this.#c.set(r,i)),!e||!t))return i.url;const o=this.#b(e);e=we.makeHexColor(...o);const u=this.#b(t);if(t=we.makeHexColor(...u),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return i.url;const d=new Array(256);for(let v=0;v<=255;v++){const w=v/255;d[v]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const h=d.join(","),p=`g_${this.#s}_hcm_filter`,m=i.filter=this.#m(p);this.#p(h,h,h,m),this.#g(m);const x=(v,w)=>{const E=o[v]/255,N=u[v]/255,A=new Array(w+1);for(let T=0;T<=w;T++)A[T]=E+T/w*(N-E);return A.join(",")};return this.#p(x(0,5),x(1,5),x(2,5),m),i.url=this.#d(p),i.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[s]=this.#h([e]),r=`alpha_${s}`;if(t=this.#o.get(r),t)return this.#o.set(e,t),t;const i=`g_${this.#s}_alpha_map_${this.#r++}`,o=this.#d(i);this.#o.set(e,o),this.#o.set(r,o);const u=this.#m(i);return this.#y(s,u),o}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let s,r;if(e?([s]=this.#h([e]),r=`luminosity_${s}`):r="luminosity",t=this.#o.get(r),t)return this.#o.set(e,t),t;const i=`g_${this.#s}_luminosity_map_${this.#r++}`,o=this.#d(i);this.#o.set(e,o),this.#o.set(r,o);const u=this.#m(i);return this.#f(u),e&&this.#y(s,u),o}addHighlightHCMFilter(e,t,s,r,i){const o=`${t}-${s}-${r}-${i}`;let u=this.#c.get(e);if(u?.key===o||(u?(u.filter?.remove(),u.key=o,u.url="none",u.filter=null):(u={key:o,url:"none",filter:null},this.#c.set(e,u)),!t||!s))return u.url;const[d,h]=[t,s].map(this.#b.bind(this));let p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[x,v]=[r,i].map(this.#b.bind(this));m<p&&([p,m,x,v]=[m,p,v,x]),this.#l.style.color="";const w=(A,T,I)=>{const P=new Array(256),U=(m-p)/I,O=A/255,R=(T-A)/(255*I);let C=0;for(let D=0;D<=I;D++){const B=Math.round(p+D*U),V=O+D*R;for(let $=C;$<=B;$++)P[$]=V;C=B+1}for(let D=C;D<256;D++)P[D]=P[C-1];return P.join(",")},E=`g_${this.#s}_hcm_${e}_filter`,N=u.filter=this.#m(E);return this.#g(N),this.#p(w(x[0],v[0],5),w(x[1],v[1],5),w(x[2],v[2],5),N),u.url=this.#d(E),u.url}destroy(e=!1){e&&this.#i?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#t?.clear(),this.#t=null,this.#i?.clear(),this.#i=null,this.#r=0)}#f(e){const t=this.#a.createElementNS(Xr,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#g(e){const t=this.#a.createElementNS(Xr,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#m(e){const t=this.#a.createElementNS(Xr,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#u(e,t,s){const r=this.#a.createElementNS(Xr,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),e.append(r)}#p(e,t,s,r){const i=this.#a.createElementNS(Xr,"feComponentTransfer");r.append(i),this.#u(i,"feFuncR",e),this.#u(i,"feFuncG",t),this.#u(i,"feFuncB",s)}#y(e,t){const s=this.#a.createElementNS(Xr,"feComponentTransfer");t.append(s),this.#u(s,"feFuncA",e)}#b(e){return this.#l.style.color=e,rd(getComputedStyle(this.#l).getPropertyValue("color"))}}class LN{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){ft("Abstract method `_fetch` called.")}}class v_ extends LN{async _fetch(e){const t=await sd(e,"arraybuffer");return new Uint8Array(t)}}class ON{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){ft("Abstract method `_fetch` called.")}}class w_ extends ON{async _fetch(e){const t=await sd(e,"arraybuffer");return new Uint8Array(t)}}Ls&&ze("Please use the `legacy` build in Node.js environments.");async function qy(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class IO extends MN{}class PO extends RN{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class jO extends DN{async _fetch(e){return qy(e)}}class RO extends LN{async _fetch(e){return qy(e)}}class DO extends ON{async _fetch(e){return qy(e)}}const cl="__forcedDependency",{floor:__,ceil:k_}=Math;function Fh(n,e,t,s,r,i){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],s),n[e*4+2]=Math.max(n[e*4+2],r),n[e*4+3]=Math.max(n[e*4+3],i)}const y0=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class MO{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===y0}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const Vh=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};class LO{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[cl]:[]};#n=new Map;#s=[];#a=[];#i=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#h=new Map;#d=new Map;#f;#g;#m;#u;#p;constructor(e,t,s=!1){this.#f=e.width,this.#g=e.height,this.#y(t),s&&(this.#p=new Map)}growOperationsCount(e){e>=this.#u.length&&this.#y(e,this.#u)}#y(e,t){const s=new ArrayBuffer(e*4);this.#m=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),t&&t.length>0?(this.#u.set(t),this.#u.fill(y0,t.length)):this.#u.fill(y0)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[cl]:{__proto__:this.#t[cl]}},this.#r={__proto__:this.#r},this.#s.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#r=Object.getPrototypeOf(this.#r);const s=this.#s.pop();return s!==void 0&&(Vh(this.#p,e)?.dependencies.add(s),this.#u[e]=this.#u[s]),this}recordOpenMarker(e){return this.#s.push(e),this}getOpenMarker(){return this.#s.length===0?null:this.#s.at(-1)}recordCloseMarker(e){const t=this.#s.pop();return t!==void 0&&(Vh(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}beginMarkedContent(e){return this.#a.push(e),this}endMarkedContent(e){const t=this.#a.pop();return t!==void 0&&(Vh(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}pushBaseTransform(e){return this.#i.push(we.multiplyByDOMMatrix(this.#i.at(-1),e.getTransform())),this}popBaseTransform(){return this.#i.length>1&&this.#i.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#n.set(e,t),this}recordSimpleDataFromNamed(e,t,s){this.#e[e]=this.#n.get(t)??s}recordFutureForcedDependency(e,t){return this.recordIncrementalData(cl,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(cl,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(e,t,s,r,i,o){const u=we.multiplyByDOMMatrix(this.#i.at(-1),t.getTransform()),d=[1/0,1/0,-1/0,-1/0];we.axialAlignedBoundingBox([s,i,r,o],u,d);const h=we.intersect(this.#r,d);return h?(this.#r[0]=h[0],this.#r[1]=h[1],this.#r[2]=h[2],this.#r[3]=h[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(e,t,s,r,i,o){const u=this.#r;if(u[0]===1/0)return this;const d=we.multiplyByDOMMatrix(this.#i.at(-1),t.getTransform());if(u[0]===-1/0)return we.axialAlignedBoundingBox([s,i,r,o],d,this.#o),this;const h=[1/0,1/0,-1/0,-1/0];return we.axialAlignedBoundingBox([s,i,r,o],d,h),this.#o[0]=Math.min(this.#o[0],Math.max(h[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(h[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(h[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(h[3],u[3])),this}recordCharacterBBox(e,t,s,r=1,i=0,o=0,u){const d=s.bbox;let h,p;if(d&&(h=d[2]!==d[0]&&d[3]!==d[1]&&this.#d.get(s),h!==!1&&(p=[0,0,0,0],we.axialAlignedBoundingBox(d,s.fontMatrix,p),(r!==1||i!==0||o!==0)&&we.scaleMinMax([r,0,0,-r,i,o],p),h)))return this.recordBBox(e,t,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(e);const m=u();return d&&p&&h===void 0&&(h=p[0]<=i-m.actualBoundingBoxLeft&&p[2]>=i+m.actualBoundingBoxRight&&p[1]<=o-m.actualBoundingBoxAscent&&p[3]>=o+m.actualBoundingBoxDescent,this.#d.set(s,h),h)?this.recordBBox(e,t,p[0],p[2],p[1],p[3]):this.recordBBox(e,t,i-m.actualBoundingBoxLeft,i+m.actualBoundingBoxRight,o-m.actualBoundingBoxAscent,o+m.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#f,this.#r[2]),this.#o[3]=Math.min(this.#g,this.#r[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const s=this.#l,r=this.#e,i=this.#t;for(const o of t)o in this.#e?s.add(r[o]):o in i&&i[o].forEach(s.add,s);return this}recordNamedDependency(e,t){return this.#n.has(t)&&this.#l.add(this.#n.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[cl]),this.#p){const s=Vh(this.#p,e),{dependencies:r}=s;this.#l.forEach(r.add,r),this.#s.forEach(r.add,r),this.#a.forEach(r.add,r),r.delete(e),s.isRenderingOperation=!0}if(this.#c===e){const s=__(this.#o[0]*256/this.#f),r=__(this.#o[1]*256/this.#g),i=k_(this.#o[2]*256/this.#f),o=k_(this.#o[3]*256/this.#g);Fh(this.#m,e,s,r,i,o);for(const u of this.#l)u!==e&&Fh(this.#m,u,s,r,i,o);for(const u of this.#s)u!==e&&Fh(this.#m,u,s,r,i,o);for(const u of this.#a)u!==e&&Fh(this.#m,u,s,r,i,o);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const s=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const r of s)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#h.get(e);return this.#h.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#d.clear(),new MO(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class Cf{#e;#t;#n;#s=0;#a=0;constructor(e,t,s){if(e instanceof Cf&&e.#n===!!s)return e;this.#e=e,this.#t=t,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#a++,this.#e.save(this.#t),this}restore(e){return this.#a>0&&(this.#e.restore(this.#t),this.#a--),this}recordOpenMarker(e){return this.#s++,this}getOpenMarker(){return this.#s>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#s--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,s){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#n||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,s,r,i,o){return this.#n||this.#e.recordClipBox(this.#t,t,s,r,i,o),this}recordBBox(e,t,s,r,i,o){return this.#n||this.#e.recordBBox(this.#t,t,s,r,i,o),this}recordCharacterBBox(e,t,s,r,i,o,u){return this.#n||this.#e.recordCharacterBBox(this.#t,t,s,r,i,o,u),this}recordFullPageBBox(e){return this.#n||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#n||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const An={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},ys={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function x0(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,s),n.clip(r)}class Wy{isModifyingCurrentTransform(){return!1}getPattern(){ft("Abstract method `getPattern` called.")}}class OO extends Wy{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,r){let i;if(r===ys.STROKE||r===ys.FILL){const o=t.current.getClippedPathBoundingBox(r,kt(e))||[0,0,0,0],u=Math.ceil(o[2]-o[0])||1,d=Math.ceil(o[3]-o[1])||1,h=t.cachedCanvases.getCanvas("pattern",u,d),p=h.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-o[0],-o[1]),s=we.transform(s,[1,0,0,1,o[0],o[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),x0(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),i=e.createPattern(h.canvas,"no-repeat");const m=new DOMMatrix(s);i.setTransform(m)}else x0(e,this._bbox),i=this._createGradient(e);return i}}function xg(n,e,t,s,r,i,o,u){const d=e.coords,h=e.colors,p=n.data,m=n.width*4;let x;d[t+1]>d[s+1]&&(x=t,t=s,s=x,x=i,i=o,o=x),d[s+1]>d[r+1]&&(x=s,s=r,r=x,x=o,o=u,u=x),d[t+1]>d[s+1]&&(x=t,t=s,s=x,x=i,i=o,o=x);const v=(d[t]+e.offsetX)*e.scaleX,w=(d[t+1]+e.offsetY)*e.scaleY,E=(d[s]+e.offsetX)*e.scaleX,N=(d[s+1]+e.offsetY)*e.scaleY,A=(d[r]+e.offsetX)*e.scaleX,T=(d[r+1]+e.offsetY)*e.scaleY;if(w>=T)return;const I=h[i],P=h[i+1],U=h[i+2],O=h[o],R=h[o+1],C=h[o+2],D=h[u],B=h[u+1],V=h[u+2],$=Math.round(w),L=Math.round(T);let de,ye,ie,oe,Y,he,le,W;for(let Z=$;Z<=L;Z++){if(Z<N){const fe=Z<w?0:(w-Z)/(w-N);de=v-(v-E)*fe,ye=I-(I-O)*fe,ie=P-(P-R)*fe,oe=U-(U-C)*fe}else{let fe;Z>T?fe=1:N===T?fe=0:fe=(N-Z)/(N-T),de=E-(E-A)*fe,ye=O-(O-D)*fe,ie=R-(R-B)*fe,oe=C-(C-V)*fe}let ce;Z<w?ce=0:Z>T?ce=1:ce=(w-Z)/(w-T),Y=v-(v-A)*ce,he=I-(I-D)*ce,le=P-(P-B)*ce,W=U-(U-V)*ce;const xe=Math.round(Math.min(de,Y)),je=Math.round(Math.max(de,Y));let Re=m*Z+xe*4;for(let fe=xe;fe<=je;fe++)ce=(de-fe)/(de-Y),ce<0?ce=0:ce>1&&(ce=1),p[Re++]=ye-(ye-he)*ce|0,p[Re++]=ie-(ie-le)*ce|0,p[Re++]=oe-(oe-W)*ce|0,p[Re++]=255}}function FO(n,e,t){const s=e.coords,r=e.colors;let i,o;switch(e.type){case u0.LATTICE:const u=e.verticesPerRow,d=Math.floor(s.length/u)-1,h=u-1;for(i=0;i<d;i++){let p=i*u;for(let m=0;m<h;m++,p++)xg(n,t,s[p],s[p+1],s[p+u],r[p],r[p+1],r[p+u]),xg(n,t,s[p+u+1],s[p+1],s[p+u],r[p+u+1],r[p+1],r[p+u])}break;case u0.TRIANGLES:for(i=0,o=s.length;i<o;i+=3)xg(n,t,s[i],s[i+1],s[i+2],r[i],r[i+1],r[i+2]);break;default:throw new Error("illegal figure")}}class VO extends Wy{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-d,m=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),x=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),v=h/m,w=p/x,E={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/v,scaleY:1/w},N=m+4,A=x+4,T=s.getCanvas("mesh",N,A),I=T.context,P=I.createImageData(m,x);if(t){const O=P.data;for(let R=0,C=O.length;R<C;R+=4)O[R]=t[0],O[R+1]=t[1],O[R+2]=t[2],O[R+3]=255}for(const O of this._figures)FO(P,O,E);return I.putImageData(P,2,2),{canvas:T.canvas,offsetX:u-2*v,offsetY:d-2*w,scaleX:v,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,r){x0(e,this._bbox);const i=new Float32Array(2);if(r===ys.SHADING)we.singularValueDecompose2dScale(kt(e),i);else if(this.matrix){we.singularValueDecompose2dScale(this.matrix,i);const[u,d]=i;we.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=u,i[1]*=d}else we.singularValueDecompose2dScale(t.baseTransform,i);const o=this._createMeshCanvas(i,r===ys.SHADING?null:this._background,t.cachedCanvases);return r!==ys.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class UO extends Wy{getPattern(){return"hotpink"}}function BO(n){switch(n[0]){case"RadialAxial":return new OO(n);case"Mesh":return new VO(n);case"Dummy":return new UO}throw new Error(`Unknown IR type: ${n[0]}`)}const E_={COLORED:1,UNCOLORED:2};class Gy{static MAX_PATTERN_SIZE=3e3;constructor(e,t,s,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(e,t){const{bbox:s,operatorList:r,paintType:i,tilingType:o,color:u,canvasGraphicsFactory:d}=this;let{xstep:h,ystep:p}=this;h=Math.abs(h),p=Math.abs(p),gp("TilingType: "+o);const m=s[0],x=s[1],v=s[2],w=s[3],E=v-m,N=w-x,A=new Float32Array(2);we.singularValueDecompose2dScale(this.matrix,A);const[T,I]=A;we.singularValueDecompose2dScale(this.baseTransform,A);const P=T*A[0],U=I*A[1];let O=E,R=N,C=!1,D=!1;const B=Math.ceil(h*P),V=Math.ceil(p*U),$=Math.ceil(E*P),L=Math.ceil(N*U);B>=$?O=h:C=!0,V>=L?R=p:D=!0;const de=this.getSizeAndScale(O,this.ctx.canvas.width,P),ye=this.getSizeAndScale(R,this.ctx.canvas.height,U),ie=e.cachedCanvases.getCanvas("pattern",de.size,ye.size),oe=ie.context,Y=d.createCanvasGraphics(oe,t);if(Y.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(Y,i,u),oe.translate(-de.scale*m,-ye.scale*x),Y.transform(0,de.scale,0,0,ye.scale,0,0),oe.save(),Y.dependencyTracker?.save(),this.clipBbox(Y,m,x,v,w),Y.baseTransform=kt(Y.ctx),Y.executeOperatorList(r),Y.endDrawing(),Y.dependencyTracker?.restore(),oe.restore(),C||D){const he=ie.canvas;C&&(O=h),D&&(R=p);const le=this.getSizeAndScale(O,this.ctx.canvas.width,P),W=this.getSizeAndScale(R,this.ctx.canvas.height,U),Z=le.size,ce=W.size,xe=e.cachedCanvases.getCanvas("pattern-workaround",Z,ce),je=xe.context,Re=C?Math.floor(E/h):0,fe=D?Math.floor(N/p):0;for(let Ue=0;Ue<=Re;Ue++)for(let Se=0;Se<=fe;Se++)je.drawImage(he,Z*Ue,ce*Se,Z,ce,0,0,Z,ce);return{canvas:xe.canvas,scaleX:le.scale,scaleY:W.scale,offsetX:m,offsetY:x}}return{canvas:ie.canvas,scaleX:de.scale,scaleY:ye.scale,offsetX:m,offsetY:x}}getSizeAndScale(e,t,s){const r=Math.max(Gy.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*s);return i>=r?i=r:s=i/e,{scale:s,size:i}}clipBbox(e,t,s,r,i){const o=r-t,u=i-s;e.ctx.rect(t,s,o,u),we.axialAlignedBoundingBox([t,s,r,i],kt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const r=e.ctx,i=e.current;switch(t){case E_.COLORED:const{fillStyle:o,strokeStyle:u}=this.ctx;r.fillStyle=i.fillColor=o,r.strokeStyle=i.strokeColor=u;break;case E_.UNCOLORED:r.fillStyle=r.strokeStyle=s,i.fillColor=i.strokeColor=s;break;default:throw new eO(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,r,i){let o=s;r!==ys.SHADING&&(o=we.transform(o,t.baseTransform),this.matrix&&(o=we.transform(o,this.matrix)));const u=this.createPatternCanvas(t,i);let d=new DOMMatrix(o);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const h=e.createPattern(u.canvas,"repeat");return h.setTransform(d),h}}function zO({src:n,srcPos:e=0,dest:t,width:s,height:r,nonBlackColor:i=4294967295,inverseDecode:o=!1}){const u=bs.isLittleEndian?4278190080:255,[d,h]=o?[i,u]:[u,i],p=s>>3,m=s&7,x=n.length;t=new Uint32Array(t.buffer);let v=0;for(let w=0;w<r;w++){for(const N=e+p;e<N;e++){const A=e<x?n[e]:255;t[v++]=A&128?h:d,t[v++]=A&64?h:d,t[v++]=A&32?h:d,t[v++]=A&16?h:d,t[v++]=A&8?h:d,t[v++]=A&4?h:d,t[v++]=A&2?h:d,t[v++]=A&1?h:d}if(m===0)continue;const E=e<x?n[e++]:255;for(let N=0;N<m;N++)t[v++]=E&1<<7-N?h:d}return{srcPos:e,destPos:v}}const N_=16,A_=100,$O=15,S_=10,Ks=16,bg=new DOMMatrix,hn=new Float32Array(2),vl=new Float32Array([1/0,1/0,-1/0,-1/0]);function HO(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,r,i,o,u){e.transform(t,s,r,i,o,u),this.__originalTransform(t,s,r,i,o,u)},n.setTransform=function(t,s,r,i,o,u){e.setTransform(t,s,r,i,o,u),this.__originalSetTransform(t,s,r,i,o,u)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,r,i,o,u){e.bezierCurveTo(t,s,r,i,o,u),this.__originalBezierCurveTo(t,s,r,i,o,u)},n.rect=function(t,s,r,i){e.rect(t,s,r,i),this.__originalRect(t,s,r,i)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class qO{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,s)):(r=this.canvasFactory.create(t,s),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Uh(n,e,t,s,r,i,o,u,d,h){const[p,m,x,v,w,E]=kt(n);if(m===0&&x===0){const T=o*p+w,I=Math.round(T),P=u*v+E,U=Math.round(P),O=(o+d)*p+w,R=Math.abs(Math.round(O)-I)||1,C=(u+h)*v+E,D=Math.abs(Math.round(C)-U)||1;return n.setTransform(Math.sign(p),0,0,Math.sign(v),I,U),n.drawImage(e,t,s,r,i,0,0,R,D),n.setTransform(p,m,x,v,w,E),[R,D]}if(p===0&&v===0){const T=u*x+w,I=Math.round(T),P=o*m+E,U=Math.round(P),O=(u+h)*x+w,R=Math.abs(Math.round(O)-I)||1,C=(o+d)*m+E,D=Math.abs(Math.round(C)-U)||1;return n.setTransform(0,Math.sign(m),Math.sign(x),0,I,U),n.drawImage(e,t,s,r,i,0,0,D,R),n.setTransform(p,m,x,v,w,E),[D,R]}n.drawImage(e,t,s,r,i,o,u,d,h);const N=Math.hypot(p,m),A=Math.hypot(x,v);return[N*d,A*h]}class T_{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=c0;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=fs.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,s){s?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=vl.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=ys.FILL,t=null){const s=this.minMax.slice();if(e===ys.STROKE){t||ft("Stroke bounding box must include transform."),we.singularValueDecompose2dScale(t,hn);const r=hn[0]*this.lineWidth/2,i=hn[1]*this.lineWidth/2;s[0]-=r,s[1]-=i,s[2]+=r,s[3]+=i}return s}updateClipFromPath(){const e=we.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(vl,0)}getClippedPathBoundingBox(e=ys.FILL,t=null){return we.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function C_(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,r=t%Ks,i=(t-r)/Ks,o=r===0?i:i+1,u=n.createImageData(s,Ks);let d=0,h;const p=e.data,m=u.data;let x,v,w,E;if(e.kind===rf.GRAYSCALE_1BPP){const N=p.byteLength,A=new Uint32Array(m.buffer,0,m.byteLength>>2),T=A.length,I=s+7>>3,P=4294967295,U=bs.isLittleEndian?4278190080:255;for(x=0;x<o;x++){for(w=x<i?Ks:r,h=0,v=0;v<w;v++){const O=N-d;let R=0;const C=O>I?s:O*8-7,D=C&-8;let B=0,V=0;for(;R<D;R+=8)V=p[d++],A[h++]=V&128?P:U,A[h++]=V&64?P:U,A[h++]=V&32?P:U,A[h++]=V&16?P:U,A[h++]=V&8?P:U,A[h++]=V&4?P:U,A[h++]=V&2?P:U,A[h++]=V&1?P:U;for(;R<C;R++)B===0&&(V=p[d++],B=128),A[h++]=V&B?P:U,B>>=1}for(;h<T;)A[h++]=0;n.putImageData(u,0,x*Ks)}}else if(e.kind===rf.RGBA_32BPP){for(v=0,E=s*Ks*4,x=0;x<i;x++)m.set(p.subarray(d,d+E)),d+=E,n.putImageData(u,0,v),v+=Ks;x<o&&(E=s*r*4,m.set(p.subarray(d,d+E)),n.putImageData(u,0,v))}else if(e.kind===rf.RGB_24BPP)for(w=Ks,E=s*w,x=0;x<o;x++){for(x>=i&&(w=r,E=s*w),h=0,v=E;v--;)m[h++]=p[d++],m[h++]=p[d++],m[h++]=p[d++],m[h++]=255;n.putImageData(u,0,x*Ks)}else throw new Error(`bad image kind: ${e.kind}`)}function I_(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,r=t%Ks,i=(t-r)/Ks,o=r===0?i:i+1,u=n.createImageData(s,Ks);let d=0;const h=e.data,p=u.data;for(let m=0;m<o;m++){const x=m<i?Ks:r;({srcPos:d}=zO({src:h,srcPos:d,dest:p,width:s,height:x,nonBlackColor:0})),n.putImageData(u,0,m*Ks)}}function Qc(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Bh(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function P_(n,e){if(e)return!0;we.singularValueDecompose2dScale(n,hn);const t=Math.fround(Cr.pixelRatio*Bl.PDF_TO_CSS_UNITS);return hn[0]<=t&&hn[1]<=t}const WO=["butt","round","square"],GO=["miter","round","bevel"],KO={},j_={};class Il{constructor(e,t,s,r,i,{optionalContentConfig:o,markedContentStack:u=null},d,h,p){this.ctx=e,this.current=new T_(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=r,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=o,this.cachedCanvases=new qO(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(e,t,s=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:r=null}){const i=this.ctx.canvas.width,o=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,i,o),this.ctx.fillStyle=u,s){const d=this.cachedCanvases.getCanvas("transparent",i,o);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...kt(this.compositeCtx))}this.ctx.save(),Bh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=kt(this.ctx)}executeOperatorList(e,t,s,r,i){const o=e.argsArray,u=e.fnArray;let d=t||0;const h=o.length;if(h===d)return d;const p=h-d>S_&&typeof s=="function",m=p?Date.now()+$O:0;let x=0;const v=this.commonObjs,w=this.objs;let E,N;for(;;){if(r!==void 0&&d===r.nextBreakPoint)return r.breakIt(d,s),d;if(!i||i(d))if(E=u[d],N=o[d]??null,E!==Ru.dependency)N===null?this[E](d):this[E](d,...N);else for(const A of N){this.dependencyTracker?.recordNamedData(A,d);const T=A.startsWith("g_")?v:w;if(!T.has(A))return T.get(A,s),d}if(d++,d===h)return d;if(p&&++x>S_){if(Date.now()>m)return s(),d;x=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const s=e.width??e.displayWidth,r=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),u=s,d=r,h="prescale1",p,m;for(;i>2&&u>1||o>2&&d>1;){let x=u,v=d;i>2&&u>1&&(x=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),i/=u/x),o>2&&d>1&&(v=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,o/=d/v),p=this.cachedCanvases.getCanvas(h,x,v),m=p.context,m.clearRect(0,0,x,v),m.drawImage(e,0,0,u,d,0,0,x,v),e=p.canvas,u=x,d=v,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:u,paintHeight:d}}_createMaskCanvas(e,t){const s=this.ctx,{width:r,height:i}=t,o=this.current.fillColor,u=this.current.patternFill,d=kt(s);let h,p,m,x;if((t.bitmap||t.data)&&t.count>1){const B=t.bitmap||t.data.buffer;p=JSON.stringify(u?d:[d.slice(0,4),o]),h=this._cachedBitmapsMap.get(B),h||(h=new Map,this._cachedBitmapsMap.set(B,h));const V=h.get(p);if(V&&!u){const $=Math.round(Math.min(d[0],d[2])+d[4]),L=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(e,An.transformAndFill),{canvas:V,offsetX:$,offsetY:L}}m=V}m||(x=this.cachedCanvases.getCanvas("maskCanvas",r,i),I_(x.context,t));let v=we.transform(d,[1/r,0,0,-1/i,0,0]);v=we.transform(v,[1,0,0,1,0,-i]);const w=vl.slice();we.axialAlignedBoundingBox([0,0,r,i],v,w);const[E,N,A,T]=w,I=Math.round(A-E)||1,P=Math.round(T-N)||1,U=this.cachedCanvases.getCanvas("fillCanvas",I,P),O=U.context,R=E,C=N;O.translate(-R,-C),O.transform(...v),m||(m=this._scaleImage(x.canvas,gr(O)),m=m.img,h&&u&&h.set(p,m)),O.imageSmoothingEnabled=P_(kt(O),t.interpolate),Uh(O,m,0,0,m.width,m.height,0,0,r,i),O.globalCompositeOperation="source-in";const D=we.transform(gr(O),[1,0,0,1,-R,-C]);return O.fillStyle=u?o.getPattern(s,this,D,ys.FILL,e):o,O.fillRect(0,0,r,i),h&&!u&&(this.cachedCanvases.delete("fillCanvas"),h.set(p,U.canvas)),this.dependencyTracker?.recordDependencies(e,An.transformAndFill),{canvas:U.canvas,offsetX:Math.round(R),offsetY:Math.round(C)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=WO[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=GO[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){this.dependencyTracker?.recordSimpleData("dash",e);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[s,r]of t)switch(s){case"LW":this.setLineWidth(e,r);break;case"LC":this.setLineCap(e,r);break;case"LJ":this.setLineJoin(e,r);break;case"ML":this.setMiterLimit(e,r);break;case"D":this.setDash(e,r[0],r[1]);break;case"RI":this.setRenderingIntent(e,r);break;case"FL":this.setFlatness(e,r);break;case"Font":this.setFont(e,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,t,s);this.suspendedCtx=this.ctx;const o=this.ctx=i.context;o.setTransform(this.suspendedCtx.getTransform()),Qc(this.suspendedCtx,o),HO(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Qc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,r){const i=r[0],o=r[1],u=r[2]-i,d=r[3]-o;u===0||d===0||(this.genericComposeSMask(t.context,s,u,d,t.subtype,t.backdrop,t.transferMap,i,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,r,i,o,u,d,h,p,m){let x=e.canvas,v=d-p,w=h-m;if(o)if(v<0||w<0||v+s>x.width||w+r>x.height){const N=this.cachedCanvases.getCanvas("maskExtension",s,r),A=N.context;A.drawImage(x,-v,-w),A.globalCompositeOperation="destination-atop",A.fillStyle=o,A.fillRect(0,0,s,r),A.globalCompositeOperation="source-over",x=N.canvas,v=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(v,w,s,r),e.clip(N),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(v,w,s,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&u?t.filter=this.filterFactory.addAlphaFilter(u):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(u));const E=new Path2D;E.rect(d,h,s,r),t.clip(E),t.globalCompositeOperation="destination-in",t.drawImage(x,v,w,s,r,d,h,s,r),t.restore()}save(e){this.inSMaskMode&&Qc(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Qc(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,r,i,o,u){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,s,r,i,o,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,r){let[i]=s;if(!r){i||=s[0]=new Path2D,this[t](e,i);return}if(this.dependencyTracker!==null){const o=t===Ru.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,r[0]-o,r[2]+o,r[1]-o,r[3]+o).recordDependencies(e,["transform"])}i instanceof Path2D||(i=s[0]=CN(i)),we.axialAlignedBoundingBox(r,kt(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){const r=this.ctx,i=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&i?.getPattern){const o=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=i.getPattern(r,this,gr(r),ys.STROKE,e),o){const u=new Path2D;u.addPath(t,r.getTransform().invertSelf().multiplySelf(o)),t=u}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,An.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(ys.STROKE,kt(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){const r=this.ctx,i=this.current.fillColor,o=this.current.patternFill;let u=!1;if(o){const h=i.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(e),r.save(),r.fillStyle=i.getPattern(r,this,gr(r),ys.FILL,e),h){const p=new Path2D;p.addPath(t,r.getTransform().invertSelf().multiplySelf(h)),t=p}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),this.dependencyTracker?.recordDependencies(e,An.fill),u&&(r.restore(),this.dependencyTracker?.restore(e)),s&&this.consumePath(e,t,d)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,An.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=KO}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=j_}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;t!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",e),r.recordCloseMarker(e)}if(t!==void 0){const r=new Path2D,i=s.getTransform().invertSelf();for(const{transform:o,x:u,y:d,fontSize:h,path:p}of t)p&&r.addPath(p,new DOMMatrix(o).preMultiplySelf(i).translate(u,d).scale(h,-h));s.clip(r)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const r=this.commonObjs.get(t),i=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=r.fontMatrix||c0,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ze("Invalid font matrix for font "+t),s<0?(s=-s,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=s,r.isType3Font)return;const o=r.loadedName||"sans-serif",u=r.systemFontInfo?.css||`"${o}", ${r.fallbackName}`;let d="normal";r.black?d="900":r.bold&&(d="bold");const h=r.italic?"italic":"normal";let p=s;s<N_?p=N_:s>A_&&(p=A_),this.current.fontSizeScale=s/p,this.ctx.font=`${h} ${d} ${p}px ${u}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#n(e,t,s){const r=new Path2D;return r.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),r}paintChar(e,t,s,r,i,o){const u=this.ctx,d=this.current,h=d.font,p=d.textRenderingMode,m=d.fontSize/d.fontSizeScale,x=p&fs.FILL_STROKE_MASK,v=!!(p&fs.ADD_TO_PATH_FLAG),w=d.patternFill&&!h.missingFile,E=d.patternStroke&&!h.missingFile;let N;if((h.disableFontFace||v||w||E)&&!h.missingFile&&(N=h.getPathGenerator(this.commonObjs,t)),N&&(h.disableFontFace||w||E)){u.save(),u.translate(s,r),u.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(e,u,h);let A;if(x===fs.FILL||x===fs.FILL_STROKE)if(i){A=u.getTransform(),u.setTransform(...i);const T=this.#n(N,A,i);u.fill(T)}else u.fill(N);if(x===fs.STROKE||x===fs.FILL_STROKE)if(o){A||=u.getTransform(),u.setTransform(...o);const{a:T,b:I,c:P,d:U}=A,O=we.inverseTransform(o),R=we.transform([T,I,P,U,0,0],O);we.singularValueDecompose2dScale(R,hn),u.lineWidth*=Math.max(hn[0],hn[1])/m,u.stroke(this.#n(N,A,o))}else u.lineWidth/=m,u.stroke(N);u.restore()}else(x===fs.FILL||x===fs.FILL_STROKE)&&(u.fillText(t,s,r),this.dependencyTracker?.recordCharacterBBox(e,u,h,m,s,r,()=>u.measureText(t))),(x===fs.STROKE||x===fs.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,u,h,m,s,r,()=>u.measureText(t)).recordDependencies(e,An.stroke),u.strokeText(t,s,r));v&&((this.pendingTextPaths||=[]).push({transform:kt(u),x:s,y:r,fontSize:m,path:N}),this.dependencyTracker?.recordCharacterBBox(e,u,h,m,s,r))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){s=!0;break}return $e(this,"isFontSubpixelAAEnabled",s)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,An.showText).resetBBox(e),this.current.textRenderingMode&fs.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,r=s.font;if(r.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const i=s.fontSize;if(i===0){this.dependencyTracker?.recordOperation(e);return}const o=this.ctx,u=s.fontSizeScale,d=s.charSpacing,h=s.wordSpacing,p=s.fontDirection,m=s.textHScale*p,x=t.length,v=r.vertical,w=v?1:-1,E=r.defaultVMetrics,N=i*s.fontMatrix[0],A=s.textRenderingMode===fs.FILL&&!r.disableFontFace&&!s.patternFill;o.save(),s.textMatrix&&o.transform(...s.textMatrix),o.translate(s.x,s.y+s.textRise),p>0?o.scale(m,-1):o.scale(m,1);let T,I;if(s.patternFill){o.save();const C=s.fillColor.getPattern(o,this,gr(o),ys.FILL,e);T=kt(o),o.restore(),o.fillStyle=C}if(s.patternStroke){o.save();const C=s.strokeColor.getPattern(o,this,gr(o),ys.STROKE,e);I=kt(o),o.restore(),o.strokeStyle=C}let P=s.lineWidth;const U=s.textMatrixScale;if(U===0||P===0){const C=s.textRenderingMode&fs.FILL_STROKE_MASK;(C===fs.STROKE||C===fs.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=U;if(u!==1&&(o.scale(u,u),P/=u),o.lineWidth=P,r.isInvalidPDFjsFont){const C=[];let D=0;for(const V of t)C.push(V.unicode),D+=V.width;const B=C.join("");if(o.fillText(B,0,0),this.dependencyTracker!==null){const V=o.measureText(B);this.dependencyTracker.recordBBox(e,this.ctx,-V.actualBoundingBoxLeft,V.actualBoundingBoxRight,-V.actualBoundingBoxAscent,V.actualBoundingBoxDescent).recordShowTextOperation(e)}s.x+=D*N*m,o.restore(),this.compose();return}let O=0,R;for(R=0;R<x;++R){const C=t[R];if(typeof C=="number"){O+=w*C*i/1e3;continue}let D=!1;const B=(C.isSpace?h:0)+d,V=C.fontChar,$=C.accent;let L,de,ye=C.width;if(v){const Y=C.vmetric||E,he=-(C.vmetric?Y[1]:ye*.5)*N,le=Y[2]*N;ye=Y?-Y[0]:ye,L=he/u,de=(O+le)/u}else L=O/u,de=0;let ie;if(r.remeasure&&ye>0){ie=o.measureText(V);const Y=ie.width*1e3/i*u;if(ye<Y&&this.isFontSubpixelAAEnabled){const he=ye/Y;D=!0,o.save(),o.scale(he,1),L/=he}else ye!==Y&&(L+=(ye-Y)/2e3*i/u)}if(this.contentVisible&&(C.isInFont||r.missingFile)){if(A&&!$)o.fillText(V,L,de),this.dependencyTracker?.recordCharacterBBox(e,o,ie?{bbox:null}:r,i/u,L,de,()=>ie??o.measureText(V));else if(this.paintChar(e,V,L,de,T,I),$){const Y=L+i*$.offset.x/u,he=de-i*$.offset.y/u;this.paintChar(e,$.fontChar,Y,he,T,I)}}const oe=v?ye*N-B*p:ye*N+B*p;O+=oe,D&&o.restore()}v?s.y-=O:s.x+=O*m,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const s=this.ctx,r=this.current,i=r.font,o=r.fontSize,u=r.fontDirection,d=i.vertical?1:-1,h=r.charSpacing,p=r.wordSpacing,m=r.textHScale*u,x=r.fontMatrix||c0,v=t.length,w=r.textRenderingMode===fs.INVISIBLE;let E,N,A,T;if(w||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),r.textMatrix&&s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),s.scale(m,u);const I=this.dependencyTracker;for(this.dependencyTracker=I?new Cf(I,e):null,E=0;E<v;++E){if(N=t[E],typeof N=="number"){T=d*N*o/1e3,this.ctx.translate(T,0),r.x+=T*m;continue}const P=(N.isSpace?p:0)+h,U=i.charProcOperatorList[N.operatorListId];U?this.contentVisible&&(this.save(),s.scale(o,o),s.transform(...x),this.executeOperatorList(U),this.restore()):ze(`Type3 character "${N.operatorListId}" is not available.`);const O=[N.width,0];we.applyTransform(O,x),A=O[0]*o+P,s.translate(A,0),r.x+=A*m}s.restore(),I&&(this.dependencyTracker=I)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,r,i,o,u){const d=new Path2D;d.rect(r,i,o-r,u-i),this.ctx.clip(d),this.dependencyTracker?.recordBBox(e,this.ctx,r,o,i,u).recordClipBox(e,this.ctx,r,o,i,u),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const r=this.baseTransform||kt(this.ctx),i={createCanvasGraphics:(o,u)=>new Il(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Cf(this.dependencyTracker,u,!0):null)};s=new Gy(t,this.ctx,i,r)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=BO(this.getObject(e,t)),this.cachedPatterns.set(t,r)),s&&(r.matrix=s),r}shadingFill(e,t){if(!this.contentVisible)return;const s=this.ctx;this.save(e);const r=this._getPattern(e,t);s.fillStyle=r.getPattern(s,this,gr(s),ys.SHADING,e);const i=gr(s);if(i){const{width:o,height:u}=s.canvas,d=vl.slice();we.axialAlignedBoundingBox([0,0,o,u],i,d);const[h,p,m,x]=d;this.ctx.fillRect(h,p,m-h,x-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,An.transform).recordDependencies(e,An.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){ft("Should not call beginInlineImage")}beginImageData(){ft("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=kt(this.ctx),s)){we.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,i,o,u]=s,d=new Path2D;d.rect(r,i,o-r,u-i),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(e,this.ctx,r,o,i,u),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||gp("TODO: Support non-isolated groups."),t.knockout&&ze("Knockout groups not supported.");const r=kt(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=vl.slice();we.axialAlignedBoundingBox(t.bbox,kt(s),i);const o=[0,0,s.canvas.width,s.canvas.height];i=we.intersect(i,o)||[0,0,0,0];const u=Math.floor(i[0]),d=Math.floor(i[1]),h=Math.max(Math.ceil(i[2])-u,1),p=Math.max(Math.ceil(i[3])-d,1);this.current.startNewPathAndClipBox([0,0,h,p]);let m="groupAt"+this.groupLevel;t.smask&&(m+="_smask_"+this.smaskCounter++%2);const x=this.cachedCanvases.getCanvas(m,h,p),v=x.context;v.translate(-u,-d),v.transform(...r);let w=new Path2D;const[E,N,A,T]=t.bbox;if(w.rect(E,N,A-E,T-N),t.matrix){const I=new Path2D;I.addPath(w,new DOMMatrix(t.matrix)),w=I}v.clip(w),t.smask&&this.smaskStack.push({canvas:x.canvas,context:v,offsetX:u,offsetY:d,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,d),s.save()),Qc(s,v),this.ctx=v,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const i=kt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...i);const o=vl.slice();we.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],i,o),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,s,r,i,o){if(this.#e(),Bh(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],d=s[3]-s[1];if(o&&this.annotationCanvasMap){r=r.slice(),r[4]-=s[0],r[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=d,we.singularValueDecompose2dScale(kt(this.ctx),hn);const{viewportScale:h}=this,p=Math.ceil(u*this.outputScaleX*h),m=Math.ceil(d*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(p,m);const{canvas:x,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(t,x),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(hn[0],0,0,-hn[1],0,d*hn[1]),Bh(this.ctx)}else{Bh(this.ctx),this.endPath(e);const h=new Path2D;h.rect(s[0],s[1],u,d),this.ctx.clip(h)}}this.current=new T_(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...r),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const r=this.ctx,i=this._createMaskCanvas(e,t),o=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,i.offsetX,i.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,i.offsetX,i.offsetX+o.width,i.offsetY,i.offsetY+o.height).recordOperation(e),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,r=0,i=0,o,u){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const d=this.ctx;d.save();const h=kt(d);d.transform(s,r,i,o,0,0);const p=this._createMaskCanvas(e,t);d.setTransform(1,0,0,1,p.offsetX-h[4],p.offsetY-h[5]),this.dependencyTracker?.resetBBox(e);for(let m=0,x=u.length;m<x;m+=2){const v=we.transform(h,[s,r,i,o,u[m],u[m+1]]);d.drawImage(p.canvas,v[4],v[5]),this.dependencyTracker?.recordBBox(e,this.ctx,v[4],v[4]+p.canvas.width,v[5],v[5]+p.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,i=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,An.transformAndFill);for(const o of t){const{data:u,width:d,height:h,transform:p}=o,m=this.cachedCanvases.getCanvas("maskCanvas",d,h),x=m.context;x.save();const v=this.getObject(e,u,o);I_(x,v),x.globalCompositeOperation="source-in",x.fillStyle=i?r.getPattern(x,this,gr(s),ys.FILL,e):r,x.fillRect(0,0,d,h),x.restore(),s.save(),s.transform(...p),s.scale(1,-1),Uh(s,m.canvas,0,0,d,h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,s,0,d,0,h),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){ze("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,r,i){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){ze("Dependent image isn't ready yet");return}const u=o.width,d=o.height,h=[];for(let p=0,m=i.length;p<m;p+=2)h.push({transform:[s,0,0,r,i[p],i[p+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(e,o,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:r}=e,i=this.cachedCanvases.getCanvas("inlineImage",s,r),o=i.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",i.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const s=t.width,r=t.height,i=this.ctx;this.save(e);const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none"),i.scale(1/s,-1/r);let u;if(t.bitmap)u=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)u=t;else{const p=this.cachedCanvases.getCanvas("inlineImage",s,r).context;C_(p,t),u=this.applyTransferMapsToCanvas(p)}const d=this._scaleImage(u,gr(i));i.imageSmoothingEnabled=P_(kt(i),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,i,0,s,-r,0).recordDependencies(e,An.imageXObject).recordOperation(e),Uh(i,d.img,0,0,d.paintWidth,d.paintHeight,0,-r,s,r),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){if(!this.contentVisible)return;const r=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const o=t.width,u=t.height,h=this.cachedCanvases.getCanvas("inlineImage",o,u).context;C_(h,t),i=this.applyTransferMapsToCanvas(h)}this.dependencyTracker?.resetBBox(e);for(const o of s)r.save(),r.transform(...o.transform),r.scale(1,-1),Uh(r,i,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,An.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const i=this.ctx;this.pendingClip?(r||(this.pendingClip===j_?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=kt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:r,d:i}=this.ctx.getTransform();let o,u;if(s===0&&r===0){const d=Math.abs(t),h=Math.abs(i);if(d===h)if(e===0)o=u=1/d;else{const p=d*e;o=u=p<1?1/p:1}else if(e===0)o=1/d,u=1/h;else{const p=d*e,m=h*e;o=p<1?1/p:1,u=m<1?1/m:1}}else{const d=Math.abs(t*i-s*r),h=Math.hypot(t,s),p=Math.hypot(r,i);if(e===0)o=p/d,u=h/d;else{const m=e*d;o=p>m?p/m:1,u=h>m?h/m:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:r}}=this,[i,o]=this.getScaleForStroking();if(i===o){s.lineWidth=(r||1)*i,s.stroke(e);return}const u=s.getLineDash();t&&s.save(),s.scale(i,o),bg.a=1/i,bg.d=1/o;const d=new Path2D;if(d.addPath(e,bg),u.length>0){const h=Math.max(i,o);s.setLineDash(u.map(p=>p/h)),s.lineDashOffset/=h}s.lineWidth=r||1,s.stroke(d),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const n in Ru)Il.prototype[n]!==void 0&&(Il.prototype[Ru[n]]=Il.prototype[n]);class Pl{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class YO{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const gl=Symbol("INTERNAL");class XO{#e=!1;#t=!1;#n=!1;#s=!0;constructor(e,{name:t,intent:s,usage:r,rbGroups:i}){this.#e=!!(e&dn.DISPLAY),this.#t=!!(e&dn.PRINT),this.name=t,this.intent=s,this.usage=r,this.rbGroups=i}get visible(){if(this.#n)return this.#s;if(!this.#s)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,s=!1){e!==gl&&ft("Internal method `_setVisible` called."),this.#n=s,this.#s=t}}class QO{#e=null;#t=new Map;#n=null;#s=null;constructor(e,t=dn.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#s=e.order;for(const s of e.groups)this.#t.set(s.id,new XO(t,s));if(e.baseState==="OFF")for(const s of this.#t.values())s._setVisible(gl,!1);for(const s of e.on)this.#t.get(s)._setVisible(gl,!0);for(const s of e.off)this.#t.get(s)._setVisible(gl,!1);this.#n=this.getHash()}}#a(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let r=1;r<t;r++){const i=e[r];let o;if(Array.isArray(i))o=this.#a(i);else if(this.#t.has(i))o=this.#t.get(i).visible;else return ze(`Optional content group not found: ${i}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return gp("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(ze(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#a(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return ze(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return ze(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return ze(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return ze(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return ze(`Unknown optional content policy ${e.policy}.`),!0}return ze(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){const r=this.#t.get(e);if(!r){ze(`Optional content group not found: ${e}`);return}if(s&&t&&r.rbGroups.length)for(const i of r.rbGroups)for(const o of i)o!==e&&this.#t.get(o)?._setVisible(gl,!1,!0);r._setVisible(gl,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let s;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const i=this.#t.get(r);if(i)switch(s){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!i.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#s?this.#s.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new PN;for(const[t,s]of this.#t)e.update(`${t}:${s.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class JO{constructor(e,{disableRange:t=!1,disableStream:s=!1}){et(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:i,progressiveDone:o,contentDispositionFilename:u}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=u,i?.length>0){const d=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((d,h)=>{this._onReceiveData({begin:d,chunk:h})}),e.addProgressListener((d,h)=>{this._onProgress({loaded:d,total:h})}),e.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(s),!0)});et(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){et(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new ZO(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new e5(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class ZO{constructor(e,t,s=!1,r=null){this._stream=e,this._done=s||!1,this._filename=By(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class e5{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function t5(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let p=u(t);return p=unescape(p),p=d(p),p=h(p),i(p)}if(t=o(n),t){const p=h(t);return i(p)}if(t=s("filename","i").exec(n),t){t=t[1];let p=u(t);return p=h(p),i(p)}function s(p,m){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function r(p,m){if(p){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const x=new TextDecoder(p,{fatal:!0}),v=td(m);m=x.decode(v),e=!1}catch{}}return m}function i(p){return e&&/[\x80-\xff]/.test(p)&&(p=r("utf-8",p),e&&(p=r("iso-8859-1",p))),p}function o(p){const m=[];let x;const v=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(x=v.exec(p))!==null;){let[,E,N,A]=x;if(E=parseInt(E,10),E in m){if(E===0)break;continue}m[E]=[N,A]}const w=[];for(let E=0;E<m.length&&E in m;++E){let[N,A]=m[E];A=u(A),N&&(A=unescape(A),E===0&&(A=d(A))),w.push(A)}return w.join("")}function u(p){if(p.startsWith('"')){const m=p.slice(1).split('\\"');for(let x=0;x<m.length;++x){const v=m[x].indexOf('"');v!==-1&&(m[x]=m[x].slice(0,v),m.length=x+1),m[x]=m[x].replaceAll(/\\(.)/g,"$1")}p=m.join('"')}return p}function d(p){const m=p.indexOf("'");if(m===-1)return p;const x=p.slice(0,m),w=p.slice(m+1).replace(/^[^']*'/,"");return r(x,w)}function h(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,x,v,w){if(v==="q"||v==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,N){return String.fromCharCode(parseInt(N,16))}),r(x,w);try{w=atob(w)}catch{}return r(x,w)})}return""}function FN(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const r=e[s];r!==void 0&&t.append(s,r)}return t}function bp(n){return URL.parse(n)?.origin??null}function VN({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(n.get("Content-Length"),10);return!Number.isInteger(i)||(r.suggestedLength=i,i<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function UN(n){const e=n.get("Content-Disposition");if(e){let t=t5(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(By(t))return t}return null}function ad(n,e){return new Tf(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function BN(n){return n===200||n===206}function zN(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function $N(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ze(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class s5{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=FN(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return et(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new n5(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new r5(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class n5{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),r=t.url;fetch(r,zN(s,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=bp(i.url),!BN(i.status))throw ad(i.status,r);this._reader=i.body.getReader(),this._headersCapability.resolve();const o=i.headers,{allowRangeRequests:u,suggestedLength:d}=VN({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=d||this._contentLength,this._filename=UN(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new ya("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:$N(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class r5{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${s-1}`);const o=r.url;fetch(o,zN(i,this._withCredentials,this._abortController)).then(u=>{const d=bp(u.url);if(d!==e._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${e._responseOrigin}".`);if(!BN(u.status))throw ad(u.status,o);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:$N(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const vg=200,wg=206;function i5(n){const e=n.response;return typeof e!="string"?e:td(e).buffer}class a5{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:s}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=FN(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,o]of this.headers)t.setRequestHeader(i,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=wg):r.expectedStatus=vg,t.responseType="arraybuffer",et(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){const s=this.pendingRequests[e];s&&s.onProgress?.(t)}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){s.onError(r.status);return}const i=r.status||vg;if(!(i===vg&&s.expectedStatus===wg)&&i!==s.expectedStatus){s.onError(r.status);return}const u=i5(r);if(i===wg){const d=r.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);h?s.onDone({begin:parseInt(h[1],10),chunk:u}):(ze('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class o5{constructor(e){this._source=e,this._manager=new a5(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return et(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new l5(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new c5(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class l5{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=bp(t.responseURL);const s=t.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[d,...h]=u.split(": ");return[d,h.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:o}=VN({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=UN(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=ad(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class c5{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=bp(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=ad(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const u5=/^[a-z][a-z0-9\-+.]+:/i;function d5(n){if(u5.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class h5{constructor(e){this.source=e,this.url=d5(e.url),et(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return et(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new f5(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new p5(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class f5{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=ad(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new ya("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class p5{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Jc=Symbol("INITIAL_DATA");class HN{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Jc}}get(e,t=null){if(t){const r=this.#t(e);return r.promise.then(()=>t(r.data)),null}const s=this.#e[e];if(!s||s.data===Jc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=this.#e[e];return!!t&&t.data!==Jc}delete(e){const t=this.#e[e];return!t||t.data===Jc?!1:(delete this.#e[e],!0)}resolve(e,t=null){const s=this.#t(e);s.data=t,s.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Jc&&(yield[e,t])}}}const m5=1e5,R_=30;class Ms{#e=Promise.withResolvers();#t=null;#n=!1;#s=!!globalThis.FontInspector?.enabled;#a=null;#i=null;#r=0;#o=0;#c=null;#l=null;#h=0;#d=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#b=new Map;static#x=new Map;static#N=new WeakMap;static#k=null;static#w=new Set;constructor({textContentSource:e,container:t,viewport:s}){if(e instanceof ReadableStream)this.#m=e;else if(typeof e=="object")this.#m=new ReadableStream({start(d){d.enqueue(e),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#d=s.scale*Cr.pixelRatio,this.#h=s.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:i,pageX:o,pageY:u}=s.rawDims;this.#y=[1,0,0,-1,-o,u+i],this.#o=r,this.#r=i,Ms.#C(),ho(t,s),this.#e.promise.finally(()=>{Ms.#w.delete(this),this.#i=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=bs.platform;return $e(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:s})=>{if(s){this.#e.resolve();return}this.#a??=t.lang,Object.assign(this.#f,t.styles),this.#S(t.items),e()},this.#e.reject)};return this.#c=this.#m.getReader(),Ms.#w.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const s=e.scale*Cr.pixelRatio,r=e.rotation;if(r!==this.#h&&(t?.(),this.#h=r,ho(this.#l,{rotation:r})),s!==this.#d){t?.(),this.#d=s;const i={div:null,properties:null,ctx:Ms.#I(this.#a)};for(const o of this.#u)i.properties=this.#p.get(o),i.div=o,this.#E(i)}}cancel(){const e=new ya("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#S(e){if(this.#n)return;this.#i.ctx??=Ms.#I(this.#a);const t=this.#u,s=this.#g;for(const r of e){if(t.length>m5){ze("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const i=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),r.id&&this.#t.setAttribute("id",`${r.id}`),i.append(this.#t)}else r.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}s.push(r.str),this.#v(r)}}#v(e){const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#u.push(t);const r=we.transform(this.#y,e.transform);let i=Math.atan2(r[1],r[0]);const o=this.#f[e.fontName];o.vertical&&(i+=Math.PI/2);let u=this.#s&&o.fontSubstitution||o.fontFamily;u=Ms.fontFamilyMap.get(u)||u;const d=Math.hypot(r[2],r[3]),h=d*Ms.#O(u,o,this.#a);let p,m;i===0?(p=r[4],m=r[5]-h):(p=r[4]+h*Math.sin(i),m=r[5]-h*Math.cos(i));const x="calc(var(--total-scale-factor) *",v=t.style;this.#t===this.#l?(v.left=`${(100*p/this.#o).toFixed(2)}%`,v.top=`${(100*m/this.#r).toFixed(2)}%`):(v.left=`${x}${p.toFixed(2)}px)`,v.top=`${x}${m.toFixed(2)}px)`),v.fontSize=`${x}${(Ms.#k*d).toFixed(2)}px)`,v.fontFamily=u,s.fontSize=d,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#s&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),i!==0&&(s.angle=i*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const E=Math.abs(e.transform[0]),N=Math.abs(e.transform[3]);E!==N&&Math.max(E,N)/Math.min(E,N)>1.5&&(w=!0)}if(w&&(s.canvasWidth=o.vertical?e.height:e.width),this.#p.set(t,s),this.#i.div=t,this.#i.properties=s,this.#E(this.#i),s.hasText&&this.#t.append(t),s.hasEOL){const E=document.createElement("br");E.setAttribute("role","presentation"),this.#t.append(E)}}#E(e){const{div:t,properties:s,ctx:r}=e,{style:i}=t;let o="";if(Ms.#k>1&&(o=`scale(${1/Ms.#k})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=i,{canvasWidth:d,fontSize:h}=s;Ms.#T(r,h*this.#d,u);const{width:p}=r.measureText(t.textContent);p>0&&(o=`scaleX(${d*this.#d/p}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(i.transform=o)}static cleanup(){if(!(this.#w.size>0)){this.#b.clear();for(const{canvas:e}of this.#x.values())e.remove();this.#x.clear()}}static#I(e=null){let t=this.#x.get(e||="");if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#x.set(e,t),this.#N.set(t,{size:0,family:""})}return t}static#T(e,t,s){const r=this.#N.get(e);t===r.size&&s===r.family||(e.font=`${t}px ${s}`,r.size=t,r.family=s)}static#C(){if(this.#k!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#k=e.getBoundingClientRect().height,e.remove()}static#O(e,t,s){const r=this.#b.get(e);if(r)return r;const i=this.#I(s);i.canvas.width=i.canvas.height=R_,this.#T(i,R_,e);const o=i.measureText(""),u=o.fontBoundingBoxAscent,d=Math.abs(o.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let h=.8;return u?h=u/(u+d):(bs.platform.isFirefox&&ze("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?h=t.ascent:t.descent&&(h=1+t.descent)),this.#b.set(e,h),h}}const g5=100;function qN(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Ky,{docId:t}=e,s=n.url?kO(n.url):null,r=n.data?EO(n.data):null,i=n.httpHeaders||null,o=n.withCredentials===!0,u=n.password??null,d=n.range instanceof WN?n.range:null,h=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let p=n.worker instanceof ms?n.worker:null;const m=n.verbosity,x=typeof n.docBaseUrl=="string"&&!yp(n.docBaseUrl)?n.docBaseUrl:null,v=Lh(n.cMapUrl),w=n.cMapPacked!==!1,E=n.CMapReaderFactory||(Ls?jO:b_),N=Lh(n.iccUrl),A=Lh(n.standardFontDataUrl),T=n.StandardFontDataFactory||(Ls?RO:v_),I=Lh(n.wasmUrl),P=n.WasmFactory||(Ls?DO:w_),U=n.stopAtErrors!==!0,O=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,R=n.isEvalSupported!==!1,C=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Ls,D=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Ls&&(bs.platform.isFirefox||!globalThis.chrome),B=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,V=typeof n.disableFontFace=="boolean"?n.disableFontFace:Ls,$=n.fontExtraProperties===!0,L=n.enableXfa===!0,de=n.ownerDocument||globalThis.document,ye=n.disableRange===!0,ie=n.disableStream===!0,oe=n.disableAutoFetch===!0,Y=n.pdfBug===!0,he=n.CanvasFactory||(Ls?PO:TO),le=n.FilterFactory||(Ls?IO:CO),W=n.enableHWA===!0,Z=n.useWasm!==!1,ce=d?d.length:n.length??NaN,xe=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Ls&&!V,je=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(E===b_&&T===v_&&P===w_&&v&&A&&I&&lu(v,document.baseURI)&&lu(A,document.baseURI)&&lu(I,document.baseURI)),Re=null;Q6(m);const fe={canvasFactory:new he({ownerDocument:de,enableHWA:W}),filterFactory:new le({docId:t,ownerDocument:de}),cMapReaderFactory:je?null:new E({baseUrl:v,isCompressed:w}),standardFontDataFactory:je?null:new T({baseUrl:A}),wasmFactory:je?null:new P({baseUrl:I})};p||(p=ms.create({verbosity:m,port:Pl.workerPort}),e._worker=p);const Ue={docId:t,apiVersion:"5.4.449",data:r,password:u,disableAutoFetch:oe,rangeChunkSize:h,length:ce,docBaseUrl:x,enableXfa:L,evaluatorOptions:{maxImageSize:O,disableFontFace:V,ignoreErrors:U,isEvalSupported:R,isOffscreenCanvasSupported:C,isImageDecoderSupported:D,canvasMaxAreaInBytes:B,fontExtraProperties:$,useSystemFonts:xe,useWasm:Z,useWorkerFetch:je,cMapUrl:v,iccUrl:N,standardFontDataUrl:A,wasmUrl:I}},Se={ownerDocument:de,pdfBug:Y,styleElement:Re,loadingParams:{disableAutoFetch:oe,enableXfa:L}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const We=p.messageHandler.sendWithPromise("GetDocRequest",Ue,r?[r.buffer]:null);let st;if(d)st=new JO(d,{disableRange:ye,disableStream:ie});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Tt=lu(s)?s5:Ls?h5:o5;st=new Tt({url:s,length:ce,httpHeaders:i,withCredentials:o,rangeChunkSize:h,disableRange:ye,disableStream:ie})}return We.then(Tt=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const en=new cu(t,Tt,p.port),mi=new b5(en,e,st,Se,fe,W);e._transport=mi,en.send("Ready",null)})}).catch(e._capability.reject),e}class Ky{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Ky.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class WN{#e=Promise.withResolvers();#t=[];#n=[];#s=[];#a=[];constructor(e,t,s=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(e){this.#a.push(e)}addProgressListener(e){this.#s.push(e)}addProgressiveReadListener(e){this.#n.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const s of this.#a)s(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const s of this.#s)s(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#n)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){ft("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class y5{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return $e(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class x5{#e=!1;constructor(e,t,s,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=r?new h_:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new HN,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:i=!1}={}){return new nd({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:r,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return $e(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:r="display",annotationMode:i=Ji.ENABLE,transform:o=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:h=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:x=!1,recordOperations:v=!1,operationsFilter:w=null}){this._stats?.time("Overall");const E=this._transport.getRenderingIntent(r,i,m,x),{renderingIntent:N,cacheKey:A}=E;this.#e=!1,d||=this._transport.getOptionalContentConfig(N);let T=this._intentStates.get(A);T||(T=Object.create(null),this._intentStates.set(A,T)),T.streamReaderCancelTimeout&&(clearTimeout(T.streamReaderCancelTimeout),T.streamReaderCancelTimeout=null);const I=!!(N&dn.PRINT);T.displayReadyCapability||(T.displayReadyCapability=Promise.withResolvers(),T.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(E));const P=!!(this._pdfBug&&globalThis.StepperManager?.enabled),U=!this.recordedBBoxes&&(v||P),O=D=>{if(T.renderTasks.delete(R),U){const B=R.gfx?.dependencyTracker.take();B&&(R.stepper&&R.stepper.setOperatorBBoxes(B,R.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=B))}I&&(this.#e=!0),this.#t(),D?(R.capability.reject(D),this._abortOperatorList({intentState:T,reason:D instanceof Error?D:new Error(D)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new wl({callback:O,params:{canvas:t,canvasContext:e,dependencyTracker:U?new LO(t,T.operatorList.length,P):null,viewport:s,transform:o,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:T.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!I,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:w});(T.renderTasks||=new Set).add(R);const C=R.task;return Promise.all([T.displayReadyCapability.promise,d]).then(([D,B])=>{if(this.destroyed){O();return}if(this._stats?.time("Rendering"),!(B.renderingIntent&N))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:D,optionalContentConfig:B}),R.operatorListChanged()}).catch(O),C}getOperatorList({intent:e="display",annotationMode:t=Ji.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){function i(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const o=this._transport.getRenderingIntent(e,t,s,r,!0);let u=this._intentStates.get(o.cacheKey);u||(u=Object.create(null),this._intentStates.set(o.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=i,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Du.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,r){function i(){o.read().then(function({value:d,done:h}){if(h){s(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),i()},r)}const o=t.getReader(),u={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new h_),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const s=this._intentStates.get(t);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let s=0,r=e.length;s<r;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:r}){const{map:i,transfer:o}=s,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:r},o).getReader(),h=this._intentStates.get(t);h.streamReader=d;const p=()=>{d.read().then(({value:m,done:x})=>{if(x){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,h),p())},m=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const x of h.renderTasks)x.operatorListChanged();this.#t()}if(h.displayReadyCapability)h.displayReadyCapability.reject(m);else if(h.opListReadCapability)h.opListReadCapability.reject(m);else throw m}})};p()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof Uy){let r=g5;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new ya(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,i]of this._intentStates)if(i===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}class ms{#e=Promise.withResolvers();#t=null;#n=null;#s=null;static#a=0;static#i=!1;static#r=new WeakMap;static{Ls&&(this.#i=!0,Pl.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!s?.origin||s.origin==="null")return!1;const r=new URL(t,s);return s.origin===r.origin},this._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},this.fromPort=e=>{if(uO("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.create(e)}}constructor({name:e=null,port:t=null,verbosity:s=J6()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(ms.#r.has(t))throw new Error("Cannot use more than one PDFWorker per port.");ms.#r.set(t,this),this.#c(t)}else this.#l()}get promise(){return this.#e.promise}#o(){this.#e.resolve(),this.#t.send("configure",{verbosity:this.verbosity})}get port(){return this.#n}get messageHandler(){return this.#t}#c(e){this.#n=e,this.#t=new cu("main","worker",e),this.#t.on("ready",()=>{}),this.#o()}#l(){if(ms.#i||ms.#d){this.#h();return}let{workerSrc:e}=ms;try{ms._isSameOrigin(window.location,e)||(e=ms._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new cu("main","worker",t),r=()=>{i.abort(),s.destroy(),t.terminate(),this.destroyed?this.#e.reject(new Error("Worker was destroyed")):this.#h()},i=new AbortController;t.addEventListener("error",()=>{this.#s||r()},{signal:i.signal}),s.on("test",u=>{if(i.abort(),this.destroyed||!u){r();return}this.#t=s,this.#n=t,this.#s=t,this.#o()}),s.on("ready",u=>{if(i.abort(),this.destroyed){r();return}try{o()}catch{this.#h()}});const o=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};o();return}catch{gp("The worker has been disabled.")}this.#h()}#h(){ms.#i||(ze("Setting up fake worker."),ms.#i=!0),ms._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this.#e.reject(new Error("Worker was destroyed"));return}const t=new SO;this.#n=t;const s=`fake${ms.#a++}`,r=new cu(s+"_worker",s,t);e.setup(r,t),this.#t=new cu(s,s+"_worker",t),this.#o()}).catch(e=>{this.#e.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this.#s?.terminate(),this.#s=null,ms.#r.delete(this.#n),this.#n=null,this.#t?.destroy(),this.#t=null}static create(e){const t=this.#r.get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new ms(e)}static get workerSrc(){if(Pl.workerSrc)return Pl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#d(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return $e(this,"_setupFakeWorkerGlobal",(async()=>this.#d?this.#d:(await import(this.workerSrc)).WorkerMessageHandler)())}}class b5{#e=new Map;#t=new Map;#n=new Map;#s=new Map;#a=null;constructor(e,t,s,r,i,o){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new HN,this.fontLoader=new wO({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#i(e,t=null){const s=this.#e.get(e);if(s)return s;const r=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,r),r}get annotationStorage(){return $e(this,"annotationStorage",new Hy)}getRenderingIntent(e,t=Ji.ENABLE,s=null,r=!1,i=!1){let o=dn.DISPLAY,u=m0;switch(e){case"any":o=dn.ANY;break;case"display":break;case"print":o=dn.PRINT;break;default:ze(`getRenderingIntent - invalid intent: ${e}`)}const d=o&dn.PRINT&&s instanceof jN?s:this.annotationStorage;switch(t){case Ji.DISABLE:o+=dn.ANNOTATIONS_DISABLE;break;case Ji.ENABLE:break;case Ji.ENABLE_FORMS:o+=dn.ANNOTATIONS_FORMS;break;case Ji.ENABLE_STORAGE:o+=dn.ANNOTATIONS_STORAGE,u=d.serializable;break;default:ze(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(o+=dn.IS_EDITING),i&&(o+=dn.OPLIST);const{ids:h,hash:p}=d.modifiedIds,m=[o,u.hash,p];return{renderingIntent:o,cacheKey:m.join("_"),annotationStorageSerializable:u,modifiedIds:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of this.#t.values())e.push(s._destroy());this.#t.clear(),this.#n.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ms.cleanup(),this._networkStream?.cancelAllRequests(new ya("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,r)=>{et(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},r.onPull=()=>{this._fullReader.read().then(function({value:i,done:o}){if(o){r.close();return}et(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{r.error(i)})},r.onCancel=i=>{this._fullReader.cancel(i),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:i,contentLength:o}=this._fullReader;return(!r||!i)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{t.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:i,contentLength:o}}),e.on("GetRangeReader",(s,r)=>{et(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(s.begin,s.end);if(!i){r.close();return}r.onPull=()=>{i.read().then(function({value:o,done:u}){if(u){r.close();return}et(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{i.cancel(o),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new y5(s,this))}),e.on("DocException",s=>{t._capability.reject(Gs(s))}),e.on("PasswordRequest",s=>{this.#a=Promise.withResolvers();try{if(!t.onPassword)throw Gs(s);const r=i=>{i instanceof Error?this.#a.reject(i):this.#a.resolve({password:i})};t.onPassword(r,s.code)}catch(r){this.#a.reject(r)}return this.#a.promise}),e.on("DataLoaded",s=>{t.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;this.#t.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,r,i])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in i){const m=i.error;ze(`Error during font loading: ${m}`),this.commonObjs.resolve(s,m);break}const o=new ut(i),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(m,x)=>globalThis.FontInspector.fontAdded(m,x):null,d=new _O(o,u,i.extra,i.charProcOperatorList);this.fontLoader.bind(d).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:h}=i;et(h,"The imageRef must be defined.");for(const m of this.#t.values())for(const[,x]of m.objs)if(x?.ref===h)return x.dataLen?(this.commonObjs.resolve(s,structuredClone(x)),x.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(s,i);break;case"Pattern":const p=new as(i);this.commonObjs.resolve(s,p.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([s,r,i,o])=>{if(this.destroyed)return;const u=this.#t.get(r);if(!u.objs.has(s)){if(u._intentStates.size===0){o?.bitmap?.close();return}switch(i){case"Image":case"Pattern":u.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",s=>{this.destroyed||t.onProgress?.({loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ze("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=this.#n.get(t);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&this.#s.set(i.refStr,e);const o=new x5(t,i,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#n.set(t,r),r}getPageIndex(e){return g0(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#i("GetOptionalContentConfig").then(t=>new QO(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(r=>({info:r[0],metadata:r[1]?new YO(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:r[2]}));return this.#e.set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ms.cleanup()}}cachedPageNumber(e){if(!g0(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#s.get(t)??null}}class v5{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class wl{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:s,commonObjs:r,annotationCanvasMap:i,operatorList:o,pageIndex:u,canvasFactory:d,filterFactory:h,useRequestAnimationFrame:p=!1,pdfBug:m=!1,pageColors:x=null,enableHWA:v=!1,operationsFilter:w=null}){this.callback=e,this.params=t,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=h,this._pdfBug=m,this.pageColors=x,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new v5(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=v,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(wl.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");wl.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:r,background:i,dependencyTracker:o}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Il(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),wl.#t.delete(this._canvas),e||=new Uy(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),wl.#t.delete(this._canvas),this.callback())))}}const GN="5.4.449",w5="f44e5f0e6";class Sn{#e=null;#t=null;#n;#s=null;#a=!1;#i=!1;#r=null;#o;#c=null;#l=null;static#h=null;static get _keyboardManager(){return $e(this,"_keyboardManager",new id([[["Escape","mac+Escape"],Sn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Sn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Sn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Sn.prototype._moveToPrevious],[["Home","mac+Home"],Sn.prototype._moveToBeginning],[["End","mac+End"],Sn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#i=!1,this.#r=e):this.#i=!0,this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#n=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Sn.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#r&&(e.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#m.bind(this),{signal:t}),e.addEventListener("keydown",this.#g.bind(this),{signal:t});const s=this.#t=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,e.append(s),e}renderMainDropdown(){const e=this.#s=this.#d();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#d(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",Pn,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(e.id=`${this.#r.id}_colorpicker_dropdown`);for(const[s,r]of this.#l.highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",r),i.title=s,i.setAttribute("data-l10n-id",Sn.#h[s]);const o=document.createElement("span");i.append(o),o.className="swatch",o.style.backgroundColor=r,i.ariaSelected=r===this.#n,i.addEventListener("click",this.#f.bind(this,r),{signal:t}),e.append(i)}return e.addEventListener("keydown",this.#g.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Ze.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#m(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#p){this.#m(e);return}if(e.target===this.#e){this.#s.firstElementChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#s?.firstElementChild||e.target===this.#e){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#p){this.#m(e);return}this.#s.firstElementChild?.focus()}_moveToEnd(e){if(!this.#p){this.#m(e);return}this.#s.lastElementChild?.focus()}#g(e){Sn._keyboardManager.exec(this,e)}#m(e){if(this.#p){this.hideDropdown();return}if(this.#a=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#s){this.#s.classList.remove("hidden");return}const t=this.#s=this.#d();this.#e.append(t)}#u(e){this.#s?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#s?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#s&&!this.#s.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#p){this.#r?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#s)return;const t=this.#l.highlightColors.values();for(const s of this.#s.children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#s?.remove(),this.#s=null}}class Mu{#e=null;#t=null;#n=null;static#s=null;constructor(e){this.#t=e,this.#n=e._uiManager,Mu.#s||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,color:s}=this.#t,r=this.#e=document.createElement("input");return r.type="color",r.value=s||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",Mu.#s[e]),r.addEventListener("input",()=>{this.#n.updateParams(t,r.value)},{signal:this.#n._signal}),r}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function D_(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Zc(n){return Math.max(0,Math.min(255,255*n))}class M_{static CMYK_G([e,t,s,r]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Zc(e),[e,e,e]}static G_HTML([e]){const t=D_(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Zc)}static RGB_HTML(e){return`#${e.map(D_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,s+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,s,r]){return[Zc(1-Math.min(1,e+r)),Zc(1-Math.min(1,s+r)),Zc(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const r=1-e,i=1-t,o=1-s,u=Math.min(r,i,o);return["CMYK",r,i,o,u]}}class _5{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){ft("Abstract method `_createSVG` called.")}}class If extends _5{_createSVG(e){return document.createElementNS(Xr,e)}}const k5=9,fo=new WeakSet,E5=new Date().getTimezoneOffset()*60*1e3;class _g{static create(e){switch(e.data.annotationType){case Kt.LINK:return new Yy(e);case Kt.TEXT:return new A5(e);case Kt.WIDGET:switch(e.data.fieldType){case"Tx":return new S5(e);case"Btn":return e.data.radioButton?new KN(e):e.data.checkBox?new C5(e):new I5(e);case"Ch":return new P5(e);case"Sig":return new T5(e)}return new _o(e);case Kt.POPUP:return new b0(e);case Kt.FREETEXT:return new YN(e);case Kt.LINE:return new R5(e);case Kt.SQUARE:return new D5(e);case Kt.CIRCLE:return new M5(e);case Kt.POLYLINE:return new XN(e);case Kt.CARET:return new O5(e);case Kt.INK:return new Xy(e);case Kt.POLYGON:return new L5(e);case Kt.HIGHLIGHT:return new QN(e);case Kt.UNDERLINE:return new F5(e);case Kt.SQUIGGLY:return new V5(e);case Kt.STRIKEOUT:return new U5(e);case Kt.STAMP:return new JN(e);case Kt.FILEATTACHMENT:return new B5(e);default:return new At(e)}}}class At{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return At._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:s,rect:r}=this.data;let i=-1/0,o=-1/0;if(t?.length>=8){for(let u=0;u<t.length;u+=8)t[u+1]>o?(o=t[u+1],i=t[u+2]):t[u+1]===o&&(i=Math.max(i,t[u+2]));return[i,o]}if(s?.length>=1){for(const u of s)for(let d=0,h=u.length;d<h;d+=2)u[d+1]>o?(o=u[d+1],i=u[d]):u[d+1]===o&&(i=Math.max(i,u[d]));if(i!==1/0)return[i,o]}return r?[r[2],r[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:i,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/s,e[1]=100*(e[1]-o)/r,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${ju}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,s={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:s})||this.annotationStorage.setValue(`${ju}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:s}=e;t&&this.#s(t);let r=this.#n?.popup||this.popup;!r&&s?.text&&(this._createPopup(s),r=this.#n.popup),r&&(r.updateEdited(e),s?.deleted&&(r.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#e&&(this.#s(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#s(e){const{container:{style:t},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:o,pageX:u,pageY:d}}}}=this;s?.splice(0,4,...e),t.left=`${100*(e[0]-u)/i}%`,t.top=`${100*(o-e[3]+d)/o}%`,r===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(r)}_createContainer(e){const{data:t,parent:{page:s,viewport:r}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),!(this instanceof _o)&&!(this instanceof Yy)&&(i.tabIndex=0);const{style:o}=i;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof b0){const{rotation:E}=t;return!t.hasOwnCanvas&&E!==0&&this.setRotation(E,i),i}const{width:u,height:d}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const E=t.borderStyle.horizontalCornerRadius,N=t.borderStyle.verticalCornerRadius;if(E>0||N>0){const T=`calc(${E}px * var(--total-scale-factor)) / calc(${N}px * var(--total-scale-factor))`;o.borderRadius=T}else if(this instanceof KN){const T=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;o.borderRadius=T}switch(t.borderStyle.style){case ml.SOLID:o.borderStyle="solid";break;case ml.DASHED:o.borderStyle="dashed";break;case ml.BEVELED:ze("Unimplemented border style: beveled");break;case ml.INSET:ze("Unimplemented border style: inset");break;case ml.UNDERLINE:o.borderBottomStyle="solid";break}const A=t.borderColor||null;A?(this.#t=!0,o.borderColor=we.makeHexColor(A[0]|0,A[1]|0,A[2]|0)):o.borderWidth=0}const h=we.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:p,pageHeight:m,pageX:x,pageY:v}=r.rawDims;o.left=`${100*(h[0]-x)/p}%`,o.top=`${100*(h[1]-v)/m}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(o.width=`${100*u/p}%`,o.height=`${100*d/m}%`):this.setRotation(w,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:i,height:o}=this;e%180!==0&&([i,o]=[o,i]),t.style.width=`${100*i/s}%`,t.style.height=`${100*o/r}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,r)=>{const i=r.detail[t],o=i[0],u=i.slice(1);r.target.style[s]=M_[`${o}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:M_[`${o}_rgb`](u)})};return $e(this,"_commonActions",{display:t=>{const{display:s}=t.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const r of Object.keys(t.detail))(e[r]||s[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[r,i]of Object.entries(t)){const o=s[r];if(o){const u={detail:{[r]:i},target:e};o(u),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,r,i]=this.data.rect.map(E=>Math.fround(E));if(e.length===8){const[E,N,A,T]=e.subarray(2,6);if(r===E&&i===N&&t===A&&s===T)return}const{style:o}=this.container;let u;if(this.#t){const{borderColor:E,borderWidth:N}=o;o.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${E}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const d=r-t,h=i-s,{svgFactory:p}=this,m=p.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const x=p.createElement("defs");m.append(x);const v=p.createElement("clipPath"),w=`clippath_${this.data.id}`;v.setAttribute("id",w),v.setAttribute("clipPathUnits","objectBoundingBox"),x.append(v);for(let E=2,N=e.length;E<N;E+=8){const A=e[E],T=e[E+1],I=e[E+2],P=e[E+3],U=p.createElement("rect"),O=(I-t)/d,R=(i-T)/h,C=(A-I)/d,D=(T-P)/h;U.setAttribute("x",O),U.setAttribute("y",R),U.setAttribute("width",C),U.setAttribute("height",D),v.append(U),u?.push(`<rect vector-effect="non-scaling-stroke" x="${O}" y="${R}" width="${C}" height="${D}"/>`)}this.#t&&(u.push("</g></svg>')"),o.backgroundImage=u.join("")),this.container.append(m),this.container.style.clipPath=`url(#${w})`}_createPopup(e=null){const{data:t}=this;let s,r;e?(s={str:e.text},r=e.date):(s=t.contentsObj,r=t.modificationDate),this.#n=new b0({data:{color:t.color,titleObj:t.titleObj,modificationDate:r,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){ft("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:i,id:o,exportValues:u}of r){if(i===-1||o===t)continue;const d=typeof u=="string"?u:null,h=document.querySelector(`[data-element-id="${o}"]`);if(h&&!fo.has(h)){ze(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:d,domElement:h})}return s}for(const r of document.getElementsByName(e)){const{exportValue:i}=r,o=r.getAttribute("data-element-id");o!==t&&fo.has(r)&&s.push({id:o,exportValue:i,domElement:r})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class N5 extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Yy extends At{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(s,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(s,e.action,e.overlaidText),r=!0):e.attachment?(this.#t(s,e.attachment,e.overlaidText,e.attachmentDest),r=!0):e.setOCGState?(this.#n(s,e.setOCGState,e.overlaidText),r=!0):e.dest?(this._bindLink(s,e.dest,e.overlaidText),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),r=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=s,this.container.append(s)),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,s=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),s&&(e.title=s)}_bindNamedAction(e,t,s=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),s&&(e.title=s),this.#e()}#t(e,t,s="",r=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:s&&(e.title=s),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,r),!1),this.#e()}#n(e,t,s=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),s&&(e.title=s),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(t.actions)){const i=s.get(r);i&&(e[i]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){ze('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{s?.();const{fields:r,refs:i,include:o}=t,u=[];if(r.length!==0||i.length!==0){const p=new Set(i);for(const m of r){const x=this._fieldObjects[m]||[];for(const{id:v}of x)p.add(v)}for(const m of Object.values(this._fieldObjects))for(const x of m)p.has(x.id)===o&&u.push(x)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const d=this.annotationStorage,h=[];for(const p of u){const{id:m}=p;switch(h.push(m),p.type){case"text":{const v=p.defaultValue||"";d.setValue(m,{value:v});break}case"checkbox":case"radiobutton":{const v=p.defaultValue===p.exportValues;d.setValue(m,{value:v});break}case"combobox":case"listbox":{const v=p.defaultValue||"";d.setValue(m,{value:v});break}default:continue}const x=document.querySelector(`[data-element-id="${m}"]`);if(x){if(!fo.has(x)){ze(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;x.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}}),!1}}}class A5 extends At{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class _o extends At{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return bs.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,r,i){s.includes("mouse")?e.addEventListener(s,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(s,o=>{if(s==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(o)}})})}_setEventListeners(e,t,s,r){for(const[i,o]of s)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,i,o,r),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":we.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||k5,i=e.style;let o;const u=2,d=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(h/(pg*r))||1,m=h/p;o=Math.min(r,d(m/pg))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-u);o=Math.min(r,d(h/pg))}i.fontSize=`calc(${o}px * var(--total-scale-factor))`,i.color=we.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class S5 extends _o{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,r){const i=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=s),i.setValue(o.id,{[r]:s})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let i=r.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&i.length>o&&(i=i.slice(0,o));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:i,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??i,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??i),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),fo.add(s),this.contentElement=s,s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:h,datetimeType:p,timeStep:m}=this.data,x=!!p&&this.enableScripting;h&&(s.title=h),this._setRequired(s,this.data.required),o&&(s.maxLength=o),s.addEventListener("input",w=>{e.setValue(t,{value:w.target.value}),this.setPropertyOnSiblings(s,"value",w.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",w=>{const E=this.data.defaultFieldValue??"";s.value=d.userValue=E,d.formattedValue=null});let v=w=>{const{formattedValue:E}=d;E!=null&&(w.target.value=E),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",E=>{if(d.focused)return;const{target:N}=E;if(x&&(N.type=p,m&&(N.step=m)),d.userValue){const A=d.userValue;if(x)if(p==="time"){const T=new Date(A),I=[T.getHours(),T.getMinutes(),T.getSeconds()];N.value=I.map(P=>P.toString().padStart(2,"0")).join(":")}else N.value=new Date(A-E5).toISOString().split(p==="date"?"T":".",1)[0];else N.value=A}d.lastCommittedValue=N.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",E=>{this.showElementAndHideCanvas(E.target);const N={value(A){d.userValue=A.detail.value??"",x||e.setValue(t,{value:d.userValue.toString()}),A.target.value=d.userValue},formattedValue(A){const{formattedValue:T}=A.detail;d.formattedValue=T,T!=null&&A.target!==document.activeElement&&(A.target.value=T);const I={formattedValue:T};x&&(I.value=T),e.setValue(t,I)},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{const{charLimit:T}=A.detail,{target:I}=A;if(T===0){I.removeAttribute("maxLength");return}I.setAttribute("maxLength",T);let P=d.userValue;!P||P.length<=T||(P=P.slice(0,T),I.value=d.userValue=P,e.setValue(t,{value:P}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:P,willCommit:!0,commitKey:1,selStart:I.selectionStart,selEnd:I.selectionEnd}}))}};this._dispatchEventFromSandbox(N,E)}),s.addEventListener("keydown",E=>{d.commitKey=1;let N=-1;if(E.key==="Escape"?N=0:E.key==="Enter"&&!this.data.multiLine?N=2:E.key==="Tab"&&(d.commitKey=3),N===-1)return;const{value:A}=E.target;d.lastCommittedValue!==A&&(d.lastCommittedValue=A,d.userValue=A,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:N,selStart:E.target.selectionStart,selEnd:E.target.selectionEnd}}))});const w=v;v=null,s.addEventListener("blur",E=>{if(!d.focused||!E.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:N}=E;let{value:A}=N;if(x){if(A&&p==="time"){const T=A.split(":").map(I=>parseInt(I,10));A=new Date(2e3,0,1,T[0],T[1],T[2]||0).valueOf(),N.step=""}else A.includes("T")||(A=`${A}T00:00`),A=new Date(A).valueOf();N.type="text"}d.userValue=A,d.lastCommittedValue!==A&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:d.commitKey,selStart:E.target.selectionStart,selEnd:E.target.selectionEnd}}),w(E)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",E=>{d.lastCommittedValue=null;const{data:N,target:A}=E,{value:T,selectionStart:I,selectionEnd:P}=A;let U=I,O=P;switch(E.inputType){case"deleteWordBackward":{const R=T.substring(0,I).match(/\w*[^\w]*$/);R&&(U-=R[0].length);break}case"deleteWordForward":{const R=T.substring(I).match(/^[^\w]*\w*/);R&&(O+=R[0].length);break}case"deleteContentBackward":I===P&&(U-=1);break;case"deleteContentForward":I===P&&(O+=1);break}E.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,change:N||"",willCommit:!1,selStart:U,selEnd:O}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],E=>E.target.value)}if(v&&s.addEventListener("blur",v),this.data.comb){const E=(this.data.rect[2]-this.data.rect[0])/o;s.classList.add("comb"),s.style.letterSpacing=`calc(${E}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class T5 extends _o{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class C5 extends _o{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let r=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return fo.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const h of this._getElementsByName(u,s)){const p=d&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=p),e.setValue(h.id,{value:p})}e.setValue(s,{value:d})}),i.addEventListener("resetform",o=>{const u=t.defaultFieldValue||"Off";o.target.checked=u===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",o=>{const u={value(d){d.target.checked=d.detail.value!=="Off",e.setValue(s,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class KN extends _o{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let r=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(s,{value:r})),r)for(const o of this._getElementsByName(t.fieldName,s))e.setValue(o.id,{value:!1});const i=document.createElement("input");if(fo.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const h of this._getElementsByName(u,s))e.setValue(h.id,{value:!1});e.setValue(s,{value:d})}),i.addEventListener("resetform",o=>{const u=t.defaultFieldValue;o.target.checked=u!=null&&u===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;i.addEventListener("updatefromsandbox",u=>{const d={value:h=>{const p=o===h.detail.value;for(const m of this._getElementsByName(h.target.name)){const x=p&&m.id===s;m.domElement&&(m.domElement.checked=x),e.setValue(m.id,{value:x})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class I5 extends Yy{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class P5 extends _o{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");fo.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue;for(const x of r.options)x.selected=x.value===m});for(const p of this.data.options){const m=document.createElement("option");m.textContent=p.displayValue,m.value=p.exportValue,s.value.includes(p.exportValue)&&(m.setAttribute("selected",!0),i=!1),r.append(m)}let o=null;if(i){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),r.prepend(p),o=()=>{p.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}const u=p=>{const m=p?"value":"textContent",{options:x,multiple:v}=r;return v?Array.prototype.filter.call(x,w=>w.selected).map(w=>w[m]):x.selectedIndex===-1?null:x[x.selectedIndex][m]};let d=u(!1);const h=p=>{const m=p.target.options;return Array.prototype.map.call(m,x=>({displayValue:x.textContent,exportValue:x.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",p=>{const m={value(x){o?.();const v=x.detail.value,w=new Set(Array.isArray(v)?v:[v]);for(const E of r.options)E.selected=w.has(E.value);e.setValue(t,{value:u(!0)}),d=u(!1)},multipleSelection(x){r.multiple=!0},remove(x){const v=r.options,w=x.detail.remove;v[w].selected=!1,r.remove(w),v.length>0&&Array.prototype.findIndex.call(v,N=>N.selected)===-1&&(v[0].selected=!0),e.setValue(t,{value:u(!0),items:h(x)}),d=u(!1)},clear(x){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),d=u(!1)},insert(x){const{index:v,displayValue:w,exportValue:E}=x.detail.insert,N=r.children[v],A=document.createElement("option");A.textContent=w,A.value=E,N?N.before(A):r.append(A),e.setValue(t,{value:u(!0),items:h(x)}),d=u(!1)},items(x){const{items:v}=x.detail;for(;r.length!==0;)r.remove(0);for(const w of v){const{displayValue:E,exportValue:N}=w,A=document.createElement("option");A.textContent=E,A.value=N,r.append(A)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:u(!0),items:h(x)}),d=u(!1)},indices(x){const v=new Set(x.detail.indices);for(const w of x.target.options)w.selected=v.has(w.index);e.setValue(t,{value:u(!0)}),d=u(!1)},editable(x){x.target.disabled=!x.detail.editable}};this._dispatchEventFromSandbox(m,p)}),r.addEventListener("input",p=>{const m=u(!0),x=u(!1);e.setValue(t,{value:m}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:d,change:x,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):r.addEventListener("input",function(p){e.setValue(t,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class b0 extends At{constructor(e){const{data:t,elements:s,parent:r}=e,i=!!r._commentManager;if(super(e,{isRenderable:!i&&At._hasPopupData(t)}),this.elements=s,i&&At._hasPopupData(t)){const o=this.popup=this.#e();for(const u of s)u.popup=o}else this.popup=null}#e(){return new j5({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),s=[];for(const r of this.elements)r.popup=t,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${bl}${r}`).join(",")),this.container}}class j5{#e=null;#t=this.#H.bind(this);#n=this.#V.bind(this);#s=this.#R.bind(this);#a=this.#_.bind(this);#i=null;#r=null;#o=null;#c=null;#l=null;#h=null;#d=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#b=null;#x=null;#N=null;#k=null;#w=null;#S=!1;#v=null;#E=null;constructor({container:e,color:t,elements:s,titleObj:r,modificationDate:i,contentsObj:o,richText:u,parent:d,rect:h,parentRect:p,open:m,commentManager:x=null}){this.#r=e,this.#k=r,this.#o=o,this.#N=u,this.#h=d,this.#i=t,this.#x=h,this.#d=p,this.#l=s,this.#e=x,this.#v=s[0],this.#c=h0.toDateObject(i),this.trigger=s.flatMap(v=>v.getElementsToTriggerPopup()),x||(this.#I(),this.#r.hidden=!0,m&&this.#_())}#I(){if(this.#m)return;this.#m=new AbortController;const{signal:e}=this.#m;for(const t of this.trigger)t.addEventListener("click",this.#a,{signal:e}),t.addEventListener("pointerenter",this.#s,{signal:e}),t.addEventListener("pointerleave",this.#n,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#T(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#y=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#v.container.after(this.#p);return}if(this.#y||this.#T(),!this.#y)return;const{signal:e}=this.#m=new AbortController,t=this.#v.hasOwnCommentButton,s=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},r=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},i=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#p=this.#v.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=this.#p=document.createElement("button");o.className="annotationCommentButton";const u=this.#v.container;o.style.zIndex=u.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#O(),this.#C(),o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),u.after(o)}}#C(){if(this.#v.extraPopupElement&&!this.#v.editor)return;this.#p||this.renderCommentButton();const[e,t]=this.#y,{style:s}=this.#p;s.left=`calc(${e}%)`,s.top=`calc(${t}% - var(--comment-button-dim))`}#O(){this.#v.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#v.commentData;return e?this.#h._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:e,color:t,opacity:s,creationDate:r,modificationDate:i}=this.#v.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:s,creationDate:r,modificationDate:i}}get elementBeforePopup(){return this.#p}get comment(){return this.#E||=this.#v.commentText,this.#E}set comment(e){e!==this.comment&&(this.#v.commentText=this.#E=e)}focus(){this.#v.container?.focus()}get parentBoundingClientRect(){return this.#v.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#p&&(this.#p.classList.toggle("selected",e),this.#p.ariaExpanded=t)}setSelectedCommentButton(e){this.#p.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:e,y:t,height:s}=this.#p.getBoundingClientRect(),{x:r,y:i,width:o,height:u}=this.#v.layer.getBoundingClientRect();return[(e-r)/o,(t+s-i)/u]}set commentPopupPosition(e){this.#b=e}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,s]=this.#b||this.commentButtonPosition.map(h=>h/100),r=this.parentBoundingClientRect,{x:i,y:o,width:u,height:d}=r;this.#e.showDialog(null,this,i+t*u,o+s*d,{...e,parentDimensions:r})}render(){if(this.#g)return;const e=this.#g=document.createElement("div");if(e.className="popup",this.#i){const s=e.style.outlineColor=we.makeHexColor(...this.#i);e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#k?.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=this.#k}if(e.append(t),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),t.append(s)}TN({html:this.#j||this.#o.str,dir:this.#o?.dir,className:"popupContent"},e),this.#r.append(e)}get#j(){const e=this.#N,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#N.html||null}get#D(){return this.#j?.attributes?.style?.fontSize||0}get#F(){return this.#j?.attributes?.style?.color||null}#M(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:this.#F,fontSize:this.#D?`calc(${this.#D}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:r});return s}#H(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#_()}updateEdited({rect:e,popup:t,deleted:s}){if(this.#e){s?(this.remove(),this.#E=null):t&&(t.deleted?this.remove():(this.#O(),this.#E=t.text)),e&&(this.#y=null,this.#T(),this.#C());return}if(s||t?.deleted){this.remove();return}this.#I(),this.#w||={contentsObj:this.#o,richText:this.#N},e&&(this.#u=null),t&&t.text&&(this.#N=this.#M(t.text),this.#c=h0.toDateObject(t.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#N}=this.#w,this.#w=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#S=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#A(){if(this.#u!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:r,pageY:i}}}=this.#h;let o=!!this.#d,u=o?this.#d:this.#x;for(const w of this.#l)if(!u||we.intersect(w.data.rect,u)!==null){u=w.data.rect,o=!0;break}const d=we.normalizeRect([u[0],e[3]-u[1]+e[1],u[2],e[3]-u[3]+e[1]]),p=o?u[2]-u[0]+5:0,m=d[0]+p,x=d[1];this.#u=[100*(m-r)/t,100*(x-i)/s];const{style:v}=this.#r;v.left=`${this.#u[0]}%`,v.top=`${this.#u[1]}%`}#_(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#R(),this.#r.addEventListener("click",this.#a),this.#r.addEventListener("keydown",this.#t)):(this.#V(),this.#r.removeEventListener("click",this.#a),this.#r.removeEventListener("keydown",this.#t))}#R(){this.#g||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#A(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#V(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#S=this.isVisible,this.#S&&(this.#r.hidden=!0)}maybeShow(){this.#e||(this.#I(),this.#S&&(this.#g||this.#R(),this.#S=!1,this.#r.hidden=!1))}get isVisible(){return this.#e?!1:this.#r.hidden===!1}}class YN extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=qe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class R5 extends At{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:s}=this,r=this.svgFactory.create(t,s,!0),i=this.#e=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),r.append(i),this.container.append(r),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class D5 extends At{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:s}=this,r=this.svgFactory.create(t,s,!0),i=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",i/2),o.setAttribute("y",i/2),o.setAttribute("width",t-i),o.setAttribute("height",s-i),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class M5 extends At{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:s}=this,r=this.svgFactory.create(t,s,!0),i=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",s/2),o.setAttribute("rx",t/2-i/2),o.setAttribute("ry",s/2-i/2),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class XN extends At{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:s,popupRef:r},width:i,height:o}=this;if(!t)return this.container;const u=this.svgFactory.create(i,o,!0);let d=[];for(let p=0,m=t.length;p<m;p+=2){const x=t[p]-e[0],v=e[3]-t[p+1];d.push(`${x},${v}`)}d=d.join(" ");const h=this.#e=this.svgFactory.createElement(this.svgElementName);return h.setAttribute("points",d),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),u.append(h),this.container.append(u),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class L5 extends XN{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class O5 extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Xy extends At{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?qe.HIGHLIGHT:qe.INK}#n(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:s,borderStyle:r,popupRef:i}}=this,{transform:o,width:u,height:d}=this.#n(t,e),h=this.svgFactory.create(u,d,!0),p=this.#e=this.svgFactory.createElement("svg:g");h.append(p),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",o);for(let m=0,x=s.length;m<x;m++){const v=this.svgFactory.createElement(this.svgElementName);this.#t.push(v),v.setAttribute("points",s[m].join(",")),p.append(v)}return!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:s,rect:r}=e,i=this.#e;if(t>=0&&i.setAttribute("stroke-width",t||1),s)for(let o=0,u=this.#t.length;o<u;o++)this.#t[o].setAttribute("points",s[o].join(","));if(r){const{transform:o,width:u,height:d}=this.#n(this.data.rotation,r);i.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),i.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class QN extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=qe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class F5 extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class V5 extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class U5 extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class JN extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=qe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class B5 extends At{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let s;t.hasAppearance||t.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#t.bind(this)),this.#e=s;const{isMac:r}=bs.platform;return e.addEventListener("keydown",i=>{i.key==="Enter"&&(r?i.metaKey:i.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Qy{#e=null;#t=null;#n=null;#s=new Map;#a=null;#i=null;#r=[];#o=!1;constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:r,page:i,viewport:o,structTreeLayer:u,commentManager:d,linkService:h,annotationStorage:p}){this.div=e,this.#e=t,this.#t=s,this.#a=u||null,this.#i=h||null,this.#n=p||new Hy,this.page=i,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=d||null}hasEditableAnnotations(){return this.#s.size>0}async render(e){const{annotations:t}=e,s=this.div;ho(s,this.viewport);const r=new Map,i=[],o={data:null,layer:s,linkService:this.#i,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new If,annotationStorage:this.#n,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const u of t){if(u.noHTML)continue;const d=u.annotationType===Kt.POPUP;if(d){const m=r.get(u.id);if(!m)continue;if(!this._commentManager){i.push(u);continue}o.elements=m}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;o.data=u;const h=_g.create(o);if(!h.isRenderable)continue;if(!d&&(this.#r.push(h),u.popupRef)){const m=r.get(u.popupRef);m?m.push(h):r.set(u.popupRef,[h])}const p=h.render();u.hidden&&(p.style.visibility="hidden"),h._isEditable&&(this.#s.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}await this.#c();for(const u of i){const d=o.elements=r.get(u.id);o.data=u;const h=_g.create(o);if(!h.isRenderable)continue;const p=h.render();h.contentElement.id=`${bl}${u.id}`,u.hidden&&(p.style.visibility="hidden"),d.at(-1).container.after(p)}this.#l()}async#c(){if(this.#r.length===0)return;this.div.replaceChildren();const e=[];if(!this.#o){this.#o=!0;for(const{contentElement:s,data:{id:r}}of this.#r){const i=s.id=`${bl}${r}`;e.push(this.#a?.getAriaAttributes(i).then(o=>{if(o)for(const[u,d]of o)s.setAttribute(u,d)}))}}this.#r.sort(({data:{rect:[s,r,i,o]}},{data:{rect:[u,d,h,p]}})=>{if(s===i&&r===o)return 1;if(u===h&&d===p)return-1;const m=o,x=r,v=(r+o)/2,w=p,E=d,N=(d+p)/2;if(v>=w&&N<=x)return-1;if(N>=m&&v<=E)return 1;const A=(s+i)/2,T=(u+h)/2;return A-T});const t=document.createDocumentFragment();for(const s of this.#r)t.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&t.append(s.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),this.#e)for(const s of this.#r)this.#e.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#i,svgFactory:new If,parent:this};for(const s of e){s.borderStyle||=Qy._defaultBorderStyle,t.data=s;const r=_g.create(t);r.isRenderable&&(r.render(),r.contentElement.id=`${bl}${s.id}`,this.#r.push(r))}await this.#c()}update({viewport:e}){const t=this.div;this.viewport=e,ho(t,{rotation:e.rotation}),this.#l(),t.hidden=!1}#l(){if(!this.#t)return;const e=this.div;for(const[t,s]of this.#t){const r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:i}=r;i?i.nodeName==="CANVAS"?i.replaceWith(s):i.classList.contains("annotationContent")?i.after(s):i.before(s):r.append(s);const o=this.#s.get(t);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,r.id,s),o._hasNoCanvas=!1):o.canvas=s)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(e){return this.#s.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:s,rotation:r}=e,i=new N5({data:{id:s,rect:e.getPDFRect(),rotation:r},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#i,annotationStorage:this.#n});return i.render(),i.contentElement.id=`${bl}${s}`,i.createOrUpdatePopup(),this.#r.push(i),i}removeAnnotation(e){const t=this.#r.findIndex(r=>r.data.id===e);if(t<0)return;const[s]=this.#r.splice(t,1);this.#e?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return $e(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ml.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const zh=/\r\n?|\n/g;class os extends Ie{#e="";#t=`${this.id}-editor`;#n=null;#s;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=os.prototype,t=i=>i.isEmpty(),s=xa.TRANSLATE_SMALL,r=xa.TRANSLATE_BIG;return $e(this,"_keyboardManager",new id([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}]]))}static _type="freetext";static _editorType=qe.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||os._defaultColor||Ie._defaultLineColor,this.#s=e.fontSize||os._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){Ie.initialize(e,t);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Ze.FREETEXT_SIZE:os._defaultFontSize=t;break;case Ze.FREETEXT_COLOR:os._defaultColor=t;break}}updateParams(e,t){switch(e){case Ze.FREETEXT_SIZE:this.#a(t);break;case Ze.FREETEXT_COLOR:this.#i(t);break}}static get defaultPropertiesToUpdate(){return[[Ze.FREETEXT_SIZE,os._defaultFontSize],[Ze.FREETEXT_COLOR,os._defaultColor||Ie._defaultLineColor]]}get propertiesToUpdate(){return[[Ze.FREETEXT_SIZE,this.#s],[Ze.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Mu(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ze.FREETEXT_COLOR}#a(e){const t=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#s)*this.parentScale),this.#s=r,this.#o()},s=this.#s;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#i(e){const t=r=>{this.color=r,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-os._internalPadding*e,-(os._internalPadding+this.#s)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const e=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const e=[];this.editorDiv.normalize();let t=null;for(const s of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(os.#c(s)),t=s);return e.join(`
`)}#o(){const[e,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:i}=this,o=i.style.display,u=i.classList.contains("hidden");i.classList.remove("hidden"),i.style.display="hidden",r.div.append(this.div),s=i.getBoundingClientRect(),i.remove(),i.style.display=o,i.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/t):(this.width=s.height/e,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#r().trimEnd();if(e===t)return;const s=r=>{if(this.#e=r,!r){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(e)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){os._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,i]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[h,p]=this.pageDimensions,[m,x]=this.pageTranslation;let v,w;switch(this.rotation){case 0:v=e+(o[0]-m)/h,w=t+this.height-(o[1]-x)/p;break;case 90:v=e+(o[0]-m)/h,w=t-(o[1]-x)/p,[u,d]=[d,-u];break;case 180:v=e-this.width+(o[0]-m)/h,w=t-(o[1]-x)/p,[u,d]=[-u,-d];break;case 270:v=e+(o[0]-m-this.height*p)/h,w=t+(o[1]-x-this.width*h)/p,[u,d]=[-d,u];break}this.setAt(v*r,w*i,u,d)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(zh,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:s}=t;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const r=os.#d(t.getData("text")||"").replaceAll(zh,`
`);if(!r)return;const i=window.getSelection();if(!i.rangeCount)return;this.editorDiv.normalize(),i.deleteFromDocument();const o=i.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),i.collapseToStart();return}const{startContainer:u,startOffset:d}=o,h=[],p=[];if(u.nodeType===Node.TEXT_NODE){const v=u.parentElement;if(p.push(u.nodeValue.slice(d).replaceAll(zh,"")),v!==this.editorDiv){let w=h;for(const E of this.editorDiv.childNodes){if(E===v){w=p;continue}w.push(os.#c(E))}}h.push(u.nodeValue.slice(0,d).replaceAll(zh,""))}else if(u===this.editorDiv){let v=h,w=0;for(const E of this.editorDiv.childNodes)w++===d&&(v=p),v.push(os.#c(E))}this.#e=`${h.join(`
`)}${r}${p.join(`
`)}`,this.#l();const m=new Range;let x=Math.sumPrecise(h.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const w=v.nodeValue.length;if(x<=w){m.setStart(v,x),m.setEnd(v,x);break}x-=w}i.removeAllRanges(),i.addRange(m)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#h(){return this.#e.replaceAll(""," ")}static#d(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=os._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,s){let r=null;if(e instanceof YN){const{data:{defaultAppearanceData:{fontSize:o,fontColor:u},rect:d,rotation:h,id:p,popupRef:m,richText:x,contentsObj:v,creationDate:w,modificationDate:E},textContent:N,textPosition:A,parent:{page:{pageNumber:T}}}=e;if(!N||N.length===0)return null;r=e={annotationType:qe.FREETEXT,color:Array.from(u),fontSize:o,value:N.join(`
`),position:A,pageIndex:T-1,rect:d.slice(0),rotation:h,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:v?.str||null,richText:x,creationDate:w,modificationDate:E}}const i=await super.deserialize(e,t,s);return i.#s=e.fontSize,i.color=we.makeHexColor(...e.color),i.#e=os.#d(e.value),i._initialData=r,e.comment&&i.setCommentData(e),i}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Ie._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(e),{color:t,fontSize:this.#s,value:this.#h()});return this.addComment(s),e?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(e){const{value:t,fontSize:s,color:r,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==s||e.color.some((o,u)=>o!==r[u])||e.pageIndex!==i}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:s}=t;s.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,s.color=this.color,t.replaceChildren();for(const r of this.#e.split(`
`)){const i=document.createElement("div");i.append(r?document.createTextNode(r):document.createElement("br")),t.append(i)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class ve{static PRECISION=1e-4;toSVGPath(){ft("Abstract method `toSVGPath` must be implemented.")}get box(){ft("Abstract getter `box` must be implemented.")}serialize(e,t){ft("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,r,i,o){o||=new Float32Array(e.length);for(let u=0,d=e.length;u<d;u+=2)o[u]=t+e[u]*r,o[u+1]=s+e[u+1]*i;return o}static _rescaleAndSwap(e,t,s,r,i,o){o||=new Float32Array(e.length);for(let u=0,d=e.length;u<d;u+=2)o[u]=t+e[u+1]*r,o[u+1]=s+e[u]*i;return o}static _translate(e,t,s,r){r||=new Float32Array(e.length);for(let i=0,o=e.length;i<o;i+=2)r[i]=t+e[i],r[i+1]=s+e[i+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,r,i){switch(i){case 90:return[1-t/s,e/r];case 180:return[1-e/s,1-t/r];case 270:return[t/s,1-e/r];default:return[e/s,t/r]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,r,i,o){return[(e+5*s)/6,(t+5*r)/6,(5*s+i)/6,(5*r+o)/6,(s+i)/2,(r+o)/2]}}class to{#e;#t=[];#n;#s;#a=[];#i=new Float32Array(18);#r;#o;#c;#l;#h;#d;#f=[];static#g=8;static#m=2;static#u=to.#g+to.#m;constructor({x:e,y:t},s,r,i,o,u=0){this.#e=s,this.#d=i*r,this.#s=o,this.#i.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=u,this.#l=to.#g*r,this.#c=to.#u*r,this.#h=r,this.#f.push(e,t)}isEmpty(){return isNaN(this.#i[8])}#p(){const e=this.#i.subarray(4,6),t=this.#i.subarray(16,18),[s,r,i,o]=this.#e;return[(this.#r+(e[0]-t[0])/2-s)/i,(this.#o+(e[1]-t[1])/2-r)/o,(this.#r+(t[0]-e[0])/2-s)/i,(this.#o+(t[1]-e[1])/2-r)/o]}add({x:e,y:t}){this.#r=e,this.#o=t;const[s,r,i,o]=this.#e;let[u,d,h,p]=this.#i.subarray(8,12);const m=e-h,x=t-p,v=Math.hypot(m,x);if(v<this.#c)return!1;const w=v-this.#l,E=w/v,N=E*m,A=E*x;let T=u,I=d;u=h,d=p,h+=N,p+=A,this.#f?.push(e,t);const P=-A/w,U=N/w,O=P*this.#d,R=U*this.#d;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([h+O,p+R],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([h-O,p-R],16),isNaN(this.#i[6])?(this.#a.length===0&&(this.#i.set([u+O,d+R],2),this.#a.push(NaN,NaN,NaN,NaN,(u+O-s)/i,(d+R-r)/o),this.#i.set([u-O,d-R],14),this.#t.push(NaN,NaN,NaN,NaN,(u-O-s)/i,(d-R-r)/o)),this.#i.set([T,I,u,d,h,p],6),!this.isEmpty()):(this.#i.set([T,I,u,d,h,p],6),Math.abs(Math.atan2(I-d,T-u)-Math.atan2(A,N))<Math.PI/2?([u,d,h,p]=this.#i.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((u+h)/2-s)/i,((d+p)/2-r)/o),[u,d,T,I]=this.#i.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((T+u)/2-s)/i,((I+d)/2-r)/o),!0):([T,I,u,d,h,p]=this.#i.subarray(0,6),this.#a.push(((T+5*u)/6-s)/i,((I+5*d)/6-r)/o,((5*u+h)/6-s)/i,((5*d+p)/6-r)/o,((u+h)/2-s)/i,((d+p)/2-r)/o),[h,p,u,d,T,I]=this.#i.subarray(12,18),this.#t.push(((T+5*u)/6-s)/i,((I+5*d)/6-r)/o,((5*u+h)/6-s)/i,((5*d+p)/6-r)/o,((u+h)/2-s)/i,((d+p)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#a,t=this.#t;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?s.push(`L${e[r+4]} ${e[r+5]}`):s.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);this.#x(s);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return this.#b(s),s.join(" ")}#y(){const[e,t,s,r]=this.#e,[i,o,u,d]=this.#p();return`M${(this.#i[2]-e)/s} ${(this.#i[3]-t)/r} L${(this.#i[4]-e)/s} ${(this.#i[5]-t)/r} L${i} ${o} L${u} ${d} L${(this.#i[16]-e)/s} ${(this.#i[17]-t)/r} L${(this.#i[14]-e)/s} ${(this.#i[15]-t)/r} Z`}#b(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#x(e){const[t,s,r,i]=this.#e,o=this.#i.subarray(4,6),u=this.#i.subarray(16,18),[d,h,p,m]=this.#p();e.push(`L${(o[0]-t)/r} ${(o[1]-s)/i} L${d} ${h} L${p} ${m} L${(u[0]-t)/r} ${(u[1]-s)/i}`)}newFreeDrawOutline(e,t,s,r,i,o){return new ZN(e,t,s,r,i,o)}getOutlines(){const e=this.#a,t=this.#t,s=this.#i,[r,i,o,u]=this.#e,d=new Float32Array((this.#f?.length??0)+2);for(let m=0,x=d.length-2;m<x;m+=2)d[m]=(this.#f[m]-r)/o,d[m+1]=(this.#f[m+1]-i)/u;if(d[d.length-2]=(this.#r-r)/o,d[d.length-1]=(this.#o-i)/u,isNaN(s[6])&&!this.isEmpty())return this.#N(d);const h=new Float32Array(this.#a.length+24+this.#t.length);let p=e.length;for(let m=0;m<p;m+=2){if(isNaN(e[m])){h[m]=h[m+1]=NaN;continue}h[m]=e[m],h[m+1]=e[m+1]}p=this.#w(h,p);for(let m=t.length-6;m>=6;m-=6)for(let x=0;x<6;x+=2){if(isNaN(t[m+x])){h[p]=h[p+1]=NaN,p+=2;continue}h[p]=t[m+x],h[p+1]=t[m+x+1],p+=2}return this.#k(h,p),this.newFreeDrawOutline(h,d,this.#e,this.#h,this.#n,this.#s)}#N(e){const t=this.#i,[s,r,i,o]=this.#e,[u,d,h,p]=this.#p(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(t[2]-s)/i,(t[3]-r)/o,NaN,NaN,NaN,NaN,(t[4]-s)/i,(t[5]-r)/o,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,(t[16]-s)/i,(t[17]-r)/o,NaN,NaN,NaN,NaN,(t[14]-s)/i,(t[15]-r)/o],0),this.newFreeDrawOutline(m,e,this.#e,this.#h,this.#n,this.#s)}#k(e,t){const s=this.#t;return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6}#w(e,t){const s=this.#i.subarray(4,6),r=this.#i.subarray(16,18),[i,o,u,d]=this.#e,[h,p,m,x]=this.#p();return e.set([NaN,NaN,NaN,NaN,(s[0]-i)/u,(s[1]-o)/d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,m,x,NaN,NaN,NaN,NaN,(r[0]-i)/u,(r[1]-o)/d],t),t+=24}}class ZN extends ve{#e;#t=new Float32Array(4);#n;#s;#a;#i;#r;constructor(e,t,s,r,i,o){super(),this.#r=e,this.#a=t,this.#e=s,this.#i=r,this.#n=i,this.#s=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(o);const[u,d,h,p]=this.#t;for(let m=0,x=e.length;m<x;m+=2)e[m]=(e[m]-u)/h,e[m+1]=(e[m+1]-d)/p;for(let m=0,x=t.length;m<x;m+=2)t[m]=(t[m]-u)/h,t[m+1]=(t[m+1]-d)/p}toSVGPath(){const e=[`M${this.#r[4]} ${this.#r[5]}`];for(let t=6,s=this.#r.length;t<s;t+=6){if(isNaN(this.#r[t])){e.push(`L${this.#r[t+4]} ${this.#r[t+5]}`);continue}e.push(`C${this.#r[t]} ${this.#r[t+1]} ${this.#r[t+2]} ${this.#r[t+3]} ${this.#r[t+4]} ${this.#r[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,s,r],i){const o=s-e,u=r-t;let d,h;switch(i){case 0:d=ve._rescale(this.#r,e,r,o,-u),h=ve._rescale(this.#a,e,r,o,-u);break;case 90:d=ve._rescaleAndSwap(this.#r,e,t,o,u),h=ve._rescaleAndSwap(this.#a,e,t,o,u);break;case 180:d=ve._rescale(this.#r,s,t,-o,u),h=ve._rescale(this.#a,s,t,-o,u);break;case 270:d=ve._rescaleAndSwap(this.#r,s,r,-o,-u),h=ve._rescaleAndSwap(this.#a,s,r,-o,-u);break}return{outline:Array.from(d),points:[Array.from(h)]}}#o(e){const t=this.#r;let s=t[4],r=t[5];const i=[s,r,s,r];let o=s,u=r,d=s,h=r;const p=e?Math.max:Math.min,m=new Float32Array(4);for(let v=6,w=t.length;v<w;v+=6){const E=t[v+4],N=t[v+5];isNaN(t[v])?(we.pointBoundingBox(E,N,i),u>N?(o=E,u=N):u===N&&(o=p(o,E)),h<N?(d=E,h=N):h===N&&(d=p(d,E))):(m[0]=m[1]=1/0,m[2]=m[3]=-1/0,we.bezierBoundingBox(s,r,...t.slice(v,v+6),m),we.rectBoundingBox(m[0],m[1],m[2],m[3],i),u>m[1]?(o=m[0],u=m[1]):u===m[1]&&(o=p(o,m[0])),h<m[3]?(d=m[2],h=m[3]):h===m[3]&&(d=p(d,m[2]))),s=E,r=N}const x=this.#t;x[0]=i[0]-this.#n,x[1]=i[1]-this.#n,x[2]=i[2]-i[0]+2*this.#n,x[3]=i[3]-i[1]+2*this.#n,this.firstPoint=[o,u],this.lastPoint=[d,h]}get box(){return this.#t}newOutliner(e,t,s,r,i,o=0){return new to(e,t,s,r,i,o)}getNewOutline(e,t){const[s,r,i,o]=this.#t,[u,d,h,p]=this.#e,m=i*h,x=o*p,v=s*h+u,w=r*p+d,E=this.newOutliner({x:this.#a[0]*m+v,y:this.#a[1]*x+w},this.#e,this.#i,e,this.#s,t??this.#n);for(let N=2;N<this.#a.length;N+=2)E.add({x:this.#a[N]*m+v,y:this.#a[N+1]*x+w});return E.getOutlines()}}class v0{#e;#t;#n;#s=[];#a=[];constructor(e,t=0,s=0,r=!0){const i=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:E,y:N,width:A,height:T}of e){const I=Math.floor((E-t)/o)*o,P=Math.ceil((E+A+t)/o)*o,U=Math.floor((N-t)/o)*o,O=Math.ceil((N+T+t)/o)*o,R=[I,U,O,!0],C=[P,U,O,!1];this.#s.push(R,C),we.rectBoundingBox(I,U,P,O,i)}const u=i[2]-i[0]+2*s,d=i[3]-i[1]+2*s,h=i[0]-s,p=i[1]-s;let m=r?-1/0:1/0,x=1/0;const v=this.#s.at(r?-1:-2),w=[v[0],v[2]];for(const E of this.#s){const[N,A,T,I]=E;!I&&r?A<x?(x=A,m=N):A===x&&(m=Math.max(m,N)):I&&!r&&(A<x?(x=A,m=N):A===x&&(m=Math.min(m,N))),E[0]=(N-h)/u,E[1]=(A-p)/d,E[2]=(T-p)/d}this.#e=new Float32Array([h,p,u,d]),this.#t=[m,x],this.#n=w}getOutlines(){this.#s.sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of this.#s)t[3]?(e.push(...this.#l(t)),this.#o(t)):(this.#c(t),e.push(...this.#l(t)));return this.#i(e)}#i(e){const t=[],s=new Set;for(const o of e){const[u,d,h]=o;t.push([u,d,o],[u,h,o])}t.sort((o,u)=>o[1]-u[1]||o[0]-u[0]);for(let o=0,u=t.length;o<u;o+=2){const d=t[o][2],h=t[o+1][2];d.push(h),h.push(d),s.add(d),s.add(h)}const r=[];let i;for(;s.size>0;){const o=s.values().next().value;let[u,d,h,p,m]=o;s.delete(o);let x=u,v=d;for(i=[u,h],r.push(i);;){let w;if(s.has(p))w=p;else if(s.has(m))w=m;else break;s.delete(w),[u,d,h,p,m]=w,x!==u&&(i.push(x,v,u,v===d?d:h),x=u),v=v===d?h:d}i.push(x,v)}return new z5(r,this.#e,this.#t,this.#n)}#r(e){const t=this.#a;let s=0,r=t.length-1;for(;s<=r;){const i=s+r>>1,o=t[i][0];if(o===e)return i;o<e?s=i+1:r=i-1}return r+1}#o([,e,t]){const s=this.#r(e);this.#a.splice(s,0,[e,t])}#c([,e,t]){const s=this.#r(e);for(let r=s;r<this.#a.length;r++){const[i,o]=this.#a[r];if(i!==e)break;if(i===e&&o===t){this.#a.splice(r,1);return}}for(let r=s-1;r>=0;r--){const[i,o]=this.#a[r];if(i!==e)break;if(i===e&&o===t){this.#a.splice(r,1);return}}}#l(e){const[t,s,r]=e,i=[[t,s,r]],o=this.#r(r);for(let u=0;u<o;u++){const[d,h]=this.#a[u];for(let p=0,m=i.length;p<m;p++){const[,x,v]=i[p];if(!(h<=x||v<=d)){if(x>=d){if(v>h)i[p][1]=h;else{if(m===1)return[];i.splice(p,1),p--,m--}continue}i[p][2]=d,v>h&&i.push([t,h,v])}}}return i}}class z5 extends ve{#e;#t;constructor(e,t,s,r){super(),this.#t=e,this.#e=t,this.firstPoint=s,this.lastPoint=r}toSVGPath(){const e=[];for(const t of this.#t){let[s,r]=t;e.push(`M${s} ${r}`);for(let i=2;i<t.length;i+=2){const o=t[i],u=t[i+1];o===s?(e.push(`V${u}`),r=u):u===r&&(e.push(`H${o}`),s=o)}e.push("Z")}return e.join(" ")}serialize([e,t,s,r],i){const o=[],u=s-e,d=r-t;for(const h of this.#t){const p=new Array(h.length);for(let m=0;m<h.length;m+=2)p[m]=e+h[m]*u,p[m+1]=r-h[m+1]*d;o.push(p)}return o}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class w0 extends to{newFreeDrawOutline(e,t,s,r,i,o){return new $5(e,t,s,r,i,o)}}class $5 extends ZN{newOutliner(e,t,s,r,i,o=0){return new w0(e,t,s,r,i,o)}}class Ft extends Ie{#e=null;#t=0;#n;#s=null;#a=null;#i=null;#r=null;#o=0;#c=null;#l=null;#h=null;#d=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=qe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Ft.prototype;return $e(this,"_keyboardManager",new id([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Ft._defaultColor,this.#p=e.thickness||Ft._defaultThickness,this.opacity=e.opacity||Ft._defaultOpacity,this.#n=e.boxes||null,this.#y=e.methodOfCreation||"",this.#u=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#d=!0,this.#x(e),this.#v()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#r=e.focusNode,this.#o=e.focusOffset,this.#b(),this.#v(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#d?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#b(){const e=new v0(this.#n,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new v0(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#i=t.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:r}=this.#i;this.#g=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#x({highlightOutlines:e,highlightId:t,clipPathId:s}){this.#l=e;const r=1.5;if(this.#i=e.getNewOutline(this.#p/2+r,.0025),t>=0)this.#h=t,this.#s=s,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:Ft.#E(this.#l.box,(m-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:Ft.#E(this.#i.box,m),path:{d:this.#i.toSVGPath()}})}const[i,o,u,d]=e.box;switch(this.rotation){case 0:this.x=i,this.y=o,this.width=u,this.height=d;break;case 90:{const[m,x]=this.parentDimensions;this.x=o,this.y=1-i,this.width=u*x/m,this.height=d*m/x;break}case 180:this.x=1-i,this.y=1-o,this.width=u,this.height=d;break;case 270:{const[m,x]=this.parentDimensions;this.x=1-o,this.y=i,this.width=u*x/m,this.height=d*m/x;break}}const{firstPoint:h}=e;this.#f=[(h[0]-i)/u,(h[1]-o)/d];const{lastPoint:p}=this.#i;this.#g=[(p[0]-i)/u,(p[1]-o)/d]}static initialize(e,t){Ie.initialize(e,t),Ft._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Ze.HIGHLIGHT_COLOR:Ft._defaultColor=t;break;case Ze.HIGHLIGHT_THICKNESS:Ft._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case Ze.HIGHLIGHT_COLOR:this.#N(t);break;case Ze.HIGHLIGHT_THICKNESS:this.#k(t);break}}static get defaultPropertiesToUpdate(){return[[Ze.HIGHLIGHT_COLOR,Ft._defaultColor],[Ze.HIGHLIGHT_THICKNESS,Ft._defaultThickness]]}get propertiesToUpdate(){return[[Ze.HIGHLIGHT_COLOR,this.color||Ft._defaultColor],[Ze.HIGHLIGHT_THICKNESS,this.#p||Ft._defaultThickness],[Ze.HIGHLIGHT_FREE,this.#d]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#N(e){const t=(i,o)=>{this.color=i,this.opacity=o,this.onUpdatedColor()},s=this.color,r=this.opacity;this.addCommands({cmd:t.bind(this,e,Ft._defaultOpacity),undo:t.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#k(e){const t=this.#p,s=r=>{this.#p=r,this.#w(r)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Sn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#C())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#C())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#S(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#v(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#S():e&&(this.#v(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#w(e){this.#d&&(this.#x({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}#S(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#v(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#s}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#d},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#d},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#d),this.#c&&(this.#c.style.clipPath=this.#s))}static#E([e,t,s,r],i){switch(i){case 90:return[1-t-r,e,r,s];case 180:return[1-e-s,1-t-r,s,r];case 270:return[t,1-e-s,r,s]}return[e,t,s,r]}rotate(e){const{drawLayer:t}=this.parent;let s;this.#d?(e=(e-this.rotation+360)%360,s=Ft.#E(this.#l.box,e)):s=Ft.#E([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:s,root:{"data-main-rotation":e}}),t.updateProperties(this.#m,{bbox:Ft.#E(this.#i.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#u&&(e.setAttribute("aria-label",this.#u),e.setAttribute("role","mark")),this.#d?e.classList.add("free"):this.div.addEventListener("keydown",this.#I.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#s,this.setDims(),IN(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#I(e){Ft._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#T(!0);break;case 1:case 3:this.#T(!1);break}}#T(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#r,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#d||this.#T(!1))}get _mustFixPosition(){return!this.#d}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!e}}))}#C(){return this.#d?this.rotation:0}#O(){if(this.#d)return null;const[e,t]=this.pageDimensions,[s,r]=this.pageTranslation,i=this.#n,o=new Float32Array(i.length*8);let u=0;for(const{x:d,y:h,width:p,height:m}of i){const x=d*e+s,v=(1-h)*t+r;o[u]=o[u+4]=x,o[u+1]=o[u+3]=v,o[u+2]=o[u+6]=x+p*e,o[u+5]=o[u+7]=v-m*t,u+=8}return o}#j(e){return this.#l.serialize(e,this.#C())}static startHighlighting(e,t,{target:s,x:r,y:i}){const{x:o,y:u,width:d,height:h}=s.getBoundingClientRect(),p=new AbortController,m=e.combinedSignal(p),x=v=>{p.abort(),this.#F(e,v)};window.addEventListener("blur",x,{signal:m}),window.addEventListener("pointerup",x,{signal:m}),window.addEventListener("pointerdown",Pt,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Pn,{signal:m}),s.addEventListener("pointermove",this.#D.bind(this,e),{signal:m}),this._freeHighlight=new w0({x:r,y:i},[o,u,d,h],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#D(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,s){let r=null;if(e instanceof QN){const{data:{quadPoints:w,rect:E,rotation:N,id:A,color:T,opacity:I,popupRef:P,richText:U,contentsObj:O,creationDate:R,modificationDate:C},parent:{page:{pageNumber:D}}}=e;r=e={annotationType:qe.HIGHLIGHT,color:Array.from(T),opacity:I,quadPoints:w,boxes:null,pageIndex:D-1,rect:E.slice(0),rotation:N,annotationElementId:A,id:A,deleted:!1,popupRef:P,richText:U,comment:O?.str||null,creationDate:R,modificationDate:C}}else if(e instanceof Xy){const{data:{inkLists:w,rect:E,rotation:N,id:A,color:T,borderStyle:{rawWidth:I},popupRef:P,richText:U,contentsObj:O,creationDate:R,modificationDate:C},parent:{page:{pageNumber:D}}}=e;r=e={annotationType:qe.HIGHLIGHT,color:Array.from(T),thickness:I,inkLists:w,boxes:null,pageIndex:D-1,rect:E.slice(0),rotation:N,annotationElementId:A,id:A,deleted:!1,popupRef:P,richText:U,comment:O?.str||null,creationDate:R,modificationDate:C}}const{color:i,quadPoints:o,inkLists:u,opacity:d}=e,h=await super.deserialize(e,t,s);h.color=we.makeHexColor(...i),h.opacity=d||1,u&&(h.#p=e.thickness),h._initialData=r,e.comment&&h.setCommentData(e);const[p,m]=h.pageDimensions,[x,v]=h.pageTranslation;if(o){const w=h.#n=[];for(let E=0;E<o.length;E+=8)w.push({x:(o[E]-x)/p,y:1-(o[E+1]-v)/m,width:(o[E+2]-o[E])/p,height:(o[E+1]-o[E+5])/m});h.#b(),h.#v(),h.rotate(h.rotation)}else if(u){h.#d=!0;const w=u[0],E={x:w[0]-x,y:m-(w[1]-v)},N=new w0(E,[0,0,p,m],1,h.#p/2,!0,.001);for(let I=0,P=w.length;I<P;I+=2)E.x=w[I]-x,E.y=m-(w[I+1]-v),N.add(E);const{id:A,clipPathId:T}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:N.toSVGPath()}},!0,!0);h.#x({highlightOutlines:N.getOutlines(),highlightId:A,clipPathId:T}),h.#v(),h.rotate(h.parentRotation)}return h}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=Ie._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(e);return Object.assign(s,{color:t,opacity:this.opacity,thickness:this.#p,quadPoints:this.#O(),outlines:this.#j(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#M(s)?null:(s.id=this.annotationElementId,s)}#M(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((s,r)=>s!==t[r])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class eA{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){ft("Not implemented")}}class at extends Ie{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#s=null;static#a=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#i(e),this.#c())}#i({drawOutlines:e,drawId:t,drawingOptions:s}){this.#e=e,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#r(e,this.parent),this.#d(e.box)}#r(e,t){const{id:s}=t.drawLayer.draw(at._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(e,t){const s=new Set(Object.keys(e));for(const[r,i]of Object.entries(t))s.has(r)?Object.assign(e[r],i):e[r]=i;return e}static getDefaultDrawingOptions(e){ft("Not implemented")}static get typesMap(){ft("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,t),this._currentParent&&(at.#n.updateProperty(s,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)e.push([s,t[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[s,r]of this.constructor.typesMap)e.push([s,t[r]]);return e}_updateProperty(e,t,s){const r=this._drawingOptions,i=r[t],o=u=>{r.updateProperty(t,u);const d=this.#e.updateProperty(t,u);d&&this.#d(d),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,at._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#h()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,at._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#h()),{bbox:this.#f()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,at._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#h(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#d(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#o()):e&&(this._uiManager.addShouldRescale(this),this.#c(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#r(this.#e,e)}}#l([e,t,s,r]){const{parentDimensions:[i,o],rotation:u}=this;switch(u){case 90:return[t,1-e,s*(o/i),r*(i/o)];case 180:return[1-e,1-t,s,r];case 270:return[1-t,e,s*(o/i),r*(i/o)];default:return[e,t,s,r]}}#h(){const{x:e,y:t,width:s,height:r,parentDimensions:[i,o],rotation:u}=this;switch(u){case 90:return[1-t,e,s*(i/o),r*(o/i)];case 180:return[1-e,1-t,s,r];case 270:return[t,1-e,s*(i/o),r*(o/i)];default:return[e,t,s,r]}}#d(e){[this.x,this.y,this.width,this.height]=this.#l(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:e,y:t,width:s,height:r,rotation:i,parentRotation:o,parentDimensions:[u,d]}=this;switch((i*4+o)/90){case 1:return[1-t-r,e,r,s];case 2:return[1-e-s,1-t-r,s,r];case 3:return[t,1-e-s,r,s];case 4:return[e,t-s*(u/d),r*(d/u),s*(u/d)];case 5:return[1-t,e,s*(u/d),r*(d/u)];case 6:return[1-e-r*(d/u),1-t,r*(d/u),s*(u/d)];case 7:return[t-s*(u/d),1-e-r*(d/u),s*(u/d),r*(d/u)];case 8:return[e-s,t-r,s,r];case 9:return[1-t,e-s,r,s];case 10:return[1-e,1-t,s,r];case 11:return[t-r,1-e,r,s];case 12:return[e-r*(d/u),t,r*(d/u),s*(u/d)];case 13:return[1-t-s*(u/d),e-r*(d/u),s*(u/d),r*(d/u)];case 14:return[1-e,1-t-s*(u/d),r*(d/u),s*(u/d)];case 15:return[t,1-e,s*(u/d),r*(d/u)];default:return[e,t,s,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,at._mergeSVGProperties({bbox:this.#f()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#d(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");return s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),s}static createDrawerInstance(e,t,s,r,i){ft("Not implemented")}static startDrawing(e,t,s,r){const{target:i,offsetX:o,offsetY:u,pointerId:d,pointerType:h}=r;if(ot.isInitializedAndDifferentPointerType(h))return;const{viewport:{rotation:p}}=e,{width:m,height:x}=i.getBoundingClientRect(),v=at.#s=new AbortController,w=e.combinedSignal(v);if(ot.setPointer(h,d),window.addEventListener("pointerup",E=>{ot.isSamePointerIdOrRemove(E.pointerId)&&this._endDraw(E)},{signal:w}),window.addEventListener("pointercancel",E=>{ot.isSamePointerIdOrRemove(E.pointerId)&&this._currentParent.endDrawingSession()},{signal:w}),window.addEventListener("pointerdown",E=>{ot.isSamePointerType(E.pointerType)&&(ot.initializeAndAddPointerId(E.pointerId),at.#n.isCancellable()&&(at.#n.removeLastElement(),at.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Pn,{signal:w}),i.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),i.addEventListener("touchmove",E=>{ot.isSameTimeStamp(E.timeStamp)&&Pt(E)},{signal:w}),e.toggleDrawing(),t._editorUndoBar?.hide(),at.#n){e.drawLayer.updateProperties(this._currentDrawId,at.#n.startNew(o,u,m,x,p));return}t.updateUIForDefaultProperties(this),at.#n=this.createDrawerInstance(o,u,m,x,p),at.#a=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(at.#a.toSVGProperties(),at.#n.defaultSVGProperties),!0,!1)}static _drawMove(e){if(ot.isSameTimeStamp(e.timeStamp),!at.#n)return;const{offsetX:t,offsetY:s,pointerId:r}=e;if(ot.isSamePointerId(r)){if(ot.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,at.#n.add(t,s)),ot.setTimeStamp(e.timeStamp),Pt(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,at.#n=null,at.#a=null,ot.clearPointerType(),ot.clearTimeStamp()),at.#s&&(at.#s.abort(),at.#s=null,ot.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,at.#n.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const s=at.#n,r=this._currentDrawId,i=s.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(r,s.setLastElement(i))},undo:()=>{t.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Ze.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Ze.DRAW_STEP),!at.#n.isEmpty()){const{pageDimensions:[s,r],scale:i}=t,o=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:at.#n.getOutlines(s*i,r*i,i,this._INNER_MARGIN),drawingOptions:at.#a,mustBeCommitted:!e});return this._cleanup(!0),o}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,s,r,i,o){ft("Not implemented")}static async deserialize(e,t,s){const{rawDims:{pageWidth:r,pageHeight:i,pageX:o,pageY:u}}=t.viewport,d=this.deserializeDraw(o,u,r,i,this._INNER_MARGIN,e),h=await super.deserialize(e,t,s);return h.createDrawingOptions(e),h.#i({drawOutlines:d}),h.#c(),h.onScaleChanging(),h.rotate(),h}serializeDraw(e){const[t,s]=this.pageTranslation,[r,i]=this.pageDimensions;return this.#e.serialize([t,s,r,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class H5{#e=new Float64Array(6);#t;#n;#s;#a;#i;#r="";#o=0;#c=new od;#l;#h;constructor(e,t,s,r,i,o){this.#l=s,this.#h=r,this.#s=i,this.#a=o,[e,t]=this.#d(e,t);const u=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t],this.#n=[{line:u,points:this.#i}],this.#e.set(u,0)}updateProperty(e,t){e==="stroke-width"&&(this.#a=t)}#d(e,t){return ve._normalizePoint(e,t,this.#l,this.#h,this.#s)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#i.length<=10}add(e,t){[e,t]=this.#d(e,t);const[s,r,i,o]=this.#e.subarray(2,6),u=e-i,d=t-o;return Math.hypot(this.#l*u,this.#h*d)<=2?null:(this.#i.push(e,t),isNaN(s)?(this.#e.set([i,o,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([s,r,i,o,e,t],0),this.#t.push(...ve.createBezierPoints(s,r,i,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,r,i){this.#l=s,this.#h=r,this.#s=i,[e,t]=this.#d(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:o,points:this.#i}),this.#e.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(e){return this.#n?(this.#n.push(e),this.#t=e.line,this.#i=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#r="";for(let e=0,t=this.#n.length;e<t;e++){const{line:s,points:r}=this.#n[e];this.#t=s,this.#i=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const e=ve.svgRound(this.#t[4]),t=ve.svgRound(this.#t[5]);if(this.#i.length===2)return this.#r=`${this.#r} M ${e} ${t} Z`,this.#r;if(this.#i.length<=6){const r=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,r)} M ${e} ${t}`,this.#o=6}if(this.#i.length===4){const r=ve.svgRound(this.#t[10]),i=ve.svgRound(this.#t[11]);return this.#r=`${this.#r} L ${r} ${i}`,this.#o=12,this.#r}const s=[];this.#o===0&&(s.push(`M ${e} ${t}`),this.#o=6);for(let r=this.#o,i=this.#t.length;r<i;r+=6){const[o,u,d,h,p,m]=this.#t.slice(r,r+6).map(ve.svgRound);s.push(`C${o} ${u} ${d} ${h} ${p} ${m}`)}return this.#r+=s.join(" "),this.#o=this.#t.length,this.#r}getOutlines(e,t,s,r){const i=this.#n.at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),this.#c.build(this.#n,e,t,s,this.#s,this.#a,r),this.#e=null,this.#t=null,this.#n=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class od extends ve{#e;#t=0;#n;#s;#a;#i;#r;#o;#c;build(e,t,s,r,i,o,u){this.#a=t,this.#i=s,this.#r=r,this.#o=i,this.#c=o,this.#n=u??0,this.#s=e,this.#d()}get thickness(){return this.#c}setLastElement(e){return this.#s.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#s.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#s){if(e.push(`M${ve.svgRound(t[4])} ${ve.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${ve.svgRound(t[10])} ${ve.svgRound(t[11])}`);continue}for(let s=6,r=t.length;s<r;s+=6){const[i,o,u,d,h,p]=t.subarray(s,s+6).map(ve.svgRound);e.push(`C${i} ${o} ${u} ${d} ${h} ${p}`)}}return e.join("")}serialize([e,t,s,r],i){const o=[],u=[],[d,h,p,m]=this.#h();let x,v,w,E,N,A,T,I,P;switch(this.#o){case 0:P=ve._rescale,x=e,v=t+r,w=s,E=-r,N=e+d*s,A=t+(1-h-m)*r,T=e+(d+p)*s,I=t+(1-h)*r;break;case 90:P=ve._rescaleAndSwap,x=e,v=t,w=s,E=r,N=e+h*s,A=t+d*r,T=e+(h+m)*s,I=t+(d+p)*r;break;case 180:P=ve._rescale,x=e+s,v=t,w=-s,E=r,N=e+(1-d-p)*s,A=t+h*r,T=e+(1-d)*s,I=t+(h+m)*r;break;case 270:P=ve._rescaleAndSwap,x=e+s,v=t+r,w=-s,E=-r,N=e+(1-h-m)*s,A=t+(1-d-p)*r,T=e+(1-h)*s,I=t+(1-d)*r;break}for(const{line:U,points:O}of this.#s)o.push(P(U,x,v,w,E,i?new Array(U.length):null)),u.push(P(O,x,v,w,E,i?new Array(O.length):null));return{lines:o,points:u,rect:[N,A,T,I]}}static deserialize(e,t,s,r,i,{paths:{lines:o,points:u},rotation:d,thickness:h}){const p=[];let m,x,v,w,E;switch(d){case 0:E=ve._rescale,m=-e/s,x=t/r+1,v=1/s,w=-1/r;break;case 90:E=ve._rescaleAndSwap,m=-t/r,x=-e/s,v=1/r,w=1/s;break;case 180:E=ve._rescale,m=e/s+1,x=-t/r,v=-1/s,w=1/r;break;case 270:E=ve._rescaleAndSwap,m=t/r+1,x=e/s+1,v=-1/r,w=-1/s;break}if(!o){o=[];for(const A of u){const T=A.length;if(T===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1]]));continue}if(T===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1],NaN,NaN,NaN,NaN,A[2],A[3]]));continue}const I=new Float32Array(3*(T-2));o.push(I);let[P,U,O,R]=A.subarray(0,4);I.set([NaN,NaN,NaN,NaN,P,U],0);for(let C=4;C<T;C+=2){const D=A[C],B=A[C+1];I.set(ve.createBezierPoints(P,U,O,R,D,B),(C-2)*3),[P,U,O,R]=[O,R,D,B]}}}for(let A=0,T=o.length;A<T;A++)p.push({line:E(o[A].map(I=>I??NaN),m,x,v,w),points:E(u[A].map(I=>I??NaN),m,x,v,w)});const N=new this.prototype.constructor;return N.build(p,s,r,1,d,h,i),N}#l(e=this.#c){const t=this.#n+e/2*this.#r;return this.#o%180===0?[t/this.#a,t/this.#i]:[t/this.#i,t/this.#a]}#h(){const[e,t,s,r]=this.#e,[i,o]=this.#l(0);return[e+i,t+o,s-2*i,r-2*o]}#d(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#s){if(r.length<=12){for(let u=4,d=r.length;u<d;u+=6)we.pointBoundingBox(r[u],r[u+1],e);continue}let i=r[4],o=r[5];for(let u=6,d=r.length;u<d;u+=6){const[h,p,m,x,v,w]=r.subarray(u,u+6);we.bezierBoundingBox(i,o,h,p,m,x,v,w,e),i=v,o=w}}const[t,s]=this.#l();e[0]=Os(e[0]-t,0,1),e[1]=Os(e[1]-s,0,1),e[2]=Os(e[2]+t,0,1),e[3]=Os(e[3]+s,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,s]=this.#l();this.#c=e;const[r,i]=this.#l(),[o,u]=[r-t,i-s],d=this.#e;return d[0]-=o,d[1]-=u,d[2]+=2*o,d[3]+=2*u,d}updateParentDimensions([e,t],s){const[r,i]=this.#l();this.#a=e,this.#i=t,this.#r=s;const[o,u]=this.#l(),d=o-r,h=u-i,p=this.#e;return p[0]-=d,p[1]-=h,p[2]+=2*d,p[3]+=2*h,p}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(ve.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let s=0,r=0,i=0,o=0,u=0,d=0;switch(this.#t){case 90:r=t/e,i=-e/t,u=e;break;case 180:s=-1,o=-1,u=e,d=t;break;case 270:r=-t/e,i=e/t,d=t;break;default:return""}return`matrix(${s} ${r} ${i} ${o} ${ve.svgRound(u)} ${ve.svgRound(d)})`}getPathResizingSVGProperties([e,t,s,r]){const[i,o]=this.#l(),[u,d,h,p]=this.#e;if(Math.abs(h-i)<=ve.PRECISION||Math.abs(p-o)<=ve.PRECISION){const E=e+s/2-(u+h/2),N=t+r/2-(d+p/2);return{path:{"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`,transform:`${this.rotationTransform} translate(${E} ${N})`}}}const m=(s-2*i)/(h-2*i),x=(r-2*o)/(p-2*o),v=h/s,w=p/r;return{path:{"transform-origin":`${ve.svgRound(u)} ${ve.svgRound(d)}`,transform:`${this.rotationTransform} scale(${v} ${w}) translate(${ve.svgRound(i)} ${ve.svgRound(o)}) scale(${m} ${x}) translate(${ve.svgRound(-i)} ${ve.svgRound(-o)})`}}}getPathResizedSVGProperties([e,t,s,r]){const[i,o]=this.#l(),u=this.#e,[d,h,p,m]=u;if(u[0]=e,u[1]=t,u[2]=s,u[3]=r,Math.abs(p-i)<=ve.PRECISION||Math.abs(m-o)<=ve.PRECISION){const N=e+s/2-(d+p/2),A=t+r/2-(h+m/2);for(const{line:T,points:I}of this.#s)ve._translate(T,N,A,T),ve._translate(I,N,A,I);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const x=(s-2*i)/(p-2*i),v=(r-2*o)/(m-2*o),w=-x*(d+i)+e+i,E=-v*(h+o)+t+o;if(x!==1||v!==1||w!==0||E!==0)for(const{line:N,points:A}of this.#s)ve._rescale(N,w,E,x,v,N),ve._rescale(A,w,E,x,v,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],s){const[r,i]=s,o=this.#e,u=e-o[0],d=t-o[1];if(this.#a===r&&this.#i===i)for(const{line:h,points:p}of this.#s)ve._translate(h,u,d,h),ve._translate(p,u,d,p);else{const h=this.#a/r,p=this.#i/i;this.#a=r,this.#i=i;for(const{line:m,points:x}of this.#s)ve._rescale(m,u,d,h,p,m),ve._rescale(x,u,d,h,p,x);o[2]*=h,o[3]*=p}return o[0]=e,o[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(e[0])} ${ve.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class vp extends eA{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ie._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new vp(this._viewParameters);return e.updateAll(this),e}}class Jy extends at{static _type="ink";static _editorType=qe.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){Ie.initialize(e,t),this._defaultDrawingOptions=new vp(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return $e(this,"typesMap",new Map([[Ze.INK_THICKNESS,"stroke-width"],[Ze.INK_COLOR,"stroke"],[Ze.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,s,r,i){return new H5(e,t,s,r,i,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,s,r,i,o){return od.deserialize(e,t,s,r,i,o)}static async deserialize(e,t,s){let r=null;if(e instanceof Xy){const{data:{inkLists:o,rect:u,rotation:d,id:h,color:p,opacity:m,borderStyle:{rawWidth:x},popupRef:v,richText:w,contentsObj:E,creationDate:N,modificationDate:A},parent:{page:{pageNumber:T}}}=e;r=e={annotationType:qe.INK,color:Array.from(p),thickness:x,opacity:m,paths:{points:o},boxes:null,pageIndex:T-1,rect:u.slice(0),rotation:d,annotationElementId:h,id:h,deleted:!1,popupRef:v,richText:w,comment:E?.str||null,creationDate:N,modificationDate:A}}const i=await super.deserialize(e,t,s);return i._initialData=r,e.comment&&i.setCommentData(e),i}get toolbarButtons(){return this._colorPicker||=new Mu(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ze.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:s}=this;t.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:s}){this._drawingOptions=Jy.getDefaultDrawingOptions({stroke:we.makeHexColor(...e),"stroke-width":t,"stroke-opacity":s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:s}=this.serializeDraw(e),{_drawingOptions:{stroke:r,"stroke-opacity":i,"stroke-width":o}}=this,u=Object.assign(super.serialize(e),{color:Ie._colorManager.convert(r),opacity:i,thickness:o,paths:{lines:t,points:s}});return this.addComment(u),e?(u.isCopy=!0,u):this.annotationElementId&&!this.#e(u)?null:(u.id=this.annotationElementId,u)}#e(e){const{color:t,thickness:s,opacity:r,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((o,u)=>o!==t[u])||e.thickness!==s||e.opacity!==r||e.pageIndex!==i}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class _0 extends od{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const $h=8,eu=3;class yl{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,s,r){return s-=e,r-=t,s===0?r>0?0:4:s===1?r+6:2-r}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#s(e,t,s,r,i,o,u){const d=this.#t(s,r,i,o);for(let h=0;h<8;h++){const p=(-h+d-u+16)%8,m=this.#n[2*p],x=this.#n[2*p+1];if(e[(s+m)*t+(r+x)]!==0)return p}return-1}static#a(e,t,s,r,i,o,u){const d=this.#t(s,r,i,o);for(let h=0;h<8;h++){const p=(h+d+u+16)%8,m=this.#n[2*p],x=this.#n[2*p+1];if(e[(s+m)*t+(r+x)]!==0)return p}return-1}static#i(e,t,s,r){const i=e.length,o=new Int32Array(i);for(let p=0;p<i;p++)o[p]=e[p]<=r?1:0;for(let p=1;p<s-1;p++)o[p*t]=o[p*t+t-1]=0;for(let p=0;p<t;p++)o[p]=o[t*s-1-p]=0;let u=1,d;const h=[];for(let p=1;p<s-1;p++){d=1;for(let m=1;m<t-1;m++){const x=p*t+m,v=o[x];if(v===0)continue;let w=p,E=m;if(v===1&&o[x-1]===0)u+=1,E-=1;else if(v>=1&&o[x+1]===0)u+=1,E+=1,v>1&&(d=v);else{v!==1&&(d=Math.abs(v));continue}const N=[m,p],A=E===m+1,T={isHole:A,points:N,id:u,parent:0};h.push(T);let I;for(const V of h)if(V.id===d){I=V;break}I?I.isHole?T.parent=A?I.parent:d:T.parent=A?d:I.parent:T.parent=A?d:0;const P=this.#s(o,t,p,m,w,E,0);if(P===-1){o[x]=-u,o[x]!==1&&(d=Math.abs(o[x]));continue}let U=this.#n[2*P],O=this.#n[2*P+1];const R=p+U,C=m+O;w=R,E=C;let D=p,B=m;for(;;){const V=this.#a(o,t,D,B,w,E,1);U=this.#n[2*V],O=this.#n[2*V+1];const $=D+U,L=B+O;N.push(L,$);const de=D*t+B;if(o[de+1]===0?o[de]=-u:o[de]===1&&(o[de]=u),$===p&&L===m&&D===R&&B===C){o[x]!==1&&(d=Math.abs(o[x]));break}else w=D,E=B,D=$,B=L}}}return h}static#r(e,t,s,r){if(s-t<=4){for(let R=t;R<s-2;R+=2)r.push(e[R],e[R+1]);return}const i=e[t],o=e[t+1],u=e[s-4]-i,d=e[s-3]-o,h=Math.hypot(u,d),p=u/h,m=d/h,x=p*o-m*i,v=d/u,w=1/h,E=Math.atan(v),N=Math.cos(E),A=Math.sin(E),T=w*(Math.abs(N)+Math.abs(A)),I=w*(1-T+T**2),P=Math.max(Math.atan(Math.abs(A+N)*I),Math.atan(Math.abs(A-N)*I));let U=0,O=t;for(let R=t+2;R<s-2;R+=2){const C=Math.abs(x-p*e[R+1]+m*e[R]);C>U&&(O=R,U=C)}U>(h*P)**2?(this.#r(e,t,O+2,r),this.#r(e,O,s,r)):r.push(i,o)}static#o(e){const t=[],s=e.length;return this.#r(e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t}static#c(e,t,s,r,i,o){const u=new Float32Array(o**2),d=-2*r**2,h=o>>1;for(let E=0;E<o;E++){const N=(E-h)**2;for(let A=0;A<o;A++)u[E*o+A]=Math.exp((N+(A-h)**2)/d)}const p=new Float32Array(256),m=-2*i**2;for(let E=0;E<256;E++)p[E]=Math.exp(E**2/m);const x=e.length,v=new Uint8Array(x),w=new Uint32Array(256);for(let E=0;E<s;E++)for(let N=0;N<t;N++){const A=E*t+N,T=e[A];let I=0,P=0;for(let O=0;O<o;O++){const R=E+O-h;if(!(R<0||R>=s))for(let C=0;C<o;C++){const D=N+C-h;if(D<0||D>=t)continue;const B=e[R*t+D],V=u[O*o+C]*p[Math.abs(B-T)];I+=B*V,P+=V}}const U=v[A]=Math.round(I/P);w[U]++}return[v,w]}static#l(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t}static#h(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let r=-1/0,i=1/0;for(let u=0,d=s.length;u<d;u++){const h=s[u]=e[u<<2];r=Math.max(r,h),i=Math.min(i,h)}const o=255/(r-i);for(let u=0,d=s.length;u<d;u++)s[u]=(s[u]-i)*o;return s}static#d(e){let t,s=-1/0,r=-1/0;const i=e.findIndex(d=>d!==0);let o=i,u=i;for(t=i;t<256;t++){const d=e[t];d>s&&(t-o>r&&(r=t-o,u=t-1),s=d,o=t)}for(t=u-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:s,height:r}=e,{maxDim:i}=this.#e;let o=s,u=r;if(s>i||r>i){let x=s,v=r,w=Math.log2(Math.max(s,r)/i);const E=Math.floor(w);w=w===E?E-1:E;for(let A=0;A<w;A++){o=Math.ceil(x/2),u=Math.ceil(v/2);const T=new OffscreenCanvas(o,u);T.getContext("2d").drawImage(e,0,0,x,v,0,0,o,u),x=o,v=u,e!==t&&e.close(),e=T.transferToImageBitmap()}const N=Math.min(i/o,i/u);o=Math.round(o*N),u=Math.round(u*N)}const h=new OffscreenCanvas(o,u).getContext("2d",{willReadFrequently:!0});h.fillStyle="white",h.fillRect(0,0,o,u),h.filter="grayscale(1)",h.drawImage(e,0,0,e.width,e.height,0,0,o,u);const p=h.getImageData(0,0,o,u).data;return[this.#h(p),o,u]}static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:r},i,o,u,d){let h=new OffscreenCanvas(1,1),p=h.getContext("2d",{alpha:!1});const m=200,x=p.font=`${s} ${r} ${m}px ${t}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:w,actualBoundingBoxAscent:E,actualBoundingBoxDescent:N,fontBoundingBoxAscent:A,fontBoundingBoxDescent:T,width:I}=p.measureText(e),P=1.5,U=Math.ceil(Math.max(Math.abs(v)+Math.abs(w)||0,I)*P),O=Math.ceil(Math.max(Math.abs(E)+Math.abs(N)||m,Math.abs(A)+Math.abs(T)||m)*P);h=new OffscreenCanvas(U,O),p=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=x,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,U,O),p.fillStyle="black",p.fillText(e,U*(P-1)/2,O*(3-P)/2);const R=this.#h(p.getImageData(0,0,U,O).data),C=this.#l(R),D=this.#d(C),B=this.#i(R,U,O,D);return this.processDrawnLines({lines:{curves:B,width:U,height:O},pageWidth:i,pageHeight:o,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(e,t,s,r,i){const[o,u,d]=this.#f(e),[h,p]=this.#c(o,u,d,Math.hypot(u,d)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),m=this.#d(p),x=this.#i(h,u,d,m);return this.processDrawnLines({lines:{curves:x,width:u,height:d},pageWidth:t,pageHeight:s,rotation:r,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:r,innerMargin:i,mustSmooth:o,areContours:u}){r%180!==0&&([t,s]=[s,t]);const{curves:d,width:h,height:p}=e,m=e.thickness??0,x=[],v=Math.min(t/h,s/p),w=v/t,E=v/s,N=[];for(const{points:T}of d){const I=o?this.#o(T):T;if(!I)continue;N.push(I);const P=I.length,U=new Float32Array(P),O=new Float32Array(3*(P===2?2:P-2));if(x.push({line:O,points:U}),P===2){U[0]=I[0]*w,U[1]=I[1]*E,O.set([NaN,NaN,NaN,NaN,U[0],U[1]],0);continue}let[R,C,D,B]=I;R*=w,C*=E,D*=w,B*=E,U.set([R,C,D,B],0),O.set([NaN,NaN,NaN,NaN,R,C],0);for(let V=4;V<P;V+=2){const $=U[V]=I[V]*w,L=U[V+1]=I[V+1]*E;O.set(ve.createBezierPoints(R,C,D,B,$,L),(V-2)*3),[R,C,D,B]=[D,B,$,L]}}if(x.length===0)return null;const A=u?new _0:new od;return A.build(x,t,s,1,r,u?0:m,i),{outline:A,newCurves:N,areContours:u,thickness:m,width:h,height:p}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:r,height:i}){let o=1/0,u=-1/0,d=0;for(const I of e){d+=I.length;for(let P=2,U=I.length;P<U;P++){const O=I[P]-I[P-2];o=Math.min(o,O),u=Math.max(u,O)}}let h;o>=-128&&u<=127?h=Int8Array:o>=-32768&&u<=32767?h=Int16Array:h=Int32Array;const p=e.length,m=$h+eu*p,x=new Uint32Array(m);let v=0;x[v++]=m*Uint32Array.BYTES_PER_ELEMENT+(d-2*p)*h.BYTES_PER_ELEMENT,x[v++]=0,x[v++]=r,x[v++]=i,x[v++]=t?0:1,x[v++]=Math.max(0,Math.floor(s??0)),x[v++]=p,x[v++]=h.BYTES_PER_ELEMENT;for(const I of e)x[v++]=I.length-2,x[v++]=I[0],x[v++]=I[1];const w=new CompressionStream("deflate-raw"),E=w.writable.getWriter();await E.ready,E.write(x);const N=h.prototype.constructor;for(const I of e){const P=new N(I.length-2);for(let U=2,O=I.length;U<O;U++)P[U-2]=I[U]-I[U-2];E.write(P)}E.close();const A=await new Response(w.readable).arrayBuffer(),T=new Uint8Array(A);return AN(T)}static async decompressSignature(e){try{const t=oO(e),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),i=r.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let o=null,u=0;for await(const I of s)o||=new Uint8Array(new Uint32Array(I.buffer,0,4)[0]),o.set(I,u),u+=I.length;const d=new Uint32Array(o.buffer,0,o.length>>2),h=d[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const p=d[2],m=d[3],x=d[4]===0,v=d[5],w=d[6],E=d[7],N=[],A=($h+eu*w)*Uint32Array.BYTES_PER_ELEMENT;let T;switch(E){case Int8Array.BYTES_PER_ELEMENT:T=new Int8Array(o.buffer,A);break;case Int16Array.BYTES_PER_ELEMENT:T=new Int16Array(o.buffer,A);break;case Int32Array.BYTES_PER_ELEMENT:T=new Int32Array(o.buffer,A);break}u=0;for(let I=0;I<w;I++){const P=d[eu*I+$h],U=new Float32Array(P+2);N.push(U);for(let O=0;O<eu-1;O++)U[O]=d[eu*I+$h+O+1];for(let O=0;O<P;O++)U[O+2]=U[O]+T[u++]}return{areContours:x,thickness:v,outlines:N,width:p,height:m}}catch(t){return ze(`decompressSignature: ${t}`),null}}}class Zy extends eA{constructor(){super(),super.updateProperties({fill:Ie._defaultLineColor,"stroke-width":0})}clone(){const e=new Zy;return e.updateAll(this),e}}class ex extends vp{constructor(e){super(e),super.updateProperties({stroke:Ie._defaultLineColor,"stroke-width":1})}clone(){const e=new ex(this._viewParameters);return e.updateAll(this),e}}class xr extends at{#e=!1;#t=null;#n=null;#s=null;static _type="signature";static _editorType=qe.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){Ie.initialize(e,t),this._defaultDrawingOptions=new Zy,this._defaultDrawnSignatureOptions=new ex(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return $e(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:r,mustSmooth:i,areContours:o,description:u,uuid:d,heightInPage:h}=this.#n,{rawDims:{pageWidth:p,pageHeight:m},rotation:x}=this.parent.viewport,v=yl.processDrawnLines({lines:r,pageWidth:p,pageHeight:m,rotation:x,innerMargin:xr._INNER_MARGIN,mustSmooth:i,areContours:o});this.addSignature(v,h,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#s=e,this.addEditToolbar()}getUuid(){return this.#s}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:s,width:r,height:i}=this.#n,o=Math.max(r,i),u=yl.processDrawnLines({lines:{curves:e.map(d=>({points:d})),thickness:s,width:r,height:i},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,s,r){const{x:i,y:o}=this,{outline:u}=this.#n=e;this.#e=u instanceof _0,this.description=s;let d;this.#e?d=xr.getDefaultDrawingOptions():(d=xr._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,h]=this.pageDimensions;let p=t/h;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=i,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:s},rotation:r}=this.parent.viewport;return yl.process(e,t,s,r,xr._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:s,pageHeight:r},rotation:i}=this.parent.viewport;return yl.extractContoursFromText(e,t,s,r,i,xr._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:s},rotation:r}=this.parent.viewport;return yl.processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:r,innerMargin:xr._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=xr.getDefaultDrawingOptions():(this._drawingOptions=xr._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:s}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":r}}=this,i=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:r});return this.addComment(i),e?(i.paths={lines:t,points:s},i.uuid=this.#s,i.isCopy=!0):i.lines=t,this.#t&&(i.accessibilityData={type:"Figure",alt:this.#t}),i}static deserializeDraw(e,t,s,r,i,o){return o.areContours?_0.deserialize(e,t,s,r,i,o):od.deserialize(e,t,s,r,i,o)}static async deserialize(e,t,s){const r=await super.deserialize(e,t,s);return r.#e=e.areContours,r.description=e.accessibilityData?.alt||"",r.#s=e.uuid,r}}class q5 extends Ie{#e=null;#t=null;#n=null;#s=null;#a=null;#i="";#r=null;#o=!1;#c=null;#l=!1;#h=!1;static _type="stamp";static _editorType=qe.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#s=e.bitmapUrl,this.#a=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){Ie.initialize(e,t)}static isHandlingMimeForPasting(e){return f0.includes(e)}static paste(e,t){t.pasteEditor({mode:qe.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#d(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#i=e.file.name),this.#m()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:i,height:o}=e||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:r,width:i,height:o,channels:r.length/(i*o)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),t&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#g(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(s=>this.#d(s,!0)).finally(()=>this.#f());return}if(this.#s){const s=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#d(r)).finally(()=>this.#f());return}if(this.#a){const s=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(r=>this.#d(r)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=f0.join(",");const t=this._uiManager._signal;this.#n=new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#d(r)}s()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#g();return}super.rebuild(),this.div!==null&&(this.#t&&this.#r===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#s||this.#a||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#t=s,r&&(this.#e=r),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},e)}#m(){const{div:e}=this;let{width:t,height:s}=this.#e;const[r,i]=this.pageDimensions,o=.75;if(this.width)t=this.width*r,s=this.height*i;else if(t>o*r||s>o*i){const d=Math.min(o*r/t,o*i/s);t*=d,s*=d}this._uiManager.enableWaiting(!1);const u=this.#r=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=t/r,this.height=s/i,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#p(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&this.div.setAttribute("aria-description",this.#i),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,s=!1){e||(e=224);const{width:r,height:i}=this.#e,o=new Cr;let u=this.#e,d=r,h=i,p=null;if(t){if(r>t||i>t){const O=Math.min(t/r,t/i);d=Math.floor(r*O),h=Math.floor(i*O)}p=document.createElement("canvas");const x=p.width=Math.ceil(d*o.sx),v=p.height=Math.ceil(h*o.sy);this.#l||(u=this.#u(x,v));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let E="white",N="#cfcfd8";this._uiManager.hcmFilter!=="none"?N="black":fO.isDarkMode&&(E="#8f8f9d",N="#42414d");const A=15,T=A*o.sx,I=A*o.sy,P=new OffscreenCanvas(T*2,I*2),U=P.getContext("2d");U.fillStyle=E,U.fillRect(0,0,T*2,I*2),U.fillStyle=N,U.fillRect(0,0,T,I),U.fillRect(T,I,T,I),w.fillStyle=w.createPattern(P,"repeat"),w.fillRect(0,0,x,v),w.drawImage(u,0,0,u.width,u.height,0,0,x,v)}let m=null;if(s){let x,v;if(o.symmetric&&u.width<e&&u.height<e)x=u.width,v=u.height;else if(u=this.#e,r>e||i>e){const N=Math.min(e/r,e/i);x=Math.floor(r*N),v=Math.floor(i*N),this.#l||(u=this.#u(x,v))}const E=new OffscreenCanvas(x,v).getContext("2d",{willReadFrequently:!0});E.drawImage(u,0,0,u.width,u.height,0,0,x,v),m={width:x,height:v,data:E.getImageData(0,0,x,v).data}}return{canvas:p,width:d,height:h,imageData:m}}#u(e,t){const{width:s,height:r}=this.#e;let i=s,o=r,u=this.#e;for(;i>2*e||o>2*t;){const d=i,h=o;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(i,o);p.getContext("2d").drawImage(u,0,0,d,h,0,0,i,o),u=p.transferToImageBitmap()}return u}#p(){const[e,t]=this.parentDimensions,{width:s,height:r}=this,i=new Cr,o=Math.ceil(s*e*i.sx),u=Math.ceil(r*t*i.sy),d=this.#r;if(!d||d.width===o&&d.height===u)return;d.width=o,d.height=u;const h=this.#l?this.#e:this.#u(o,u),p=d.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(h,0,0,h.width,h.height,0,0,o,u)}#y(e){if(e){if(this.#l){const r=this._uiManager.imageManager.getSvgUrl(this.#t);if(r)return r}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,s]=this.pageDimensions,r=Math.round(this.width*t*Bl.PDF_TO_CSS_UNITS),i=Math.round(this.height*s*Bl.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,i);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,r,i),o.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,s){let r=null,i=!1;if(e instanceof JN){const{data:{rect:E,rotation:N,id:A,structParent:T,popupRef:I,richText:P,contentsObj:U,creationDate:O,modificationDate:R},container:C,parent:{page:{pageNumber:D}},canvas:B}=e;let V,$;B?(delete e.canvas,{id:V,bitmap:$}=s.imageManager.getFromCanvas(C.id,B),B.remove()):(i=!0,e._hasNoCanvas=!0);const L=(await t._structTree.getAriaAttributes(`${bl}${A}`))?.get("aria-label")||"";r=e={annotationType:qe.STAMP,bitmapId:V,bitmap:$,pageIndex:D-1,rect:E.slice(0),rotation:N,annotationElementId:A,id:A,deleted:!1,accessibilityData:{decorative:!1,altText:L},isSvg:!1,structParent:T,popupRef:I,richText:P,comment:U?.str||null,creationDate:O,modificationDate:R}}const o=await super.deserialize(e,t,s),{rect:u,bitmap:d,bitmapUrl:h,bitmapId:p,isSvg:m,accessibilityData:x}=e;i?(s.addMissingCanvas(e.id,o),o.#o=!0):p&&s.imageManager.isValidId(p)?(o.#t=p,d&&(o.#e=d)):o.#s=h,o.#l=m;const[v,w]=o.pageDimensions;return o.width=(u[2]-u[0])/v,o.height=(u[3]-u[1])/w,x&&(o.altTextData=x),o._initialData=r,e.comment&&o.setCommentData(e),o.#h=!!r,o}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(s),e)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:i}=this.serializeAltText(!1);if(!r&&i&&(s.accessibilityData={type:"Figure",alt:i}),this.annotationElementId){const u=this.#b(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(t===null)return s;t.stamps||=new Map;const o=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const u=t.stamps.get(this.#t);o>u.area&&(u.area=o,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return s}#b(e){const{pageIndex:t,accessibilityData:{altText:s}}=this._initialData,r=e.pageIndex===t,i=(e.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&i,isSameAltText:i}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Qr{#e;#t=!1;#n=null;#s=null;#a=null;#i=new Map;#r=!1;#o=!1;#c=!1;#l=null;#h=null;#d=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([os,Jy,q5,Ft,xr].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:r,accessibilityManager:i,annotationLayer:o,drawLayer:u,textLayer:d,viewport:h,l10n:p}){const m=[...Qr.#p.values()];if(!Qr._initialized){Qr._initialized=!0;for(const x of m)x.initialize(p,e)}e.registerEditorTypes(m),this.#u=e,this.pageIndex=t,this.div=s,this.#e=i,this.#n=o,this.viewport=h,this.#d=d,this.drawLayer=u,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===qe.NONE}updateToolbar(e){this.#u.updateToolbar(e)}updateMode(e=this.#u.getMode()){switch(this.#w(),e){case qe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case qe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case qe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===qe.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const s of Qr.#p.values())t.toggle(`${s._type}Editing`,e===s._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#d?.div}setEditingState(e){this.#u.setEditingState(e)}addCommands(e){this.#u.addCommands(e)}cleanUndoStack(e){this.#u.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.togglePointerEvents(e)}get#y(){return this.#i.size!==0?this.#i.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const e=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),e.add(s.annotationElementId));const t=this.#n;if(t)for(const s of t.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#d&&!this.#g){this.#g=new AbortController;const r=this.#u.combinedSignal(this.#g);this.#d.div.addEventListener("pointerdown",i=>{const{clientX:u,clientY:d,timeStamp:h}=i,p=this.#m;if(h-p>500){this.#m=h;return}this.#m=-1;const{classList:m}=this.div;m.toggle("getElements",!0);const x=document.elementsFromPoint(u,d);if(m.toggle("getElements",!1),!this.div.contains(x[0]))return;let v;const w=new RegExp(`^${ju}[0-9]+$`);for(const N of x)if(w.test(N.id)){v=N.id;break}if(!v)return;const E=this.#i.get(v);E?.annotationElementId===null&&(i.stopPropagation(),i.preventDefault(),E.dblclick(i))},{signal:r,capture:!0})}const e=this.#n,t=[];if(e){const r=new Map,i=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){t.push(u);continue}if(u.serialize()!==null){r.set(u.annotationElementId,u);continue}else i.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const o=e.getEditableAnnotations();for(const u of o){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let h=i.get(d);if(h){h.resetAnnotationElement(u),h.show(!1),u.show();continue}h=r.get(d),h&&(this.#u.addChangedExistingAnnotation(h),h.renderAnnotationElement(u)&&h.show(!1)),u.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of Qr.#p.values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e?.updateFakeAnnotations(t),this.#o=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#u.getActive()!==e&&this.#u.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#d?.div&&!this.#f){this.#f=new AbortController;const e=this.#u.combinedSignal(this.#f);this.#d.div.addEventListener("pointerdown",this.#b.bind(this),{signal:e}),this.#d.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#d?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#d.div.classList.remove("highlighting"))}#b(e){this.#u.unselectAll();const{target:t}=e;if(t===this.#d.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#d.div.contains(t)){const{isMac:s}=bs.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#d.div.classList.add("free"),this.toggleDrawing(),Ft.startHighlighting(this,this.#u.direction==="ltr",{target:this.#d.div,x:e.x,y:e.y}),this.#d.div.addEventListener("pointerup",()=>{this.#d.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),e.preventDefault()}}enableClick(){if(this.#s)return;this.#s=new AbortController;const e=this.#u.combinedSignal(this.#s);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#s?.abort(),this.#s=null}attach(e){this.#i.set(e.id,e);const{annotationElementId:t}=e;t&&this.#u.isDeletedAnnotationElement(t)&&this.#u.removeDeletedAnnotationElement(e)}detach(e){this.#i.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#u.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#u.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#u.addDeletedAnnotationElement(e),Ie.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#u.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#u.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#a&&(e._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getEditorByUID(e){for(const t of this.#i.values())if(t.uid===e)return t;return null}getNextId(){return this.#u.getId()}get#x(){return Qr.#p.get(this.#u.getMode())}combinedSignal(e){return this.#u.combinedSignal(e)}#N(e){const t=this.#x;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#x?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#u.updateMode(e.mode);const{offsetX:s,offsetY:r}=this.#k(),i=this.getNextId(),o=this.#N({parent:this,id:i,x:s,y:r,uiManager:this.#u,isCentered:!0,...t});o&&this.add(o)}async deserialize(e){return await Qr.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#u)||null}createAndAddNewEditor(e,t,s={}){const r=this.getNextId(),i=this.#N({parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:this.#u,isCentered:t,...s});return i&&this.add(i),i}get boundingClientRect(){return this.div.getBoundingClientRect()}#k(){const{x:e,y:t,width:s,height:r}=this.boundingClientRect,i=Math.max(0,e),o=Math.max(0,t),u=Math.min(window.innerWidth,e+s),d=Math.min(window.innerHeight,t+r),h=(i+u)/2-e,p=(o+d)/2-t,[m,x]=this.viewport.rotation%180===0?[h,p]:[p,h];return{offsetX:m,offsetY:x}}addNewEditor(e={}){this.createAndAddNewEditor(this.#k(),!0,e)}setSelected(e){this.#u.setSelected(e)}toggleSelected(e){this.#u.toggleSelected(e)}unselect(e){this.#u.unselect(e)}pointerup(e){const{isMac:t}=bs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#r||(this.#r=!1,this.#x?.isDrawer&&this.#x.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const s=this.#u.getMode();if(s===qe.STAMP||s===qe.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#u.getMode()===qe.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:t}=bs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#r=!0,this.#x?.isDrawer){this.startDrawingSession(e);return}const s=this.#u.getActive();this.#t=!s||s.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#x.startDrawing(this,this.#u,!1,e);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#x.startDrawing(this,this.#u,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#h=null,this.#x.endDrawing(e)):null}findNewParent(e,t,s){const r=this.#u.findParent(t,s);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#x.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const e of this.#i.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#i.clear(),this.#u.removeLayer(this)}#w(){for(const e of this.#i.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,ho(this.div,e);for(const t of this.#u.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#u.commitOrRemove(),this.#w();const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,ho(this.div,{rotation:s}),t!==s)for(const r of this.#i.values())r.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#u.viewParameters.realScale}}class ps{#e=null;#t=new Map;#n=new Map;static#s=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return $e(this,"_svgFactory",new If)}static#a(e,[t,s,r,i]){const{style:o}=e;o.top=`${100*s}%`,o.left=`${100*t}%`,o.width=`${100*r}%`,o.height=`${100*i}%`}#i(){const e=ps._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#r(e,t){const s=ps._svgFactory.createElement("clipPath");e.append(s);const r=`clip_${t}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const i=ps._svgFactory.createElement("use");return s.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),r}#o(e,t){for(const[s,r]of Object.entries(t))r===null?e.removeAttribute(s):e.setAttribute(s,r)}draw(e,t=!1,s=!1){const r=ps.#s++,i=this.#i(),o=ps._svgFactory.createElement("defs");i.append(o);const u=ps._svgFactory.createElement("path");o.append(u);const d=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(r,u);const h=s?this.#r(o,d):null,p=ps._svgFactory.createElement("use");return i.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(i,e),this.#t.set(r,i),{id:r,clipPathId:`url(#${h})`}}drawOutline(e,t){const s=ps.#s++,r=this.#i(),i=ps._svgFactory.createElement("defs");r.append(i);const o=ps._svgFactory.createElement("path");i.append(o);const u=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",u),o.setAttribute("vector-effect","non-scaling-stroke");let d;if(t){const m=ps._svgFactory.createElement("mask");i.append(m),d=`mask_p${this.pageIndex}_${s}`,m.setAttribute("id",d),m.setAttribute("maskUnits","objectBoundingBox");const x=ps._svgFactory.createElement("rect");m.append(x),x.setAttribute("width","1"),x.setAttribute("height","1"),x.setAttribute("fill","white");const v=ps._svgFactory.createElement("use");m.append(v),v.setAttribute("href",`#${u}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const h=ps._svgFactory.createElement("use");r.append(h),h.setAttribute("href",`#${u}`),d&&h.setAttribute("mask",`url(#${d})`);const p=h.cloneNode();return r.append(p),h.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(r,e),this.#t.set(s,r),s}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:s,bbox:r,rootClass:i,path:o}=t,u=typeof e=="number"?this.#t.get(e):e;if(u){if(s&&this.#o(u,s),r&&ps.#a(u,r),i){const{classList:d}=u;for(const[h,p]of Object.entries(i))d.toggle(h,p)}if(o){const h=u.firstElementChild.firstElementChild;this.#o(h,o)}}}updateParent(e,t){if(t===this)return;const s=this.#t.get(e);s&&(t.#e.append(s),this.#t.delete(e),t.#t.set(e,s))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:v0};globalThis.pdfjsLib={AbortException:ya,AnnotationEditorLayer:Qr,AnnotationEditorParamsType:Ze,AnnotationEditorType:qe,AnnotationEditorUIManager:xa,AnnotationLayer:Qy,AnnotationMode:Ji,AnnotationType:Kt,applyOpacity:mO,build:w5,ColorPicker:Sn,createValidAbsoluteUrl:_N,CSSConstants:pO,DOMSVGFactory:If,DrawLayer:ps,FeatureTest:bs,fetchData:sd,findContrastColor:gO,getDocument:qN,getFilenameFromUrl:lO,getPdfFilenameFromUrl:cO,getRGB:rd,getUuid:NN,getXfaPageViewport:dO,GlobalWorkerOptions:Pl,ImageKind:rf,InvalidPDFException:d0,isDataScheme:yp,isPdfFile:By,isValidExplicitDest:AO,MathClamp:Os,noContextMenu:Pn,normalizeUnicode:iO,OPS:Ru,OutputScale:Cr,PasswordResponses:X6,PDFDataRangeTransport:WN,PDFDateString:h0,PDFWorker:ms,PermissionFlag:Y6,PixelsPerInch:Bl,RenderingCancelledException:Uy,renderRichText:TN,ResponseException:Tf,setLayerDimensions:ho,shadow:$e,SignatureExtractor:yl,stopEvent:Pt,SupportedImageMimeTypes:f0,TextLayer:Ms,TouchManager:xp,updateUrlHash:kN,Util:we,VerbosityLevel:pp,version:GN,XfaLayer:SN};Pl.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${GN}/pdf.worker.min.js`;async function W5(n,e=4,t=1.5){const s=await n.arrayBuffer(),r=await qN({data:s}).promise,i=Math.min(r.numPages,e),o=[];for(let u=1;u<=i;u++){const d=await r.getPage(u),h=d.getViewport({scale:t}),p=document.createElement("canvas"),m=p.getContext("2d");if(!m)continue;p.width=h.width,p.height=h.height,await d.render({canvasContext:m,viewport:h,canvas:p}).promise;const x=await new Promise(w=>{p.toBlob(E=>{w(E||new Blob)},"image/jpeg",.9)}),v=new File([x],`preview_page_${u}.jpg`,{type:"image/jpeg"});o.push(v)}return o}function G5(){const{user:n,userProfile:e}=Us(),[t,s]=F.useState(""),[r,i]=F.useState(""),[o,u]=F.useState(""),[d,h]=F.useState("assignment"),[p,m]=F.useState([]),[x,v]=F.useState([]),[w,E]=F.useState(!1),[N,A]=F.useState(!1),[T,I]=F.useState(!1),[P,U]=F.useState(""),[O,R]=F.useState(""),C=async V=>{if(V.preventDefault(),!n||!e){R("You must be logged in to upload notes");return}if(x.length===0){R("Please upload at least one PDF file");return}if(p.length===0){R("Please upload a PDF file first - previews will be auto-generated");return}R(""),A(!0);try{const $=`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;U(`Uploading ${x.length} PDF file(s)...`);const L=[];for(let ye=0;ye<x.length;ye++){U(`Uploading PDF ${ye+1} of ${x.length}...`);const ie=await W6(x[ye],`${$}_${ye}`);L.push(ie)}U("Uploading preview images...");const de=[];for(let ye=0;ye<p.length;ye++){const ie=await q6(p[ye],$,ye);de.push(ie)}U("Creating note..."),await OM({title:t,description:r,category:d,price:parseFloat(o),previewPages:de,thumbnailUrl:de[0]||"",pdfUrls:L,uploaderId:n.uid,uploaderName:e.name}),E(!0),U(""),setTimeout(()=>{E(!1),s(""),i(""),u(""),h("assignment"),m([]),v([])},3e3)}catch($){console.error("Error uploading note:",$),R("Failed to upload note. Please try again."),U("")}finally{A(!1)}},D=async V=>{if(V.target.files&&V.target.files.length>0){const $=Array.from(V.target.files);v($),m([]),I(!0),R("");try{const L=await W5($[0],4);m(L)}catch(L){console.error("Error extracting previews:",L),R("Could not extract previews. You can try uploading images manually.")}finally{I(!1)}}},B=()=>(x.reduce(($,L)=>$+L.size,0)/1024/1024).toFixed(2);return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-3xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center",children:l.jsx(Is,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white",children:"Upload"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Share your knowledge and earn"})]})]}),w?l.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 text-white rounded-2xl p-8 text-center shadow-xl",children:[l.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:l.jsx(Is,{className:"w-8 h-8 text-white"})}),l.jsx("h3",{className:"text-white mb-2",children:"Notes Uploaded Successfully!"}),l.jsx("p",{className:"text-white text-opacity-90",children:"Your notes are now live and available for purchase."})]}):l.jsxs("form",{onSubmit:C,className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 p-6 space-y-6 shadow-lg",children:[O&&l.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:O}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),l.jsx("span",{children:"Note Title *"})]}),l.jsx("input",{type:"text",value:t,onChange:V=>s(V.target.value),placeholder:"e.g., Advanced Mathematics Assignment Solutions",required:!0,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),l.jsx("span",{children:"Description *"})]}),l.jsx("textarea",{value:r,onChange:V=>i(V.target.value),placeholder:"Describe what's included in your notes...",required:!0,rows:4,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(E6,{className:"w-4 h-4"}),l.jsx("span",{children:"Category *"})]}),l.jsxs("select",{value:d,onChange:V=>h(V.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"assignment",children:"Assignment"}),l.jsx("option",{value:"lecture-notes",children:"Lecture Notes"})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Fs,{className:"w-4 h-4"}),l.jsx("span",{children:"Price ( INR) *"})]}),l.jsx("input",{type:"number",value:o,onChange:V=>u(V.target.value),placeholder:"9.99",step:"0.01",min:"0",required:!0,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(r0,{className:"w-4 h-4"}),l.jsx("span",{children:"PDF Files *"})]}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-3",children:"Upload one or more PDF files (these are the files buyers will download)"}),l.jsx("input",{type:"file",accept:".pdf,application/pdf",multiple:!0,onChange:D,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border-0 file:bg-purple-600 file:text-white hover:file:bg-purple-700 text-gray-900 dark:text-white"}),x.length>0&&l.jsxs("div",{className:"mt-3 space-y-2",children:[l.jsxs("div",{className:"text-sm text-green-600 dark:text-green-400",children:[x.length," PDF file(s) selected (",B()," MB total)"]}),l.jsx("div",{className:"flex flex-wrap gap-2",children:x.map((V,$)=>l.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded-lg text-xs text-gray-600 dark:text-gray-400",children:[l.jsx(r0,{className:"w-3 h-3"}),l.jsx("span",{className:"max-w-[150px] truncate",children:V.name})]},$))})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(WL,{className:"w-4 h-4"}),l.jsx("span",{children:"Preview Images (Auto-generated)"})]}),T?l.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl",children:[l.jsx(e6,{className:"w-5 h-5 text-blue-600 animate-spin"}),l.jsx("span",{className:"text-blue-700 dark:text-blue-300",children:"Extracting preview pages from PDF..."})]}):p.length>0?l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"text-sm text-green-600 dark:text-green-400",children:[" ",p.length," preview page(s) extracted from PDF"]}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:p.map((V,$)=>l.jsx("div",{className:"aspect-[8.5/11] bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:l.jsx("img",{src:URL.createObjectURL(V),alt:`Preview ${$+1}`,className:"w-full h-full object-cover"})},$))})]}):l.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Upload a PDF above - the first 4 pages will be automatically extracted as previews"})]}),l.jsx("button",{type:"submit",disabled:N,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3.5 rounded-xl hover:shadow-xl transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:N?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),P||"Uploading..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Is,{className:"w-5 h-5"}),"Upload Notes"]})})]}),l.jsxs("div",{className:"mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-2xl p-6",children:[l.jsx("h3",{className:"text-blue-900 dark:text-blue-200 mb-3",children:"Upload Guidelines"}),l.jsxs("ul",{className:"space-y-2 text-blue-800 dark:text-blue-300 text-sm",children:[l.jsx("li",{children:" Ensure your notes are original or you have permission to sell them"}),l.jsx("li",{children:" You can upload multiple PDF files for a single note listing"}),l.jsx("li",{children:" Provide 1-3 preview images showing sample pages from your notes"}),l.jsx("li",{children:" Write an accurate description of what's included"}),l.jsx("li",{children:" Price your notes fairly based on content quality and length"})]})]})]})})}function K5({note:n,onClose:e}){const{user:t,userProfile:s}=Us(),[r,i]=F.useState(0),[o,u]=F.useState([]),[d,h]=F.useState(!0),[p,m]=F.useState(!1),[x,v]=F.useState(!1),[w,E]=F.useState(!1),[N,A]=F.useState(5),[T,I]=F.useState(""),[P,U]=F.useState(!1),[O,R]=F.useState("");F.useEffect(()=>{C(),D()},[n.id,t?.uid]);async function C(){h(!0);try{const L=await HM(n.id);u(L)}catch(L){console.error("Error loading reviews:",L)}finally{h(!1)}}async function D(){if(t?.uid)try{const L=await oN(t.uid,n.id);if(m(L),L){const de=await lN(t.uid,n.id);v(de)}}catch(L){console.error("Error checking purchase status:",L)}}async function B(L){if(L.preventDefault(),!(!t?.uid||!s)){U(!0),R("");try{await qM({noteId:n.id,userId:t.uid,userName:s.name,rating:N,comment:T}),E(!1),I(""),v(!0),await C()}catch(de){R(de.message||"Failed to submit review")}finally{U(!1)}}}const V=()=>{r<n.previewPages.length-1&&i(r+1)},$=()=>{r>0&&i(r-1)};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[l.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 p-4 lg:p-6 flex items-center justify-between z-10 rounded-t-2xl",children:[l.jsx("h2",{className:"text-gray-900 dark:text-white pr-8",children:n.title}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors flex-shrink-0",children:l.jsx(pi,{className:"w-6 h-6 text-gray-700 dark:text-gray-300"})})]}),l.jsxs("div",{className:"p-4 lg:p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("h3",{className:"text-gray-900 dark:text-white mb-3",children:["Preview Pages (",n.previewPages.length," pages)"]}),l.jsxs("div",{className:"relative bg-gray-100 dark:bg-gray-800 rounded-2xl overflow-hidden",children:[l.jsx("img",{src:n.previewPages[r],alt:`Page ${r+1}`,className:"w-full h-auto"}),n.previewPages.length>1&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:$,disabled:r===0,className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-white dark:bg-gray-900 rounded-xl shadow-xl disabled:opacity-50 disabled:cursor-not-allowed hover:scale-110 transition-transform",children:l.jsx(s0,{className:"w-6 h-6 text-gray-700 dark:text-gray-300"})}),l.jsx("button",{onClick:V,disabled:r===n.previewPages.length-1,className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-white dark:bg-gray-900 rounded-xl shadow-xl disabled:opacity-50 disabled:cursor-not-allowed hover:scale-110 transition-transform",children:l.jsx(n0,{className:"w-6 h-6 text-gray-700 dark:text-gray-300"})}),l.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black bg-opacity-70 text-white px-4 py-2 rounded-xl text-sm backdrop-blur-sm",children:[r+1," / ",n.previewPages.length]})]})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-gray-900 dark:text-white mb-2",children:"Description"}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:n.description})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-xl shadow-lg",children:[l.jsx("div",{className:"text-white text-opacity-90 text-sm mb-1",children:"Price"}),l.jsxs("div",{className:"text-white text-xl",children:["",n.price]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-500 p-4 rounded-xl shadow-lg",children:[l.jsx("div",{className:"text-white text-opacity-90 text-sm mb-1",children:"Rating"}),l.jsxs("div",{className:"flex items-center gap-1 text-white",children:[l.jsx(ro,{className:"w-4 h-4 fill-current"}),l.jsx("span",{className:"text-xl",children:n.rating})]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 p-4 rounded-xl shadow-lg",children:[l.jsx("div",{className:"text-white text-opacity-90 text-sm mb-1",children:"Sales"}),l.jsx("div",{className:"text-white text-xl",children:n.salesCount})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-4 rounded-xl shadow-lg",children:[l.jsx("div",{className:"text-white text-opacity-90 text-sm mb-1",children:"Category"}),l.jsx("div",{className:"text-white text-xl capitalize",children:n.category})]})]}),l.jsx("div",{className:"mb-6 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 p-5 rounded-2xl border border-blue-200 dark:border-blue-800",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center",children:l.jsx(di,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Uploaded by"}),l.jsx("div",{className:"text-gray-900 dark:text-white",children:n.uploaderName})]})]})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h3",{className:"text-gray-900 dark:text-white",children:["Reviews (",o.length,")"]}),p&&!x&&!w&&l.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl text-sm font-medium hover:shadow-lg transition-all",children:"Write a Review"})]}),w&&l.jsxs("form",{onSubmit:B,className:"mb-6 bg-gray-50 dark:bg-gray-800 rounded-2xl p-4 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm mb-2",children:"Rating"}),l.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(L=>l.jsx("button",{type:"button",onClick:()=>A(L),className:"p-1 transition-transform hover:scale-110",children:l.jsx(ro,{className:`w-8 h-8 ${L<=N?"fill-yellow-500 text-yellow-500":"text-gray-300 dark:text-gray-600"}`})},L))})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm mb-2",children:"Comment"}),l.jsx("textarea",{value:T,onChange:L=>I(L.target.value),placeholder:"Share your experience with this note...",rows:3,className:"w-full px-4 py-3 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white resize-none",required:!0})]}),O&&l.jsx("div",{className:"mb-4 text-red-600 dark:text-red-400 text-sm",children:O}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{type:"submit",disabled:P,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl text-sm font-medium hover:shadow-lg transition-all disabled:opacity-50",children:P?"Submitting...":"Submit Review"}),l.jsx("button",{type:"button",onClick:()=>E(!1),className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl text-sm font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}),d?l.jsx("div",{className:"flex justify-center py-8",children:l.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):o.length>0?l.jsx("div",{className:"space-y-4",children:o.map(L=>l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:L.userName}),l.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(de=>l.jsx(ro,{className:`w-4 h-4 ${de<=L.rating?"fill-yellow-500 text-yellow-500":"text-gray-300 dark:text-gray-600"}`},de))})]}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm mb-2",children:L.comment}),l.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-xs",children:L.date})]},L.id))}):l.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"No reviews yet. Be the first to review!"})]})]})]})})}function L_(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function Y5(...n){return e=>{let t=!1;const s=n.map(r=>{const i=L_(r,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():L_(n[r],null)}}}}var X5=Symbol.for("react.lazy"),Pf=FS[" use ".trim().toString()];function Q5(n){return typeof n=="object"&&n!==null&&"then"in n}function tA(n){return n!=null&&typeof n=="object"&&"$$typeof"in n&&n.$$typeof===X5&&"_payload"in n&&Q5(n._payload)}function J5(n){const e=e3(n),t=F.forwardRef((s,r)=>{let{children:i,...o}=s;tA(i)&&typeof Pf=="function"&&(i=Pf(i._payload));const u=F.Children.toArray(i),d=u.find(s3);if(d){const h=d.props.children,p=u.map(m=>m===d?F.Children.count(h)>1?F.Children.only(null):F.isValidElement(h)?h.props.children:null:m);return l.jsx(e,{...o,ref:r,children:F.isValidElement(h)?F.cloneElement(h,void 0,p):null})}return l.jsx(e,{...o,ref:r,children:i})});return t.displayName=`${n}.Slot`,t}var Z5=J5("Slot");function e3(n){const e=F.forwardRef((t,s)=>{let{children:r,...i}=t;if(tA(r)&&typeof Pf=="function"&&(r=Pf(r._payload)),F.isValidElement(r)){const o=r3(r),u=n3(i,r.props);return r.type!==F.Fragment&&(u.ref=s?Y5(s,o):o),F.cloneElement(r,u)}return F.Children.count(r)>1?F.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var t3=Symbol("radix.slottable");function s3(n){return F.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===t3}function n3(n,e){const t={...e};for(const s in e){const r=n[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?t[s]=(...u)=>{const d=i(...u);return r(...u),d}:r&&(t[s]=r):s==="style"?t[s]={...r,...i}:s==="className"&&(t[s]=[r,i].filter(Boolean).join(" "))}return{...n,...t}}function r3(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function sA(n){var e,t,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(e=0;e<r;e++)n[e]&&(t=sA(n[e]))&&(s&&(s+=" "),s+=t)}else for(t in n)n[t]&&(s&&(s+=" "),s+=t);return s}function nA(){for(var n,e,t=0,s="",r=arguments.length;t<r;t++)(n=arguments[t])&&(e=sA(n))&&(s&&(s+=" "),s+=e);return s}const O_=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,F_=nA,i3=(n,e)=>t=>{var s;if(e?.variants==null)return F_(n,t?.class,t?.className);const{variants:r,defaultVariants:i}=e,o=Object.keys(r).map(h=>{const p=t?.[h],m=i?.[h];if(p===null)return null;const x=O_(p)||O_(m);return r[h][x]}),u=t&&Object.entries(t).reduce((h,p)=>{let[m,x]=p;return x===void 0||(h[m]=x),h},{}),d=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((h,p)=>{let{class:m,className:x,...v}=p;return Object.entries(v).every(w=>{let[E,N]=w;return Array.isArray(N)?N.includes({...i,...u}[E]):{...i,...u}[E]===N})?[...h,m,x]:h},[]);return F_(n,o,d,t?.class,t?.className)},a3=(n,e)=>{const t=new Array(n.length+e.length);for(let s=0;s<n.length;s++)t[s]=n[s];for(let s=0;s<e.length;s++)t[n.length+s]=e[s];return t},o3=(n,e)=>({classGroupId:n,validator:e}),rA=(n=new Map,e=null,t)=>({nextPart:n,validators:e,classGroupId:t}),jf="-",V_=[],l3="arbitrary..",c3=n=>{const e=d3(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:s}=n;return{getClassGroupId:o=>{if(o.startsWith("[")&&o.endsWith("]"))return u3(o);const u=o.split(jf),d=u[0]===""&&u.length>1?1:0;return iA(u,d,e)},getConflictingClassGroupIds:(o,u)=>{if(u){const d=s[o],h=t[o];return d?h?a3(h,d):d:h||V_}return t[o]||V_}}},iA=(n,e,t)=>{if(n.length-e===0)return t.classGroupId;const r=n[e],i=t.nextPart.get(r);if(i){const h=iA(n,e+1,i);if(h)return h}const o=t.validators;if(o===null)return;const u=e===0?n.join(jf):n.slice(e).join(jf),d=o.length;for(let h=0;h<d;h++){const p=o[h];if(p.validator(u))return p.classGroupId}},u3=n=>n.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=n.slice(1,-1),t=e.indexOf(":"),s=e.slice(0,t);return s?l3+s:void 0})(),d3=n=>{const{theme:e,classGroups:t}=n;return h3(t,e)},h3=(n,e)=>{const t=rA();for(const s in n){const r=n[s];tx(r,t,s,e)}return t},tx=(n,e,t,s)=>{const r=n.length;for(let i=0;i<r;i++){const o=n[i];f3(o,e,t,s)}},f3=(n,e,t,s)=>{if(typeof n=="string"){p3(n,e,t);return}if(typeof n=="function"){m3(n,e,t,s);return}g3(n,e,t,s)},p3=(n,e,t)=>{const s=n===""?e:aA(e,n);s.classGroupId=t},m3=(n,e,t,s)=>{if(y3(n)){tx(n(s),e,t,s);return}e.validators===null&&(e.validators=[]),e.validators.push(o3(t,n))},g3=(n,e,t,s)=>{const r=Object.entries(n),i=r.length;for(let o=0;o<i;o++){const[u,d]=r[o];tx(d,aA(e,u),t,s)}},aA=(n,e)=>{let t=n;const s=e.split(jf),r=s.length;for(let i=0;i<r;i++){const o=s[i];let u=t.nextPart.get(o);u||(u=rA(),t.nextPart.set(o,u)),t=u}return t},y3=n=>"isThemeGetter"in n&&n.isThemeGetter===!0,x3=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=Object.create(null),s=Object.create(null);const r=(i,o)=>{t[i]=o,e++,e>n&&(e=0,s=t,t=Object.create(null))};return{get(i){let o=t[i];if(o!==void 0)return o;if((o=s[i])!==void 0)return r(i,o),o},set(i,o){i in t?t[i]=o:r(i,o)}}},k0="!",U_=":",b3=[],B_=(n,e,t,s,r)=>({modifiers:n,hasImportantModifier:e,baseClassName:t,maybePostfixModifierPosition:s,isExternal:r}),v3=n=>{const{prefix:e,experimentalParseClassName:t}=n;let s=r=>{const i=[];let o=0,u=0,d=0,h;const p=r.length;for(let E=0;E<p;E++){const N=r[E];if(o===0&&u===0){if(N===U_){i.push(r.slice(d,E)),d=E+1;continue}if(N==="/"){h=E;continue}}N==="["?o++:N==="]"?o--:N==="("?u++:N===")"&&u--}const m=i.length===0?r:r.slice(d);let x=m,v=!1;m.endsWith(k0)?(x=m.slice(0,-1),v=!0):m.startsWith(k0)&&(x=m.slice(1),v=!0);const w=h&&h>d?h-d:void 0;return B_(i,v,x,w)};if(e){const r=e+U_,i=s;s=o=>o.startsWith(r)?i(o.slice(r.length)):B_(b3,!1,o,void 0,!0)}if(t){const r=s;s=i=>t({className:i,parseClassName:r})}return s},w3=n=>{const e=new Map;return n.orderSensitiveModifiers.forEach((t,s)=>{e.set(t,1e6+s)}),t=>{const s=[];let r=[];for(let i=0;i<t.length;i++){const o=t[i],u=o[0]==="[",d=e.has(o);u||d?(r.length>0&&(r.sort(),s.push(...r),r=[]),s.push(o)):r.push(o)}return r.length>0&&(r.sort(),s.push(...r)),s}},_3=n=>({cache:x3(n.cacheSize),parseClassName:v3(n),sortModifiers:w3(n),...c3(n)}),k3=/\s+/,E3=(n,e)=>{const{parseClassName:t,getClassGroupId:s,getConflictingClassGroupIds:r,sortModifiers:i}=e,o=[],u=n.trim().split(k3);let d="";for(let h=u.length-1;h>=0;h-=1){const p=u[h],{isExternal:m,modifiers:x,hasImportantModifier:v,baseClassName:w,maybePostfixModifierPosition:E}=t(p);if(m){d=p+(d.length>0?" "+d:d);continue}let N=!!E,A=s(N?w.substring(0,E):w);if(!A){if(!N){d=p+(d.length>0?" "+d:d);continue}if(A=s(w),!A){d=p+(d.length>0?" "+d:d);continue}N=!1}const T=x.length===0?"":x.length===1?x[0]:i(x).join(":"),I=v?T+k0:T,P=I+A;if(o.indexOf(P)>-1)continue;o.push(P);const U=r(A,N);for(let O=0;O<U.length;++O){const R=U[O];o.push(I+R)}d=p+(d.length>0?" "+d:d)}return d},N3=(...n)=>{let e=0,t,s,r="";for(;e<n.length;)(t=n[e++])&&(s=oA(t))&&(r&&(r+=" "),r+=s);return r},oA=n=>{if(typeof n=="string")return n;let e,t="";for(let s=0;s<n.length;s++)n[s]&&(e=oA(n[s]))&&(t&&(t+=" "),t+=e);return t},A3=(n,...e)=>{let t,s,r,i;const o=d=>{const h=e.reduce((p,m)=>m(p),n());return t=_3(h),s=t.cache.get,r=t.cache.set,i=u,u(d)},u=d=>{const h=s(d);if(h)return h;const p=E3(d,t);return r(d,p),p};return i=o,(...d)=>i(N3(...d))},S3=[],ts=n=>{const e=t=>t[n]||S3;return e.isThemeGetter=!0,e},lA=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,cA=/^\((?:(\w[\w-]*):)?(.+)\)$/i,T3=/^\d+\/\d+$/,C3=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,I3=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,P3=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,j3=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,R3=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ul=n=>T3.test(n),Ge=n=>!!n&&!Number.isNaN(Number(n)),Wi=n=>!!n&&Number.isInteger(Number(n)),kg=n=>n.endsWith("%")&&Ge(n.slice(0,-1)),Yr=n=>C3.test(n),D3=()=>!0,M3=n=>I3.test(n)&&!P3.test(n),uA=()=>!1,L3=n=>j3.test(n),O3=n=>R3.test(n),F3=n=>!ke(n)&&!Ee(n),V3=n=>Jl(n,fA,uA),ke=n=>lA.test(n),Qa=n=>Jl(n,pA,M3),Eg=n=>Jl(n,H3,Ge),z_=n=>Jl(n,dA,uA),U3=n=>Jl(n,hA,O3),Hh=n=>Jl(n,mA,L3),Ee=n=>cA.test(n),tu=n=>Zl(n,pA),B3=n=>Zl(n,q3),$_=n=>Zl(n,dA),z3=n=>Zl(n,fA),$3=n=>Zl(n,hA),qh=n=>Zl(n,mA,!0),Jl=(n,e,t)=>{const s=lA.exec(n);return s?s[1]?e(s[1]):t(s[2]):!1},Zl=(n,e,t=!1)=>{const s=cA.exec(n);return s?s[1]?e(s[1]):t:!1},dA=n=>n==="position"||n==="percentage",hA=n=>n==="image"||n==="url",fA=n=>n==="length"||n==="size"||n==="bg-size",pA=n=>n==="length",H3=n=>n==="number",q3=n=>n==="family-name",mA=n=>n==="shadow",W3=()=>{const n=ts("color"),e=ts("font"),t=ts("text"),s=ts("font-weight"),r=ts("tracking"),i=ts("leading"),o=ts("breakpoint"),u=ts("container"),d=ts("spacing"),h=ts("radius"),p=ts("shadow"),m=ts("inset-shadow"),x=ts("text-shadow"),v=ts("drop-shadow"),w=ts("blur"),E=ts("perspective"),N=ts("aspect"),A=ts("ease"),T=ts("animate"),I=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],U=()=>[...P(),Ee,ke],O=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto","contain","none"],C=()=>[Ee,ke,d],D=()=>[ul,"full","auto",...C()],B=()=>[Wi,"none","subgrid",Ee,ke],V=()=>["auto",{span:["full",Wi,Ee,ke]},Wi,Ee,ke],$=()=>[Wi,"auto",Ee,ke],L=()=>["auto","min","max","fr",Ee,ke],de=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ye=()=>["start","end","center","stretch","center-safe","end-safe"],ie=()=>["auto",...C()],oe=()=>[ul,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...C()],Y=()=>[n,Ee,ke],he=()=>[...P(),$_,z_,{position:[Ee,ke]}],le=()=>["no-repeat",{repeat:["","x","y","space","round"]}],W=()=>["auto","cover","contain",z3,V3,{size:[Ee,ke]}],Z=()=>[kg,tu,Qa],ce=()=>["","none","full",h,Ee,ke],xe=()=>["",Ge,tu,Qa],je=()=>["solid","dashed","dotted","double"],Re=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],fe=()=>[Ge,kg,$_,z_],Ue=()=>["","none",w,Ee,ke],Se=()=>["none",Ge,Ee,ke],We=()=>["none",Ge,Ee,ke],st=()=>[Ge,Ee,ke],Tt=()=>[ul,"full",...C()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Yr],breakpoint:[Yr],color:[D3],container:[Yr],"drop-shadow":[Yr],ease:["in","out","in-out"],font:[F3],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Yr],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Yr],shadow:[Yr],spacing:["px",Ge],text:[Yr],"text-shadow":[Yr],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ul,ke,Ee,N]}],container:["container"],columns:[{columns:[Ge,ke,Ee,u]}],"break-after":[{"break-after":I()}],"break-before":[{"break-before":I()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:U()}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:D()}],"inset-x":[{"inset-x":D()}],"inset-y":[{"inset-y":D()}],start:[{start:D()}],end:[{end:D()}],top:[{top:D()}],right:[{right:D()}],bottom:[{bottom:D()}],left:[{left:D()}],visibility:["visible","invisible","collapse"],z:[{z:[Wi,"auto",Ee,ke]}],basis:[{basis:[ul,"full","auto",u,...C()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ge,ul,"auto","initial","none",ke]}],grow:[{grow:["",Ge,Ee,ke]}],shrink:[{shrink:["",Ge,Ee,ke]}],order:[{order:[Wi,"first","last","none",Ee,ke]}],"grid-cols":[{"grid-cols":B()}],"col-start-end":[{col:V()}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":B()}],"row-start-end":[{row:V()}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":L()}],"auto-rows":[{"auto-rows":L()}],gap:[{gap:C()}],"gap-x":[{"gap-x":C()}],"gap-y":[{"gap-y":C()}],"justify-content":[{justify:[...de(),"normal"]}],"justify-items":[{"justify-items":[...ye(),"normal"]}],"justify-self":[{"justify-self":["auto",...ye()]}],"align-content":[{content:["normal",...de()]}],"align-items":[{items:[...ye(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ye(),{baseline:["","last"]}]}],"place-content":[{"place-content":de()}],"place-items":[{"place-items":[...ye(),"baseline"]}],"place-self":[{"place-self":["auto",...ye()]}],p:[{p:C()}],px:[{px:C()}],py:[{py:C()}],ps:[{ps:C()}],pe:[{pe:C()}],pt:[{pt:C()}],pr:[{pr:C()}],pb:[{pb:C()}],pl:[{pl:C()}],m:[{m:ie()}],mx:[{mx:ie()}],my:[{my:ie()}],ms:[{ms:ie()}],me:[{me:ie()}],mt:[{mt:ie()}],mr:[{mr:ie()}],mb:[{mb:ie()}],ml:[{ml:ie()}],"space-x":[{"space-x":C()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":C()}],"space-y-reverse":["space-y-reverse"],size:[{size:oe()}],w:[{w:[u,"screen",...oe()]}],"min-w":[{"min-w":[u,"screen","none",...oe()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[o]},...oe()]}],h:[{h:["screen","lh",...oe()]}],"min-h":[{"min-h":["screen","lh","none",...oe()]}],"max-h":[{"max-h":["screen","lh",...oe()]}],"font-size":[{text:["base",t,tu,Qa]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,Ee,Eg]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",kg,ke]}],"font-family":[{font:[B3,ke,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,Ee,ke]}],"line-clamp":[{"line-clamp":[Ge,"none",Ee,Eg]}],leading:[{leading:[i,...C()]}],"list-image":[{"list-image":["none",Ee,ke]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ee,ke]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Y()}],"text-color":[{text:Y()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...je(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ge,"from-font","auto",Ee,Qa]}],"text-decoration-color":[{decoration:Y()}],"underline-offset":[{"underline-offset":[Ge,"auto",Ee,ke]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ee,ke]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ee,ke]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:he()}],"bg-repeat":[{bg:le()}],"bg-size":[{bg:W()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Wi,Ee,ke],radial:["",Ee,ke],conic:[Wi,Ee,ke]},$3,U3]}],"bg-color":[{bg:Y()}],"gradient-from-pos":[{from:Z()}],"gradient-via-pos":[{via:Z()}],"gradient-to-pos":[{to:Z()}],"gradient-from":[{from:Y()}],"gradient-via":[{via:Y()}],"gradient-to":[{to:Y()}],rounded:[{rounded:ce()}],"rounded-s":[{"rounded-s":ce()}],"rounded-e":[{"rounded-e":ce()}],"rounded-t":[{"rounded-t":ce()}],"rounded-r":[{"rounded-r":ce()}],"rounded-b":[{"rounded-b":ce()}],"rounded-l":[{"rounded-l":ce()}],"rounded-ss":[{"rounded-ss":ce()}],"rounded-se":[{"rounded-se":ce()}],"rounded-ee":[{"rounded-ee":ce()}],"rounded-es":[{"rounded-es":ce()}],"rounded-tl":[{"rounded-tl":ce()}],"rounded-tr":[{"rounded-tr":ce()}],"rounded-br":[{"rounded-br":ce()}],"rounded-bl":[{"rounded-bl":ce()}],"border-w":[{border:xe()}],"border-w-x":[{"border-x":xe()}],"border-w-y":[{"border-y":xe()}],"border-w-s":[{"border-s":xe()}],"border-w-e":[{"border-e":xe()}],"border-w-t":[{"border-t":xe()}],"border-w-r":[{"border-r":xe()}],"border-w-b":[{"border-b":xe()}],"border-w-l":[{"border-l":xe()}],"divide-x":[{"divide-x":xe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":xe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...je(),"hidden","none"]}],"divide-style":[{divide:[...je(),"hidden","none"]}],"border-color":[{border:Y()}],"border-color-x":[{"border-x":Y()}],"border-color-y":[{"border-y":Y()}],"border-color-s":[{"border-s":Y()}],"border-color-e":[{"border-e":Y()}],"border-color-t":[{"border-t":Y()}],"border-color-r":[{"border-r":Y()}],"border-color-b":[{"border-b":Y()}],"border-color-l":[{"border-l":Y()}],"divide-color":[{divide:Y()}],"outline-style":[{outline:[...je(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ge,Ee,ke]}],"outline-w":[{outline:["",Ge,tu,Qa]}],"outline-color":[{outline:Y()}],shadow:[{shadow:["","none",p,qh,Hh]}],"shadow-color":[{shadow:Y()}],"inset-shadow":[{"inset-shadow":["none",m,qh,Hh]}],"inset-shadow-color":[{"inset-shadow":Y()}],"ring-w":[{ring:xe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Y()}],"ring-offset-w":[{"ring-offset":[Ge,Qa]}],"ring-offset-color":[{"ring-offset":Y()}],"inset-ring-w":[{"inset-ring":xe()}],"inset-ring-color":[{"inset-ring":Y()}],"text-shadow":[{"text-shadow":["none",x,qh,Hh]}],"text-shadow-color":[{"text-shadow":Y()}],opacity:[{opacity:[Ge,Ee,ke]}],"mix-blend":[{"mix-blend":[...Re(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Re()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ge]}],"mask-image-linear-from-pos":[{"mask-linear-from":fe()}],"mask-image-linear-to-pos":[{"mask-linear-to":fe()}],"mask-image-linear-from-color":[{"mask-linear-from":Y()}],"mask-image-linear-to-color":[{"mask-linear-to":Y()}],"mask-image-t-from-pos":[{"mask-t-from":fe()}],"mask-image-t-to-pos":[{"mask-t-to":fe()}],"mask-image-t-from-color":[{"mask-t-from":Y()}],"mask-image-t-to-color":[{"mask-t-to":Y()}],"mask-image-r-from-pos":[{"mask-r-from":fe()}],"mask-image-r-to-pos":[{"mask-r-to":fe()}],"mask-image-r-from-color":[{"mask-r-from":Y()}],"mask-image-r-to-color":[{"mask-r-to":Y()}],"mask-image-b-from-pos":[{"mask-b-from":fe()}],"mask-image-b-to-pos":[{"mask-b-to":fe()}],"mask-image-b-from-color":[{"mask-b-from":Y()}],"mask-image-b-to-color":[{"mask-b-to":Y()}],"mask-image-l-from-pos":[{"mask-l-from":fe()}],"mask-image-l-to-pos":[{"mask-l-to":fe()}],"mask-image-l-from-color":[{"mask-l-from":Y()}],"mask-image-l-to-color":[{"mask-l-to":Y()}],"mask-image-x-from-pos":[{"mask-x-from":fe()}],"mask-image-x-to-pos":[{"mask-x-to":fe()}],"mask-image-x-from-color":[{"mask-x-from":Y()}],"mask-image-x-to-color":[{"mask-x-to":Y()}],"mask-image-y-from-pos":[{"mask-y-from":fe()}],"mask-image-y-to-pos":[{"mask-y-to":fe()}],"mask-image-y-from-color":[{"mask-y-from":Y()}],"mask-image-y-to-color":[{"mask-y-to":Y()}],"mask-image-radial":[{"mask-radial":[Ee,ke]}],"mask-image-radial-from-pos":[{"mask-radial-from":fe()}],"mask-image-radial-to-pos":[{"mask-radial-to":fe()}],"mask-image-radial-from-color":[{"mask-radial-from":Y()}],"mask-image-radial-to-color":[{"mask-radial-to":Y()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":P()}],"mask-image-conic-pos":[{"mask-conic":[Ge]}],"mask-image-conic-from-pos":[{"mask-conic-from":fe()}],"mask-image-conic-to-pos":[{"mask-conic-to":fe()}],"mask-image-conic-from-color":[{"mask-conic-from":Y()}],"mask-image-conic-to-color":[{"mask-conic-to":Y()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:he()}],"mask-repeat":[{mask:le()}],"mask-size":[{mask:W()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ee,ke]}],filter:[{filter:["","none",Ee,ke]}],blur:[{blur:Ue()}],brightness:[{brightness:[Ge,Ee,ke]}],contrast:[{contrast:[Ge,Ee,ke]}],"drop-shadow":[{"drop-shadow":["","none",v,qh,Hh]}],"drop-shadow-color":[{"drop-shadow":Y()}],grayscale:[{grayscale:["",Ge,Ee,ke]}],"hue-rotate":[{"hue-rotate":[Ge,Ee,ke]}],invert:[{invert:["",Ge,Ee,ke]}],saturate:[{saturate:[Ge,Ee,ke]}],sepia:[{sepia:["",Ge,Ee,ke]}],"backdrop-filter":[{"backdrop-filter":["","none",Ee,ke]}],"backdrop-blur":[{"backdrop-blur":Ue()}],"backdrop-brightness":[{"backdrop-brightness":[Ge,Ee,ke]}],"backdrop-contrast":[{"backdrop-contrast":[Ge,Ee,ke]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ge,Ee,ke]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ge,Ee,ke]}],"backdrop-invert":[{"backdrop-invert":["",Ge,Ee,ke]}],"backdrop-opacity":[{"backdrop-opacity":[Ge,Ee,ke]}],"backdrop-saturate":[{"backdrop-saturate":[Ge,Ee,ke]}],"backdrop-sepia":[{"backdrop-sepia":["",Ge,Ee,ke]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":C()}],"border-spacing-x":[{"border-spacing-x":C()}],"border-spacing-y":[{"border-spacing-y":C()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ee,ke]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ge,"initial",Ee,ke]}],ease:[{ease:["linear","initial",A,Ee,ke]}],delay:[{delay:[Ge,Ee,ke]}],animate:[{animate:["none",T,Ee,ke]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[E,Ee,ke]}],"perspective-origin":[{"perspective-origin":U()}],rotate:[{rotate:Se()}],"rotate-x":[{"rotate-x":Se()}],"rotate-y":[{"rotate-y":Se()}],"rotate-z":[{"rotate-z":Se()}],scale:[{scale:We()}],"scale-x":[{"scale-x":We()}],"scale-y":[{"scale-y":We()}],"scale-z":[{"scale-z":We()}],"scale-3d":["scale-3d"],skew:[{skew:st()}],"skew-x":[{"skew-x":st()}],"skew-y":[{"skew-y":st()}],transform:[{transform:[Ee,ke,"","none","gpu","cpu"]}],"transform-origin":[{origin:U()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Tt()}],"translate-x":[{"translate-x":Tt()}],"translate-y":[{"translate-y":Tt()}],"translate-z":[{"translate-z":Tt()}],"translate-none":["translate-none"],accent:[{accent:Y()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Y()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ee,ke]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ee,ke]}],fill:[{fill:["none",...Y()]}],"stroke-w":[{stroke:[Ge,tu,Qa,Eg]}],stroke:[{stroke:["none",...Y()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},G3=A3(W3);function gA(...n){return G3(nA(n))}const K3=i3("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function ht({className:n,variant:e,size:t,asChild:s=!1,...r}){const i=s?Z5:"button";return l.jsx(i,{"data-slot":"button",className:gA(K3({variant:e,size:t,className:n})),...r})}function Y3({onNavigateToLogin:n,onNavigateToSignup:e}){const[t,s]=F.useState(!1),[r,i]=F.useState(""),{isDark:o,toggleTheme:u}=Vu(),d=p=>{const m=document.getElementById(p);m&&(m.scrollIntoView({behavior:"smooth"}),s(!1))},h=[{icon:Vs,title:"Assignments",description:"Access high-quality assignment solutions from top students across various subjects and courses."},{icon:ia,title:"PYQ Papers",description:"Download previous year question papers with detailed solutions to ace your exams."},{icon:i0,title:"Lecture Notes",description:"Comprehensive lecture notes prepared by experienced students and educators."},{icon:Fs,title:"Earn Money",description:"Upload your notes and earn from every download. Turn your knowledge into income."}];return l.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-950",children:[l.jsx("nav",{className:"sticky top-0 z-50 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-gray-200 dark:border-slate-800",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(Is,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white",children:"Notezy"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-400 hidden sm:block",children:"Knowledge Marketplace"})]})]}),l.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[l.jsx("button",{onClick:()=>d("about"),className:"text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white transition-colors",children:"About Us"}),l.jsx("button",{onClick:()=>d("features"),className:"text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white transition-colors",children:"Features"}),l.jsx("button",{onClick:()=>d("contact"),className:"text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white transition-colors",children:"Contact"}),l.jsx("button",{onClick:u,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 text-gray-700 dark:text-slate-300 transition-colors",children:o?l.jsx(ga,{className:"w-5 h-5"}):l.jsx(pa,{className:"w-5 h-5"})}),l.jsx(ht,{onClick:n,variant:"ghost",className:"text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-slate-800",children:"Login"}),l.jsx(ht,{onClick:e,className:"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 hover:from-blue-700 hover:via-purple-700 hover:to-pink-700 text-white shadow-lg",children:"Sign Up"})]}),l.jsxs("div",{className:"flex md:hidden items-center gap-2",children:[l.jsx("button",{onClick:u,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 text-gray-700 dark:text-slate-300",children:o?l.jsx(ga,{className:"w-5 h-5"}):l.jsx(pa,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>s(!t),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 text-gray-700 dark:text-slate-300",children:t?l.jsx(pi,{className:"w-6 h-6"}):l.jsx(bN,{className:"w-6 h-6"})})]})]}),t&&l.jsx("div",{className:"md:hidden py-4 border-t border-gray-200 dark:border-slate-800",children:l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx("button",{onClick:()=>d("about"),className:"text-left px-4 py-2 text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:"About Us"}),l.jsx("button",{onClick:()=>d("features"),className:"text-left px-4 py-2 text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:"Features"}),l.jsx("button",{onClick:()=>d("contact"),className:"text-left px-4 py-2 text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:"Contact"}),l.jsxs("div",{className:"flex gap-2 px-4 pt-2",children:[l.jsx(ht,{onClick:n,variant:"outline",className:"flex-1 border-gray-300 dark:border-slate-700 text-gray-700 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-800",children:"Login"}),l.jsx(ht,{onClick:e,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:"Sign Up"})]})]})})]})}),l.jsxs("section",{className:"relative overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-100/50 via-purple-100/50 to-pink-100/50 dark:from-blue-900/20 dark:via-purple-900/20 dark:to-pink-900/20"}),l.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 lg:py-32",children:l.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[l.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-green-50 dark:bg-slate-800/50 border border-green-200 dark:border-slate-700 rounded-full mb-8",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),l.jsx("span",{className:"text-sm text-green-700 dark:text-slate-300",children:"New Platform  Just Launched"})]}),l.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-6xl text-gray-900 dark:text-white mb-6",children:["Your Academic Success",l.jsx("span",{className:"block bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent",children:"Starts Here"})]}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-slate-400 mb-8 max-w-2xl mx-auto",children:"Access quality assignments, PYQs, and lecture notes. Share your knowledge and earn from your notes."}),l.jsx("div",{className:"max-w-2xl mx-auto mb-8",children:l.jsxs("div",{className:"relative",children:[l.jsx(ma,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 dark:text-slate-400"}),l.jsx("input",{type:"text",placeholder:"Search for notes, assignments, PYQ papers...",value:r,onChange:p=>i(p.target.value),className:"w-full pl-12 pr-4 py-4 bg-white dark:bg-slate-800/50 border border-gray-300 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-slate-500"})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[l.jsx(ht,{onClick:e,className:"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 hover:from-blue-700 hover:via-purple-700 hover:to-pink-700 text-white shadow-xl text-lg px-8 py-6",children:"Get Started Free"}),l.jsx(ht,{onClick:()=>d("features"),variant:"outline",className:"border-gray-300 dark:border-slate-700 text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-slate-800 text-lg px-8 py-6",children:"Learn More"})]})]})})]}),l.jsx("section",{id:"features",className:"py-20 bg-gray-50 dark:bg-slate-900/50",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"text-center mb-16",children:[l.jsx("h2",{className:"text-3xl sm:text-4xl text-gray-900 dark:text-white mb-4",children:"What We Offer"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400 max-w-2xl mx-auto",children:"Everything you need to excel in your studies and earn from your knowledge"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:h.map((p,m)=>{const x=p.icon;return l.jsxs("div",{className:"bg-white dark:bg-slate-800/50 border border-gray-200 dark:border-slate-700 rounded-xl p-6 hover:border-purple-500/50 transition-all group hover:shadow-lg",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500/10 via-purple-500/10 to-pink-500/10 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:l.jsx(x,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),l.jsx("h3",{className:"text-gray-900 dark:text-white mb-2",children:p.title}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:p.description})]},m)})})]})}),l.jsx("section",{id:"about",className:"py-20 bg-white dark:bg-slate-950",children:l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"bg-white dark:bg-slate-800/50 border border-gray-200 dark:border-slate-700 rounded-2xl p-8 lg:p-12 shadow-lg",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center",children:l.jsx(i0,{className:"w-6 h-6 text-white"})}),l.jsx("h2",{className:"text-3xl text-gray-900 dark:text-white",children:"About Us"})]}),l.jsxs("div",{className:"space-y-4 text-gray-700 dark:text-slate-300",children:[l.jsxs("p",{children:["Welcome to ",l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Notezy"})," - a brand new platform designed by students, for students. We understand the challenges of finding quality study materials and the effort that goes into creating excellent notes."]}),l.jsxs("p",{children:["Our mission is simple: to provide students with easy access to high-quality ",l.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"assignments"}),", ",l.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"previous year question papers (PYQs)"}),", and ",l.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"lecture notes"})," while empowering content creators to earn from their hard work."]}),l.jsx("p",{children:"Whether you're looking to excel in your studies or want to monetize your knowledge, Notezy is your one-stop platform. Join our growing community and experience the future of academic resource sharing."}),l.jsx("div",{className:"pt-4",children:l.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 dark:bg-blue-500/10 border border-blue-200 dark:border-blue-500/20 rounded-lg",children:[l.jsx(Fs,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),l.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Start earning by selling your notes today!"})]})})]})]})})}),l.jsx("section",{className:"py-20 bg-gray-50 dark:bg-slate-900/50",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white dark:bg-slate-800/50 border border-gray-200 dark:border-slate-700 rounded-xl p-8 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx(Wn,{className:"w-8 h-8 text-green-600 dark:text-green-400"}),l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white",children:"Privacy Policy"})]}),l.jsx("p",{className:"text-gray-700 dark:text-slate-300 mb-4",children:"Your privacy and security are our top priorities. We implement industry-standard security measures to protect your personal information."}),l.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-slate-400",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"All user data is encrypted and stored securely"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"We never share your personal information with third parties"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Payment information is processed through secure gateways"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"You have full control over your data and can request deletion anytime"})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-800/50 border border-gray-200 dark:border-slate-700 rounded-xl p-8 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx(gN,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white",children:"Terms & Conditions"})]}),l.jsx("p",{className:"text-gray-700 dark:text-slate-300 mb-4",children:"By using Notezy, you agree to our terms of service designed to ensure a fair and transparent marketplace."}),l.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-slate-400",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"All uploaded content must be original or properly authorized"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:l.jsx("span",{className:"text-amber-600 dark:text-yellow-400",children:"Notes once purchased cannot be returned or refunded"})})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Sellers are responsible for the accuracy of their content"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Platform fees apply to all transactions"})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-800/50 border border-gray-200 dark:border-slate-700 rounded-xl p-8 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx(Vs,{className:"w-8 h-8 text-red-600 dark:text-red-400"}),l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white",children:"Refund & Cancellation"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-500/10 border border-red-200 dark:border-red-500/20 rounded-lg",children:l.jsx("p",{className:"text-red-700 dark:text-red-400",children:l.jsx("span",{children:"No Refunds  No Cancellations"})})}),l.jsx("p",{className:"text-gray-700 dark:text-slate-300 text-sm",children:"Due to the digital nature of our products, all sales are final. Once you purchase and download notes, they cannot be returned or refunded."}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400 text-sm",children:"We encourage users to carefully review note previews, ratings, and reviews before making a purchase. If you encounter any issues with downloaded content, please contact our support team."})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-800/50 border border-gray-200 dark:border-slate-700 rounded-xl p-8 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx(fp,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white",children:"Shipping & Delivery"})]}),l.jsx("p",{className:"text-gray-700 dark:text-slate-300 mb-4",children:"All notes are delivered digitally - no physical shipping required!"}),l.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-slate-400",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"Instant access after payment confirmation"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:'Download your purchased notes from the "Downloads" section'})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"Access your notes anytime, anywhere"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"No delivery charges or waiting time"})]})]})]})]})})}),l.jsx("section",{id:"contact",className:"py-20 bg-white dark:bg-slate-950",children:l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white dark:from-slate-800/50 dark:to-slate-800/30 border border-gray-200 dark:border-slate-700 rounded-2xl p-8 lg:p-12 text-center shadow-lg",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-2xl mb-6",children:l.jsx(Ul,{className:"w-8 h-8 text-white"})}),l.jsx("h2",{className:"text-3xl text-gray-900 dark:text-white mb-4",children:"Get in Touch"}),l.jsx("p",{className:"text-gray-700 dark:text-slate-300 mb-6 max-w-2xl mx-auto",children:"Have questions, feedback, or need support? We'd love to hear from you! Our team is here to help."}),l.jsxs("a",{href:"mailto:notzy2026@gmail.com",className:"inline-flex items-center gap-2 px-6 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-slate-700/50 dark:hover:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded-xl text-gray-900 dark:text-white transition-colors",children:[l.jsx(Ul,{className:"w-5 h-5"}),l.jsx("span",{children:"notzy2026@gmail.com"})]}),l.jsx("div",{className:"mt-8 pt-8 border-t border-gray-200 dark:border-slate-700",children:l.jsx("p",{className:"text-gray-600 dark:text-slate-400 text-sm",children:"We're a growing platform and currently focused on email support. Social media channels coming soon!"})})]})})}),l.jsx("footer",{className:"bg-gray-100 dark:bg-slate-900 border-t border-gray-200 dark:border-slate-800 py-12",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center",children:l.jsx(Is,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-gray-900 dark:text-white",children:"Notezy"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-400",children:"Knowledge Marketplace"})]})]}),l.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-sm text-gray-600 dark:text-slate-400",children:[l.jsx("button",{onClick:()=>d("about"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"About Us"}),l.jsx("button",{onClick:()=>d("features"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Features"}),l.jsx("button",{onClick:()=>d("contact"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Contact"})]})]}),l.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200 dark:border-slate-800",children:[l.jsxs("div",{className:"flex flex-wrap justify-center gap-4 md:gap-6 text-sm text-gray-600 dark:text-slate-400 mb-6",children:[l.jsx(Cs,{to:"/terms",className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Terms & Conditions"}),l.jsx(Cs,{to:"/privacy",className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Privacy Policy"}),l.jsx(Cs,{to:"/refund",className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Refund & Cancellation"}),l.jsx(Cs,{to:"/shipping",className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Shipping & Delivery"}),l.jsx(Cs,{to:"/contact",className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Contact Us"})]}),l.jsx("p",{className:"text-center text-sm text-gray-500 dark:text-slate-500",children:" 2025 Notezy. All rights reserved. Built for students, by students."})]})]})})]})}function _l({className:n,type:e,...t}){return l.jsx("input",{type:e,"data-slot":"input",className:gA("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n),...t})}function X3({onNavigateToSignup:n,onNavigateToLanding:e}){const[t,s]=F.useState(""),[r,i]=F.useState(""),[o,u]=F.useState(!1),[d,h]=F.useState(""),[p,m]=F.useState(!1),{login:x,enterGuestMode:v}=Us(),{isDark:w,toggleTheme:E}=Vu(),N=async A=>{if(A.preventDefault(),h(""),m(!0),!t||!r){h("Please fill in all fields"),m(!1);return}const T=await x(t,r);T.success||h(T.error||"Invalid email or password"),m(!1)};return l.jsxs("div",{className:`min-h-screen flex items-center justify-center px-4 py-8 ${w?"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900":"bg-gradient-to-br from-gray-100 via-white to-gray-100"}`,children:[l.jsx("button",{onClick:E,className:`fixed top-4 right-4 p-3 rounded-xl transition-colors z-50 ${w?"bg-slate-800/50 hover:bg-slate-800 text-slate-300":"bg-white/80 hover:bg-white text-gray-700 shadow-lg"}`,children:w?l.jsx(ga,{className:"w-5 h-5"}):l.jsx(pa,{className:"w-5 h-5"})}),e&&l.jsxs("button",{onClick:e,className:`fixed top-4 left-4 flex items-center gap-2 px-4 py-2 rounded-lg transition-colors z-50 ${w?"bg-slate-800/50 hover:bg-slate-800 border border-slate-700 text-slate-300 hover:text-white":"bg-white/80 hover:bg-white shadow-lg text-gray-700 hover:text-gray-900"}`,children:[l.jsx(zt,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Back to Home"})]}),l.jsxs("div",{className:"w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"inline-flex items-center gap-3 mb-4",children:l.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-2xl flex items-center justify-center shadow-xl",children:l.jsx(Is,{className:"w-8 h-8 text-white"})})}),l.jsx("h1",{className:`text-3xl mb-2 ${w?"text-white":"text-gray-900"}`,children:"Welcome Back"}),l.jsx("p",{className:w?"text-slate-400":"text-gray-600",children:"Sign in to access your notes marketplace"})]}),l.jsxs("div",{className:`backdrop-blur-xl rounded-2xl p-8 shadow-2xl ${w?"bg-slate-800/50 border border-slate-700/50":"bg-white/80 border border-gray-200"}`,children:[l.jsxs("form",{onSubmit:N,className:"space-y-6",children:[d&&l.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:d}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{htmlFor:"email",className:`block text-sm ${w?"text-slate-300":"text-gray-700"}`,children:"Email Address"}),l.jsx(_l,{id:"email",type:"email",value:t,onChange:A=>s(A.target.value),placeholder:"Enter your email",className:w?"bg-slate-900/50 border-slate-700 text-white placeholder:text-slate-500 focus:border-purple-500 focus:ring-purple-500/20":"bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 focus:border-purple-500 focus:ring-purple-500/20"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{htmlFor:"password",className:`block text-sm ${w?"text-slate-300":"text-gray-700"}`,children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(_l,{id:"password",type:o?"text":"password",value:r,onChange:A=>i(A.target.value),placeholder:"Enter your password",className:`pr-10 ${w?"bg-slate-900/50 border-slate-700 text-white placeholder:text-slate-500 focus:border-purple-500 focus:ring-purple-500/20":"bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 focus:border-purple-500 focus:ring-purple-500/20"}`}),l.jsx("button",{type:"button",onClick:()=>u(!o),className:`absolute right-3 top-1/2 -translate-y-1/2 ${w?"text-slate-400 hover:text-slate-300":"text-gray-400 hover:text-gray-600"}`,children:o?l.jsx(mN,{className:"w-5 h-5"}):l.jsx(hp,{className:"w-5 h-5"})})]})]}),l.jsx(ht,{type:"submit",disabled:p,className:"w-full bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 hover:from-blue-700 hover:via-purple-700 hover:to-pink-700 text-white shadow-lg hover:shadow-xl transition-all",children:p?"Signing in...":"Sign In"}),l.jsxs("div",{className:"relative my-4",children:[l.jsx("div",{className:"absolute inset-0 flex items-center",children:l.jsx("div",{className:`w-full border-t ${w?"border-slate-700":"border-gray-300"}`})}),l.jsx("div",{className:"relative flex justify-center text-sm",children:l.jsx("span",{className:`px-2 ${w?"bg-slate-800/50 text-slate-400":"bg-white/80 text-gray-500"}`,children:"or"})})]}),l.jsxs("button",{type:"button",onClick:v,className:`w-full py-3 rounded-xl font-medium transition-all flex items-center justify-center gap-2 ${w?"bg-slate-700 hover:bg-slate-600 text-slate-200":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:[l.jsx(di,{className:"w-5 h-5"}),"Continue as Guest"]})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:w?"text-slate-400":"text-gray-600",children:["Don't have an account?"," ",l.jsx("button",{onClick:n,className:"text-purple-500 hover:text-purple-400 transition-colors font-medium",children:"Sign Up"})]})})]}),l.jsx("p",{className:`text-center text-xs mt-6 ${w?"text-slate-500":"text-gray-500"}`,children:"By continuing, you agree to our Terms of Service and Privacy Policy"})]})]})}function Q3({onNavigateToLogin:n,onNavigateToLanding:e}){const[t,s]=F.useState(""),[r,i]=F.useState(""),[o,u]=F.useState(""),[d,h]=F.useState(""),[p,m]=F.useState(!1),[x,v]=F.useState(""),[w,E]=F.useState(!1),{signup:N,enterGuestMode:A}=Us(),{isDark:T,toggleTheme:I}=Vu(),P=async U=>{if(U.preventDefault(),v(""),E(!0),!t||!r||!o||!d){v("Please fill in all fields"),E(!1);return}if(o!==d){v("Passwords do not match"),E(!1);return}if(o.length<6){v("Password must be at least 6 characters"),E(!1);return}const O=await N(t,r,o);O.success||v(O.error||"Failed to create account"),E(!1)};return l.jsxs("div",{className:`min-h-screen flex items-center justify-center px-4 py-8 ${T?"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900":"bg-gradient-to-br from-gray-100 via-white to-gray-100"}`,children:[l.jsx("button",{onClick:I,className:`fixed top-4 right-4 p-3 rounded-xl transition-colors z-50 ${T?"bg-slate-800/50 hover:bg-slate-800 text-slate-300":"bg-white/80 hover:bg-white text-gray-700 shadow-lg"}`,children:T?l.jsx(ga,{className:"w-5 h-5"}):l.jsx(pa,{className:"w-5 h-5"})}),e&&l.jsxs("button",{onClick:e,className:`fixed top-4 left-4 flex items-center gap-2 px-4 py-2 rounded-lg transition-colors z-50 ${T?"bg-slate-800/50 hover:bg-slate-800 border border-slate-700 text-slate-300 hover:text-white":"bg-white/80 hover:bg-white shadow-lg text-gray-700 hover:text-gray-900"}`,children:[l.jsx(zt,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Back to Home"})]}),l.jsxs("div",{className:"w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"inline-flex items-center gap-3 mb-4",children:l.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-2xl flex items-center justify-center shadow-xl",children:l.jsx(Is,{className:"w-8 h-8 text-white"})})}),l.jsx("h1",{className:`text-3xl mb-2 ${T?"text-white":"text-gray-900"}`,children:"Create Account"}),l.jsx("p",{className:T?"text-slate-400":"text-gray-600",children:"Join the knowledge marketplace"})]}),l.jsxs("div",{className:`backdrop-blur-xl rounded-2xl p-8 shadow-2xl ${T?"bg-slate-800/50 border border-slate-700/50":"bg-white/80 border border-gray-200"}`,children:[l.jsxs("form",{onSubmit:P,className:"space-y-5",children:[x&&l.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:x}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{htmlFor:"name",className:`block text-sm ${T?"text-slate-300":"text-gray-700"}`,children:"Full Name"}),l.jsx(_l,{id:"name",type:"text",value:t,onChange:U=>s(U.target.value),placeholder:"Enter your full name",className:T?"bg-slate-900/50 border-slate-700 text-white placeholder:text-slate-500 focus:border-purple-500 focus:ring-purple-500/20":"bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 focus:border-purple-500 focus:ring-purple-500/20"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{htmlFor:"email",className:`block text-sm ${T?"text-slate-300":"text-gray-700"}`,children:"Email Address"}),l.jsx(_l,{id:"email",type:"email",value:r,onChange:U=>i(U.target.value),placeholder:"Enter your email",className:T?"bg-slate-900/50 border-slate-700 text-white placeholder:text-slate-500 focus:border-purple-500 focus:ring-purple-500/20":"bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 focus:border-purple-500 focus:ring-purple-500/20"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{htmlFor:"password",className:`block text-sm ${T?"text-slate-300":"text-gray-700"}`,children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(_l,{id:"password",type:p?"text":"password",value:o,onChange:U=>u(U.target.value),placeholder:"Create a password",className:`pr-10 ${T?"bg-slate-900/50 border-slate-700 text-white placeholder:text-slate-500 focus:border-purple-500 focus:ring-purple-500/20":"bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 focus:border-purple-500 focus:ring-purple-500/20"}`}),l.jsx("button",{type:"button",onClick:()=>m(!p),className:`absolute right-3 top-1/2 -translate-y-1/2 ${T?"text-slate-400 hover:text-slate-300":"text-gray-400 hover:text-gray-600"}`,children:p?l.jsx(mN,{className:"w-5 h-5"}):l.jsx(hp,{className:"w-5 h-5"})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{htmlFor:"confirmPassword",className:`block text-sm ${T?"text-slate-300":"text-gray-700"}`,children:"Confirm Password"}),l.jsx(_l,{id:"confirmPassword",type:p?"text":"password",value:d,onChange:U=>h(U.target.value),placeholder:"Confirm your password",className:T?"bg-slate-900/50 border-slate-700 text-white placeholder:text-slate-500 focus:border-purple-500 focus:ring-purple-500/20":"bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 focus:border-purple-500 focus:ring-purple-500/20"})]}),l.jsx(ht,{type:"submit",disabled:w,className:"w-full bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 hover:from-blue-700 hover:via-purple-700 hover:to-pink-700 text-white shadow-lg hover:shadow-xl transition-all",children:w?"Creating Account...":"Create Account"}),l.jsxs("div",{className:"relative my-4",children:[l.jsx("div",{className:"absolute inset-0 flex items-center",children:l.jsx("div",{className:`w-full border-t ${T?"border-slate-700":"border-gray-300"}`})}),l.jsx("div",{className:"relative flex justify-center text-sm",children:l.jsx("span",{className:`px-2 ${T?"bg-slate-800/50 text-slate-400":"bg-white/80 text-gray-500"}`,children:"or"})})]}),l.jsxs("button",{type:"button",onClick:A,className:`w-full py-3 rounded-xl font-medium transition-all flex items-center justify-center gap-2 ${T?"bg-slate-700 hover:bg-slate-600 text-slate-200":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:[l.jsx(di,{className:"w-5 h-5"}),"Continue as Guest"]})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:T?"text-slate-400":"text-gray-600",children:["Already have an account?"," ",l.jsx("button",{onClick:n,className:"text-purple-500 hover:text-purple-400 transition-colors font-medium",children:"Sign In"})]})})]}),l.jsx("p",{className:`text-center text-xs mt-6 ${T?"text-slate-500":"text-gray-500"}`,children:"By creating an account, you agree to our Terms of Service and Privacy Policy"})]})]})}function J3({onNavigateToTerms:n,onNavigateToAbout:e,onNavigateToPrivacy:t,onNavigateToRefund:s,onNavigateToShipping:r}){const{userProfile:i,logout:o}=Us(),{isDark:u,toggleTheme:d}=Vu(),h=()=>{o()};return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 lg:ml-64 pb-24 lg:pb-8 mobile-page-content",children:l.jsxs("div",{className:"max-w-4xl mx-auto p-4 lg:p-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-2xl lg:text-3xl text-gray-900 dark:text-white mb-2",children:"Settings"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"Manage your account preferences and security"})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-lg flex items-center justify-center",children:l.jsx(di,{className:"w-5 h-5 text-white"})}),l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"Account"})]}),l.jsx("div",{className:"space-y-4",children:l.jsx("div",{className:"flex items-center justify-between p-4 bg-gray-100 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700/50",children:l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-900 dark:text-white",children:i?.name||"User"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:i?.email})]})})})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-lg flex items-center justify-center",children:u?l.jsx(pa,{className:"w-5 h-5 text-white"}):l.jsx(ga,{className:"w-5 h-5 text-white"})}),l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"Appearance"})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-100 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700/50",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-900 dark:text-white",children:"Theme"}),l.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:["Current: ",u?"Dark Mode":"Light Mode"]})]}),l.jsx("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg transition-all",children:u?l.jsxs(l.Fragment,{children:[l.jsx(ga,{className:"w-4 h-4"}),"Switch to Light"]}):l.jsxs(l.Fragment,{children:[l.jsx(pa,{className:"w-4 h-4"}),"Switch to Dark"]})})]})})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-teal-500 rounded-lg flex items-center justify-center",children:l.jsx(Wn,{className:"w-5 h-5 text-white"})}),l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"Legal"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-4 bg-gray-100 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700/50 hover:bg-gray-200 dark:hover:bg-slate-800 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Vs,{className:"w-5 h-5 text-gray-500 dark:text-slate-400"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Terms & Conditions"})]}),l.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:""})]}),l.jsxs("button",{onClick:t,className:"w-full flex items-center justify-between p-4 bg-gray-100 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700/50 hover:bg-gray-200 dark:hover:bg-slate-800 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Wn,{className:"w-5 h-5 text-gray-500 dark:text-slate-400"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Privacy Policy"})]}),l.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:""})]}),l.jsxs("button",{onClick:s,className:"w-full flex items-center justify-between p-4 bg-gray-100 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700/50 hover:bg-gray-200 dark:hover:bg-slate-800 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(gN,{className:"w-5 h-5 text-gray-500 dark:text-slate-400"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Refund Policy"})]}),l.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:""})]}),l.jsxs("button",{onClick:r,className:"w-full flex items-center justify-between p-4 bg-gray-100 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700/50 hover:bg-gray-200 dark:hover:bg-slate-800 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(fp,{className:"w-5 h-5 text-gray-500 dark:text-slate-400"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Shipping Policy"})]}),l.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:""})]}),l.jsxs("button",{onClick:e,className:"w-full flex items-center justify-between p-4 bg-gray-100 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700/50 hover:bg-gray-200 dark:hover:bg-slate-800 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(YL,{className:"w-5 h-5 text-gray-500 dark:text-slate-400"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"About Us"})]}),l.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:""})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-red-200 dark:border-red-900/30 rounded-2xl p-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-red-500 to-rose-500 rounded-lg flex items-center justify-center",children:l.jsx(Af,{className:"w-5 h-5 text-white"})}),l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"Danger Zone"})]}),l.jsxs(ht,{onClick:h,className:"w-full bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700 text-white",children:[l.jsx(Af,{className:"w-5 h-5 mr-2"}),"Log Out"]})]})]})})}function Z3({onBack:n}){return l.jsx("div",{className:"min-h-screen bg-slate-950 lg:ml-64 pt-20 pb-24 lg:pt-0 lg:pb-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto p-4 lg:p-8",children:[l.jsxs(ht,{onClick:n,variant:"ghost",className:"mb-6 text-slate-400 hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Settings"]}),l.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-xl border border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsx("h1",{className:"text-3xl text-white mb-6",children:"Terms & Conditions"}),l.jsxs("div",{className:"space-y-6 text-slate-300",children:[l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"1. Acceptance of Terms"}),l.jsx("p",{className:"leading-relaxed",children:"By accessing and using Notezy, you accept and agree to be bound by the terms and provision of this agreement. If you do not agree to these terms, please do not use our service."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"2. User Accounts"}),l.jsx("p",{className:"leading-relaxed mb-3",children:"To access certain features of the platform, you must create an account. You agree to:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[l.jsx("li",{children:"Provide accurate and complete information"}),l.jsx("li",{children:"Maintain the security of your password"}),l.jsx("li",{children:"Accept responsibility for all activities under your account"}),l.jsx("li",{children:"Notify us immediately of any unauthorized access"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"3. Content Guidelines"}),l.jsx("p",{className:"leading-relaxed mb-3",children:"When uploading notes and educational materials, you must ensure that:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[l.jsx("li",{children:"You own the copyright or have permission to share the content"}),l.jsx("li",{children:"The content does not violate any intellectual property rights"}),l.jsx("li",{children:"The material is accurate and not misleading"}),l.jsx("li",{children:"The content does not contain harmful or inappropriate material"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"4. Purchases and Payments"}),l.jsx("p",{className:"leading-relaxed",children:"All purchases made through Notezy are final. We reserve the right to refuse or cancel any transaction. Sellers agree to our revenue sharing model, and earnings will be paid according to our payment schedule."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"5. Intellectual Property"}),l.jsx("p",{className:"leading-relaxed",children:"The Notezy platform, including its design, features, and original content, is protected by copyright and other intellectual property laws. Users retain ownership of their uploaded content but grant us a license to display and distribute it through our platform."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"6. Prohibited Activities"}),l.jsx("p",{className:"leading-relaxed mb-3",children:"Users are prohibited from:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[l.jsx("li",{children:"Uploading copyrighted material without permission"}),l.jsx("li",{children:"Engaging in fraudulent activities"}),l.jsx("li",{children:"Harassing or threatening other users"}),l.jsx("li",{children:"Attempting to compromise platform security"}),l.jsx("li",{children:"Using automated tools to scrape content"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"7. Termination"}),l.jsx("p",{className:"leading-relaxed",children:"We reserve the right to suspend or terminate accounts that violate these terms without prior notice. Users may close their accounts at any time through the settings page."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"8. Limitation of Liability"}),l.jsx("p",{className:"leading-relaxed",children:'Notezy is provided "as is" without warranties of any kind. We are not liable for any damages arising from the use of our platform, including but not limited to loss of data, revenue, or educational opportunities.'})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"9. Changes to Terms"}),l.jsx("p",{className:"leading-relaxed",children:"We reserve the right to modify these terms at any time. Users will be notified of significant changes via email. Continued use of the platform after changes constitutes acceptance of the new terms."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-white mb-3",children:"10. Contact Information"}),l.jsx("p",{className:"leading-relaxed",children:"For questions about these terms, please contact us at legal@noteshub.com"})]}),l.jsx("div",{className:"mt-8 pt-6 border-t border-slate-800",children:l.jsx("p",{className:"text-sm text-slate-400",children:"Last updated: December 16, 2024"})})]})]})]})})}function eF({onBack:n}){return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 lg:ml-64 pt-20 pb-24 lg:pt-0 lg:pb-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto p-4 lg:p-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs(ht,{onClick:n,variant:"ghost",className:"mb-4 text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Settings"]}),l.jsx("h1",{className:"text-2xl lg:text-3xl text-gray-900 dark:text-white mb-2",children:"About Us"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"Learn more about Notezy"})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center",children:l.jsx(i0,{className:"w-6 h-6 text-white"})}),l.jsx("h2",{className:"text-2xl text-gray-900 dark:text-white",children:"Welcome to Notezy"})]}),l.jsxs("div",{className:"space-y-4 text-gray-700 dark:text-slate-300",children:[l.jsxs("p",{children:["Welcome to ",l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Notezy"})," - a brand new platform designed by students, for students. We understand the challenges of finding quality study materials and the effort that goes into creating excellent notes."]}),l.jsxs("p",{children:["Our mission is simple: to provide students with easy access to high-quality ",l.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"assignments"}),", ",l.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"previous year question papers (PYQs)"}),", and ",l.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"lecture notes"})," while empowering content creators to earn from their hard work."]}),l.jsx("p",{children:"Whether you're looking to excel in your studies or want to monetize your knowledge, Notezy is your one-stop platform. Join our growing community and experience the future of academic resource sharing."}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-4",children:"What We Provide"}),l.jsxs("ul",{className:"space-y-3",children:[l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Assignments:"})," High-quality assignment solutions from top students across various subjects and courses"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"PYQ Papers:"})," Previous year question papers with detailed solutions to help you ace your exams"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-pink-600 dark:text-pink-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Lecture Notes:"})," Comprehensive lecture notes prepared by experienced students and educators"]})]})]})]}),l.jsx("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:l.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 dark:bg-blue-500/10 border border-blue-200 dark:border-blue-500/20 rounded-lg",children:[l.jsx(Fs,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),l.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Start earning by selling your notes today!"})]})}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Contact Us"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400 mb-2",children:"Have questions or feedback? We'd love to hear from you!"}),l.jsx("a",{href:"mailto:notzy2026@gmail.com",className:"text-purple-600 dark:text-purple-400 hover:underline",children:"notzy2026@gmail.com"})]})]})]})]})})}function tF({onBack:n}){return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 lg:ml-64 pt-20 pb-24 lg:pt-0 lg:pb-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto p-4 lg:p-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs(ht,{onClick:n,variant:"ghost",className:"mb-4 text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Settings"]}),l.jsx("h1",{className:"text-2xl lg:text-3xl text-gray-900 dark:text-white mb-2",children:"Privacy Policy"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"How we protect and handle your data"})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-teal-500 rounded-xl flex items-center justify-center",children:l.jsx(Wn,{className:"w-6 h-6 text-white"})}),l.jsx("h2",{className:"text-2xl text-gray-900 dark:text-white",children:"Your Privacy Matters"})]}),l.jsxs("div",{className:"space-y-6 text-gray-700 dark:text-slate-300",children:[l.jsx("p",{className:"text-lg text-gray-900 dark:text-white",children:"Your privacy and security are our top priorities. We implement industry-standard security measures to protect your personal information."}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Data Protection"}),l.jsxs("ul",{className:"space-y-3",children:[l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Encryption:"})," All user data is encrypted and stored securely using industry-standard protocols"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"No Third-Party Sharing:"})," We never share your personal information with third parties without your explicit consent"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Secure Payments:"})," Payment information is processed through secure, PCI-compliant gateways"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Data Control:"})," You have full control over your data and can request deletion anytime"]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Information We Collect"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Account information (name, email address)"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Transaction history and purchase records"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Uploaded content and notes"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Usage data and analytics (anonymous)"})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"How We Use Your Data"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"To provide and improve our services"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"To process transactions and payments"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"To send important account updates (with your permission)"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"To prevent fraud and ensure platform security"})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Your Rights"}),l.jsx("p",{className:"mb-3",children:"You have the right to:"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-pink-600 dark:text-pink-400 mt-1",children:""}),l.jsx("span",{children:"Access your personal data"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-pink-600 dark:text-pink-400 mt-1",children:""}),l.jsx("span",{children:"Request correction of inaccurate data"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-pink-600 dark:text-pink-400 mt-1",children:""}),l.jsx("span",{children:"Request deletion of your account and data"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-pink-600 dark:text-pink-400 mt-1",children:""}),l.jsx("span",{children:"Opt-out of marketing communications"})]})]})]}),l.jsx("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700 bg-blue-50 dark:bg-blue-500/10 p-4 rounded-lg border border-blue-200 dark:border-blue-500/20",children:l.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Note:"})," Notezy is not meant for collecting personally identifiable information (PII) or handling sensitive data beyond what's necessary for the platform operation. We are committed to data minimization and only collect what's essential."]})}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:["For any privacy-related questions or to exercise your rights, please contact us at"," ",l.jsx("a",{href:"mailto:notzy2026@gmail.com",className:"text-purple-600 dark:text-purple-400 hover:underline",children:"notzy2026@gmail.com"})]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-500 mt-4",children:"Last updated: December 2025"})]})]})]})]})})}function sF({onBack:n}){return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 lg:ml-64 pt-20 pb-24 lg:pt-0 lg:pb-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto p-4 lg:p-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs(ht,{onClick:n,variant:"ghost",className:"mb-4 text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Settings"]}),l.jsx("h1",{className:"text-2xl lg:text-3xl text-gray-900 dark:text-white mb-2",children:"Refund & Cancellation Policy"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"Understanding our digital product policy"})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-rose-500 rounded-xl flex items-center justify-center",children:l.jsx(Vs,{className:"w-6 h-6 text-white"})}),l.jsx("h2",{className:"text-2xl text-gray-900 dark:text-white",children:"Refund & Cancellation"})]}),l.jsx("div",{className:"mb-6 p-6 bg-red-50 dark:bg-red-500/10 border-2 border-red-200 dark:border-red-500/20 rounded-xl",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(pN,{className:"w-6 h-6 text-red-600 dark:text-red-400 mt-1 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg text-red-700 dark:text-red-400 mb-2",children:"No Refunds  No Cancellations"}),l.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm",children:"All sales are final. Due to the digital nature of our products, we cannot offer refunds or cancellations once a purchase is completed and the notes are downloaded."})]})]})}),l.jsxs("div",{className:"space-y-6 text-gray-700 dark:text-slate-300",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Why No Refunds?"}),l.jsx("p",{className:"mb-4",children:'Notezy offers digital products (study notes, assignments, PYQ papers) that are delivered instantly upon purchase. Unlike physical products, digital content cannot be "returned" once accessed.'}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Instant Access:"})," You receive immediate access to the content after purchase"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Digital Nature:"})," Once downloaded, the content is in your possession"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Industry Standard:"})," This is standard practice for digital content platforms"]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Before You Purchase"}),l.jsx("p",{className:"mb-4",children:"We encourage all users to make informed decisions before purchasing. Here's what you can do:"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Preview Content:"})," Use the preview feature to review sample pages before buying"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Read Reviews:"})," Check ratings and reviews from other students"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Check Details:"})," Review the note description, page count, and topics covered"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Verify Seller:"})," Look at the seller's rating and upload history"]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Order Cancellation"}),l.jsx("p",{className:"mb-3",children:"Orders cannot be cancelled once the payment is processed, as you receive immediate access to the purchased content."}),l.jsx("div",{className:"bg-amber-50 dark:bg-amber-500/10 border border-amber-200 dark:border-amber-500/20 rounded-lg p-4",children:l.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-400",children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Tip:"})," Double-check your cart before completing the purchase to ensure you're buying the correct notes."]})})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Technical Issues"}),l.jsx("p",{className:"mb-3",children:"If you experience technical difficulties accessing your purchased content, we're here to help:"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Download problems or corrupted files"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Payment processed but content not accessible"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Missing pages or incomplete content"})]})]}),l.jsxs("p",{className:"mt-3 text-sm",children:["Please contact our support team at"," ",l.jsx("a",{href:"mailto:notzy2026@gmail.com",className:"text-purple-600 dark:text-purple-400 hover:underline",children:"notzy2026@gmail.com"})," ","with your order details and we'll resolve the issue promptly."]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Content Quality Issues"}),l.jsx("p",{className:"mb-3",children:"While we don't offer refunds, we take content quality seriously. If you receive notes that are:"}),l.jsxs("ul",{className:"space-y-2 mb-4",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Significantly different from the description"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Plagiarized or violate copyright"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Completely unreadable or unusable"})]})]}),l.jsx("p",{className:"text-sm",children:"Please report the issue to us immediately. We will investigate and may take action against the seller, including removal of the content from our platform."})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50 p-4 rounded-lg",children:[l.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Policy Updates:"})," We reserve the right to update this policy at any time. Continued use of the platform after changes constitutes acceptance of the updated policy."]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-500 mt-3",children:"Last updated: December 2025"})]})]})]})]})})}function nF({onBack:n}){return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 lg:ml-64 pt-20 pb-24 lg:pt-0 lg:pb-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto p-4 lg:p-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs(ht,{onClick:n,variant:"ghost",className:"mb-4 text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Settings"]}),l.jsx("h1",{className:"text-2xl lg:text-3xl text-gray-900 dark:text-white mb-2",children:"Shipping & Delivery Policy"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"Digital delivery information"})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center",children:l.jsx(fp,{className:"w-6 h-6 text-white"})}),l.jsx("h2",{className:"text-2xl text-gray-900 dark:text-white",children:"Digital Delivery"})]}),l.jsx("div",{className:"mb-6 p-6 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-500/10 dark:to-purple-500/10 border border-blue-200 dark:border-blue-500/20 rounded-xl",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(qn,{className:"w-6 h-6 text-blue-600 dark:text-blue-400 mt-1 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-2",children:"100% Digital - No Physical Shipping"}),l.jsx("p",{className:"text-gray-700 dark:text-slate-300 text-sm",children:"All notes are delivered digitally through our platform. There's no physical shipping involved, which means instant access and no delivery charges!"})]})]})}),l.jsxs("div",{className:"space-y-6 text-gray-700 dark:text-slate-300",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-4",children:"How It Works"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-blue-100 dark:bg-blue-500/20 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"1"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-gray-900 dark:text-white mb-1",children:"Purchase Notes"}),l.jsx("p",{className:"text-sm",children:"Browse and purchase the notes you need from our marketplace"})]})]}),l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-purple-100 dark:bg-purple-500/20 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"2"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-gray-900 dark:text-white mb-1",children:"Instant Access"}),l.jsx("p",{className:"text-sm",children:"Payment is processed securely and you get immediate access"})]})]}),l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-pink-100 dark:bg-pink-500/20 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-pink-600 dark:text-pink-400",children:"3"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-gray-900 dark:text-white mb-1",children:'Download from "Downloads" Section'}),l.jsx("p",{className:"text-sm",children:"Access all your purchased notes anytime from the Downloads page"})]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-4",children:"Delivery Timeline"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-green-50 dark:bg-green-500/10 border border-green-200 dark:border-green-500/20 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(fa,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),l.jsx("h4",{className:"text-gray-900 dark:text-white",children:"Processing Time"})]}),l.jsxs("p",{className:"text-sm text-gray-700 dark:text-slate-300",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400",children:"Instant"})," - Notes are available immediately after payment confirmation"]})]}),l.jsxs("div",{className:"bg-blue-50 dark:bg-blue-500/10 border border-blue-200 dark:border-blue-500/20 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(qn,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),l.jsx("h4",{className:"text-gray-900 dark:text-white",children:"Download Speed"})]}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-slate-300",children:"Depends on your internet connection - typically a few seconds"})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Benefits of Digital Delivery"}),l.jsxs("ul",{className:"space-y-3",children:[l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Instant Access:"})," No waiting for shipping - get your notes immediately after purchase"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"No Shipping Charges:"})," Zero delivery fees - pay only for the content"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Access Anywhere:"})," Download on any device, anytime, from anywhere"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Eco-Friendly:"})," No paper waste or carbon emissions from shipping"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Permanent Access:"})," Your purchased notes remain in your Downloads section indefinitely"]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Accessing Your Notes"}),l.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 rounded-lg p-4 space-y-3",children:[l.jsx("p",{className:"text-sm",children:"To access your purchased notes:"}),l.jsxs("ol",{className:"space-y-2 text-sm",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"1."}),l.jsxs("span",{children:["Navigate to the ",l.jsx("span",{className:"text-gray-900 dark:text-white",children:'"Downloads"'})," section from the main menu"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"2."}),l.jsx("span",{children:"Find the notes you want to view"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"3."}),l.jsxs("span",{children:["Click ",l.jsx("span",{className:"text-gray-900 dark:text-white",children:'"View Notes"'})," to open them in our built-in PDF viewer"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"4."}),l.jsx("span",{children:"You can view, zoom, and navigate through the notes at your convenience"})]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Technical Requirements"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Internet connection for downloading"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"PDF viewer (built into the platform) or PDF reader software"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Compatible with all modern browsers and devices"})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Having Issues?"}),l.jsx("p",{className:"mb-3",children:"If you experience any problems accessing your purchased notes:"}),l.jsxs("ul",{className:"space-y-2 mb-4",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Check your internet connection"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Ensure your payment was successfully processed"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Try refreshing the Downloads page"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Clear your browser cache and cookies"})]})]}),l.jsxs("p",{className:"text-sm",children:["Still having trouble? Contact our support team at"," ",l.jsx("a",{href:"mailto:notzy2026@gmail.com",className:"text-purple-600 dark:text-purple-400 hover:underline",children:"notzy2026@gmail.com"})," ","and we'll help you resolve the issue."]})]}),l.jsx("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700 bg-blue-50 dark:bg-blue-500/10 p-4 rounded-lg border border-blue-200 dark:border-blue-500/20",children:l.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Remember:"})," All notes are delivered digitally. There are no physical products shipped, no tracking numbers, and no delivery addresses required. Everything happens instantly online!"]})}),l.jsx("div",{className:"pt-4",children:l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-500",children:"Last updated: December 2025"})})]})]})]})})}function rF({note:n,onClose:e}){const[t,s]=F.useState(1),[r,i]=F.useState(100),o=n.previewPages.length,u=()=>{s(x=>Math.max(1,x-1))},d=()=>{s(x=>Math.min(o,x+1))},h=()=>{i(x=>Math.min(200,x+25))},p=()=>{i(x=>Math.max(50,x-25))},m=()=>{alert(`Downloading ${n.title}...`)};return l.jsxs("div",{className:"fixed inset-0 bg-slate-950/95 backdrop-blur-sm z-50 flex flex-col",children:[l.jsx("div",{className:"bg-slate-900/80 backdrop-blur-xl border-b border-slate-800 px-4 py-3",children:l.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx(ht,{onClick:e,variant:"ghost",size:"sm",className:"text-slate-400 hover:text-white",children:l.jsx(pi,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-white",children:n.title}),l.jsxs("p",{className:"text-sm text-slate-400",children:["by ",n.uploaderName]})]})]}),l.jsxs(ht,{onClick:m,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white",children:[l.jsx(qn,{className:"w-4 h-4 mr-2"}),"Download PDF"]})]})}),l.jsx("div",{className:"bg-slate-900/80 backdrop-blur-xl border-b border-slate-800 px-4 py-3",children:l.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-center gap-6",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ht,{onClick:u,disabled:t===1,variant:"ghost",size:"sm",className:"text-slate-400 hover:text-white disabled:opacity-50",children:l.jsx(s0,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-slate-800/50 rounded-lg",children:[l.jsx("span",{className:"text-white",children:t}),l.jsx("span",{className:"text-slate-500",children:"/"}),l.jsx("span",{className:"text-slate-400",children:o})]}),l.jsx(ht,{onClick:d,disabled:t===o,variant:"ghost",size:"sm",className:"text-slate-400 hover:text-white disabled:opacity-50",children:l.jsx(n0,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ht,{onClick:p,disabled:r===50,variant:"ghost",size:"sm",className:"text-slate-400 hover:text-white disabled:opacity-50",children:l.jsx(F6,{className:"w-5 h-5"})}),l.jsx("div",{className:"px-4 py-2 bg-slate-800/50 rounded-lg",children:l.jsxs("span",{className:"text-white",children:[r,"%"]})}),l.jsx(ht,{onClick:h,disabled:r===200,variant:"ghost",size:"sm",className:"text-slate-400 hover:text-white disabled:opacity-50",children:l.jsx(L6,{className:"w-5 h-5"})})]})]})}),l.jsx("div",{className:"flex-1 overflow-auto bg-slate-900 p-4 lg:p-8",children:l.jsxs("div",{className:"max-w-5xl mx-auto",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-2xl overflow-hidden transition-transform",style:{transform:`scale(${r/100})`,transformOrigin:"top center"},children:l.jsxs("div",{className:"aspect-[8.5/11] relative",children:[l.jsx("img",{src:n.previewPages[t-1],alt:`Page ${t}`,className:"w-full h-full object-contain"}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:l.jsx("div",{className:"transform -rotate-45 text-6xl font-bold text-black/5 select-none",children:"PREVIEW"})})]})}),l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:"text-slate-400",children:["Page ",t," of ",o]})})]})}),l.jsx("div",{className:"lg:hidden bg-slate-900/80 backdrop-blur-xl border-t border-slate-800 px-4 py-3",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs(ht,{onClick:u,disabled:t===1,variant:"ghost",className:"text-slate-400 hover:text-white disabled:opacity-50",children:[l.jsx(s0,{className:"w-5 h-5 mr-1"}),"Previous"]}),l.jsxs("span",{className:"text-white",children:[t," / ",o]}),l.jsxs(ht,{onClick:d,disabled:t===o,variant:"ghost",className:"text-slate-400 hover:text-white disabled:opacity-50",children:["Next",l.jsx(n0,{className:"w-5 h-5 ml-1"})]})]})})]})}function H_({onBack:n}){const{user:e,userProfile:t}=Us(),[s,r]=F.useState(null),[i,o]=F.useState([]),[u,d]=F.useState(""),[h,p]=F.useState(!0),[m,x]=F.useState(!1),v=F.useRef(null);F.useEffect(()=>{e&&w()},[e]),F.useEffect(()=>{v.current?.scrollIntoView({behavior:"smooth"})},[i]),F.useEffect(()=>{if(!s)return;const A=setInterval(()=>{E(s)},3e3);return()=>clearInterval(A)},[s]);async function w(){if(e)try{const A=await ZM(e.uid);A.length>0&&(r(A[0].id),await E(A[0].id))}catch(A){console.error("Error initializing chat:",A)}finally{p(!1)}}async function E(A){try{const T=await uN(A);o(T)}catch(T){console.error("Error loading messages:",T)}}async function N(A){if(A.preventDefault(),!(!u.trim()||!e||!t)){x(!0);try{if(s)await cN(s,e.uid,t.name,!1,u),d(""),await E(s);else{const T=await JM(e.uid,t.name,t.email,u);r(T),d(""),await E(T)}}catch(T){console.error("Error sending message:",T)}finally{x(!1)}}}return h?l.jsx("div",{className:"fixed inset-0 bg-gray-50 dark:bg-gray-950 lg:left-64 flex items-center justify-center z-50",children:l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):l.jsxs("div",{className:"fixed inset-0 bg-gray-50 dark:bg-gray-950 lg:left-64 flex flex-col z-50",children:[l.jsxs("div",{className:"flex-shrink-0 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 p-4 flex items-center gap-4",children:[l.jsx("button",{onClick:n,className:"p-2 -ml-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors",children:l.jsx(zt,{className:"w-6 h-6 text-gray-700 dark:text-gray-300"})}),l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:l.jsx(mn,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Customer Support"}),l.jsxs("p",{className:"text-xs text-green-500 flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"We typically reply within minutes"]})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:i.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[l.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-4",children:l.jsx(mn,{className:"w-10 h-10 text-white"})}),l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-2",children:"Welcome to Notezy Support!"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md",children:"Have a question or need help? Send us a message and our team will get back to you as soon as possible."})]}):l.jsxs(l.Fragment,{children:[i.map(A=>{const T=A.isAdmin===!1;return l.jsx("div",{style:{display:"flex",justifyContent:T?"flex-end":"flex-start"},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:"8px",maxWidth:"75%",flexDirection:T?"row-reverse":"row"},children:[!T&&l.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsx(mn,{className:"w-4 h-4 text-white"})}),l.jsxs("div",{style:{borderRadius:"16px",borderBottomRightRadius:T?"4px":"16px",borderBottomLeftRadius:T?"16px":"4px",padding:"12px 16px",background:T?"linear-gradient(to right, #2563eb, #9333ea)":void 0,backgroundColor:T?void 0:"white",color:T?"white":"#111827",border:T?"none":"1px solid #e5e7eb"},className:T?"":"dark:bg-gray-800 dark:text-white dark:border-gray-700",children:[!T&&l.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium block mb-1",children:"Support Team"}),l.jsx("p",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",margin:0},children:A.text}),l.jsx("span",{style:{fontSize:"11px",marginTop:"4px",display:"block",opacity:T?.7:.5,textAlign:T?"right":"left"},children:new Date(A.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},A.id)}),l.jsx("div",{ref:v})]})}),l.jsx("div",{className:"flex-shrink-0 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800 p-4 safe-area-inset-bottom",children:l.jsx("form",{onSubmit:N,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{type:"text",value:u,onChange:A=>d(A.target.value),placeholder:"Type your message...",className:"flex-1 px-4 py-3 bg-gray-100 dark:bg-gray-800 border-0 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white placeholder-gray-500"}),l.jsx("button",{type:"submit",disabled:m||!u.trim(),className:"p-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-full hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",children:m?l.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):l.jsx(Iu,{className:"w-6 h-6"})})]})})})]})}function iF({onNavigate:n}){const[e,t]=F.useState([]),[s,r]=F.useState([]),[i,o]=F.useState(!0);F.useEffect(()=>{async function h(){try{const[p,m]=await Promise.all([Oy(),Ly()]);t(p),r(m)}catch(p){console.error("Error loading admin data:",p)}finally{o(!1)}}h()},[]);const u=e.reduce((h,p)=>h+p.totalEarnings,0),d=s.reduce((h,p)=>h+p.salesCount,0);return i?l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 lg:ml-64 flex items-center justify-center",children:l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center",children:l.jsx(Sf,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl text-gray-900 dark:text-white",children:"Admin Dashboard"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage your platform"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-2xl shadow-xl",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx(Pu,{className:"w-8 h-8"}),l.jsx("span",{className:"text-white text-opacity-90",children:"Total Users"})]}),l.jsx("div",{className:"text-3xl font-bold",children:e.length})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-2xl shadow-xl",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx(Vs,{className:"w-8 h-8"}),l.jsx("span",{className:"text-white text-opacity-90",children:"Total Notes"})]}),l.jsx("div",{className:"text-3xl font-bold",children:s.length})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 text-white p-6 rounded-2xl shadow-xl",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx(Fs,{className:"w-8 h-8"}),l.jsx("span",{className:"text-white text-opacity-90",children:"Total Revenue"})]}),l.jsxs("div",{className:"text-3xl font-bold",children:["",u.toFixed(2)]})]}),l.jsxs("div",{className:"text-white p-6 rounded-2xl shadow-xl",style:{backgroundColor:"#f97316"},children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx(ro,{className:"w-8 h-8"}),l.jsx("span",{className:"text-white text-opacity-90",children:"Total Sales"})]}),l.jsx("div",{className:"text-3xl font-bold",children:d})]})]}),l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-4",children:"Admin Actions"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("button",{onClick:()=>n("admin-earnings"),className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:shadow-lg transition-all text-left",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mb-4",children:l.jsx(Fs,{className:"w-6 h-6 text-white"})}),l.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-2",children:"User Earnings"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"View earnings for all users"})]}),l.jsxs("button",{onClick:()=>n("admin-notes"),className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:shadow-lg transition-all text-left",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mb-4",children:l.jsx(ro,{className:"w-6 h-6 text-white"})}),l.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-2",children:"Manage Notes"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Mark notes as top selling"})]}),l.jsxs("button",{onClick:()=>n("admin-chats"),className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:shadow-lg transition-all text-left",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-4",children:l.jsx(mn,{className:"w-6 h-6 text-white"})}),l.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-2",children:"Support Chats"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Respond to customer queries"})]})]})]})})}function aF({onBack:n}){const[e,t]=F.useState([]),[s,r]=F.useState(!0),[i,o]=F.useState("");F.useEffect(()=>{async function h(){try{const p=await Oy();t(p.sort((m,x)=>x.totalEarnings-m.totalEarnings))}catch(p){console.error("Error loading users:",p)}finally{r(!1)}}h()},[]);const u=e.filter(h=>h.name.toLowerCase().includes(i.toLowerCase())||h.email.toLowerCase().includes(i.toLowerCase())),d=e.reduce((h,p)=>h+p.totalEarnings,0);return s?l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 lg:ml-64 flex items-center justify-center",children:l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[l.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-800 rounded-xl transition-colors",children:l.jsx(zt,{className:"w-6 h-6 text-gray-700 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:l.jsx(Fs,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl text-gray-900 dark:text-white",children:"User Earnings"}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Total Platform Revenue: ",d.toFixed(2)]})]})]})]}),l.jsx("div",{className:"mb-6",children:l.jsxs("div",{className:"relative max-w-md",children:[l.jsx(ma,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search users...",value:i,onChange:h=>o(h.target.value),className:"w-full pl-12 pr-4 py-3 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white"})]})}),l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 overflow-hidden shadow-lg",children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"User"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Email"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Notes Uploaded"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Total Earnings"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:u.map(h=>l.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center text-white font-medium",children:h.name.charAt(0).toUpperCase()}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:h.name}),h.isAdmin&&l.jsx("span",{className:"px-2 py-0.5 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 text-xs rounded-full",children:"Admin"})]})}),l.jsx("td",{className:"px-6 py-4 text-gray-600 dark:text-gray-400",children:h.email}),l.jsx("td",{className:"px-6 py-4 text-gray-700 dark:text-gray-300",children:h.uploadedNotes.length}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:["",h.totalEarnings.toFixed(2)]})})]},h.id))})]})}),u.length===0&&l.jsx("div",{className:"p-12 text-center text-gray-500 dark:text-gray-400",children:"No users found"})]})]})})}function oF({onBack:n}){const[e,t]=F.useState([]),[s,r]=F.useState(!0),[i,o]=F.useState(""),[u,d]=F.useState(null),[h,p]=F.useState(null);F.useEffect(()=>{m()},[]);async function m(){try{const N=await Ly();t(N)}catch(N){console.error("Error loading notes:",N)}finally{r(!1)}}async function x(N,A){d(N);try{await YM(N,!A),t(e.map(T=>T.id===N?{...T,isTopSelling:!A}:T))}catch(T){console.error("Error updating note:",T)}finally{d(null)}}async function v(N,A){d(N);try{await XM(N,!A),t(e.map(T=>T.id===N?{...T,isVerified:!A}:T))}catch(T){console.error("Error updating note:",T)}finally{d(null)}}async function w(N,A){if(confirm(`Are you sure you want to delete "${A}"? This action cannot be undone.`)){p(N);try{await QM(N),t(e.filter(T=>T.id!==N))}catch(T){console.error("Error deleting note:",T),alert("Failed to delete note")}finally{p(null)}}}const E=e.filter(N=>N.title.toLowerCase().includes(i.toLowerCase())||N.uploaderName.toLowerCase().includes(i.toLowerCase()));return s?l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 lg:ml-64 flex items-center justify-center",children:l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[l.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-800 rounded-xl transition-colors",children:l.jsx(zt,{className:"w-6 h-6 text-gray-700 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center",children:l.jsx(ro,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl text-gray-900 dark:text-white",children:"Manage Notes"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Verify, feature, or delete notes"})]})]})]}),l.jsx("div",{className:"mb-6",children:l.jsxs("div",{className:"relative max-w-md",children:[l.jsx(ma,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search notes...",value:i,onChange:N=>o(N.target.value),className:"w-full pl-12 pr-4 py-3 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white"})]})}),l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 overflow-hidden shadow-lg",children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Note"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Uploader"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Price"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Sales"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Status"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:E.map(N=>l.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[N.thumbnailUrl?l.jsx("img",{src:N.thumbnailUrl,alt:N.title,className:"w-12 h-12 rounded-lg object-cover"}):l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:N.title}),l.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:N.category})]})]})}),l.jsx("td",{className:"px-6 py-4 text-gray-600 dark:text-gray-400",children:N.uploaderName}),l.jsxs("td",{className:"px-6 py-4 text-gray-700 dark:text-gray-300",children:["",N.price]}),l.jsx("td",{className:"px-6 py-4 text-gray-700 dark:text-gray-300",children:N.salesCount}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex flex-wrap gap-1",children:[N.isVerified&&l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs rounded-full",children:[l.jsx(o0,{className:"w-3 h-3"}),"Verified"]}),N.isTopSelling&&l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 text-xs rounded-full",children:[l.jsx(Sf,{className:"w-3 h-3"}),"Top"]}),!N.isVerified&&!N.isTopSelling&&l.jsx("span",{className:"text-gray-400 text-xs",children:"None"})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>v(N.id,N.isVerified||!1),disabled:u===N.id,className:`p-2 rounded-lg transition-all ${N.isVerified?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-green-100 dark:hover:bg-green-900/30 hover:text-green-700 dark:hover:text-green-400"} ${u===N.id?"opacity-50":""}`,title:N.isVerified?"Remove verification":"Verify note",children:l.jsx(Ut,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>x(N.id,N.isTopSelling||!1),disabled:u===N.id,className:`p-2 rounded-lg transition-all ${N.isTopSelling?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-yellow-100 dark:hover:bg-yellow-900/30 hover:text-yellow-700 dark:hover:text-yellow-400"} ${u===N.id?"opacity-50":""}`,title:N.isTopSelling?"Remove from top selling":"Mark as top selling",children:l.jsx(Sf,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>w(N.id,N.title),disabled:h===N.id,className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-red-100 dark:hover:bg-red-900/30 hover:text-red-700 dark:hover:text-red-400 transition-all",title:"Delete note",children:h===N.id?l.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}):l.jsx(wN,{className:"w-5 h-5"})})]})})]},N.id))})]})}),E.length===0&&l.jsx("div",{className:"p-12 text-center text-gray-500 dark:text-gray-400",children:i?"No notes found matching your search":"No notes found"})]})]})})}function lF({onBack:n}){const{userProfile:e}=Us(),[t,s]=F.useState([]),[r,i]=F.useState(null),[o,u]=F.useState([]),[d,h]=F.useState(""),[p,m]=F.useState(!0),[x,v]=F.useState(!1),w=F.useRef(null);F.useEffect(()=>{E()},[]),F.useEffect(()=>{r&&N(r.id)},[r]),F.useEffect(()=>{w.current?.scrollIntoView({behavior:"smooth"})},[o]);async function E(){try{const P=await eL();s(P)}catch(P){console.error("Error loading chats:",P)}finally{m(!1)}}async function N(P){try{const U=await uN(P);u(U)}catch(U){console.error("Error loading messages:",U)}}async function A(P){if(P.preventDefault(),!(!d.trim()||!r||!e)){v(!0);try{await cN(r.id,e.id,e.name,!0,d),h(""),await N(r.id),await E()}catch(U){console.error("Error sending message:",U)}finally{v(!1)}}}async function T(P,U){try{await tL(P,U),await E(),r?.id===P&&i({...r,status:U})}catch(O){console.error("Error updating status:",O)}}function I(){i(null)}return p?l.jsx("div",{style:{minHeight:"100vh",marginLeft:"256px",display:"flex",alignItems:"center",justifyContent:"center"},className:"bg-gray-50 dark:bg-gray-950 lg:ml-64 ml-0",children:l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):r?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"lg:hidden fixed inset-0 z-50 bg-white dark:bg-gray-950 flex flex-col",children:[l.jsxs("div",{style:{backgroundColor:"white",borderBottom:"1px solid #e5e7eb",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},className:"dark:bg-gray-900 dark:border-gray-800",children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("button",{onClick:I,style:{padding:"8px",marginLeft:"-4px",borderRadius:"12px"},className:"hover:bg-gray-100 dark:hover:bg-gray-800",children:l.jsx(zt,{style:{width:"20px",height:"20px"},className:"text-gray-700 dark:text-gray-300"})}),l.jsx("div",{style:{width:"36px",height:"36px",background:"linear-gradient(135deg, #3b82f6, #9333ea)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"500",fontSize:"14px"},children:r.userName.charAt(0).toUpperCase()}),l.jsxs("div",{children:[l.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},className:"text-gray-900 dark:text-white",children:r.userName}),l.jsx("div",{style:{fontSize:"12px"},className:"text-gray-500 dark:text-gray-400",children:r.userEmail})]})]}),r.status==="open"?l.jsx("button",{onClick:()=>T(r.id,"closed"),style:{padding:"8px",borderRadius:"8px"},className:"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400",children:l.jsx(c_,{style:{width:"16px",height:"16px"}})}):l.jsx("button",{onClick:()=>T(r.id,"open"),style:{padding:"8px",borderRadius:"8px"},className:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",children:l.jsx(Ut,{style:{width:"16px",height:"16px"}})})]}),l.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"16px",paddingBottom:"80px"},children:[o.map(P=>l.jsx("div",{style:{display:"flex",justifyContent:P.isAdmin?"flex-end":"flex-start",marginBottom:"12px"},children:l.jsxs("div",{style:{maxWidth:"80%",borderRadius:"16px",padding:"10px 16px",background:P.isAdmin?"linear-gradient(to right, #2563eb, #9333ea)":"#e5e7eb",color:P.isAdmin?"white":"#111827"},children:[l.jsx("p",{style:{fontSize:"14px",margin:0},children:P.text}),l.jsx("span",{style:{fontSize:"11px",marginTop:"2px",display:"block",color:P.isAdmin?"rgba(255,255,255,0.7)":"#6b7280"},children:new Date(P.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},P.id)),l.jsx("div",{ref:w})]}),l.jsx("form",{onSubmit:A,style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"white",borderTop:"1px solid #e5e7eb",padding:"12px",paddingBottom:"max(12px, env(safe-area-inset-bottom))"},className:"dark:bg-gray-900 dark:border-gray-800",children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("input",{type:"text",value:d,onChange:P=>h(P.target.value),placeholder:"Type your reply...",style:{flex:1,padding:"10px 16px",borderRadius:"9999px",border:"none",fontSize:"14px"},className:"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),l.jsx("button",{type:"submit",disabled:x||!d.trim(),style:{padding:"10px",borderRadius:"50%",background:"linear-gradient(to right, #2563eb, #9333ea)",color:"white",border:"none",cursor:"pointer",opacity:x||!d.trim()?.5:1},children:x?l.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid white",borderTopColor:"transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}):l.jsx(Iu,{style:{width:"20px",height:"20px"}})})]})})]}),l.jsx("div",{className:"hidden lg:block",style:{marginLeft:"256px",height:"100vh",display:"flex"},children:l.jsxs("div",{style:{display:"flex",width:"100%",height:"100%"},children:[l.jsxs("div",{style:{width:"320px",borderRight:"1px solid #e5e7eb",display:"flex",flexDirection:"column",flexShrink:0},className:"bg-white dark:bg-gray-900 dark:border-gray-800",children:[l.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",gap:"12px"},className:"dark:border-gray-800",children:[l.jsx("button",{onClick:n,style:{padding:"8px",marginLeft:"-8px",borderRadius:"12px"},className:"hover:bg-gray-100 dark:hover:bg-gray-800",children:l.jsx(zt,{style:{width:"20px",height:"20px"},className:"text-gray-700 dark:text-gray-300"})}),l.jsx(mn,{style:{width:"20px",height:"20px"},className:"text-blue-600"}),l.jsx("span",{style:{fontWeight:"500"},className:"text-gray-900 dark:text-white",children:"Chats"})]}),l.jsx("div",{style:{flex:1,overflowY:"auto"},children:t.map(P=>l.jsxs("button",{onClick:()=>i(P),style:{width:"100%",padding:"12px 16px",textAlign:"left",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",border:"none",backgroundColor:r?.id===P.id?"rgba(59, 130, 246, 0.1)":"transparent"},className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 dark:border-gray-800",children:[l.jsx("div",{style:{width:"40px",height:"40px",minWidth:"40px",background:"linear-gradient(135deg, #3b82f6, #9333ea)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"600",fontSize:"14px"},children:P.userName.charAt(0).toUpperCase()}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"2px"},children:[l.jsx("span",{style:{fontWeight:"500",fontSize:"14px"},className:"text-gray-900 dark:text-white",children:P.userName}),l.jsx("span",{style:{fontSize:"11px",padding:"2px 8px",borderRadius:"9999px",backgroundColor:P.status==="open"?"rgba(34, 197, 94, 0.1)":"#f3f4f6",color:P.status==="open"?"#16a34a":"#6b7280"},children:P.status})]}),l.jsx("p",{style:{fontSize:"13px",margin:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},className:"text-gray-500 dark:text-gray-400",children:P.lastMessage})]})]},P.id))})]}),l.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},className:"bg-gray-50 dark:bg-gray-950",children:[l.jsxs("div",{style:{padding:"12px 24px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},className:"bg-white dark:bg-gray-900 dark:border-gray-800",children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[l.jsx("div",{style:{width:"40px",height:"40px",background:"linear-gradient(135deg, #3b82f6, #9333ea)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"500"},children:r.userName.charAt(0).toUpperCase()}),l.jsxs("div",{children:[l.jsx("div",{style:{fontWeight:"500"},className:"text-gray-900 dark:text-white",children:r.userName}),l.jsx("div",{style:{fontSize:"14px"},className:"text-gray-500 dark:text-gray-400",children:r.userEmail})]})]}),r.status==="open"?l.jsxs("button",{onClick:()=>T(r.id,"closed"),style:{display:"flex",alignItems:"center",gap:"4px",padding:"6px 12px",borderRadius:"8px",fontSize:"14px",border:"none",cursor:"pointer"},className:"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 hover:bg-red-200",children:[l.jsx(c_,{style:{width:"16px",height:"16px"}})," Close"]}):l.jsxs("button",{onClick:()=>T(r.id,"open"),style:{display:"flex",alignItems:"center",gap:"4px",padding:"6px 12px",borderRadius:"8px",fontSize:"14px",border:"none",cursor:"pointer"},className:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 hover:bg-green-200",children:[l.jsx(Ut,{style:{width:"16px",height:"16px"}})," Reopen"]})]}),l.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"16px"},children:[o.map(P=>l.jsx("div",{style:{display:"flex",justifyContent:P.isAdmin?"flex-end":"flex-start",marginBottom:"12px"},children:l.jsxs("div",{style:{maxWidth:"70%",borderRadius:"16px",padding:"12px 16px",background:P.isAdmin?"linear-gradient(to right, #2563eb, #9333ea)":"#e5e7eb",color:P.isAdmin?"white":"#111827"},children:[l.jsx("p",{style:{margin:0},children:P.text}),l.jsx("span",{style:{fontSize:"12px",marginTop:"4px",display:"block",color:P.isAdmin?"rgba(255,255,255,0.7)":"#6b7280"},children:new Date(P.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},P.id)),l.jsx("div",{ref:w})]}),l.jsx("form",{onSubmit:A,style:{padding:"16px",borderTop:"1px solid #e5e7eb"},className:"bg-white dark:bg-gray-900 dark:border-gray-800",children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[l.jsx("input",{type:"text",value:d,onChange:P=>h(P.target.value),placeholder:"Type your reply...",style:{flex:1,padding:"12px 16px",borderRadius:"12px",border:"none",fontSize:"14px"},className:"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),l.jsx("button",{type:"submit",disabled:x||!d.trim(),style:{padding:"12px",borderRadius:"12px",background:"linear-gradient(to right, #2563eb, #9333ea)",color:"white",border:"none",cursor:"pointer",opacity:x||!d.trim()?.5:1},children:x?l.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid white",borderTopColor:"transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}):l.jsx(Iu,{style:{width:"20px",height:"20px"}})})]})})]})]})})]}):l.jsx("div",{className:"bg-gray-50 dark:bg-gray-950",style:{minHeight:"100vh",paddingBottom:"80px"},children:l.jsxs("div",{className:"lg:ml-64",style:{padding:"16px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"16px"},children:[l.jsx("button",{onClick:n,style:{padding:"8px",borderRadius:"12px"},className:"hover:bg-gray-200 dark:hover:bg-gray-800",children:l.jsx(zt,{style:{width:"24px",height:"24px"},className:"text-gray-700 dark:text-gray-300"})}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[l.jsx("div",{style:{width:"40px",height:"40px",background:"linear-gradient(135deg, #3b82f6, #2563eb)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx(mn,{style:{width:"20px",height:"20px",color:"white"}})}),l.jsxs("div",{children:[l.jsx("h1",{style:{fontSize:"20px",fontWeight:"600",margin:0},className:"text-gray-900 dark:text-white",children:"Support Chats"}),l.jsxs("p",{style:{fontSize:"12px",margin:0},className:"text-gray-500 dark:text-gray-400",children:[t.length," conversations"]})]})]})]}),l.jsx("div",{style:{borderRadius:"16px",overflow:"hidden",border:"1px solid #e5e7eb"},className:"bg-white dark:bg-gray-900 dark:border-gray-800",children:t.length>0?t.map((P,U)=>l.jsxs("button",{onClick:()=>i(P),style:{width:"100%",padding:"16px",textAlign:"left",display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",border:"none",borderBottom:U<t.length-1?"1px solid #e5e7eb":"none",backgroundColor:"transparent"},className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 active:bg-gray-100 dark:active:bg-gray-800 dark:border-gray-800",children:[l.jsx("div",{style:{width:"48px",height:"48px",minWidth:"48px",background:"linear-gradient(135deg, #3b82f6, #9333ea)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"600",fontSize:"18px"},children:P.userName.charAt(0).toUpperCase()}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"4px"},children:[l.jsx("span",{style:{fontWeight:"500"},className:"text-gray-900 dark:text-white",children:P.userName}),l.jsx("span",{style:{fontSize:"12px",padding:"2px 8px",borderRadius:"9999px",backgroundColor:P.status==="open"?"rgba(34, 197, 94, 0.1)":"#f3f4f6",color:P.status==="open"?"#16a34a":"#6b7280"},children:P.status})]}),l.jsx("p",{style:{fontSize:"14px",margin:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},className:"text-gray-500 dark:text-gray-400",children:P.lastMessage})]})]},P.id)):l.jsxs("div",{style:{padding:"48px",textAlign:"center"},className:"text-gray-500 dark:text-gray-400",children:[l.jsx(mn,{style:{width:"64px",height:"64px",margin:"0 auto 16px",opacity:.3}}),l.jsx("p",{children:"No support chats yet"})]})})]})})}function cF(){const[n,e]=F.useState([]),[t,s]=F.useState(!0),[r,i]=F.useState(null),[o,u]=F.useState(""),[d,h]=F.useState(null);F.useEffect(()=>{p()},[]);async function p(){try{const w=await Oy();e(w.filter(E=>!E.isAdmin))}catch(w){console.error("Error loading users:",w)}finally{s(!1)}}async function m(w,E){i(w);try{await GM(w,!E),e(N=>N.map(A=>A.id===w?{...A,isVerified:!E}:A)),d?.id===w&&h(N=>N?{...N,isVerified:!E}:null)}catch(N){console.error("Error updating verification status:",N)}finally{i(null)}}async function x(w,E){i(w);try{await KM(w,!E),e(N=>N.map(A=>A.id===w?{...A,isBlocked:!E}:A)),d?.id===w&&h(N=>N?{...N,isBlocked:!E}:null)}catch(N){console.error("Error updating block status:",N)}finally{i(null)}}const v=n.filter(w=>w.name.toLowerCase().includes(o.toLowerCase())||w.email.toLowerCase().includes(o.toLowerCase()));return t?l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 lg:ml-64 flex items-center justify-center",children:l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:[l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{backgroundColor:"#db2777"},children:l.jsx(Pu,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl text-gray-900 dark:text-white",children:"Manage Users"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Verify or block platform users"})]})]}),l.jsx("div",{className:"mb-6",children:l.jsxs("div",{className:"relative max-w-md",children:[l.jsx(ma,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search by name or email...",value:o,onChange:w=>u(w.target.value),className:"w-full pl-12 pr-4 py-3 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500 text-gray-900 dark:text-white"})]})}),l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 overflow-hidden",children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-800",children:[l.jsx("th",{className:"text-left p-4 text-gray-600 dark:text-gray-400 font-medium",children:"User"}),l.jsx("th",{className:"text-left p-4 text-gray-600 dark:text-gray-400 font-medium",children:"Email"}),l.jsx("th",{className:"text-left p-4 text-gray-600 dark:text-gray-400 font-medium",children:"Status"}),l.jsx("th",{className:"text-left p-4 text-gray-600 dark:text-gray-400 font-medium",children:"Notes"}),l.jsx("th",{className:"text-left p-4 text-gray-600 dark:text-gray-400 font-medium",children:"Earnings"}),l.jsx("th",{className:"text-right p-4 text-gray-600 dark:text-gray-400 font-medium",children:"Actions"})]})}),l.jsx("tbody",{children:v.map(w=>l.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800 last:border-0 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-medium overflow-hidden",style:{backgroundColor:"#6366f1"},children:w.avatarUrl?l.jsx("img",{src:w.avatarUrl,alt:w.name,className:"w-full h-full object-cover"}):w.name.charAt(0).toUpperCase()}),l.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})}),l.jsx("td",{className:"p-4 text-gray-600 dark:text-gray-400",children:w.email}),l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex gap-2",children:[w.isVerified&&l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:"#dcfce7",color:"#166534"},children:[l.jsx(o0,{className:"w-3 h-3"}),"Verified"]}),w.isBlocked&&l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:"#fee2e2",color:"#991b1b"},children:[l.jsx(Dh,{className:"w-3 h-3"}),"Blocked"]}),!w.isVerified&&!w.isBlocked&&l.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:"#f3f4f6",color:"#6b7280"},children:"Unverified"})]})}),l.jsx("td",{className:"p-4 text-gray-600 dark:text-gray-400",children:w.uploadedNotes.length}),l.jsxs("td",{className:"p-4 text-gray-600 dark:text-gray-400",children:["",w.totalEarnings.toFixed(2)]}),l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex gap-2 justify-end",children:[l.jsx("button",{onClick:()=>h(w),className:"p-2 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",title:"View Profile",children:l.jsx(hp,{className:"w-4 h-4"})}),l.jsxs("button",{onClick:()=>m(w.id,w.isVerified||!1),disabled:r===w.id,className:`inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${w.isVerified?"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700":"text-white hover:opacity-90"}`,style:w.isVerified?{}:{backgroundColor:"#16a34a"},children:[l.jsx(Ut,{className:"w-4 h-4"}),w.isVerified?"Unverify":"Verify"]}),l.jsx("button",{onClick:()=>x(w.id,w.isBlocked||!1),disabled:r===w.id,className:`inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${w.isBlocked?"text-white hover:opacity-90":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-red-100 dark:hover:bg-red-900/30 hover:text-red-700 dark:hover:text-red-400"}`,style:w.isBlocked?{backgroundColor:"#16a34a"}:{},children:w.isBlocked?l.jsxs(l.Fragment,{children:[l.jsx(Wn,{className:"w-4 h-4"}),"Unblock"]}):l.jsxs(l.Fragment,{children:[l.jsx(Dh,{className:"w-4 h-4"}),"Block"]})})]})})]},w.id))})]})}),v.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Pu,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-700"}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:o?"No users found matching your search":"No users found"})]})]})]}),d&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-auto shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"User Profile"}),l.jsx("button",{onClick:()=>h(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors",children:l.jsx(pi,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[l.jsx("div",{className:"w-20 h-20 rounded-2xl flex items-center justify-center text-white text-2xl font-medium overflow-hidden bg-gradient-to-br from-blue-500 to-purple-600",children:d.avatarUrl?l.jsx("img",{src:d.avatarUrl,alt:d.name,className:"w-full h-full object-cover"}):d.name.charAt(0).toUpperCase()}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white font-medium mb-1",children:d.name}),d.bio&&l.jsxs("p",{className:"text-gray-600 dark:text-gray-400 italic mb-2",children:['"',d.bio,'"']}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.isVerified&&l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",children:[l.jsx(o0,{className:"w-3 h-3"}),"Verified"]}),d.isBlocked&&l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400",children:[l.jsx(Dh,{className:"w-3 h-3"}),"Blocked"]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 text-center",children:[l.jsx(Ul,{className:"w-6 h-6 text-blue-500 mx-auto mb-2"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Email"}),l.jsx("p",{className:"text-sm text-gray-900 dark:text-white truncate",children:d.email})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 text-center",children:[l.jsx(Vs,{className:"w-6 h-6 text-purple-500 mx-auto mb-2"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Uploaded Notes"}),l.jsx("p",{className:"text-2xl text-gray-900 dark:text-white font-bold",children:d.uploadedNotes.length})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 text-center",children:[l.jsx(Fs,{className:"w-6 h-6 text-green-500 mx-auto mb-2"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Total Earnings"}),l.jsxs("p",{className:"text-2xl text-gray-900 dark:text-white font-bold",children:["",d.totalEarnings.toFixed(0)]})]})]}),d.uploadedNotes.length>0&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-gray-900 dark:text-white font-medium mb-3",children:"Uploaded Notes"}),l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:d.uploadedNotes.map(w=>l.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl",children:[w.thumbnailUrl?l.jsx("img",{src:w.thumbnailUrl,alt:w.title,className:"w-12 h-12 rounded-lg object-cover"}):l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-gray-900 dark:text-white font-medium truncate",children:w.title}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["",w.price,"  ",w.salesCount," sales"]})]}),l.jsx("div",{className:"flex gap-1",children:w.isVerified&&l.jsx("span",{className:"px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs rounded",children:"Verified"})})]},w.id))})]}),l.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-800",children:[l.jsxs("button",{onClick:()=>m(d.id,d.isVerified||!1),disabled:r===d.id,className:`flex-1 py-3 rounded-xl font-medium transition-all flex items-center justify-center gap-2 ${d.isVerified?"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300":"bg-green-600 text-white"}`,children:[l.jsx(Ut,{className:"w-5 h-5"}),d.isVerified?"Remove Verification":"Verify User"]}),l.jsx("button",{onClick:()=>x(d.id,d.isBlocked||!1),disabled:r===d.id,className:`flex-1 py-3 rounded-xl font-medium transition-all flex items-center justify-center gap-2 ${d.isBlocked?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:d.isBlocked?l.jsxs(l.Fragment,{children:[l.jsx(Wn,{className:"w-5 h-5"}),"Unblock User"]}):l.jsxs(l.Fragment,{children:[l.jsx(Dh,{className:"w-5 h-5"}),"Block User"]})})]})]})]})})]})}function uF({onBack:n}){const[e,t]=F.useState([]),[s,r]=F.useState(!0),[i,o]=F.useState(30),[u,d]=F.useState("30"),[h,p]=F.useState(!1),[m,x]=F.useState(null),[v,w]=F.useState(!1);F.useEffect(()=>{E()},[v]);async function E(){r(!0);try{const[P,U]=await Promise.all([v?iL():rL(),Fy()]);t(P),o(U),d(U.toString())}catch(P){console.error("Error loading payouts:",P)}finally{r(!1)}}async function N(P){x(P);try{await aL(P),await E()}catch(U){console.error("Error marking payout complete:",U),alert("Failed to process payout")}finally{x(null)}}async function A(){const P=parseFloat(u);if(isNaN(P)||P<0||P>100){alert("Fee must be between 0 and 100");return}p(!0);try{await sL(P),o(P),alert("Platform fee updated successfully")}catch(U){console.error("Error updating fee:",U),alert("Failed to update fee")}finally{p(!1)}}const T=e.filter(P=>P.status==="pending").length,I=e.filter(P=>P.status==="pending").reduce((P,U)=>P+U.netAmount,0);return s?l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 lg:ml-64 flex items-center justify-center",children:l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[l.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-800 rounded-xl transition-colors",children:l.jsx(zt,{className:"w-6 h-6 text-gray-700 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:l.jsx(Fs,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl text-gray-900 dark:text-white",children:"Payout Requests"}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[T," pending  ",I.toFixed(2)," to pay"]})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 p-6 mb-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(a0,{className:"w-5 h-5 text-gray-500"}),l.jsx("h2",{className:"text-lg text-gray-900 dark:text-white",children:"Platform Fee Settings"})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex-1 max-w-xs",children:[l.jsx("label",{className:"block text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Platform Fee Percentage"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"number",value:u,onChange:P=>d(P.target.value),min:"0",max:"100",className:"w-24 px-4 py-2 bg-gray-100 dark:bg-gray-800 border-0 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white"}),l.jsx("span",{className:"text-gray-500",children:"%"})]})]}),l.jsxs("button",{onClick:A,disabled:h||u===i.toString(),className:"px-4 py-2 bg-blue-600 text-white rounded-xl flex items-center gap-2 hover:bg-blue-700 transition-colors disabled:opacity-50 mt-6",children:[l.jsx(c6,{className:"w-4 h-4"}),h?"Saving...":"Save"]})]}),l.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-2",children:["Current: ",i,"%  Sellers receive ",100-i,"% of their earnings"]})]}),l.jsxs("div",{className:"flex gap-2 mb-6",children:[l.jsxs("button",{onClick:()=>w(!1),className:`px-4 py-2 rounded-xl font-medium transition-colors flex items-center gap-2 ${v?"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700":"text-white"}`,style:v?void 0:{backgroundColor:"#2563eb"},children:[l.jsx(fa,{className:"w-4 h-4"}),"Pending"]}),l.jsx("button",{onClick:()=>w(!0),className:`px-4 py-2 rounded-xl font-medium transition-colors ${v?"text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700"}`,style:v?{backgroundColor:"#2563eb"}:void 0,children:"All Payouts"})]}),l.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 overflow-hidden shadow-lg",children:e.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"User"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"UPI ID"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Gross"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Fee"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Net Amount"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Status"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Action"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:e.map(P=>l.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:P.userName}),l.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:P.userEmail})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 px-3 py-1 rounded-lg text-sm font-mono",children:P.upiId})}),l.jsxs("td",{className:"px-6 py-4 text-gray-700 dark:text-gray-300",children:["",P.grossAmount.toFixed(2)]}),l.jsxs("td",{className:"px-6 py-4 text-red-600 dark:text-red-400",children:[P.platformFee,"%"]}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("span",{className:"text-green-600 dark:text-green-400 font-bold",children:["",P.netAmount.toFixed(2)]})}),l.jsx("td",{className:"px-6 py-4",children:P.status==="pending"?l.jsxs("span",{className:"flex items-center gap-1 text-yellow-600 dark:text-yellow-400",children:[l.jsx(fa,{className:"w-4 h-4"}),"Pending"]}):l.jsxs("span",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:[l.jsx(Ut,{className:"w-4 h-4"}),"Completed"]})}),l.jsx("td",{className:"px-6 py-4",children:P.status==="pending"&&l.jsx("button",{onClick:()=>N(P.id),disabled:m===P.id,className:"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors disabled:opacity-50 flex items-center gap-2",children:m===P.id?l.jsx(l.Fragment,{children:"Processing..."}):l.jsxs(l.Fragment,{children:[l.jsx(Ut,{className:"w-4 h-4"}),"Mark Paid"]})})})]},P.id))})]})}):l.jsxs("div",{className:"p-12 text-center text-gray-500 dark:text-gray-400",children:[l.jsx(Ut,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-700"}),l.jsxs("p",{children:["No ",v?"":"pending ","payout requests"]})]})})]})})}function dF({onBack:n}){const[e,t]=F.useState([]),[s,r]=F.useState(!0),[i,o]=F.useState(null),[u,d]=F.useState(""),[h,p]=F.useState(""),[m,x]=F.useState(!1),[v,w]=F.useState("pending"),[E,N]=F.useState("");F.useEffect(()=>{A()},[]);async function A(){try{const O=await cL();t(O)}catch(O){console.error("Error loading requests:",O)}finally{r(!1)}}async function T(){if(!(!i||!u.trim())){x(!0);try{await uL(i.id,u.trim(),h.trim()||void 0),t(O=>O.map(R=>R.id===i.id?{...R,status:"responded",response:u.trim(),responseLink:h.trim()}:R)),o(null),d(""),p("")}catch(O){console.error("Error responding:",O),alert("Failed to send response")}finally{x(!1)}}}async function I(O){try{await dL(O),t(R=>R.map(C=>C.id===O?{...C,status:"closed"}:C))}catch(R){console.error("Error closing request:",R)}}const P=e.filter(O=>{const R=v==="all"||O.status===v,C=O.title.toLowerCase().includes(E.toLowerCase())||O.userName.toLowerCase().includes(E.toLowerCase())||O.description.toLowerCase().includes(E.toLowerCase());return R&&C}),U=e.filter(O=>O.status==="pending").length;return s?l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 lg:ml-64 flex items-center justify-center",children:l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:[l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[l.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-800 rounded-xl transition-colors",children:l.jsx(zt,{className:"w-6 h-6 text-gray-700 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl flex items-center justify-center",children:l.jsx(ea,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl text-gray-900 dark:text-white",children:"Note Requests"}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[U," pending requests"]})]})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[l.jsxs("div",{className:"relative flex-1 max-w-md",children:[l.jsx(ma,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search requests...",value:E,onChange:O=>N(O.target.value),className:"w-full pl-12 pr-4 py-3 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500 text-gray-900 dark:text-white"})]}),l.jsx("div",{className:"flex gap-2",children:["pending","responded","all"].map(O=>l.jsx("button",{onClick:()=>w(O),className:`px-4 py-2 rounded-xl font-medium transition-colors capitalize ${v===O?"text-white shadow-md":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700"}`,style:v===O?{backgroundColor:"#2563eb"}:void 0,children:O},O))})]}),P.length>0?l.jsx("div",{className:"space-y-4",children:P.map(O=>l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("h3",{className:"text-lg text-gray-900 dark:text-white font-medium",children:O.title}),l.jsx("span",{className:"text-sm px-2 py-0.5 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 rounded capitalize",children:O.category.replace("-"," ")})]}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["by ",O.userName,"  ",O.userEmail]})]}),l.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${O.status==="pending"?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":O.status==="responded"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400"}`,children:[O.status==="pending"&&l.jsx(fa,{className:"w-3 h-3"}),O.status==="responded"&&l.jsx(Ut,{className:"w-3 h-3"}),O.status.charAt(0).toUpperCase()+O.status.slice(1)]})]}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:O.description}),O.response&&l.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-4 mb-4 border border-green-200 dark:border-green-800",children:[l.jsx("p",{className:"text-sm text-green-700 dark:text-green-400 font-medium mb-1",children:"Your Response:"}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:O.response}),O.responseLink&&l.jsxs("a",{href:O.responseLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 dark:text-blue-400 mt-2 text-sm",children:[l.jsx(dp,{className:"w-3 h-3"}),O.responseLink]})]}),l.jsxs("div",{className:"flex gap-2",children:[O.status==="pending"&&l.jsxs("button",{onClick:()=>o(O),className:"px-4 py-2 bg-blue-600 text-white rounded-lg flex items-center gap-2 hover:bg-blue-700 transition-colors",children:[l.jsx(Iu,{className:"w-4 h-4"}),"Respond"]}),O.status!=="closed"&&l.jsx("button",{onClick:()=>I(O.id),className:"px-4 py-2 bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors",children:"Close Request"})]})]},O.id))}):l.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800",children:[l.jsx(Ut,{className:"w-20 h-20 mx-auto mb-4 text-gray-300 dark:text-gray-700"}),l.jsx("h3",{className:"text-gray-900 dark:text-white mb-2",children:"No Requests Found"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:v==="pending"?"All pending requests have been handled!":"No requests match your search."})]})]}),i&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-lg w-full shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"Respond to Request"}),l.jsx("button",{onClick:()=>o(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl",children:l.jsx(pi,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 mb-4",children:[l.jsx("h4",{className:"text-gray-900 dark:text-white font-medium",children:i.title}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:i.description})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Your Response"}),l.jsx("textarea",{value:u,onChange:O=>d(O.target.value),placeholder:"Provide helpful information or let them know if notes are available...",rows:4,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white resize-none"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(yN,{className:"w-4 h-4 inline mr-1"}),"Link to Notes (optional)"]}),l.jsx("input",{type:"url",value:h,onChange:O=>p(O.target.value),placeholder:"https://example.com/notes or link to uploaded note",className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white"})]}),l.jsxs("button",{onClick:T,disabled:m||!u.trim(),className:"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-medium hover:shadow-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:[l.jsx(Iu,{className:"w-5 h-5"}),m?"Sending...":"Send Response"]})]})]})]})})]})}function hF({onBack:n}){const{userProfile:e}=Us(),[t,s]=F.useState([]),[r,i]=F.useState(!0),[o,u]=F.useState(!1),[d,h]=F.useState(!1),[p,m]=F.useState(""),[x,v]=F.useState(""),[w,E]=F.useState("");F.useEffect(()=>{N()},[]);async function N(){try{const I=await dN();s(I)}catch(I){console.error("Error loading PYQs:",I)}finally{i(!1)}}async function A(I){if(I.preventDefault(),!(!p.trim()||!x.trim()||!w.trim())){h(!0);try{await hL(p.trim(),x.trim(),w.trim(),e?.name||"Admin"),await N(),m(""),v(""),E(""),u(!1)}catch(P){console.error("Error adding PYQ:",P),alert("Failed to add PYQ")}finally{h(!1)}}}async function T(I){try{await fL(I),s(P=>P.filter(U=>U.id!==I))}catch(P){console.error("Error deleting PYQ:",P),alert("Failed to delete PYQ")}}return r?l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 lg:ml-64 flex items-center justify-center",children:l.jsx("div",{className:"w-12 h-12 border-4 border-green-600 border-t-transparent rounded-full animate-spin"})}):l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-800 rounded-xl transition-colors",children:l.jsx(zt,{className:"w-6 h-6 text-gray-700 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:l.jsx(ia,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl text-gray-900 dark:text-white",children:"Free PYQ Papers"}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.length," papers available"]})]})]})]}),l.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 text-white rounded-xl flex items-center gap-2 hover:opacity-90 transition-colors shadow-md",style:{backgroundColor:"#16a34a"},children:[l.jsx(vN,{className:"w-5 h-5"}),"Add PYQ"]})]}),o&&l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 p-6 mb-6 shadow-lg",children:[l.jsx("h2",{className:"text-lg text-gray-900 dark:text-white mb-4",children:"Add New PYQ Paper"}),l.jsxs("form",{onSubmit:A,className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Course Code"}),l.jsx("input",{type:"text",value:p,onChange:I=>m(I.target.value),placeholder:"e.g., CS101",className:"w-full px-4 py-3 bg-gray-100 dark:bg-gray-800 border-0 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 text-gray-900 dark:text-white",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Course Name"}),l.jsx("input",{type:"text",value:x,onChange:I=>v(I.target.value),placeholder:"e.g., Introduction to Programming",className:"w-full px-4 py-3 bg-gray-100 dark:bg-gray-800 border-0 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 text-gray-900 dark:text-white",required:!0})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(yN,{className:"w-4 h-4 inline mr-1"}),"Google Drive Link"]}),l.jsx("input",{type:"url",value:w,onChange:I=>E(I.target.value),placeholder:"https://drive.google.com/...",className:"w-full px-4 py-3 bg-gray-100 dark:bg-gray-800 border-0 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 text-gray-900 dark:text-white",required:!0})]}),l.jsxs("div",{className:"flex gap-3 justify-end",children:[l.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-300 dark:hover:bg-gray-700",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 text-white rounded-xl hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#16a34a"},children:d?"Adding...":"Add PYQ"})]})]})]}),l.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 overflow-hidden shadow-lg",children:t.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Course Code"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Course Name"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Drive Link"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Added By"}),l.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600 dark:text-gray-400",children:"Action"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:t.map(I=>l.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"font-mono bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-2 py-1 rounded text-sm",children:I.courseCode})}),l.jsx("td",{className:"px-6 py-4 text-gray-900 dark:text-white",children:I.courseName}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("a",{href:I.driveLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:underline text-sm",children:[l.jsx(dp,{className:"w-4 h-4"}),"Open"]})}),l.jsx("td",{className:"px-6 py-4 text-gray-500 dark:text-gray-400 text-sm",children:I.addedBy}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("button",{onClick:()=>T(I.id),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:l.jsx(wN,{className:"w-5 h-5"})})})]},I.id))})]})}):l.jsxs("div",{className:"p-12 text-center text-gray-500 dark:text-gray-400",children:[l.jsx(ia,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-700"}),l.jsx("p",{children:"No PYQ papers added yet"}),l.jsx("p",{className:"text-sm mt-1",children:'Click "Add PYQ" to add your first paper'})]})})]})})}function fF(){const{user:n,userProfile:e}=Us(),[t,s]=F.useState([]),[r,i]=F.useState(!0),[o,u]=F.useState(!1),[d,h]=F.useState(!1),[p,m]=F.useState(""),[x,v]=F.useState(""),[w,E]=F.useState("lecture-notes");F.useEffect(()=>{n&&N()},[n]);async function N(){if(n)try{const I=await lL(n.uid);s(I)}catch(I){console.error("Error loading requests:",I)}finally{i(!1)}}async function A(I){if(I.preventDefault(),!(!n||!e||!p.trim()||!x.trim())){h(!0);try{await oL(n.uid,e.name,e.email,p.trim(),x.trim(),w),m(""),v(""),E("lecture-notes"),u(!1),await N()}catch(P){console.error("Error creating request:",P),alert("Failed to submit request")}finally{h(!1)}}}const T=I=>{switch(I){case"pending":return l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 text-xs rounded-full",children:[l.jsx(fa,{className:"w-3 h-3"}),"Pending"]});case"responded":return l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs rounded-full",children:[l.jsx(Ut,{className:"w-3 h-3"}),"Responded"]});case"closed":return l.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 text-xs rounded-full",children:"Closed"})}};return r?l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 lg:ml-64 flex items-center justify-center",children:l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-24 lg:pb-8 lg:ml-64 mobile-page-content",children:l.jsxs("div",{className:"max-w-4xl mx-auto px-4 lg:px-8 py-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl flex items-center justify-center",children:l.jsx(ea,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl text-gray-900 dark:text-white",children:"My Requests"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Request notes you can't find"})]})]}),l.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl flex items-center gap-2 hover:shadow-lg transition-all",children:[l.jsx(vN,{className:"w-5 h-5"}),"New Request"]})]}),o&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-lg w-full shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"Request Notes"}),l.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl",children:l.jsx(pi,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("form",{onSubmit:A,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Title / Subject"}),l.jsx("input",{type:"text",value:p,onChange:I=>m(I.target.value),placeholder:"e.g., Data Structures - Unit 3",required:!0,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),l.jsxs("select",{value:w,onChange:I=>E(I.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"lecture-notes",children:"Lecture Notes"}),l.jsx("option",{value:"assignment",children:"Assignment"}),l.jsx("option",{value:"pyq",children:"PYQ (Previous Year Question)"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),l.jsx("textarea",{value:x,onChange:I=>v(I.target.value),placeholder:"Describe what you're looking for, course code, semester, etc.",required:!0,rows:4,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white resize-none"})]}),l.jsx("button",{type:"submit",disabled:d,className:"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-medium hover:shadow-lg transition-all disabled:opacity-50",children:d?"Submitting...":"Submit Request"})]})]})}),t.length>0?l.jsx("div",{className:"space-y-4",children:t.map(I=>l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg text-gray-900 dark:text-white font-medium",children:I.title}),l.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:I.category.replace("-"," ")})]}),T(I.status)]}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:I.description}),l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500 mb-4",children:["Requested on ",new Date(I.createdAt).toLocaleDateString()]}),I.response&&l.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-4 border border-green-200 dark:border-green-800",children:[l.jsxs("div",{className:"flex items-center gap-2 text-green-700 dark:text-green-400 mb-2",children:[l.jsx(mn,{className:"w-4 h-4"}),l.jsx("span",{className:"font-medium",children:"Admin Response"})]}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:I.response}),I.responseLink&&l.jsxs("a",{href:I.responseLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(dp,{className:"w-4 h-4"}),"View Notes"]})]})]},I.id))}):l.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800",children:[l.jsx(ea,{className:"w-20 h-20 mx-auto mb-4 text-gray-300 dark:text-gray-700"}),l.jsx("h3",{className:"text-gray-900 dark:text-white mb-2",children:"No Requests Yet"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Can't find notes you need? Submit a request!"}),l.jsx("button",{onClick:()=>u(!0),className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all",children:"Submit Your First Request"})]})]})})}function pF({isOpen:n,onClose:e,onLogin:t,onSignup:s,message:r}){return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-md w-full shadow-2xl animate-in fade-in zoom-in duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Login Required"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors",children:l.jsx(pi,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("div",{className:"p-6",children:[l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:r||"Please login or create an account to access this feature."}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:t,className:"w-full py-3 px-4 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white rounded-xl font-medium hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[l.jsx(xN,{className:"w-5 h-5"}),"Sign In"]}),l.jsxs("button",{onClick:s,className:"w-full py-3 px-4 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center justify-center gap-2",children:[l.jsx(I6,{className:"w-5 h-5"}),"Create Account"]})]})]})]})}):null}function mF(){const n=ql();return l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950",children:[l.jsx("header",{className:"sticky top-0 z-50 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-gray-200 dark:border-slate-800",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs(Cs,{to:"/",className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(Is,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white font-semibold",children:"Notezy"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-400 hidden sm:block",children:"Knowledge Marketplace"})]})]}),l.jsxs(ht,{onClick:()=>n("/"),variant:"ghost",className:"text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Home"]})]})})}),l.jsx("div",{className:"max-w-4xl mx-auto p-4 lg:p-8 py-8",children:l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsx("h1",{className:"text-3xl text-gray-900 dark:text-white mb-6",children:"Terms & Conditions"}),l.jsxs("div",{className:"space-y-6 text-gray-700 dark:text-slate-300",children:[l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"1. Acceptance of Terms"}),l.jsx("p",{className:"leading-relaxed",children:"By accessing and using Notezy, you accept and agree to be bound by the terms and provision of this agreement. If you do not agree to these terms, please do not use our service."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"2. User Accounts"}),l.jsx("p",{className:"leading-relaxed mb-3",children:"To access certain features of the platform, you must create an account. You agree to:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[l.jsx("li",{children:"Provide accurate and complete information"}),l.jsx("li",{children:"Maintain the security of your password"}),l.jsx("li",{children:"Accept responsibility for all activities under your account"}),l.jsx("li",{children:"Notify us immediately of any unauthorized access"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"3. Content Guidelines"}),l.jsx("p",{className:"leading-relaxed mb-3",children:"When uploading notes and educational materials, you must ensure that:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[l.jsx("li",{children:"You own the copyright or have permission to share the content"}),l.jsx("li",{children:"The content does not violate any intellectual property rights"}),l.jsx("li",{children:"The material is accurate and not misleading"}),l.jsx("li",{children:"The content does not contain harmful or inappropriate material"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"4. Purchases and Payments"}),l.jsx("p",{className:"leading-relaxed",children:"All purchases made through Notezy are final. We reserve the right to refuse or cancel any transaction. Sellers agree to our revenue sharing model, and earnings will be paid according to our payment schedule."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"5. Intellectual Property"}),l.jsx("p",{className:"leading-relaxed",children:"The Notezy platform, including its design, features, and original content, is protected by copyright and other intellectual property laws. Users retain ownership of their uploaded content but grant us a license to display and distribute it through our platform."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"6. Prohibited Activities"}),l.jsx("p",{className:"leading-relaxed mb-3",children:"Users are prohibited from:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[l.jsx("li",{children:"Uploading copyrighted material without permission"}),l.jsx("li",{children:"Engaging in fraudulent activities"}),l.jsx("li",{children:"Harassing or threatening other users"}),l.jsx("li",{children:"Attempting to compromise platform security"}),l.jsx("li",{children:"Using automated tools to scrape content"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"7. Termination"}),l.jsx("p",{className:"leading-relaxed",children:"We reserve the right to suspend or terminate accounts that violate these terms without prior notice. Users may close their accounts at any time through the settings page."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"8. Limitation of Liability"}),l.jsx("p",{className:"leading-relaxed",children:'Notezy is provided "as is" without warranties of any kind. We are not liable for any damages arising from the use of our platform, including but not limited to loss of data, revenue, or educational opportunities.'})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"9. Changes to Terms"}),l.jsx("p",{className:"leading-relaxed",children:"We reserve the right to modify these terms at any time. Users will be notified of significant changes via email. Continued use of the platform after changes constitutes acceptance of the new terms."})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"10. Contact Information"}),l.jsxs("p",{className:"leading-relaxed",children:["For questions about these terms, please contact us at"," ",l.jsx("a",{href:"mailto:notzy2026@gmail.com",className:"text-purple-600 dark:text-purple-400 hover:underline",children:"notzy2026@gmail.com"})]})]}),l.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-slate-800",children:l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Last updated: December 2025"})})]})]})})]})}function gF(){const n=ql();return l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950",children:[l.jsx("header",{className:"sticky top-0 z-50 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-gray-200 dark:border-slate-800",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs(Cs,{to:"/",className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(Is,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white font-semibold",children:"Notezy"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-400 hidden sm:block",children:"Knowledge Marketplace"})]})]}),l.jsxs(ht,{onClick:()=>n("/"),variant:"ghost",className:"text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Home"]})]})})}),l.jsx("div",{className:"max-w-4xl mx-auto p-4 lg:p-8 py-8",children:l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-teal-500 rounded-xl flex items-center justify-center",children:l.jsx(Wn,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl text-gray-900 dark:text-white",children:"Privacy Policy"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"How we protect and handle your data"})]})]}),l.jsxs("div",{className:"space-y-6 text-gray-700 dark:text-slate-300",children:[l.jsx("p",{className:"text-lg text-gray-900 dark:text-white",children:"Your privacy and security are our top priorities. We implement industry-standard security measures to protect your personal information."}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Data Protection"}),l.jsxs("ul",{className:"space-y-3",children:[l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Encryption:"})," All user data is encrypted and stored securely using industry-standard protocols"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"No Third-Party Sharing:"})," We never share your personal information with third parties without your explicit consent"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Secure Payments:"})," Payment information is processed through secure, PCI-compliant gateways"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Data Control:"})," You have full control over your data and can request deletion anytime"]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Information We Collect"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Account information (name, email address)"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Transaction history and purchase records"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Uploaded content and notes"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsx("span",{children:"Usage data and analytics (anonymous)"})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"How We Use Your Data"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"To provide and improve our services"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"To process transactions and payments"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"To send important account updates (with your permission)"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsx("span",{children:"To prevent fraud and ensure platform security"})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Your Rights"}),l.jsx("p",{className:"mb-3",children:"You have the right to:"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-pink-600 dark:text-pink-400 mt-1",children:""}),l.jsx("span",{children:"Access your personal data"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-pink-600 dark:text-pink-400 mt-1",children:""}),l.jsx("span",{children:"Request correction of inaccurate data"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-pink-600 dark:text-pink-400 mt-1",children:""}),l.jsx("span",{children:"Request deletion of your account and data"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-pink-600 dark:text-pink-400 mt-1",children:""}),l.jsx("span",{children:"Opt-out of marketing communications"})]})]})]}),l.jsx("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700 bg-blue-50 dark:bg-blue-500/10 p-4 rounded-lg border border-blue-200 dark:border-blue-500/20",children:l.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Note:"})," Notezy is not meant for collecting personally identifiable information (PII) or handling sensitive data beyond what's necessary for the platform operation. We are committed to data minimization and only collect what's essential."]})}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:["For any privacy-related questions or to exercise your rights, please contact us at"," ",l.jsx("a",{href:"mailto:notzy2026@gmail.com",className:"text-purple-600 dark:text-purple-400 hover:underline",children:"notzy2026@gmail.com"})]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-500 mt-4",children:"Last updated: December 2025"})]})]})]})})]})}function yF(){const n=ql();return l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950",children:[l.jsx("header",{className:"sticky top-0 z-50 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-gray-200 dark:border-slate-800",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs(Cs,{to:"/",className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(Is,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white font-semibold",children:"Notezy"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-400 hidden sm:block",children:"Knowledge Marketplace"})]})]}),l.jsxs(ht,{onClick:()=>n("/"),variant:"ghost",className:"text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Home"]})]})})}),l.jsx("div",{className:"max-w-4xl mx-auto p-4 lg:p-8 py-8",children:l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-rose-500 rounded-xl flex items-center justify-center",children:l.jsx(Vs,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl text-gray-900 dark:text-white",children:"Refund & Cancellation Policy"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"Understanding our digital product policy"})]})]}),l.jsx("div",{className:"mb-6 p-6 bg-red-50 dark:bg-red-500/10 border-2 border-red-200 dark:border-red-500/20 rounded-xl",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(pN,{className:"w-6 h-6 text-red-600 dark:text-red-400 mt-1 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg text-red-700 dark:text-red-400 mb-2",children:"No Refunds  No Cancellations"}),l.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm",children:"All sales are final. Due to the digital nature of our products, we cannot offer refunds or cancellations once a purchase is completed and the notes are downloaded."})]})]})}),l.jsxs("div",{className:"space-y-6 text-gray-700 dark:text-slate-300",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Why No Refunds?"}),l.jsx("p",{className:"mb-4",children:'Notezy offers digital products (study notes, assignments, PYQ papers) that are delivered instantly upon purchase. Unlike physical products, digital content cannot be "returned" once accessed.'}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Instant Access:"})," You receive immediate access to the content after purchase"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Digital Nature:"})," Once downloaded, the content is in your possession"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Industry Standard:"})," This is standard practice for digital content platforms"]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Before You Purchase"}),l.jsx("p",{className:"mb-4",children:"We encourage all users to make informed decisions before purchasing. Here's what you can do:"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Preview Content:"})," Use the preview feature to review sample pages before buying"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Read Reviews:"})," Check ratings and reviews from other students"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Check Details:"})," Review the note description, page count, and topics covered"]})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-purple-600 dark:text-purple-400 mt-1",children:""}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Verify Seller:"})," Look at the seller's rating and upload history"]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Order Cancellation"}),l.jsx("p",{className:"mb-3",children:"Orders cannot be cancelled once the payment is processed, as you receive immediate access to the purchased content."}),l.jsx("div",{className:"bg-amber-50 dark:bg-amber-500/10 border border-amber-200 dark:border-amber-500/20 rounded-lg p-4",children:l.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-400",children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Tip:"})," Double-check your cart before completing the purchase to ensure you're buying the correct notes."]})})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Technical Issues"}),l.jsx("p",{className:"mb-3",children:"If you experience technical difficulties accessing your purchased content, we're here to help:"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Download problems or corrupted files"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Payment processed but content not accessible"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Missing pages or incomplete content"})]})]}),l.jsxs("p",{className:"mt-3 text-sm",children:["Please contact our support team at"," ",l.jsx("a",{href:"mailto:notzy2026@gmail.com",className:"text-purple-600 dark:text-purple-400 hover:underline",children:"notzy2026@gmail.com"})," ","with your order details and we'll resolve the issue promptly."]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Content Quality Issues"}),l.jsx("p",{className:"mb-3",children:"While we don't offer refunds, we take content quality seriously. If you receive notes that are:"}),l.jsxs("ul",{className:"space-y-2 mb-4",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Significantly different from the description"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Plagiarized or violate copyright"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Completely unreadable or unusable"})]})]}),l.jsx("p",{className:"text-sm",children:"Please report the issue to us immediately. We will investigate and may take action against the seller, including removal of the content from our platform."})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50 p-4 rounded-lg",children:[l.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Policy Updates:"})," We reserve the right to update this policy at any time. Continued use of the platform after changes constitutes acceptance of the updated policy."]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-500 mt-3",children:"Last updated: December 2025"})]})]})]})})]})}function xF(){const n=ql();return l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950",children:[l.jsx("header",{className:"sticky top-0 z-50 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-gray-200 dark:border-slate-800",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs(Cs,{to:"/",className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(Is,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white font-semibold",children:"Notezy"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-400 hidden sm:block",children:"Knowledge Marketplace"})]})]}),l.jsxs(ht,{onClick:()=>n("/"),variant:"ghost",className:"text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Home"]})]})})}),l.jsx("div",{className:"max-w-4xl mx-auto p-4 lg:p-8 py-8",children:l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center",children:l.jsx(fp,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl text-gray-900 dark:text-white",children:"Shipping & Delivery Policy"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"Digital delivery information"})]})]}),l.jsx("div",{className:"mb-6 p-6 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-500/10 dark:to-purple-500/10 border border-blue-200 dark:border-blue-500/20 rounded-xl",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(qn,{className:"w-6 h-6 text-blue-600 dark:text-blue-400 mt-1 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-2",children:"100% Digital - No Physical Shipping"}),l.jsx("p",{className:"text-gray-700 dark:text-slate-300 text-sm",children:"All notes are delivered digitally through our platform. There's no physical shipping involved, which means instant access and no delivery charges!"})]})]})}),l.jsxs("div",{className:"space-y-6 text-gray-700 dark:text-slate-300",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-4",children:"How It Works"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-blue-100 dark:bg-blue-500/20 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:"1"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-gray-900 dark:text-white mb-1 font-medium",children:"Purchase Notes"}),l.jsx("p",{className:"text-sm",children:"Browse and purchase the notes you need from our marketplace"})]})]}),l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-purple-100 dark:bg-purple-500/20 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-semibold",children:"2"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-gray-900 dark:text-white mb-1 font-medium",children:"Instant Access"}),l.jsx("p",{className:"text-sm",children:"Payment is processed securely and you get immediate access"})]})]}),l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-pink-100 dark:bg-pink-500/20 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-pink-600 dark:text-pink-400 font-semibold",children:"3"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-gray-900 dark:text-white mb-1 font-medium",children:'Download from "Downloads" Section'}),l.jsx("p",{className:"text-sm",children:"Access all your purchased notes anytime from the Downloads page"})]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-4",children:"Delivery Timeline"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-green-50 dark:bg-green-500/10 border border-green-200 dark:border-green-500/20 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(fa,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),l.jsx("h4",{className:"text-gray-900 dark:text-white font-medium",children:"Processing Time"})]}),l.jsxs("p",{className:"text-sm text-gray-700 dark:text-slate-300",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 font-semibold",children:"Instant"})," - Notes are available immediately after payment confirmation"]})]}),l.jsxs("div",{className:"bg-blue-50 dark:bg-blue-500/10 border border-blue-200 dark:border-blue-500/20 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(qn,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),l.jsx("h4",{className:"text-gray-900 dark:text-white font-medium",children:"Download Speed"})]}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-slate-300",children:"Depends on your internet connection - typically a few seconds"})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Benefits of Digital Delivery"}),l.jsxs("ul",{className:"space-y-3",children:[l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Instant Access:"})," No waiting for shipping - get your notes immediately after purchase"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"No Shipping Charges:"})," Zero delivery fees - pay only for the content"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Access Anywhere:"})," Download on any device, anytime, from anywhere"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Eco-Friendly:"})," No paper waste or carbon emissions from shipping"]})]}),l.jsxs("li",{className:"flex items-start gap-3",children:[l.jsx(Ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),l.jsxs("span",{children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Permanent Access:"})," Your purchased notes remain in your Downloads section indefinitely"]})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Technical Requirements"}),l.jsxs("ul",{className:"space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Internet connection for downloading"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"PDF viewer (built into the platform) or PDF reader software"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:""}),l.jsx("span",{children:"Compatible with all modern browsers and devices"})]})]})]}),l.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700",children:[l.jsx("h3",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Having Issues?"}),l.jsx("p",{className:"mb-3",children:"If you experience any problems accessing your purchased notes:"}),l.jsxs("ul",{className:"space-y-2 mb-4",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Check your internet connection"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Ensure your payment was successfully processed"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Try refreshing the Downloads page"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400 mt-1",children:""}),l.jsx("span",{children:"Clear your browser cache and cookies"})]})]}),l.jsxs("p",{className:"text-sm",children:["Still having trouble? Contact our support team at"," ",l.jsx("a",{href:"mailto:notzy2026@gmail.com",className:"text-purple-600 dark:text-purple-400 hover:underline",children:"notzy2026@gmail.com"})," ","and we'll help you resolve the issue."]})]}),l.jsx("div",{className:"pt-6 border-t border-gray-200 dark:border-slate-700 bg-blue-50 dark:bg-blue-500/10 p-4 rounded-lg border border-blue-200 dark:border-blue-500/20",children:l.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:[l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Remember:"})," All notes are delivered digitally. There are no physical products shipped, no tracking numbers, and no delivery addresses required. Everything happens instantly online!"]})}),l.jsx("div",{className:"pt-4",children:l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-500",children:"Last updated: December 2025"})})]})]})})]})}function bF(){const n=ql();return l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950",children:[l.jsx("header",{className:"sticky top-0 z-50 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-gray-200 dark:border-slate-800",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs(Cs,{to:"/",className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(Is,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-gray-900 dark:text-white font-semibold",children:"Notezy"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-400 hidden sm:block",children:"Knowledge Marketplace"})]})]}),l.jsxs(ht,{onClick:()=>n("/"),variant:"ghost",className:"text-gray-700 dark:text-slate-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(zt,{className:"w-5 h-5 mr-2"}),"Back to Home"]})]})})}),l.jsxs("div",{className:"max-w-4xl mx-auto p-4 lg:p-8 py-8",children:[l.jsxs("div",{className:"text-center mb-12",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-2xl mb-6 shadow-xl",children:l.jsx(Ul,{className:"w-10 h-10 text-white"})}),l.jsx("h1",{className:"text-4xl text-gray-900 dark:text-white mb-4",children:"Contact Us"}),l.jsx("p",{className:"text-lg text-gray-600 dark:text-slate-400 max-w-2xl mx-auto",children:"Have questions, feedback, or need support? We'd love to hear from you! Our team is here to help."})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsx("h2",{className:"text-2xl text-gray-900 dark:text-white mb-6",children:"Get in Touch"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center flex-shrink-0",children:l.jsx(Ul,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-gray-900 dark:text-white font-medium mb-1",children:"Email Us"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400 mb-2",children:"For general inquiries and support"}),l.jsx("a",{href:"mailto:notzy2026@gmail.com",className:"text-purple-600 dark:text-purple-400 hover:underline font-medium",children:"notzy2026@gmail.com"})]})]}),l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-teal-500 rounded-xl flex items-center justify-center flex-shrink-0",children:l.jsx(fa,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-gray-900 dark:text-white font-medium mb-1",children:"Response Time"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:"We typically respond within 24-48 hours during business days"})]})]}),l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500 to-rose-500 rounded-xl flex items-center justify-center flex-shrink-0",children:l.jsx(mn,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-gray-900 dark:text-white font-medium mb-1",children:"In-App Support"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:"Logged-in users can access our support chat directly from the app for faster assistance"})]})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-gray-200 dark:border-slate-800 rounded-2xl p-6 lg:p-8",children:[l.jsx("h2",{className:"text-2xl text-gray-900 dark:text-white mb-6",children:"How Can We Help?"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-500/10 border border-blue-200 dark:border-blue-500/20 rounded-xl",children:[l.jsx("h3",{className:"text-gray-900 dark:text-white font-medium mb-2",children:" Purchase Issues"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:"Problems with payments, accessing purchased notes, or transaction disputes"})]}),l.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-500/10 border border-purple-200 dark:border-purple-500/20 rounded-xl",children:[l.jsx("h3",{className:"text-gray-900 dark:text-white font-medium mb-2",children:" Seller Support"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:"Help with uploading notes, earnings withdrawals, or seller account issues"})]}),l.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-500/10 border border-green-200 dark:border-green-500/20 rounded-xl",children:[l.jsx("h3",{className:"text-gray-900 dark:text-white font-medium mb-2",children:" Technical Support"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:"App bugs, download issues, or account-related technical problems"})]}),l.jsxs("div",{className:"p-4 bg-amber-50 dark:bg-amber-500/10 border border-amber-200 dark:border-amber-500/20 rounded-xl",children:[l.jsx("h3",{className:"text-gray-900 dark:text-white font-medium mb-2",children:" Feedback & Suggestions"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:"Ideas for new features, improvements, or general feedback about the platform"})]}),l.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-500/10 border border-red-200 dark:border-red-500/20 rounded-xl",children:[l.jsx("h3",{className:"text-gray-900 dark:text-white font-medium mb-2",children:" Report Content"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400",children:"Report plagiarized, inappropriate, or misleading content on the platform"})]})]})]})]}),l.jsxs("div",{className:"mt-8 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-500/10 dark:to-purple-500/10 border border-blue-200 dark:border-blue-500/20 rounded-2xl p-6 lg:p-8 text-center",children:[l.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-3",children:"Before You Contact Us"}),l.jsx("p",{className:"text-gray-600 dark:text-slate-400 mb-4",children:"Many common questions are answered in our policy pages. Check them out for quick answers!"}),l.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[l.jsx(Cs,{to:"/terms",className:"px-4 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-700 rounded-lg text-sm text-gray-700 dark:text-slate-300 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",children:"Terms & Conditions"}),l.jsx(Cs,{to:"/privacy",className:"px-4 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-700 rounded-lg text-sm text-gray-700 dark:text-slate-300 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",children:"Privacy Policy"}),l.jsx(Cs,{to:"/refund",className:"px-4 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-700 rounded-lg text-sm text-gray-700 dark:text-slate-300 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",children:"Refund Policy"}),l.jsx(Cs,{to:"/shipping",className:"px-4 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-700 rounded-lg text-sm text-gray-700 dark:text-slate-300 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",children:"Shipping & Delivery"})]})]}),l.jsx("div",{className:"mt-8 text-center",children:l.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-500",children:"We're a growing platform and currently focused on email support. Social media channels coming soon!"})})]})]})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF="type.googleapis.com/google.protobuf.Int64Value",wF="type.googleapis.com/google.protobuf.UInt64Value";function yA(n,e){const t={};for(const s in n)n.hasOwnProperty(s)&&(t[s]=e(n[s]));return t}function Rf(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Rf(e));if(typeof n=="function"||typeof n=="object")return yA(n,e=>Rf(e));throw new Error("Data cannot be encoded in JSON: "+n)}function zl(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case vF:case wF:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>zl(e)):typeof n=="function"||typeof n=="object"?yA(n,e=>zl(e)):n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sx="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Js extends Qn{constructor(e,t,s){super(`${sx}/${e}`,t||""),this.details=s,Object.setPrototypeOf(this,Js.prototype)}}function _F(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Df(n,e){let t=_F(n),s=t,r;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!q_[o])return new Js("internal","internal");t=q_[o],s=o}const u=i.message;typeof u=="string"&&(s=u),r=i.details,r!==void 0&&(r=zl(r))}}catch{}return t==="ok"?null:new Js(t,s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(e,t,s,r){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Xs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=s.getImmediate({optional:!0}),this.auth||t.get().then(i=>this.auth=i,()=>{}),this.messaging||s.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r?.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),s=await this.getMessagingToken(),r=await this.getAppCheckToken(e);return{authToken:t,messagingToken:s,appCheckToken:r}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0="us-central1",EF=/^data: (.*?)(?:\n|$)/;function NF(n){let e=null;return{promise:new Promise((t,s)=>{e=setTimeout(()=>{s(new Js("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class AF{constructor(e,t,s,r,i=E0,o=(...u)=>fetch(...u)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new kF(e,t,s,r),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{const u=new URL(i);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=E0}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function SF(n,e,t){const s=Ir(e);n.emulatorOrigin=`http${s?"s":""}://${e}:${t}`,s&&(Ff(n.emulatorOrigin+"/backends"),Vf("Functions",!0))}function TF(n,e,t){const s=r=>IF(n,e,r,{});return s.stream=(r,i)=>jF(n,e,r,i),s}function xA(n){return n.emulatorOrigin&&Ir(n.emulatorOrigin)?"include":void 0}async function CF(n,e,t,s,r){t["Content-Type"]="application/json";let i;try{i=await s(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:xA(r)})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}async function bA(n,e){const t={},s=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return s.authToken&&(t.Authorization="Bearer "+s.authToken),s.messagingToken&&(t["Firebase-Instance-ID-Token"]=s.messagingToken),s.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=s.appCheckToken),t}function IF(n,e,t,s){const r=n._url(e);return PF(n,r,t,s)}async function PF(n,e,t,s){t=Rf(t);const r={data:t},i=await bA(n,s),o=s.timeout||7e4,u=NF(o),d=await Promise.race([CF(e,r,i,n.fetchImpl,n),u.promise,n.cancelAllRequests]);if(u.cancel(),!d)throw new Js("cancelled","Firebase Functions instance was deleted.");const h=Df(d.status,d.json);if(h)throw h;if(!d.json)throw new Js("internal","Response is not valid JSON object.");let p=d.json.data;if(typeof p>"u"&&(p=d.json.result),typeof p>"u")throw new Js("internal","Response is missing data field.");return{data:zl(p)}}function jF(n,e,t,s){const r=n._url(e);return RF(n,r,t,s||{})}async function RF(n,e,t,s){t=Rf(t);const r={data:t},i=await bA(n,s);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(r),headers:i,signal:s?.signal,credentials:xA(n)})}catch(x){if(x instanceof Error&&x.name==="AbortError"){const w=new Js("cancelled","Request was cancelled.");return{data:Promise.reject(w),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(w)}}}}}}const v=Df(0,null);return{data:Promise.reject(v),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(v)}}}}}}let u,d;const h=new Promise((x,v)=>{u=x,d=v});s?.signal?.addEventListener("abort",()=>{const x=new Js("cancelled","Request was cancelled.");d(x)});const p=o.body.getReader(),m=DF(p,u,d,s?.signal);return{stream:{[Symbol.asyncIterator](){const x=m.getReader();return{async next(){const{value:v,done:w}=await x.read();return{value:v,done:w}},async return(){return await x.cancel(),{done:!0,value:void 0}}}}},data:h}}function DF(n,e,t,s){const r=(o,u)=>{const d=o.match(EF);if(!d)return;const h=d[1];try{const p=JSON.parse(h);if("result"in p){e(zl(p.result));return}if("message"in p){u.enqueue(zl(p.message));return}if("error"in p){const m=Df(0,p);u.error(m),t(m);return}}catch(p){if(p instanceof Js){u.error(p),t(p);return}}},i=new TextDecoder;return new ReadableStream({start(o){let u="";return d();async function d(){if(s?.aborted){const h=new Js("cancelled","Request was cancelled");return o.error(h),t(h),Promise.resolve()}try{const{value:h,done:p}=await n.read();if(p){u.trim()&&r(u.trim(),o),o.close();return}if(s?.aborted){const x=new Js("cancelled","Request was cancelled");o.error(x),t(x),await n.cancel();return}u+=i.decode(h,{stream:!0});const m=u.split(`
`);u=m.pop()||"";for(const x of m)x.trim()&&r(x.trim(),o);return d()}catch(h){const p=h instanceof Js?h:Df(0,null);o.error(p),t(p)}}},cancel(){return n.cancel()}})}const W_="@firebase/functions",G_="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF="auth-internal",LF="app-check-internal",OF="messaging-internal";function FF(n){const e=(t,{instanceIdentifier:s})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider(MF),o=t.getProvider(OF),u=t.getProvider(LF);return new AF(r,i,o,u,s)};aa(new ri(sx,e,"PUBLIC").setMultipleInstances(!0)),Cn(W_,G_,n),Cn(W_,G_,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VF(n=Uf(),e=E0){const s=zu(bt(n),sx).getImmediate({identifier:e}),r=P0("functions");return r&&UF(s,...r),s}function UF(n,e,t){SF(bt(n),e,t)}function K_(n,e,t){return TF(bt(n),e)}FF();function BF(){const{user:n,userProfile:e}=Us(),[t,s]=F.useState(!1),[r,i]=F.useState(null);return{initiatePayment:async(u,d,h)=>{if(!n||!e)return{success:!1,error:"Please login to make a purchase"};s(!0),i(null);try{const p=VF(),v=(await K_(p,"createRazorpayOrder")({noteId:u,amount:d})).data;return new Promise(w=>{const E={key:"rzp_live_RtZARbkXo0ilnE",amount:v.amount,currency:v.currency,name:"Notezy",description:`Purchase: ${h}`,order_id:v.orderId,prefill:{name:e.name,email:e.email},theme:{color:"#6366f1"},handler:async function(A){try{const P=(await K_(p,"verifyRazorpayPayment")({razorpay_order_id:A.razorpay_order_id,razorpay_payment_id:A.razorpay_payment_id,razorpay_signature:A.razorpay_signature})).data;s(!1),w({success:!0,noteId:P.noteId})}catch(T){s(!1),i(T.message||"Payment verification failed"),w({success:!1,error:T.message})}},modal:{ondismiss:function(){s(!1),w({success:!1,error:"Payment cancelled"})}}},N=new window.Razorpay(E);N.on("payment.failed",function(A){s(!1),i(A.error.description),w({success:!1,error:A.error.description})}),N.open()})}catch(p){s(!1);const m=p.message||"Failed to initiate payment";return i(m),{success:!1,error:m}}},loading:t,error:r,clearError:()=>i(null)}}function zF(){const{isAuthenticated:n,isLoading:e,user:t,userProfile:s,logout:r,isGuest:i,exitGuestMode:o}=Us(),{initiatePayment:u}=BF(),[d,h]=F.useState("landing"),[p,m]=F.useState("home"),[x,v]=F.useState(""),[w,E]=F.useState(null),[N,A]=F.useState(null),[T,I]=F.useState(!1),[P,U]=F.useState("");F.useEffect(()=>{s?.isAdmin&&p==="home"&&m("admin")},[s?.isAdmin]);const O=s?.isBlocked||!1,[R,C]=F.useState([]),[D,B]=F.useState([]),[V,$]=F.useState([]),[L,de]=F.useState([]),[ye,ie]=F.useState([]),[oe,Y]=F.useState([]),[he,le]=F.useState(!0);if(F.useEffect(()=>{async function Se(){try{const[We,st]=await Promise.all([Ly(),dN()]);C(We),B(st)}catch(We){console.error("Error fetching notes:",We)}}Se()},[]),F.useEffect(()=>{async function Se(){if(!t){$([]),de([]),ie([]),Y([]),le(!1);return}try{le(!0);const[We,st,Tt,en]=await Promise.all([FM(t.uid),VM(t.uid),zM(t.uid),$M(t.uid)]);$(We),de(st),ie(Tt),Y(en)}catch(We){console.error("Error fetching user data:",We)}finally{le(!1)}}Se()},[t]),e)return l.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-slate-400",children:"Loading..."})]})});if(!n&&!i)return d==="login"?l.jsx(X3,{onNavigateToSignup:()=>h("signup"),onNavigateToLanding:()=>h("landing")}):d==="signup"?l.jsx(Q3,{onNavigateToLogin:()=>h("login"),onNavigateToLanding:()=>h("landing")}):l.jsx(Y3,{onNavigateToLogin:()=>h("login"),onNavigateToSignup:()=>h("signup")});const W=Se=>i?(U(Se),I(!0),!1):!0,Z=()=>{I(!1),o(),h("login")},ce=()=>{I(!1),o(),h("signup")},xe=async Se=>{if(!W("Please login to purchase notes.")||!t)return;const We=R.find(st=>st.id===Se);if(We&&!oe.includes(Se))try{const st=await u(Se,We.price,We.title);st.success?($([...V,We]),Y([...oe,Se]),alert(`Successfully purchased "${We.title}"!`)):st.error&&st.error!=="Payment cancelled"&&alert(`Payment failed: ${st.error}`)}catch(st){console.error("Error purchasing note:",st),alert("Failed to initiate payment. Please try again.")}},je=async Se=>{if(!W("Please login to bookmark notes.")||!t)return;const We=R.find(st=>st.id===Se);if(We){const st=ye.includes(Se);try{st?(await BM(t.uid,Se),de(L.filter(Tt=>Tt.id!==Se)),ie(ye.filter(Tt=>Tt!==Se))):(await UM(t.uid,Se),de([...L,We]),ie([...ye,Se]))}catch(Tt){console.error("Error updating bookmark:",Tt)}}},Re=async Se=>{if(!W("Please login to view full notes."))return;const We=[...V,...R].find(st=>st.id===Se);We&&A(We)},fe=s||{id:t?.uid||"",name:t?.displayName||"User",email:t?.email||"",avatarUrl:"",totalEarnings:0,uploadedNotes:[]},Ue=p==="home";return O?p==="support"?l.jsx("div",{className:"min-h-screen bg-slate-950",children:l.jsx(H_,{onBack:()=>m("home")})}):l.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-4",children:l.jsxs("div",{className:"max-w-md w-full bg-slate-900 border border-slate-800 rounded-2xl p-8 text-center",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#dc2626"},children:l.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),l.jsx("h1",{className:"text-2xl text-white mb-2",children:"Account Blocked"}),l.jsx("p",{className:"text-slate-400 mb-8",children:"Your account has been blocked. If you believe this is a mistake or need help, please contact our support team."}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("button",{onClick:()=>m("support"),className:"w-full py-3 px-6 rounded-xl text-white font-medium transition-colors",style:{backgroundColor:"#2563eb"},children:" Chat with Customer Care"}),l.jsx("button",{onClick:()=>r(),className:"w-full py-3 px-6 rounded-xl bg-slate-800 text-white font-medium hover:bg-slate-700 transition-colors",children:" Logout"})]})]})}):l.jsxs("div",{className:"min-h-screen bg-slate-950",children:[l.jsx(V6,{currentPage:p,onNavigate:m,onLoginRequest:Z}),l.jsx("div",{className:"hidden lg:block",children:l.jsx(U6,{searchQuery:x,onSearchChange:v,showSearch:Ue})}),p==="home"&&l.jsx(B6,{notes:R,freePYQs:D,onPreview:E,onBookmark:je,onPurchase:xe,onViewNotes:Re,bookmarkedIds:ye,purchasedIds:oe,searchQuery:x,onSearchChange:v,onRequestNotes:()=>m("my-requests")}),p==="downloads"&&l.jsx(z6,{purchasedNotes:V,onPreview:E,onViewNotes:Re}),p==="bookmarks"&&l.jsx($6,{bookmarkedNotes:L,onPreview:E,onBookmark:je,onPurchase:xe,onViewNotes:Re,purchasedIds:oe}),p==="earnings"&&l.jsx(H6,{totalEarnings:fe.totalEarnings,uploadedNotes:fe.uploadedNotes}),p==="profile"&&l.jsx(K6,{user:fe,onPreview:E}),p==="upload"&&l.jsx(G5,{}),p==="settings"&&l.jsx(J3,{onNavigateToTerms:()=>m("terms"),onNavigateToAbout:()=>m("about"),onNavigateToPrivacy:()=>m("privacy"),onNavigateToRefund:()=>m("refund"),onNavigateToShipping:()=>m("shipping")}),p==="terms"&&l.jsx(Z3,{onBack:()=>m("settings")}),p==="about"&&l.jsx(eF,{onBack:()=>m("settings")}),p==="privacy"&&l.jsx(tF,{onBack:()=>m("settings")}),p==="refund"&&l.jsx(sF,{onBack:()=>m("settings")}),p==="shipping"&&l.jsx(nF,{onBack:()=>m("settings")}),p==="support"&&l.jsx(H_,{onBack:()=>m("home")}),p==="admin"&&l.jsx(iF,{onNavigate:m}),p==="admin-earnings"&&l.jsx(aF,{onBack:()=>m("admin")}),p==="admin-notes"&&l.jsx(oF,{onBack:()=>m("admin")}),p==="admin-chats"&&l.jsx(lF,{onBack:()=>m("admin")}),p==="admin-users"&&l.jsx(cF,{}),p==="admin-payouts"&&l.jsx(uF,{onBack:()=>m("admin")}),p==="admin-requests"&&l.jsx(dF,{onBack:()=>m("admin")}),p==="admin-pyqs"&&l.jsx(hF,{onBack:()=>m("admin")}),p==="my-requests"&&l.jsx(fF,{}),w&&l.jsx(K5,{note:w,onClose:()=>E(null)}),N&&l.jsx(rF,{note:N,onClose:()=>A(null)}),l.jsx(pF,{isOpen:T,onClose:()=>I(!1),onLogin:Z,onSignup:ce,message:P})]})}function $F(){return l.jsx(mC,{children:l.jsx(pL,{children:l.jsxs(MT,{children:[l.jsx(Ja,{path:"/terms",element:l.jsx(mF,{})}),l.jsx(Ja,{path:"/privacy",element:l.jsx(gF,{})}),l.jsx(Ja,{path:"/refund",element:l.jsx(yF,{})}),l.jsx(Ja,{path:"/shipping",element:l.jsx(xF,{})}),l.jsx(Ja,{path:"/contact",element:l.jsx(bF,{})}),l.jsx(Ja,{path:"/*",element:l.jsx(zF,{})})]})})})}LS.createRoot(document.getElementById("root")).render(l.jsx(iC,{children:l.jsx($F,{})}));
